(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();var cu={exports:{}},gi={},uu={exports:{}},lt={};var Ld;function Pm(){if(Ld)return lt;Ld=1;var e=Symbol.for("react.element"),r=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),u=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),w=Symbol.iterator;function y(Y){return Y===null||typeof Y!="object"?null:(Y=w&&Y[w]||Y["@@iterator"],typeof Y=="function"?Y:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N=Object.assign,g={};function _(Y,k,q){this.props=Y,this.context=k,this.refs=g,this.updater=q||E}_.prototype.isReactComponent={},_.prototype.setState=function(Y,k){if(typeof Y!="object"&&typeof Y!="function"&&Y!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Y,k,"setState")},_.prototype.forceUpdate=function(Y){this.updater.enqueueForceUpdate(this,Y,"forceUpdate")};function b(){}b.prototype=_.prototype;function I(Y,k,q){this.props=Y,this.context=k,this.refs=g,this.updater=q||E}var O=I.prototype=new b;O.constructor=I,N(O,_.prototype),O.isPureReactComponent=!0;var J=Array.isArray,he=Object.prototype.hasOwnProperty,de={current:null},z={key:!0,ref:!0,__self:!0,__source:!0};function re(Y,k,q){var B,U={},oe=null,Ee=null;if(k!=null)for(B in k.ref!==void 0&&(Ee=k.ref),k.key!==void 0&&(oe=""+k.key),k)he.call(k,B)&&!z.hasOwnProperty(B)&&(U[B]=k[B]);var Te=arguments.length-2;if(Te===1)U.children=q;else if(1<Te){for(var ee=Array(Te),te=0;te<Te;te++)ee[te]=arguments[te+2];U.children=ee}if(Y&&Y.defaultProps)for(B in Te=Y.defaultProps,Te)U[B]===void 0&&(U[B]=Te[B]);return{$$typeof:e,type:Y,key:oe,ref:Ee,props:U,_owner:de.current}}function V(Y,k){return{$$typeof:e,type:Y.type,key:k,ref:Y.ref,props:Y.props,_owner:Y._owner}}function M(Y){return typeof Y=="object"&&Y!==null&&Y.$$typeof===e}function L(Y){var k={"=":"=0",":":"=2"};return"$"+Y.replace(/[=:]/g,function(q){return k[q]})}var X=/\/+/g;function K(Y,k){return typeof Y=="object"&&Y!==null&&Y.key!=null?L(""+Y.key):k.toString(36)}function ne(Y,k,q,B,U){var oe=typeof Y;(oe==="undefined"||oe==="boolean")&&(Y=null);var Ee=!1;if(Y===null)Ee=!0;else switch(oe){case"string":case"number":Ee=!0;break;case"object":switch(Y.$$typeof){case e:case r:Ee=!0}}if(Ee)return Ee=Y,U=U(Ee),Y=B===""?"."+K(Ee,0):B,J(U)?(q="",Y!=null&&(q=Y.replace(X,"$&/")+"/"),ne(U,k,q,"",function(te){return te})):U!=null&&(M(U)&&(U=V(U,q+(!U.key||Ee&&Ee.key===U.key?"":(""+U.key).replace(X,"$&/")+"/")+Y)),k.push(U)),1;if(Ee=0,B=B===""?".":B+":",J(Y))for(var Te=0;Te<Y.length;Te++){oe=Y[Te];var ee=B+K(oe,Te);Ee+=ne(oe,k,q,ee,U)}else if(ee=y(Y),typeof ee=="function")for(Y=ee.call(Y),Te=0;!(oe=Y.next()).done;)oe=oe.value,ee=B+K(oe,Te++),Ee+=ne(oe,k,q,ee,U);else if(oe==="object")throw k=String(Y),Error("Objects are not valid as a React child (found: "+(k==="[object Object]"?"object with keys {"+Object.keys(Y).join(", ")+"}":k)+"). If you meant to render a collection of children, use an array instead.");return Ee}function W(Y,k,q){if(Y==null)return Y;var B=[],U=0;return ne(Y,B,"","",function(oe){return k.call(q,oe,U++)}),B}function Z(Y){if(Y._status===-1){var k=Y._result;k=k(),k.then(function(q){(Y._status===0||Y._status===-1)&&(Y._status=1,Y._result=q)},function(q){(Y._status===0||Y._status===-1)&&(Y._status=2,Y._result=q)}),Y._status===-1&&(Y._status=0,Y._result=k)}if(Y._status===1)return Y._result.default;throw Y._result}var me={current:null},R={transition:null},ve={ReactCurrentDispatcher:me,ReactCurrentBatchConfig:R,ReactCurrentOwner:de};function ye(){throw Error("act(...) is not supported in production builds of React.")}return lt.Children={map:W,forEach:function(Y,k,q){W(Y,function(){k.apply(this,arguments)},q)},count:function(Y){var k=0;return W(Y,function(){k++}),k},toArray:function(Y){return W(Y,function(k){return k})||[]},only:function(Y){if(!M(Y))throw Error("React.Children.only expected to receive a single React element child.");return Y}},lt.Component=_,lt.Fragment=t,lt.Profiler=i,lt.PureComponent=I,lt.StrictMode=s,lt.Suspense=x,lt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ve,lt.act=ye,lt.cloneElement=function(Y,k,q){if(Y==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Y+".");var B=N({},Y.props),U=Y.key,oe=Y.ref,Ee=Y._owner;if(k!=null){if(k.ref!==void 0&&(oe=k.ref,Ee=de.current),k.key!==void 0&&(U=""+k.key),Y.type&&Y.type.defaultProps)var Te=Y.type.defaultProps;for(ee in k)he.call(k,ee)&&!z.hasOwnProperty(ee)&&(B[ee]=k[ee]===void 0&&Te!==void 0?Te[ee]:k[ee])}var ee=arguments.length-2;if(ee===1)B.children=q;else if(1<ee){Te=Array(ee);for(var te=0;te<ee;te++)Te[te]=arguments[te+2];B.children=Te}return{$$typeof:e,type:Y.type,key:U,ref:oe,props:B,_owner:Ee}},lt.createContext=function(Y){return Y={$$typeof:u,_currentValue:Y,_currentValue2:Y,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Y.Provider={$$typeof:o,_context:Y},Y.Consumer=Y},lt.createElement=re,lt.createFactory=function(Y){var k=re.bind(null,Y);return k.type=Y,k},lt.createRef=function(){return{current:null}},lt.forwardRef=function(Y){return{$$typeof:d,render:Y}},lt.isValidElement=M,lt.lazy=function(Y){return{$$typeof:m,_payload:{_status:-1,_result:Y},_init:Z}},lt.memo=function(Y,k){return{$$typeof:p,type:Y,compare:k===void 0?null:k}},lt.startTransition=function(Y){var k=R.transition;R.transition={};try{Y()}finally{R.transition=k}},lt.unstable_act=ye,lt.useCallback=function(Y,k){return me.current.useCallback(Y,k)},lt.useContext=function(Y){return me.current.useContext(Y)},lt.useDebugValue=function(){},lt.useDeferredValue=function(Y){return me.current.useDeferredValue(Y)},lt.useEffect=function(Y,k){return me.current.useEffect(Y,k)},lt.useId=function(){return me.current.useId()},lt.useImperativeHandle=function(Y,k,q){return me.current.useImperativeHandle(Y,k,q)},lt.useInsertionEffect=function(Y,k){return me.current.useInsertionEffect(Y,k)},lt.useLayoutEffect=function(Y,k){return me.current.useLayoutEffect(Y,k)},lt.useMemo=function(Y,k){return me.current.useMemo(Y,k)},lt.useReducer=function(Y,k,q){return me.current.useReducer(Y,k,q)},lt.useRef=function(Y){return me.current.useRef(Y)},lt.useState=function(Y){return me.current.useState(Y)},lt.useSyncExternalStore=function(Y,k,q){return me.current.useSyncExternalStore(Y,k,q)},lt.useTransition=function(){return me.current.useTransition()},lt.version="18.3.1",lt}var Bd;function Lu(){return Bd||(Bd=1,uu.exports=Pm()),uu.exports}var Ud;function Om(){if(Ud)return gi;Ud=1;var e=Lu(),r=Symbol.for("react.element"),t=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,i=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function u(d,x,p){var m,w={},y=null,E=null;p!==void 0&&(y=""+p),x.key!==void 0&&(y=""+x.key),x.ref!==void 0&&(E=x.ref);for(m in x)s.call(x,m)&&!o.hasOwnProperty(m)&&(w[m]=x[m]);if(d&&d.defaultProps)for(m in x=d.defaultProps,x)w[m]===void 0&&(w[m]=x[m]);return{$$typeof:r,type:d,key:y,ref:E,props:w,_owner:i.current}}return gi.Fragment=t,gi.jsx=u,gi.jsxs=u,gi}var zd;function Rm(){return zd||(zd=1,cu.exports=Om()),cu.exports}var c=Rm(),H=Lu(),Gl={},fu={exports:{}},Or={},du={exports:{}},hu={};var Wd;function Dm(){return Wd||(Wd=1,(function(e){function r(R,ve){var ye=R.length;R.push(ve);e:for(;0<ye;){var Y=ye-1>>>1,k=R[Y];if(0<i(k,ve))R[Y]=ve,R[ye]=k,ye=Y;else break e}}function t(R){return R.length===0?null:R[0]}function s(R){if(R.length===0)return null;var ve=R[0],ye=R.pop();if(ye!==ve){R[0]=ye;e:for(var Y=0,k=R.length,q=k>>>1;Y<q;){var B=2*(Y+1)-1,U=R[B],oe=B+1,Ee=R[oe];if(0>i(U,ye))oe<k&&0>i(Ee,U)?(R[Y]=Ee,R[oe]=ye,Y=oe):(R[Y]=U,R[B]=ye,Y=B);else if(oe<k&&0>i(Ee,ye))R[Y]=Ee,R[oe]=ye,Y=oe;else break e}}return ve}function i(R,ve){var ye=R.sortIndex-ve.sortIndex;return ye!==0?ye:R.id-ve.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var u=Date,d=u.now();e.unstable_now=function(){return u.now()-d}}var x=[],p=[],m=1,w=null,y=3,E=!1,N=!1,g=!1,_=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function O(R){for(var ve=t(p);ve!==null;){if(ve.callback===null)s(p);else if(ve.startTime<=R)s(p),ve.sortIndex=ve.expirationTime,r(x,ve);else break;ve=t(p)}}function J(R){if(g=!1,O(R),!N)if(t(x)!==null)N=!0,Z(he);else{var ve=t(p);ve!==null&&me(J,ve.startTime-R)}}function he(R,ve){N=!1,g&&(g=!1,b(re),re=-1),E=!0;var ye=y;try{for(O(ve),w=t(x);w!==null&&(!(w.expirationTime>ve)||R&&!L());){var Y=w.callback;if(typeof Y=="function"){w.callback=null,y=w.priorityLevel;var k=Y(w.expirationTime<=ve);ve=e.unstable_now(),typeof k=="function"?w.callback=k:w===t(x)&&s(x),O(ve)}else s(x);w=t(x)}if(w!==null)var q=!0;else{var B=t(p);B!==null&&me(J,B.startTime-ve),q=!1}return q}finally{w=null,y=ye,E=!1}}var de=!1,z=null,re=-1,V=5,M=-1;function L(){return!(e.unstable_now()-M<V)}function X(){if(z!==null){var R=e.unstable_now();M=R;var ve=!0;try{ve=z(!0,R)}finally{ve?K():(de=!1,z=null)}}else de=!1}var K;if(typeof I=="function")K=function(){I(X)};else if(typeof MessageChannel<"u"){var ne=new MessageChannel,W=ne.port2;ne.port1.onmessage=X,K=function(){W.postMessage(null)}}else K=function(){_(X,0)};function Z(R){z=R,de||(de=!0,K())}function me(R,ve){re=_(function(){R(e.unstable_now())},ve)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(R){R.callback=null},e.unstable_continueExecution=function(){N||E||(N=!0,Z(he))},e.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<R?Math.floor(1e3/R):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_getFirstCallbackNode=function(){return t(x)},e.unstable_next=function(R){switch(y){case 1:case 2:case 3:var ve=3;break;default:ve=y}var ye=y;y=ve;try{return R()}finally{y=ye}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(R,ve){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var ye=y;y=R;try{return ve()}finally{y=ye}},e.unstable_scheduleCallback=function(R,ve,ye){var Y=e.unstable_now();switch(typeof ye=="object"&&ye!==null?(ye=ye.delay,ye=typeof ye=="number"&&0<ye?Y+ye:Y):ye=Y,R){case 1:var k=-1;break;case 2:k=250;break;case 5:k=1073741823;break;case 4:k=1e4;break;default:k=5e3}return k=ye+k,R={id:m++,callback:ve,priorityLevel:R,startTime:ye,expirationTime:k,sortIndex:-1},ye>Y?(R.sortIndex=ye,r(p,R),t(x)===null&&R===t(p)&&(g?(b(re),re=-1):g=!0,me(J,ye-Y))):(R.sortIndex=k,r(x,R),N||E||(N=!0,Z(he))),R},e.unstable_shouldYield=L,e.unstable_wrapCallback=function(R){var ve=y;return function(){var ye=y;y=ve;try{return R.apply(this,arguments)}finally{y=ye}}}})(hu)),hu}var $d;function Im(){return $d||($d=1,du.exports=Dm()),du.exports}var Hd;function Mm(){if(Hd)return Or;Hd=1;var e=Lu(),r=Im();function t(n){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+n,l=1;l<arguments.length;l++)a+="&args[]="+encodeURIComponent(arguments[l]);return"Minified React error #"+n+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,i={};function o(n,a){u(n,a),u(n+"Capture",a)}function u(n,a){for(i[n]=a,n=0;n<a.length;n++)s.add(a[n])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),x=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},w={};function y(n){return x.call(w,n)?!0:x.call(m,n)?!1:p.test(n)?w[n]=!0:(m[n]=!0,!1)}function E(n,a,l,f){if(l!==null&&l.type===0)return!1;switch(typeof a){case"function":case"symbol":return!0;case"boolean":return f?!1:l!==null?!l.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function N(n,a,l,f){if(a===null||typeof a>"u"||E(n,a,l,f))return!0;if(f)return!1;if(l!==null)switch(l.type){case 3:return!a;case 4:return a===!1;case 5:return isNaN(a);case 6:return isNaN(a)||1>a}return!1}function g(n,a,l,f,h,v,S){this.acceptsBooleans=a===2||a===3||a===4,this.attributeName=f,this.attributeNamespace=h,this.mustUseProperty=l,this.propertyName=n,this.type=a,this.sanitizeURL=v,this.removeEmptyString=S}var _={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){_[n]=new g(n,0,!1,n,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var a=n[0];_[a]=new g(a,1,!1,n[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(n){_[n]=new g(n,2,!1,n.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){_[n]=new g(n,2,!1,n,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){_[n]=new g(n,3,!1,n.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(n){_[n]=new g(n,3,!0,n,null,!1,!1)}),["capture","download"].forEach(function(n){_[n]=new g(n,4,!1,n,null,!1,!1)}),["cols","rows","size","span"].forEach(function(n){_[n]=new g(n,6,!1,n,null,!1,!1)}),["rowSpan","start"].forEach(function(n){_[n]=new g(n,5,!1,n.toLowerCase(),null,!1,!1)});var b=/[\-:]([a-z])/g;function I(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var a=n.replace(b,I);_[a]=new g(a,1,!1,n,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var a=n.replace(b,I);_[a]=new g(a,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(n){var a=n.replace(b,I);_[a]=new g(a,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(n){_[n]=new g(n,1,!1,n.toLowerCase(),null,!1,!1)}),_.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(n){_[n]=new g(n,1,!1,n.toLowerCase(),null,!0,!0)});function O(n,a,l,f){var h=_.hasOwnProperty(a)?_[a]:null;(h!==null?h.type!==0:f||!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(N(a,l,h,f)&&(l=null),f||h===null?y(a)&&(l===null?n.removeAttribute(a):n.setAttribute(a,""+l)):h.mustUseProperty?n[h.propertyName]=l===null?h.type===3?!1:"":l:(a=h.attributeName,f=h.attributeNamespace,l===null?n.removeAttribute(a):(h=h.type,l=h===3||h===4&&l===!0?"":""+l,f?n.setAttributeNS(f,a,l):n.setAttribute(a,l))))}var J=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,he=Symbol.for("react.element"),de=Symbol.for("react.portal"),z=Symbol.for("react.fragment"),re=Symbol.for("react.strict_mode"),V=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),L=Symbol.for("react.context"),X=Symbol.for("react.forward_ref"),K=Symbol.for("react.suspense"),ne=Symbol.for("react.suspense_list"),W=Symbol.for("react.memo"),Z=Symbol.for("react.lazy"),me=Symbol.for("react.offscreen"),R=Symbol.iterator;function ve(n){return n===null||typeof n!="object"?null:(n=R&&n[R]||n["@@iterator"],typeof n=="function"?n:null)}var ye=Object.assign,Y;function k(n){if(Y===void 0)try{throw Error()}catch(l){var a=l.stack.trim().match(/\n( *(at )?)/);Y=a&&a[1]||""}return`
`+Y+n}var q=!1;function B(n,a){if(!n||q)return"";q=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(fe){var f=fe}Reflect.construct(n,[],a)}else{try{a.call()}catch(fe){f=fe}n.call(a.prototype)}else{try{throw Error()}catch(fe){f=fe}n()}}catch(fe){if(fe&&f&&typeof fe.stack=="string"){for(var h=fe.stack.split(`
`),v=f.stack.split(`
`),S=h.length-1,D=v.length-1;1<=S&&0<=D&&h[S]!==v[D];)D--;for(;1<=S&&0<=D;S--,D--)if(h[S]!==v[D]){if(S!==1||D!==1)do if(S--,D--,0>D||h[S]!==v[D]){var G=`
`+h[S].replace(" at new "," at ");return n.displayName&&G.includes("<anonymous>")&&(G=G.replace("<anonymous>",n.displayName)),G}while(1<=S&&0<=D);break}}}finally{q=!1,Error.prepareStackTrace=l}return(n=n?n.displayName||n.name:"")?k(n):""}function U(n){switch(n.tag){case 5:return k(n.type);case 16:return k("Lazy");case 13:return k("Suspense");case 19:return k("SuspenseList");case 0:case 2:case 15:return n=B(n.type,!1),n;case 11:return n=B(n.type.render,!1),n;case 1:return n=B(n.type,!0),n;default:return""}}function oe(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case z:return"Fragment";case de:return"Portal";case V:return"Profiler";case re:return"StrictMode";case K:return"Suspense";case ne:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case L:return(n.displayName||"Context")+".Consumer";case M:return(n._context.displayName||"Context")+".Provider";case X:var a=n.render;return n=n.displayName,n||(n=a.displayName||a.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case W:return a=n.displayName||null,a!==null?a:oe(n.type)||"Memo";case Z:a=n._payload,n=n._init;try{return oe(n(a))}catch{}}return null}function Ee(n){var a=n.type;switch(n.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=a.render,n=n.displayName||n.name||"",a.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return oe(a);case 8:return a===re?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function Te(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function ee(n){var a=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function te(n){var a=ee(n)?"checked":"value",l=Object.getOwnPropertyDescriptor(n.constructor.prototype,a),f=""+n[a];if(!n.hasOwnProperty(a)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var h=l.get,v=l.set;return Object.defineProperty(n,a,{configurable:!0,get:function(){return h.call(this)},set:function(S){f=""+S,v.call(this,S)}}),Object.defineProperty(n,a,{enumerable:l.enumerable}),{getValue:function(){return f},setValue:function(S){f=""+S},stopTracking:function(){n._valueTracker=null,delete n[a]}}}}function Se(n){n._valueTracker||(n._valueTracker=te(n))}function De(n){if(!n)return!1;var a=n._valueTracker;if(!a)return!0;var l=a.getValue(),f="";return n&&(f=ee(n)?n.checked?"true":"false":n.value),n=f,n!==l?(a.setValue(n),!0):!1}function et(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function We(n,a){var l=a.checked;return ye({},a,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:l??n._wrapperState.initialChecked})}function ot(n,a){var l=a.defaultValue==null?"":a.defaultValue,f=a.checked!=null?a.checked:a.defaultChecked;l=Te(a.value!=null?a.value:l),n._wrapperState={initialChecked:f,initialValue:l,controlled:a.type==="checkbox"||a.type==="radio"?a.checked!=null:a.value!=null}}function rt(n,a){a=a.checked,a!=null&&O(n,"checked",a,!1)}function Oe(n,a){rt(n,a);var l=Te(a.value),f=a.type;if(l!=null)f==="number"?(l===0&&n.value===""||n.value!=l)&&(n.value=""+l):n.value!==""+l&&(n.value=""+l);else if(f==="submit"||f==="reset"){n.removeAttribute("value");return}a.hasOwnProperty("value")?Ue(n,a.type,l):a.hasOwnProperty("defaultValue")&&Ue(n,a.type,Te(a.defaultValue)),a.checked==null&&a.defaultChecked!=null&&(n.defaultChecked=!!a.defaultChecked)}function Ot(n,a,l){if(a.hasOwnProperty("value")||a.hasOwnProperty("defaultValue")){var f=a.type;if(!(f!=="submit"&&f!=="reset"||a.value!==void 0&&a.value!==null))return;a=""+n._wrapperState.initialValue,l||a===n.value||(n.value=a),n.defaultValue=a}l=n.name,l!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,l!==""&&(n.name=l)}function Ue(n,a,l){(a!=="number"||et(n.ownerDocument)!==n)&&(l==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+l&&(n.defaultValue=""+l))}var He=Array.isArray;function Ke(n,a,l,f){if(n=n.options,a){a={};for(var h=0;h<l.length;h++)a["$"+l[h]]=!0;for(l=0;l<n.length;l++)h=a.hasOwnProperty("$"+n[l].value),n[l].selected!==h&&(n[l].selected=h),h&&f&&(n[l].defaultSelected=!0)}else{for(l=""+Te(l),a=null,h=0;h<n.length;h++){if(n[h].value===l){n[h].selected=!0,f&&(n[h].defaultSelected=!0);return}a!==null||n[h].disabled||(a=n[h])}a!==null&&(a.selected=!0)}}function ct(n,a){if(a.dangerouslySetInnerHTML!=null)throw Error(t(91));return ye({},a,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function ut(n,a){var l=a.value;if(l==null){if(l=a.children,a=a.defaultValue,l!=null){if(a!=null)throw Error(t(92));if(He(l)){if(1<l.length)throw Error(t(93));l=l[0]}a=l}a==null&&(a=""),l=a}n._wrapperState={initialValue:Te(l)}}function it(n,a){var l=Te(a.value),f=Te(a.defaultValue);l!=null&&(l=""+l,l!==n.value&&(n.value=l),a.defaultValue==null&&n.defaultValue!==l&&(n.defaultValue=l)),f!=null&&(n.defaultValue=""+f)}function ft(n){var a=n.textContent;a===n._wrapperState.initialValue&&a!==""&&a!==null&&(n.value=a)}function rn(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function nn(n,a){return n==null||n==="http://www.w3.org/1999/xhtml"?rn(a):n==="http://www.w3.org/2000/svg"&&a==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var _r,Ea=(function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(a,l,f,h){MSApp.execUnsafeLocalFunction(function(){return n(a,l,f,h)})}:n})(function(n,a){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=a;else{for(_r=_r||document.createElement("div"),_r.innerHTML="<svg>"+a.valueOf().toString()+"</svg>",a=_r.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;a.firstChild;)n.appendChild(a.firstChild)}});function Gr(n,a){if(a){var l=n.firstChild;if(l&&l===n.lastChild&&l.nodeType===3){l.nodeValue=a;return}}n.textContent=a}var gn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Pe=["Webkit","ms","Moz","O"];Object.keys(gn).forEach(function(n){Pe.forEach(function(a){a=a+n.charAt(0).toUpperCase()+n.substring(1),gn[a]=gn[n]})});function Ye(n,a,l){return a==null||typeof a=="boolean"||a===""?"":l||typeof a!="number"||a===0||gn.hasOwnProperty(n)&&gn[n]?(""+a).trim():a+"px"}function Ge(n,a){n=n.style;for(var l in a)if(a.hasOwnProperty(l)){var f=l.indexOf("--")===0,h=Ye(l,a[l],f);l==="float"&&(l="cssFloat"),f?n.setProperty(l,h):n[l]=h}}var nt=ye({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Je(n,a){if(a){if(nt[n]&&(a.children!=null||a.dangerouslySetInnerHTML!=null))throw Error(t(137,n));if(a.dangerouslySetInnerHTML!=null){if(a.children!=null)throw Error(t(60));if(typeof a.dangerouslySetInnerHTML!="object"||!("__html"in a.dangerouslySetInnerHTML))throw Error(t(61))}if(a.style!=null&&typeof a.style!="object")throw Error(t(62))}}function $t(n,a){if(n.indexOf("-")===-1)return typeof a.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ie=null;function dt(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Er=null,Ht=null,Jt=null;function mt(n){if(n=ni(n)){if(typeof Er!="function")throw Error(t(280));var a=n.stateNode;a&&(a=ll(a),Er(n.stateNode,n.type,a))}}function ir(n){Ht?Jt?Jt.push(n):Jt=[n]:Ht=n}function Sa(){if(Ht){var n=Ht,a=Jt;if(Jt=Ht=null,mt(n),a)for(n=0;n<a.length;n++)mt(a[n])}}function jn(n,a){return n(a)}function Pn(){}var On=!1;function Ta(n,a,l){if(On)return n(a,l);On=!0;try{return jn(n,a,l)}finally{On=!1,(Ht!==null||Jt!==null)&&(Pn(),Sa())}}function yn(n,a){var l=n.stateNode;if(l===null)return null;var f=ll(l);if(f===null)return null;l=f[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(n=n.type,f=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!f;break e;default:n=!1}if(n)return null;if(l&&typeof l!="function")throw Error(t(231,a,typeof l));return l}var Kn=!1;if(d)try{var an={};Object.defineProperty(an,"passive",{get:function(){Kn=!0}}),window.addEventListener("test",an,an),window.removeEventListener("test",an,an)}catch{Kn=!1}function Ms(n,a,l,f,h,v,S,D,G){var fe=Array.prototype.slice.call(arguments,3);try{a.apply(l,fe)}catch(_e){this.onError(_e)}}var Na=!1,Qa=null,T=!1,F=null,C={onError:function(n){Na=!0,Qa=n}};function A(n,a,l,f,h,v,S,D,G){Na=!1,Qa=null,Ms.apply(C,arguments)}function j(n,a,l,f,h,v,S,D,G){if(A.apply(this,arguments),Na){if(Na){var fe=Qa;Na=!1,Qa=null}else throw Error(t(198));T||(T=!0,F=fe)}}function P(n){var a=n,l=n;if(n.alternate)for(;a.return;)a=a.return;else{n=a;do a=n,(a.flags&4098)!==0&&(l=a.return),n=a.return;while(n)}return a.tag===3?l:null}function le(n){if(n.tag===13){var a=n.memoizedState;if(a===null&&(n=n.alternate,n!==null&&(a=n.memoizedState)),a!==null)return a.dehydrated}return null}function xe(n){if(P(n)!==n)throw Error(t(188))}function ie(n){var a=n.alternate;if(!a){if(a=P(n),a===null)throw Error(t(188));return a!==n?null:n}for(var l=n,f=a;;){var h=l.return;if(h===null)break;var v=h.alternate;if(v===null){if(f=h.return,f!==null){l=f;continue}break}if(h.child===v.child){for(v=h.child;v;){if(v===l)return xe(h),n;if(v===f)return xe(h),a;v=v.sibling}throw Error(t(188))}if(l.return!==f.return)l=h,f=v;else{for(var S=!1,D=h.child;D;){if(D===l){S=!0,l=h,f=v;break}if(D===f){S=!0,f=h,l=v;break}D=D.sibling}if(!S){for(D=v.child;D;){if(D===l){S=!0,l=v,f=h;break}if(D===f){S=!0,f=v,l=h;break}D=D.sibling}if(!S)throw Error(t(189))}}if(l.alternate!==f)throw Error(t(190))}if(l.tag!==3)throw Error(t(188));return l.stateNode.current===l?n:a}function ce(n){return n=ie(n),n!==null?ue(n):null}function ue(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var a=ue(n);if(a!==null)return a;n=n.sibling}return null}var Ne=r.unstable_scheduleCallback,Re=r.unstable_cancelCallback,Le=r.unstable_shouldYield,Ae=r.unstable_requestPaint,Ce=r.unstable_now,tt=r.unstable_getCurrentPriorityLevel,kt=r.unstable_ImmediatePriority,Ct=r.unstable_UserBlockingPriority,Ut=r.unstable_NormalPriority,ka=r.unstable_LowPriority,Yn=r.unstable_IdlePriority,wn=null,Zt=null;function Ls(n){if(Zt&&typeof Zt.onCommitFiberRoot=="function")try{Zt.onCommitFiberRoot(wn,n,void 0,(n.current.flags&128)===128)}catch{}}var zt=Math.clz32?Math.clz32:qx,Kx=Math.log,Yx=Math.LN2;function qx(n){return n>>>=0,n===0?32:31-(Kx(n)/Yx|0)|0}var $i=64,Hi=4194304;function Bs(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Vi(n,a){var l=n.pendingLanes;if(l===0)return 0;var f=0,h=n.suspendedLanes,v=n.pingedLanes,S=l&268435455;if(S!==0){var D=S&~h;D!==0?f=Bs(D):(v&=S,v!==0&&(f=Bs(v)))}else S=l&~h,S!==0?f=Bs(S):v!==0&&(f=Bs(v));if(f===0)return 0;if(a!==0&&a!==f&&(a&h)===0&&(h=f&-f,v=a&-a,h>=v||h===16&&(v&4194240)!==0))return a;if((f&4)!==0&&(f|=l&16),a=n.entangledLanes,a!==0)for(n=n.entanglements,a&=f;0<a;)l=31-zt(a),h=1<<l,f|=n[l],a&=~h;return f}function Qx(n,a){switch(n){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Jx(n,a){for(var l=n.suspendedLanes,f=n.pingedLanes,h=n.expirationTimes,v=n.pendingLanes;0<v;){var S=31-zt(v),D=1<<S,G=h[S];G===-1?((D&l)===0||(D&f)!==0)&&(h[S]=Qx(D,a)):G<=a&&(n.expiredLanes|=D),v&=~D}}function Fo(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function p0(){var n=$i;return $i<<=1,($i&4194240)===0&&($i=64),n}function jo(n){for(var a=[],l=0;31>l;l++)a.push(n);return a}function Us(n,a,l){n.pendingLanes|=a,a!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,a=31-zt(a),n[a]=l}function Zx(n,a){var l=n.pendingLanes&~a;n.pendingLanes=a,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=a,n.mutableReadLanes&=a,n.entangledLanes&=a,a=n.entanglements;var f=n.eventTimes;for(n=n.expirationTimes;0<l;){var h=31-zt(l),v=1<<h;a[h]=0,f[h]=-1,n[h]=-1,l&=~v}}function Po(n,a){var l=n.entangledLanes|=a;for(n=n.entanglements;l;){var f=31-zt(l),h=1<<f;h&a|n[f]&a&&(n[f]|=a),l&=~h}}var wt=0;function x0(n){return n&=-n,1<n?4<n?(n&268435455)!==0?16:536870912:4:1}var m0,Oo,v0,g0,y0,Ro=!1,Gi=[],qn=null,Qn=null,Jn=null,zs=new Map,Ws=new Map,Zn=[],e1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function w0(n,a){switch(n){case"focusin":case"focusout":qn=null;break;case"dragenter":case"dragleave":Qn=null;break;case"mouseover":case"mouseout":Jn=null;break;case"pointerover":case"pointerout":zs.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ws.delete(a.pointerId)}}function $s(n,a,l,f,h,v){return n===null||n.nativeEvent!==v?(n={blockedOn:a,domEventName:l,eventSystemFlags:f,nativeEvent:v,targetContainers:[h]},a!==null&&(a=ni(a),a!==null&&Oo(a)),n):(n.eventSystemFlags|=f,a=n.targetContainers,h!==null&&a.indexOf(h)===-1&&a.push(h),n)}function t1(n,a,l,f,h){switch(a){case"focusin":return qn=$s(qn,n,a,l,f,h),!0;case"dragenter":return Qn=$s(Qn,n,a,l,f,h),!0;case"mouseover":return Jn=$s(Jn,n,a,l,f,h),!0;case"pointerover":var v=h.pointerId;return zs.set(v,$s(zs.get(v)||null,n,a,l,f,h)),!0;case"gotpointercapture":return v=h.pointerId,Ws.set(v,$s(Ws.get(v)||null,n,a,l,f,h)),!0}return!1}function _0(n){var a=Ca(n.target);if(a!==null){var l=P(a);if(l!==null){if(a=l.tag,a===13){if(a=le(l),a!==null){n.blockedOn=a,y0(n.priority,function(){v0(l)});return}}else if(a===3&&l.stateNode.current.memoizedState.isDehydrated){n.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Xi(n){if(n.blockedOn!==null)return!1;for(var a=n.targetContainers;0<a.length;){var l=Io(n.domEventName,n.eventSystemFlags,a[0],n.nativeEvent);if(l===null){l=n.nativeEvent;var f=new l.constructor(l.type,l);Ie=f,l.target.dispatchEvent(f),Ie=null}else return a=ni(l),a!==null&&Oo(a),n.blockedOn=l,!1;a.shift()}return!0}function E0(n,a,l){Xi(n)&&l.delete(a)}function r1(){Ro=!1,qn!==null&&Xi(qn)&&(qn=null),Qn!==null&&Xi(Qn)&&(Qn=null),Jn!==null&&Xi(Jn)&&(Jn=null),zs.forEach(E0),Ws.forEach(E0)}function Hs(n,a){n.blockedOn===a&&(n.blockedOn=null,Ro||(Ro=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,r1)))}function Vs(n){function a(h){return Hs(h,n)}if(0<Gi.length){Hs(Gi[0],n);for(var l=1;l<Gi.length;l++){var f=Gi[l];f.blockedOn===n&&(f.blockedOn=null)}}for(qn!==null&&Hs(qn,n),Qn!==null&&Hs(Qn,n),Jn!==null&&Hs(Jn,n),zs.forEach(a),Ws.forEach(a),l=0;l<Zn.length;l++)f=Zn[l],f.blockedOn===n&&(f.blockedOn=null);for(;0<Zn.length&&(l=Zn[0],l.blockedOn===null);)_0(l),l.blockedOn===null&&Zn.shift()}var Ja=J.ReactCurrentBatchConfig,Ki=!0;function n1(n,a,l,f){var h=wt,v=Ja.transition;Ja.transition=null;try{wt=1,Do(n,a,l,f)}finally{wt=h,Ja.transition=v}}function a1(n,a,l,f){var h=wt,v=Ja.transition;Ja.transition=null;try{wt=4,Do(n,a,l,f)}finally{wt=h,Ja.transition=v}}function Do(n,a,l,f){if(Ki){var h=Io(n,a,l,f);if(h===null)Zo(n,a,f,Yi,l),w0(n,f);else if(t1(h,n,a,l,f))f.stopPropagation();else if(w0(n,f),a&4&&-1<e1.indexOf(n)){for(;h!==null;){var v=ni(h);if(v!==null&&m0(v),v=Io(n,a,l,f),v===null&&Zo(n,a,f,Yi,l),v===h)break;h=v}h!==null&&f.stopPropagation()}else Zo(n,a,f,null,l)}}var Yi=null;function Io(n,a,l,f){if(Yi=null,n=dt(f),n=Ca(n),n!==null)if(a=P(n),a===null)n=null;else if(l=a.tag,l===13){if(n=le(a),n!==null)return n;n=null}else if(l===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;n=null}else a!==n&&(n=null);return Yi=n,null}function S0(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(tt()){case kt:return 1;case Ct:return 4;case Ut:case ka:return 16;case Yn:return 536870912;default:return 16}default:return 16}}var ea=null,Mo=null,qi=null;function T0(){if(qi)return qi;var n,a=Mo,l=a.length,f,h="value"in ea?ea.value:ea.textContent,v=h.length;for(n=0;n<l&&a[n]===h[n];n++);var S=l-n;for(f=1;f<=S&&a[l-f]===h[v-f];f++);return qi=h.slice(n,1<f?1-f:void 0)}function Qi(n){var a=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&a===13&&(n=13)):n=a,n===10&&(n=13),32<=n||n===13?n:0}function Ji(){return!0}function N0(){return!1}function Mr(n){function a(l,f,h,v,S){this._reactName=l,this._targetInst=h,this.type=f,this.nativeEvent=v,this.target=S,this.currentTarget=null;for(var D in n)n.hasOwnProperty(D)&&(l=n[D],this[D]=l?l(v):v[D]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Ji:N0,this.isPropagationStopped=N0,this}return ye(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Ji)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Ji)},persist:function(){},isPersistent:Ji}),a}var Za={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Lo=Mr(Za),Gs=ye({},Za,{view:0,detail:0}),s1=Mr(Gs),Bo,Uo,Xs,Zi=ye({},Gs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Wo,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Xs&&(Xs&&n.type==="mousemove"?(Bo=n.screenX-Xs.screenX,Uo=n.screenY-Xs.screenY):Uo=Bo=0,Xs=n),Bo)},movementY:function(n){return"movementY"in n?n.movementY:Uo}}),k0=Mr(Zi),i1=ye({},Zi,{dataTransfer:0}),l1=Mr(i1),o1=ye({},Gs,{relatedTarget:0}),zo=Mr(o1),c1=ye({},Za,{animationName:0,elapsedTime:0,pseudoElement:0}),u1=Mr(c1),f1=ye({},Za,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),d1=Mr(f1),h1=ye({},Za,{data:0}),C0=Mr(h1),p1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},x1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},m1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function v1(n){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(n):(n=m1[n])?!!a[n]:!1}function Wo(){return v1}var g1=ye({},Gs,{key:function(n){if(n.key){var a=p1[n.key]||n.key;if(a!=="Unidentified")return a}return n.type==="keypress"?(n=Qi(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?x1[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Wo,charCode:function(n){return n.type==="keypress"?Qi(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Qi(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),y1=Mr(g1),w1=ye({},Zi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),A0=Mr(w1),_1=ye({},Gs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Wo}),E1=Mr(_1),S1=ye({},Za,{propertyName:0,elapsedTime:0,pseudoElement:0}),T1=Mr(S1),N1=ye({},Zi,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),k1=Mr(N1),C1=[9,13,27,32],$o=d&&"CompositionEvent"in window,Ks=null;d&&"documentMode"in document&&(Ks=document.documentMode);var A1=d&&"TextEvent"in window&&!Ks,b0=d&&(!$o||Ks&&8<Ks&&11>=Ks),F0=" ",j0=!1;function P0(n,a){switch(n){case"keyup":return C1.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function O0(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var es=!1;function b1(n,a){switch(n){case"compositionend":return O0(a);case"keypress":return a.which!==32?null:(j0=!0,F0);case"textInput":return n=a.data,n===F0&&j0?null:n;default:return null}}function F1(n,a){if(es)return n==="compositionend"||!$o&&P0(n,a)?(n=T0(),qi=Mo=ea=null,es=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return b0&&a.locale!=="ko"?null:a.data;default:return null}}var j1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function R0(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a==="input"?!!j1[n.type]:a==="textarea"}function D0(n,a,l,f){ir(f),a=al(a,"onChange"),0<a.length&&(l=new Lo("onChange","change",null,l,f),n.push({event:l,listeners:a}))}var Ys=null,qs=null;function P1(n){Z0(n,0)}function el(n){var a=ss(n);if(De(a))return n}function O1(n,a){if(n==="change")return a}var I0=!1;if(d){var Ho;if(d){var Vo="oninput"in document;if(!Vo){var M0=document.createElement("div");M0.setAttribute("oninput","return;"),Vo=typeof M0.oninput=="function"}Ho=Vo}else Ho=!1;I0=Ho&&(!document.documentMode||9<document.documentMode)}function L0(){Ys&&(Ys.detachEvent("onpropertychange",B0),qs=Ys=null)}function B0(n){if(n.propertyName==="value"&&el(qs)){var a=[];D0(a,qs,n,dt(n)),Ta(P1,a)}}function R1(n,a,l){n==="focusin"?(L0(),Ys=a,qs=l,Ys.attachEvent("onpropertychange",B0)):n==="focusout"&&L0()}function D1(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return el(qs)}function I1(n,a){if(n==="click")return el(a)}function M1(n,a){if(n==="input"||n==="change")return el(a)}function L1(n,a){return n===a&&(n!==0||1/n===1/a)||n!==n&&a!==a}var sn=typeof Object.is=="function"?Object.is:L1;function Qs(n,a){if(sn(n,a))return!0;if(typeof n!="object"||n===null||typeof a!="object"||a===null)return!1;var l=Object.keys(n),f=Object.keys(a);if(l.length!==f.length)return!1;for(f=0;f<l.length;f++){var h=l[f];if(!x.call(a,h)||!sn(n[h],a[h]))return!1}return!0}function U0(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function z0(n,a){var l=U0(n);n=0;for(var f;l;){if(l.nodeType===3){if(f=n+l.textContent.length,n<=a&&f>=a)return{node:l,offset:a-n};n=f}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=U0(l)}}function W0(n,a){return n&&a?n===a?!0:n&&n.nodeType===3?!1:a&&a.nodeType===3?W0(n,a.parentNode):"contains"in n?n.contains(a):n.compareDocumentPosition?!!(n.compareDocumentPosition(a)&16):!1:!1}function $0(){for(var n=window,a=et();a instanceof n.HTMLIFrameElement;){try{var l=typeof a.contentWindow.location.href=="string"}catch{l=!1}if(l)n=a.contentWindow;else break;a=et(n.document)}return a}function Go(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a&&(a==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||a==="textarea"||n.contentEditable==="true")}function B1(n){var a=$0(),l=n.focusedElem,f=n.selectionRange;if(a!==l&&l&&l.ownerDocument&&W0(l.ownerDocument.documentElement,l)){if(f!==null&&Go(l)){if(a=f.start,n=f.end,n===void 0&&(n=a),"selectionStart"in l)l.selectionStart=a,l.selectionEnd=Math.min(n,l.value.length);else if(n=(a=l.ownerDocument||document)&&a.defaultView||window,n.getSelection){n=n.getSelection();var h=l.textContent.length,v=Math.min(f.start,h);f=f.end===void 0?v:Math.min(f.end,h),!n.extend&&v>f&&(h=f,f=v,v=h),h=z0(l,v);var S=z0(l,f);h&&S&&(n.rangeCount!==1||n.anchorNode!==h.node||n.anchorOffset!==h.offset||n.focusNode!==S.node||n.focusOffset!==S.offset)&&(a=a.createRange(),a.setStart(h.node,h.offset),n.removeAllRanges(),v>f?(n.addRange(a),n.extend(S.node,S.offset)):(a.setEnd(S.node,S.offset),n.addRange(a)))}}for(a=[],n=l;n=n.parentNode;)n.nodeType===1&&a.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<a.length;l++)n=a[l],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var U1=d&&"documentMode"in document&&11>=document.documentMode,ts=null,Xo=null,Js=null,Ko=!1;function H0(n,a,l){var f=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Ko||ts==null||ts!==et(f)||(f=ts,"selectionStart"in f&&Go(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),Js&&Qs(Js,f)||(Js=f,f=al(Xo,"onSelect"),0<f.length&&(a=new Lo("onSelect","select",null,a,l),n.push({event:a,listeners:f}),a.target=ts)))}function tl(n,a){var l={};return l[n.toLowerCase()]=a.toLowerCase(),l["Webkit"+n]="webkit"+a,l["Moz"+n]="moz"+a,l}var rs={animationend:tl("Animation","AnimationEnd"),animationiteration:tl("Animation","AnimationIteration"),animationstart:tl("Animation","AnimationStart"),transitionend:tl("Transition","TransitionEnd")},Yo={},V0={};d&&(V0=document.createElement("div").style,"AnimationEvent"in window||(delete rs.animationend.animation,delete rs.animationiteration.animation,delete rs.animationstart.animation),"TransitionEvent"in window||delete rs.transitionend.transition);function rl(n){if(Yo[n])return Yo[n];if(!rs[n])return n;var a=rs[n],l;for(l in a)if(a.hasOwnProperty(l)&&l in V0)return Yo[n]=a[l];return n}var G0=rl("animationend"),X0=rl("animationiteration"),K0=rl("animationstart"),Y0=rl("transitionend"),q0=new Map,Q0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ta(n,a){q0.set(n,a),o(a,[n])}for(var qo=0;qo<Q0.length;qo++){var Qo=Q0[qo],z1=Qo.toLowerCase(),W1=Qo[0].toUpperCase()+Qo.slice(1);ta(z1,"on"+W1)}ta(G0,"onAnimationEnd"),ta(X0,"onAnimationIteration"),ta(K0,"onAnimationStart"),ta("dblclick","onDoubleClick"),ta("focusin","onFocus"),ta("focusout","onBlur"),ta(Y0,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Zs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$1=new Set("cancel close invalid load scroll toggle".split(" ").concat(Zs));function J0(n,a,l){var f=n.type||"unknown-event";n.currentTarget=l,j(f,a,void 0,n),n.currentTarget=null}function Z0(n,a){a=(a&4)!==0;for(var l=0;l<n.length;l++){var f=n[l],h=f.event;f=f.listeners;e:{var v=void 0;if(a)for(var S=f.length-1;0<=S;S--){var D=f[S],G=D.instance,fe=D.currentTarget;if(D=D.listener,G!==v&&h.isPropagationStopped())break e;J0(h,D,fe),v=G}else for(S=0;S<f.length;S++){if(D=f[S],G=D.instance,fe=D.currentTarget,D=D.listener,G!==v&&h.isPropagationStopped())break e;J0(h,D,fe),v=G}}}if(T)throw n=F,T=!1,F=null,n}function Ft(n,a){var l=a[sc];l===void 0&&(l=a[sc]=new Set);var f=n+"__bubble";l.has(f)||(ef(a,n,2,!1),l.add(f))}function Jo(n,a,l){var f=0;a&&(f|=4),ef(l,n,f,a)}var nl="_reactListening"+Math.random().toString(36).slice(2);function ei(n){if(!n[nl]){n[nl]=!0,s.forEach(function(l){l!=="selectionchange"&&($1.has(l)||Jo(l,!1,n),Jo(l,!0,n))});var a=n.nodeType===9?n:n.ownerDocument;a===null||a[nl]||(a[nl]=!0,Jo("selectionchange",!1,a))}}function ef(n,a,l,f){switch(S0(a)){case 1:var h=n1;break;case 4:h=a1;break;default:h=Do}l=h.bind(null,a,l,n),h=void 0,!Kn||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(h=!0),f?h!==void 0?n.addEventListener(a,l,{capture:!0,passive:h}):n.addEventListener(a,l,!0):h!==void 0?n.addEventListener(a,l,{passive:h}):n.addEventListener(a,l,!1)}function Zo(n,a,l,f,h){var v=f;if((a&1)===0&&(a&2)===0&&f!==null)e:for(;;){if(f===null)return;var S=f.tag;if(S===3||S===4){var D=f.stateNode.containerInfo;if(D===h||D.nodeType===8&&D.parentNode===h)break;if(S===4)for(S=f.return;S!==null;){var G=S.tag;if((G===3||G===4)&&(G=S.stateNode.containerInfo,G===h||G.nodeType===8&&G.parentNode===h))return;S=S.return}for(;D!==null;){if(S=Ca(D),S===null)return;if(G=S.tag,G===5||G===6){f=v=S;continue e}D=D.parentNode}}f=f.return}Ta(function(){var fe=v,_e=dt(l),ke=[];e:{var we=q0.get(n);if(we!==void 0){var Me=Lo,ze=n;switch(n){case"keypress":if(Qi(l)===0)break e;case"keydown":case"keyup":Me=y1;break;case"focusin":ze="focus",Me=zo;break;case"focusout":ze="blur",Me=zo;break;case"beforeblur":case"afterblur":Me=zo;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Me=k0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Me=l1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Me=E1;break;case G0:case X0:case K0:Me=u1;break;case Y0:Me=T1;break;case"scroll":Me=s1;break;case"wheel":Me=k1;break;case"copy":case"cut":case"paste":Me=d1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Me=A0}var $e=(a&4)!==0,Wt=!$e&&n==="scroll",ae=$e?we!==null?we+"Capture":null:we;$e=[];for(var Q=fe,se;Q!==null;){se=Q;var be=se.stateNode;if(se.tag===5&&be!==null&&(se=be,ae!==null&&(be=yn(Q,ae),be!=null&&$e.push(ti(Q,be,se)))),Wt)break;Q=Q.return}0<$e.length&&(we=new Me(we,ze,null,l,_e),ke.push({event:we,listeners:$e}))}}if((a&7)===0){e:{if(we=n==="mouseover"||n==="pointerover",Me=n==="mouseout"||n==="pointerout",we&&l!==Ie&&(ze=l.relatedTarget||l.fromElement)&&(Ca(ze)||ze[Rn]))break e;if((Me||we)&&(we=_e.window===_e?_e:(we=_e.ownerDocument)?we.defaultView||we.parentWindow:window,Me?(ze=l.relatedTarget||l.toElement,Me=fe,ze=ze?Ca(ze):null,ze!==null&&(Wt=P(ze),ze!==Wt||ze.tag!==5&&ze.tag!==6)&&(ze=null)):(Me=null,ze=fe),Me!==ze)){if($e=k0,be="onMouseLeave",ae="onMouseEnter",Q="mouse",(n==="pointerout"||n==="pointerover")&&($e=A0,be="onPointerLeave",ae="onPointerEnter",Q="pointer"),Wt=Me==null?we:ss(Me),se=ze==null?we:ss(ze),we=new $e(be,Q+"leave",Me,l,_e),we.target=Wt,we.relatedTarget=se,be=null,Ca(_e)===fe&&($e=new $e(ae,Q+"enter",ze,l,_e),$e.target=se,$e.relatedTarget=Wt,be=$e),Wt=be,Me&&ze)t:{for($e=Me,ae=ze,Q=0,se=$e;se;se=ns(se))Q++;for(se=0,be=ae;be;be=ns(be))se++;for(;0<Q-se;)$e=ns($e),Q--;for(;0<se-Q;)ae=ns(ae),se--;for(;Q--;){if($e===ae||ae!==null&&$e===ae.alternate)break t;$e=ns($e),ae=ns(ae)}$e=null}else $e=null;Me!==null&&tf(ke,we,Me,$e,!1),ze!==null&&Wt!==null&&tf(ke,Wt,ze,$e,!0)}}e:{if(we=fe?ss(fe):window,Me=we.nodeName&&we.nodeName.toLowerCase(),Me==="select"||Me==="input"&&we.type==="file")var Ve=O1;else if(R0(we))if(I0)Ve=M1;else{Ve=D1;var qe=R1}else(Me=we.nodeName)&&Me.toLowerCase()==="input"&&(we.type==="checkbox"||we.type==="radio")&&(Ve=I1);if(Ve&&(Ve=Ve(n,fe))){D0(ke,Ve,l,_e);break e}qe&&qe(n,we,fe),n==="focusout"&&(qe=we._wrapperState)&&qe.controlled&&we.type==="number"&&Ue(we,"number",we.value)}switch(qe=fe?ss(fe):window,n){case"focusin":(R0(qe)||qe.contentEditable==="true")&&(ts=qe,Xo=fe,Js=null);break;case"focusout":Js=Xo=ts=null;break;case"mousedown":Ko=!0;break;case"contextmenu":case"mouseup":case"dragend":Ko=!1,H0(ke,l,_e);break;case"selectionchange":if(U1)break;case"keydown":case"keyup":H0(ke,l,_e)}var Qe;if($o)e:{switch(n){case"compositionstart":var Ze="onCompositionStart";break e;case"compositionend":Ze="onCompositionEnd";break e;case"compositionupdate":Ze="onCompositionUpdate";break e}Ze=void 0}else es?P0(n,l)&&(Ze="onCompositionEnd"):n==="keydown"&&l.keyCode===229&&(Ze="onCompositionStart");Ze&&(b0&&l.locale!=="ko"&&(es||Ze!=="onCompositionStart"?Ze==="onCompositionEnd"&&es&&(Qe=T0()):(ea=_e,Mo="value"in ea?ea.value:ea.textContent,es=!0)),qe=al(fe,Ze),0<qe.length&&(Ze=new C0(Ze,n,null,l,_e),ke.push({event:Ze,listeners:qe}),Qe?Ze.data=Qe:(Qe=O0(l),Qe!==null&&(Ze.data=Qe)))),(Qe=A1?b1(n,l):F1(n,l))&&(fe=al(fe,"onBeforeInput"),0<fe.length&&(_e=new C0("onBeforeInput","beforeinput",null,l,_e),ke.push({event:_e,listeners:fe}),_e.data=Qe))}Z0(ke,a)})}function ti(n,a,l){return{instance:n,listener:a,currentTarget:l}}function al(n,a){for(var l=a+"Capture",f=[];n!==null;){var h=n,v=h.stateNode;h.tag===5&&v!==null&&(h=v,v=yn(n,l),v!=null&&f.unshift(ti(n,v,h)),v=yn(n,a),v!=null&&f.push(ti(n,v,h))),n=n.return}return f}function ns(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function tf(n,a,l,f,h){for(var v=a._reactName,S=[];l!==null&&l!==f;){var D=l,G=D.alternate,fe=D.stateNode;if(G!==null&&G===f)break;D.tag===5&&fe!==null&&(D=fe,h?(G=yn(l,v),G!=null&&S.unshift(ti(l,G,D))):h||(G=yn(l,v),G!=null&&S.push(ti(l,G,D)))),l=l.return}S.length!==0&&n.push({event:a,listeners:S})}var H1=/\r\n?/g,V1=/\u0000|\uFFFD/g;function rf(n){return(typeof n=="string"?n:""+n).replace(H1,`
`).replace(V1,"")}function sl(n,a,l){if(a=rf(a),rf(n)!==a&&l)throw Error(t(425))}function il(){}var ec=null,tc=null;function rc(n,a){return n==="textarea"||n==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var nc=typeof setTimeout=="function"?setTimeout:void 0,G1=typeof clearTimeout=="function"?clearTimeout:void 0,nf=typeof Promise=="function"?Promise:void 0,X1=typeof queueMicrotask=="function"?queueMicrotask:typeof nf<"u"?function(n){return nf.resolve(null).then(n).catch(K1)}:nc;function K1(n){setTimeout(function(){throw n})}function ac(n,a){var l=a,f=0;do{var h=l.nextSibling;if(n.removeChild(l),h&&h.nodeType===8)if(l=h.data,l==="/$"){if(f===0){n.removeChild(h),Vs(a);return}f--}else l!=="$"&&l!=="$?"&&l!=="$!"||f++;l=h}while(l);Vs(a)}function ra(n){for(;n!=null;n=n.nextSibling){var a=n.nodeType;if(a===1||a===3)break;if(a===8){if(a=n.data,a==="$"||a==="$!"||a==="$?")break;if(a==="/$")return null}}return n}function af(n){n=n.previousSibling;for(var a=0;n;){if(n.nodeType===8){var l=n.data;if(l==="$"||l==="$!"||l==="$?"){if(a===0)return n;a--}else l==="/$"&&a++}n=n.previousSibling}return null}var as=Math.random().toString(36).slice(2),_n="__reactFiber$"+as,ri="__reactProps$"+as,Rn="__reactContainer$"+as,sc="__reactEvents$"+as,Y1="__reactListeners$"+as,q1="__reactHandles$"+as;function Ca(n){var a=n[_n];if(a)return a;for(var l=n.parentNode;l;){if(a=l[Rn]||l[_n]){if(l=a.alternate,a.child!==null||l!==null&&l.child!==null)for(n=af(n);n!==null;){if(l=n[_n])return l;n=af(n)}return a}n=l,l=n.parentNode}return null}function ni(n){return n=n[_n]||n[Rn],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function ss(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(t(33))}function ll(n){return n[ri]||null}var ic=[],is=-1;function na(n){return{current:n}}function jt(n){0>is||(n.current=ic[is],ic[is]=null,is--)}function At(n,a){is++,ic[is]=n.current,n.current=a}var aa={},xr=na(aa),Ar=na(!1),Aa=aa;function ls(n,a){var l=n.type.contextTypes;if(!l)return aa;var f=n.stateNode;if(f&&f.__reactInternalMemoizedUnmaskedChildContext===a)return f.__reactInternalMemoizedMaskedChildContext;var h={},v;for(v in l)h[v]=a[v];return f&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=a,n.__reactInternalMemoizedMaskedChildContext=h),h}function br(n){return n=n.childContextTypes,n!=null}function ol(){jt(Ar),jt(xr)}function sf(n,a,l){if(xr.current!==aa)throw Error(t(168));At(xr,a),At(Ar,l)}function lf(n,a,l){var f=n.stateNode;if(a=a.childContextTypes,typeof f.getChildContext!="function")return l;f=f.getChildContext();for(var h in f)if(!(h in a))throw Error(t(108,Ee(n)||"Unknown",h));return ye({},l,f)}function cl(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||aa,Aa=xr.current,At(xr,n),At(Ar,Ar.current),!0}function of(n,a,l){var f=n.stateNode;if(!f)throw Error(t(169));l?(n=lf(n,a,Aa),f.__reactInternalMemoizedMergedChildContext=n,jt(Ar),jt(xr),At(xr,n)):jt(Ar),At(Ar,l)}var Dn=null,ul=!1,lc=!1;function cf(n){Dn===null?Dn=[n]:Dn.push(n)}function Q1(n){ul=!0,cf(n)}function sa(){if(!lc&&Dn!==null){lc=!0;var n=0,a=wt;try{var l=Dn;for(wt=1;n<l.length;n++){var f=l[n];do f=f(!0);while(f!==null)}Dn=null,ul=!1}catch(h){throw Dn!==null&&(Dn=Dn.slice(n+1)),Ne(kt,sa),h}finally{wt=a,lc=!1}}return null}var os=[],cs=0,fl=null,dl=0,Xr=[],Kr=0,ba=null,In=1,Mn="";function Fa(n,a){os[cs++]=dl,os[cs++]=fl,fl=n,dl=a}function uf(n,a,l){Xr[Kr++]=In,Xr[Kr++]=Mn,Xr[Kr++]=ba,ba=n;var f=In;n=Mn;var h=32-zt(f)-1;f&=~(1<<h),l+=1;var v=32-zt(a)+h;if(30<v){var S=h-h%5;v=(f&(1<<S)-1).toString(32),f>>=S,h-=S,In=1<<32-zt(a)+h|l<<h|f,Mn=v+n}else In=1<<v|l<<h|f,Mn=n}function oc(n){n.return!==null&&(Fa(n,1),uf(n,1,0))}function cc(n){for(;n===fl;)fl=os[--cs],os[cs]=null,dl=os[--cs],os[cs]=null;for(;n===ba;)ba=Xr[--Kr],Xr[Kr]=null,Mn=Xr[--Kr],Xr[Kr]=null,In=Xr[--Kr],Xr[Kr]=null}var Lr=null,Br=null,Rt=!1,ln=null;function ff(n,a){var l=Jr(5,null,null,0);l.elementType="DELETED",l.stateNode=a,l.return=n,a=n.deletions,a===null?(n.deletions=[l],n.flags|=16):a.push(l)}function df(n,a){switch(n.tag){case 5:var l=n.type;return a=a.nodeType!==1||l.toLowerCase()!==a.nodeName.toLowerCase()?null:a,a!==null?(n.stateNode=a,Lr=n,Br=ra(a.firstChild),!0):!1;case 6:return a=n.pendingProps===""||a.nodeType!==3?null:a,a!==null?(n.stateNode=a,Lr=n,Br=null,!0):!1;case 13:return a=a.nodeType!==8?null:a,a!==null?(l=ba!==null?{id:In,overflow:Mn}:null,n.memoizedState={dehydrated:a,treeContext:l,retryLane:1073741824},l=Jr(18,null,null,0),l.stateNode=a,l.return=n,n.child=l,Lr=n,Br=null,!0):!1;default:return!1}}function uc(n){return(n.mode&1)!==0&&(n.flags&128)===0}function fc(n){if(Rt){var a=Br;if(a){var l=a;if(!df(n,a)){if(uc(n))throw Error(t(418));a=ra(l.nextSibling);var f=Lr;a&&df(n,a)?ff(f,l):(n.flags=n.flags&-4097|2,Rt=!1,Lr=n)}}else{if(uc(n))throw Error(t(418));n.flags=n.flags&-4097|2,Rt=!1,Lr=n}}}function hf(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Lr=n}function hl(n){if(n!==Lr)return!1;if(!Rt)return hf(n),Rt=!0,!1;var a;if((a=n.tag!==3)&&!(a=n.tag!==5)&&(a=n.type,a=a!=="head"&&a!=="body"&&!rc(n.type,n.memoizedProps)),a&&(a=Br)){if(uc(n))throw pf(),Error(t(418));for(;a;)ff(n,a),a=ra(a.nextSibling)}if(hf(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(t(317));e:{for(n=n.nextSibling,a=0;n;){if(n.nodeType===8){var l=n.data;if(l==="/$"){if(a===0){Br=ra(n.nextSibling);break e}a--}else l!=="$"&&l!=="$!"&&l!=="$?"||a++}n=n.nextSibling}Br=null}}else Br=Lr?ra(n.stateNode.nextSibling):null;return!0}function pf(){for(var n=Br;n;)n=ra(n.nextSibling)}function us(){Br=Lr=null,Rt=!1}function dc(n){ln===null?ln=[n]:ln.push(n)}var J1=J.ReactCurrentBatchConfig;function ai(n,a,l){if(n=l.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(l._owner){if(l=l._owner,l){if(l.tag!==1)throw Error(t(309));var f=l.stateNode}if(!f)throw Error(t(147,n));var h=f,v=""+n;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===v?a.ref:(a=function(S){var D=h.refs;S===null?delete D[v]:D[v]=S},a._stringRef=v,a)}if(typeof n!="string")throw Error(t(284));if(!l._owner)throw Error(t(290,n))}return n}function pl(n,a){throw n=Object.prototype.toString.call(a),Error(t(31,n==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":n))}function xf(n){var a=n._init;return a(n._payload)}function mf(n){function a(ae,Q){if(n){var se=ae.deletions;se===null?(ae.deletions=[Q],ae.flags|=16):se.push(Q)}}function l(ae,Q){if(!n)return null;for(;Q!==null;)a(ae,Q),Q=Q.sibling;return null}function f(ae,Q){for(ae=new Map;Q!==null;)Q.key!==null?ae.set(Q.key,Q):ae.set(Q.index,Q),Q=Q.sibling;return ae}function h(ae,Q){return ae=ha(ae,Q),ae.index=0,ae.sibling=null,ae}function v(ae,Q,se){return ae.index=se,n?(se=ae.alternate,se!==null?(se=se.index,se<Q?(ae.flags|=2,Q):se):(ae.flags|=2,Q)):(ae.flags|=1048576,Q)}function S(ae){return n&&ae.alternate===null&&(ae.flags|=2),ae}function D(ae,Q,se,be){return Q===null||Q.tag!==6?(Q=nu(se,ae.mode,be),Q.return=ae,Q):(Q=h(Q,se),Q.return=ae,Q)}function G(ae,Q,se,be){var Ve=se.type;return Ve===z?_e(ae,Q,se.props.children,be,se.key):Q!==null&&(Q.elementType===Ve||typeof Ve=="object"&&Ve!==null&&Ve.$$typeof===Z&&xf(Ve)===Q.type)?(be=h(Q,se.props),be.ref=ai(ae,Q,se),be.return=ae,be):(be=Ll(se.type,se.key,se.props,null,ae.mode,be),be.ref=ai(ae,Q,se),be.return=ae,be)}function fe(ae,Q,se,be){return Q===null||Q.tag!==4||Q.stateNode.containerInfo!==se.containerInfo||Q.stateNode.implementation!==se.implementation?(Q=au(se,ae.mode,be),Q.return=ae,Q):(Q=h(Q,se.children||[]),Q.return=ae,Q)}function _e(ae,Q,se,be,Ve){return Q===null||Q.tag!==7?(Q=La(se,ae.mode,be,Ve),Q.return=ae,Q):(Q=h(Q,se),Q.return=ae,Q)}function ke(ae,Q,se){if(typeof Q=="string"&&Q!==""||typeof Q=="number")return Q=nu(""+Q,ae.mode,se),Q.return=ae,Q;if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case he:return se=Ll(Q.type,Q.key,Q.props,null,ae.mode,se),se.ref=ai(ae,null,Q),se.return=ae,se;case de:return Q=au(Q,ae.mode,se),Q.return=ae,Q;case Z:var be=Q._init;return ke(ae,be(Q._payload),se)}if(He(Q)||ve(Q))return Q=La(Q,ae.mode,se,null),Q.return=ae,Q;pl(ae,Q)}return null}function we(ae,Q,se,be){var Ve=Q!==null?Q.key:null;if(typeof se=="string"&&se!==""||typeof se=="number")return Ve!==null?null:D(ae,Q,""+se,be);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case he:return se.key===Ve?G(ae,Q,se,be):null;case de:return se.key===Ve?fe(ae,Q,se,be):null;case Z:return Ve=se._init,we(ae,Q,Ve(se._payload),be)}if(He(se)||ve(se))return Ve!==null?null:_e(ae,Q,se,be,null);pl(ae,se)}return null}function Me(ae,Q,se,be,Ve){if(typeof be=="string"&&be!==""||typeof be=="number")return ae=ae.get(se)||null,D(Q,ae,""+be,Ve);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case he:return ae=ae.get(be.key===null?se:be.key)||null,G(Q,ae,be,Ve);case de:return ae=ae.get(be.key===null?se:be.key)||null,fe(Q,ae,be,Ve);case Z:var qe=be._init;return Me(ae,Q,se,qe(be._payload),Ve)}if(He(be)||ve(be))return ae=ae.get(se)||null,_e(Q,ae,be,Ve,null);pl(Q,be)}return null}function ze(ae,Q,se,be){for(var Ve=null,qe=null,Qe=Q,Ze=Q=0,rr=null;Qe!==null&&Ze<se.length;Ze++){Qe.index>Ze?(rr=Qe,Qe=null):rr=Qe.sibling;var pt=we(ae,Qe,se[Ze],be);if(pt===null){Qe===null&&(Qe=rr);break}n&&Qe&&pt.alternate===null&&a(ae,Qe),Q=v(pt,Q,Ze),qe===null?Ve=pt:qe.sibling=pt,qe=pt,Qe=rr}if(Ze===se.length)return l(ae,Qe),Rt&&Fa(ae,Ze),Ve;if(Qe===null){for(;Ze<se.length;Ze++)Qe=ke(ae,se[Ze],be),Qe!==null&&(Q=v(Qe,Q,Ze),qe===null?Ve=Qe:qe.sibling=Qe,qe=Qe);return Rt&&Fa(ae,Ze),Ve}for(Qe=f(ae,Qe);Ze<se.length;Ze++)rr=Me(Qe,ae,Ze,se[Ze],be),rr!==null&&(n&&rr.alternate!==null&&Qe.delete(rr.key===null?Ze:rr.key),Q=v(rr,Q,Ze),qe===null?Ve=rr:qe.sibling=rr,qe=rr);return n&&Qe.forEach(function(pa){return a(ae,pa)}),Rt&&Fa(ae,Ze),Ve}function $e(ae,Q,se,be){var Ve=ve(se);if(typeof Ve!="function")throw Error(t(150));if(se=Ve.call(se),se==null)throw Error(t(151));for(var qe=Ve=null,Qe=Q,Ze=Q=0,rr=null,pt=se.next();Qe!==null&&!pt.done;Ze++,pt=se.next()){Qe.index>Ze?(rr=Qe,Qe=null):rr=Qe.sibling;var pa=we(ae,Qe,pt.value,be);if(pa===null){Qe===null&&(Qe=rr);break}n&&Qe&&pa.alternate===null&&a(ae,Qe),Q=v(pa,Q,Ze),qe===null?Ve=pa:qe.sibling=pa,qe=pa,Qe=rr}if(pt.done)return l(ae,Qe),Rt&&Fa(ae,Ze),Ve;if(Qe===null){for(;!pt.done;Ze++,pt=se.next())pt=ke(ae,pt.value,be),pt!==null&&(Q=v(pt,Q,Ze),qe===null?Ve=pt:qe.sibling=pt,qe=pt);return Rt&&Fa(ae,Ze),Ve}for(Qe=f(ae,Qe);!pt.done;Ze++,pt=se.next())pt=Me(Qe,ae,Ze,pt.value,be),pt!==null&&(n&&pt.alternate!==null&&Qe.delete(pt.key===null?Ze:pt.key),Q=v(pt,Q,Ze),qe===null?Ve=pt:qe.sibling=pt,qe=pt);return n&&Qe.forEach(function(jm){return a(ae,jm)}),Rt&&Fa(ae,Ze),Ve}function Wt(ae,Q,se,be){if(typeof se=="object"&&se!==null&&se.type===z&&se.key===null&&(se=se.props.children),typeof se=="object"&&se!==null){switch(se.$$typeof){case he:e:{for(var Ve=se.key,qe=Q;qe!==null;){if(qe.key===Ve){if(Ve=se.type,Ve===z){if(qe.tag===7){l(ae,qe.sibling),Q=h(qe,se.props.children),Q.return=ae,ae=Q;break e}}else if(qe.elementType===Ve||typeof Ve=="object"&&Ve!==null&&Ve.$$typeof===Z&&xf(Ve)===qe.type){l(ae,qe.sibling),Q=h(qe,se.props),Q.ref=ai(ae,qe,se),Q.return=ae,ae=Q;break e}l(ae,qe);break}else a(ae,qe);qe=qe.sibling}se.type===z?(Q=La(se.props.children,ae.mode,be,se.key),Q.return=ae,ae=Q):(be=Ll(se.type,se.key,se.props,null,ae.mode,be),be.ref=ai(ae,Q,se),be.return=ae,ae=be)}return S(ae);case de:e:{for(qe=se.key;Q!==null;){if(Q.key===qe)if(Q.tag===4&&Q.stateNode.containerInfo===se.containerInfo&&Q.stateNode.implementation===se.implementation){l(ae,Q.sibling),Q=h(Q,se.children||[]),Q.return=ae,ae=Q;break e}else{l(ae,Q);break}else a(ae,Q);Q=Q.sibling}Q=au(se,ae.mode,be),Q.return=ae,ae=Q}return S(ae);case Z:return qe=se._init,Wt(ae,Q,qe(se._payload),be)}if(He(se))return ze(ae,Q,se,be);if(ve(se))return $e(ae,Q,se,be);pl(ae,se)}return typeof se=="string"&&se!==""||typeof se=="number"?(se=""+se,Q!==null&&Q.tag===6?(l(ae,Q.sibling),Q=h(Q,se),Q.return=ae,ae=Q):(l(ae,Q),Q=nu(se,ae.mode,be),Q.return=ae,ae=Q),S(ae)):l(ae,Q)}return Wt}var fs=mf(!0),vf=mf(!1),xl=na(null),ml=null,ds=null,hc=null;function pc(){hc=ds=ml=null}function xc(n){var a=xl.current;jt(xl),n._currentValue=a}function mc(n,a,l){for(;n!==null;){var f=n.alternate;if((n.childLanes&a)!==a?(n.childLanes|=a,f!==null&&(f.childLanes|=a)):f!==null&&(f.childLanes&a)!==a&&(f.childLanes|=a),n===l)break;n=n.return}}function hs(n,a){ml=n,hc=ds=null,n=n.dependencies,n!==null&&n.firstContext!==null&&((n.lanes&a)!==0&&(Fr=!0),n.firstContext=null)}function Yr(n){var a=n._currentValue;if(hc!==n)if(n={context:n,memoizedValue:a,next:null},ds===null){if(ml===null)throw Error(t(308));ds=n,ml.dependencies={lanes:0,firstContext:n}}else ds=ds.next=n;return a}var ja=null;function vc(n){ja===null?ja=[n]:ja.push(n)}function gf(n,a,l,f){var h=a.interleaved;return h===null?(l.next=l,vc(a)):(l.next=h.next,h.next=l),a.interleaved=l,Ln(n,f)}function Ln(n,a){n.lanes|=a;var l=n.alternate;for(l!==null&&(l.lanes|=a),l=n,n=n.return;n!==null;)n.childLanes|=a,l=n.alternate,l!==null&&(l.childLanes|=a),l=n,n=n.return;return l.tag===3?l.stateNode:null}var ia=!1;function gc(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function yf(n,a){n=n.updateQueue,a.updateQueue===n&&(a.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Bn(n,a){return{eventTime:n,lane:a,tag:0,payload:null,callback:null,next:null}}function la(n,a,l){var f=n.updateQueue;if(f===null)return null;if(f=f.shared,(ht&2)!==0){var h=f.pending;return h===null?a.next=a:(a.next=h.next,h.next=a),f.pending=a,Ln(n,l)}return h=f.interleaved,h===null?(a.next=a,vc(f)):(a.next=h.next,h.next=a),f.interleaved=a,Ln(n,l)}function vl(n,a,l){if(a=a.updateQueue,a!==null&&(a=a.shared,(l&4194240)!==0)){var f=a.lanes;f&=n.pendingLanes,l|=f,a.lanes=l,Po(n,l)}}function wf(n,a){var l=n.updateQueue,f=n.alternate;if(f!==null&&(f=f.updateQueue,l===f)){var h=null,v=null;if(l=l.firstBaseUpdate,l!==null){do{var S={eventTime:l.eventTime,lane:l.lane,tag:l.tag,payload:l.payload,callback:l.callback,next:null};v===null?h=v=S:v=v.next=S,l=l.next}while(l!==null);v===null?h=v=a:v=v.next=a}else h=v=a;l={baseState:f.baseState,firstBaseUpdate:h,lastBaseUpdate:v,shared:f.shared,effects:f.effects},n.updateQueue=l;return}n=l.lastBaseUpdate,n===null?l.firstBaseUpdate=a:n.next=a,l.lastBaseUpdate=a}function gl(n,a,l,f){var h=n.updateQueue;ia=!1;var v=h.firstBaseUpdate,S=h.lastBaseUpdate,D=h.shared.pending;if(D!==null){h.shared.pending=null;var G=D,fe=G.next;G.next=null,S===null?v=fe:S.next=fe,S=G;var _e=n.alternate;_e!==null&&(_e=_e.updateQueue,D=_e.lastBaseUpdate,D!==S&&(D===null?_e.firstBaseUpdate=fe:D.next=fe,_e.lastBaseUpdate=G))}if(v!==null){var ke=h.baseState;S=0,_e=fe=G=null,D=v;do{var we=D.lane,Me=D.eventTime;if((f&we)===we){_e!==null&&(_e=_e.next={eventTime:Me,lane:0,tag:D.tag,payload:D.payload,callback:D.callback,next:null});e:{var ze=n,$e=D;switch(we=a,Me=l,$e.tag){case 1:if(ze=$e.payload,typeof ze=="function"){ke=ze.call(Me,ke,we);break e}ke=ze;break e;case 3:ze.flags=ze.flags&-65537|128;case 0:if(ze=$e.payload,we=typeof ze=="function"?ze.call(Me,ke,we):ze,we==null)break e;ke=ye({},ke,we);break e;case 2:ia=!0}}D.callback!==null&&D.lane!==0&&(n.flags|=64,we=h.effects,we===null?h.effects=[D]:we.push(D))}else Me={eventTime:Me,lane:we,tag:D.tag,payload:D.payload,callback:D.callback,next:null},_e===null?(fe=_e=Me,G=ke):_e=_e.next=Me,S|=we;if(D=D.next,D===null){if(D=h.shared.pending,D===null)break;we=D,D=we.next,we.next=null,h.lastBaseUpdate=we,h.shared.pending=null}}while(!0);if(_e===null&&(G=ke),h.baseState=G,h.firstBaseUpdate=fe,h.lastBaseUpdate=_e,a=h.shared.interleaved,a!==null){h=a;do S|=h.lane,h=h.next;while(h!==a)}else v===null&&(h.shared.lanes=0);Ra|=S,n.lanes=S,n.memoizedState=ke}}function _f(n,a,l){if(n=a.effects,a.effects=null,n!==null)for(a=0;a<n.length;a++){var f=n[a],h=f.callback;if(h!==null){if(f.callback=null,f=l,typeof h!="function")throw Error(t(191,h));h.call(f)}}}var si={},En=na(si),ii=na(si),li=na(si);function Pa(n){if(n===si)throw Error(t(174));return n}function yc(n,a){switch(At(li,a),At(ii,n),At(En,si),n=a.nodeType,n){case 9:case 11:a=(a=a.documentElement)?a.namespaceURI:nn(null,"");break;default:n=n===8?a.parentNode:a,a=n.namespaceURI||null,n=n.tagName,a=nn(a,n)}jt(En),At(En,a)}function ps(){jt(En),jt(ii),jt(li)}function Ef(n){Pa(li.current);var a=Pa(En.current),l=nn(a,n.type);a!==l&&(At(ii,n),At(En,l))}function wc(n){ii.current===n&&(jt(En),jt(ii))}var Dt=na(0);function yl(n){for(var a=n;a!==null;){if(a.tag===13){var l=a.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||l.data==="$!"))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var _c=[];function Ec(){for(var n=0;n<_c.length;n++)_c[n]._workInProgressVersionPrimary=null;_c.length=0}var wl=J.ReactCurrentDispatcher,Sc=J.ReactCurrentBatchConfig,Oa=0,It=null,Yt=null,er=null,_l=!1,oi=!1,ci=0,Z1=0;function mr(){throw Error(t(321))}function Tc(n,a){if(a===null)return!1;for(var l=0;l<a.length&&l<n.length;l++)if(!sn(n[l],a[l]))return!1;return!0}function Nc(n,a,l,f,h,v){if(Oa=v,It=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,wl.current=n===null||n.memoizedState===null?nm:am,n=l(f,h),oi){v=0;do{if(oi=!1,ci=0,25<=v)throw Error(t(301));v+=1,er=Yt=null,a.updateQueue=null,wl.current=sm,n=l(f,h)}while(oi)}if(wl.current=Tl,a=Yt!==null&&Yt.next!==null,Oa=0,er=Yt=It=null,_l=!1,a)throw Error(t(300));return n}function kc(){var n=ci!==0;return ci=0,n}function Sn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return er===null?It.memoizedState=er=n:er=er.next=n,er}function qr(){if(Yt===null){var n=It.alternate;n=n!==null?n.memoizedState:null}else n=Yt.next;var a=er===null?It.memoizedState:er.next;if(a!==null)er=a,Yt=n;else{if(n===null)throw Error(t(310));Yt=n,n={memoizedState:Yt.memoizedState,baseState:Yt.baseState,baseQueue:Yt.baseQueue,queue:Yt.queue,next:null},er===null?It.memoizedState=er=n:er=er.next=n}return er}function ui(n,a){return typeof a=="function"?a(n):a}function Cc(n){var a=qr(),l=a.queue;if(l===null)throw Error(t(311));l.lastRenderedReducer=n;var f=Yt,h=f.baseQueue,v=l.pending;if(v!==null){if(h!==null){var S=h.next;h.next=v.next,v.next=S}f.baseQueue=h=v,l.pending=null}if(h!==null){v=h.next,f=f.baseState;var D=S=null,G=null,fe=v;do{var _e=fe.lane;if((Oa&_e)===_e)G!==null&&(G=G.next={lane:0,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null}),f=fe.hasEagerState?fe.eagerState:n(f,fe.action);else{var ke={lane:_e,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null};G===null?(D=G=ke,S=f):G=G.next=ke,It.lanes|=_e,Ra|=_e}fe=fe.next}while(fe!==null&&fe!==v);G===null?S=f:G.next=D,sn(f,a.memoizedState)||(Fr=!0),a.memoizedState=f,a.baseState=S,a.baseQueue=G,l.lastRenderedState=f}if(n=l.interleaved,n!==null){h=n;do v=h.lane,It.lanes|=v,Ra|=v,h=h.next;while(h!==n)}else h===null&&(l.lanes=0);return[a.memoizedState,l.dispatch]}function Ac(n){var a=qr(),l=a.queue;if(l===null)throw Error(t(311));l.lastRenderedReducer=n;var f=l.dispatch,h=l.pending,v=a.memoizedState;if(h!==null){l.pending=null;var S=h=h.next;do v=n(v,S.action),S=S.next;while(S!==h);sn(v,a.memoizedState)||(Fr=!0),a.memoizedState=v,a.baseQueue===null&&(a.baseState=v),l.lastRenderedState=v}return[v,f]}function Sf(){}function Tf(n,a){var l=It,f=qr(),h=a(),v=!sn(f.memoizedState,h);if(v&&(f.memoizedState=h,Fr=!0),f=f.queue,bc(Cf.bind(null,l,f,n),[n]),f.getSnapshot!==a||v||er!==null&&er.memoizedState.tag&1){if(l.flags|=2048,fi(9,kf.bind(null,l,f,h,a),void 0,null),tr===null)throw Error(t(349));(Oa&30)!==0||Nf(l,a,h)}return h}function Nf(n,a,l){n.flags|=16384,n={getSnapshot:a,value:l},a=It.updateQueue,a===null?(a={lastEffect:null,stores:null},It.updateQueue=a,a.stores=[n]):(l=a.stores,l===null?a.stores=[n]:l.push(n))}function kf(n,a,l,f){a.value=l,a.getSnapshot=f,Af(a)&&bf(n)}function Cf(n,a,l){return l(function(){Af(a)&&bf(n)})}function Af(n){var a=n.getSnapshot;n=n.value;try{var l=a();return!sn(n,l)}catch{return!0}}function bf(n){var a=Ln(n,1);a!==null&&fn(a,n,1,-1)}function Ff(n){var a=Sn();return typeof n=="function"&&(n=n()),a.memoizedState=a.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ui,lastRenderedState:n},a.queue=n,n=n.dispatch=rm.bind(null,It,n),[a.memoizedState,n]}function fi(n,a,l,f){return n={tag:n,create:a,destroy:l,deps:f,next:null},a=It.updateQueue,a===null?(a={lastEffect:null,stores:null},It.updateQueue=a,a.lastEffect=n.next=n):(l=a.lastEffect,l===null?a.lastEffect=n.next=n:(f=l.next,l.next=n,n.next=f,a.lastEffect=n)),n}function jf(){return qr().memoizedState}function El(n,a,l,f){var h=Sn();It.flags|=n,h.memoizedState=fi(1|a,l,void 0,f===void 0?null:f)}function Sl(n,a,l,f){var h=qr();f=f===void 0?null:f;var v=void 0;if(Yt!==null){var S=Yt.memoizedState;if(v=S.destroy,f!==null&&Tc(f,S.deps)){h.memoizedState=fi(a,l,v,f);return}}It.flags|=n,h.memoizedState=fi(1|a,l,v,f)}function Pf(n,a){return El(8390656,8,n,a)}function bc(n,a){return Sl(2048,8,n,a)}function Of(n,a){return Sl(4,2,n,a)}function Rf(n,a){return Sl(4,4,n,a)}function Df(n,a){if(typeof a=="function")return n=n(),a(n),function(){a(null)};if(a!=null)return n=n(),a.current=n,function(){a.current=null}}function If(n,a,l){return l=l!=null?l.concat([n]):null,Sl(4,4,Df.bind(null,a,n),l)}function Fc(){}function Mf(n,a){var l=qr();a=a===void 0?null:a;var f=l.memoizedState;return f!==null&&a!==null&&Tc(a,f[1])?f[0]:(l.memoizedState=[n,a],n)}function Lf(n,a){var l=qr();a=a===void 0?null:a;var f=l.memoizedState;return f!==null&&a!==null&&Tc(a,f[1])?f[0]:(n=n(),l.memoizedState=[n,a],n)}function Bf(n,a,l){return(Oa&21)===0?(n.baseState&&(n.baseState=!1,Fr=!0),n.memoizedState=l):(sn(l,a)||(l=p0(),It.lanes|=l,Ra|=l,n.baseState=!0),a)}function em(n,a){var l=wt;wt=l!==0&&4>l?l:4,n(!0);var f=Sc.transition;Sc.transition={};try{n(!1),a()}finally{wt=l,Sc.transition=f}}function Uf(){return qr().memoizedState}function tm(n,a,l){var f=fa(n);if(l={lane:f,action:l,hasEagerState:!1,eagerState:null,next:null},zf(n))Wf(a,l);else if(l=gf(n,a,l,f),l!==null){var h=Tr();fn(l,n,f,h),$f(l,a,f)}}function rm(n,a,l){var f=fa(n),h={lane:f,action:l,hasEagerState:!1,eagerState:null,next:null};if(zf(n))Wf(a,h);else{var v=n.alternate;if(n.lanes===0&&(v===null||v.lanes===0)&&(v=a.lastRenderedReducer,v!==null))try{var S=a.lastRenderedState,D=v(S,l);if(h.hasEagerState=!0,h.eagerState=D,sn(D,S)){var G=a.interleaved;G===null?(h.next=h,vc(a)):(h.next=G.next,G.next=h),a.interleaved=h;return}}catch{}l=gf(n,a,h,f),l!==null&&(h=Tr(),fn(l,n,f,h),$f(l,a,f))}}function zf(n){var a=n.alternate;return n===It||a!==null&&a===It}function Wf(n,a){oi=_l=!0;var l=n.pending;l===null?a.next=a:(a.next=l.next,l.next=a),n.pending=a}function $f(n,a,l){if((l&4194240)!==0){var f=a.lanes;f&=n.pendingLanes,l|=f,a.lanes=l,Po(n,l)}}var Tl={readContext:Yr,useCallback:mr,useContext:mr,useEffect:mr,useImperativeHandle:mr,useInsertionEffect:mr,useLayoutEffect:mr,useMemo:mr,useReducer:mr,useRef:mr,useState:mr,useDebugValue:mr,useDeferredValue:mr,useTransition:mr,useMutableSource:mr,useSyncExternalStore:mr,useId:mr,unstable_isNewReconciler:!1},nm={readContext:Yr,useCallback:function(n,a){return Sn().memoizedState=[n,a===void 0?null:a],n},useContext:Yr,useEffect:Pf,useImperativeHandle:function(n,a,l){return l=l!=null?l.concat([n]):null,El(4194308,4,Df.bind(null,a,n),l)},useLayoutEffect:function(n,a){return El(4194308,4,n,a)},useInsertionEffect:function(n,a){return El(4,2,n,a)},useMemo:function(n,a){var l=Sn();return a=a===void 0?null:a,n=n(),l.memoizedState=[n,a],n},useReducer:function(n,a,l){var f=Sn();return a=l!==void 0?l(a):a,f.memoizedState=f.baseState=a,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:a},f.queue=n,n=n.dispatch=tm.bind(null,It,n),[f.memoizedState,n]},useRef:function(n){var a=Sn();return n={current:n},a.memoizedState=n},useState:Ff,useDebugValue:Fc,useDeferredValue:function(n){return Sn().memoizedState=n},useTransition:function(){var n=Ff(!1),a=n[0];return n=em.bind(null,n[1]),Sn().memoizedState=n,[a,n]},useMutableSource:function(){},useSyncExternalStore:function(n,a,l){var f=It,h=Sn();if(Rt){if(l===void 0)throw Error(t(407));l=l()}else{if(l=a(),tr===null)throw Error(t(349));(Oa&30)!==0||Nf(f,a,l)}h.memoizedState=l;var v={value:l,getSnapshot:a};return h.queue=v,Pf(Cf.bind(null,f,v,n),[n]),f.flags|=2048,fi(9,kf.bind(null,f,v,l,a),void 0,null),l},useId:function(){var n=Sn(),a=tr.identifierPrefix;if(Rt){var l=Mn,f=In;l=(f&~(1<<32-zt(f)-1)).toString(32)+l,a=":"+a+"R"+l,l=ci++,0<l&&(a+="H"+l.toString(32)),a+=":"}else l=Z1++,a=":"+a+"r"+l.toString(32)+":";return n.memoizedState=a},unstable_isNewReconciler:!1},am={readContext:Yr,useCallback:Mf,useContext:Yr,useEffect:bc,useImperativeHandle:If,useInsertionEffect:Of,useLayoutEffect:Rf,useMemo:Lf,useReducer:Cc,useRef:jf,useState:function(){return Cc(ui)},useDebugValue:Fc,useDeferredValue:function(n){var a=qr();return Bf(a,Yt.memoizedState,n)},useTransition:function(){var n=Cc(ui)[0],a=qr().memoizedState;return[n,a]},useMutableSource:Sf,useSyncExternalStore:Tf,useId:Uf,unstable_isNewReconciler:!1},sm={readContext:Yr,useCallback:Mf,useContext:Yr,useEffect:bc,useImperativeHandle:If,useInsertionEffect:Of,useLayoutEffect:Rf,useMemo:Lf,useReducer:Ac,useRef:jf,useState:function(){return Ac(ui)},useDebugValue:Fc,useDeferredValue:function(n){var a=qr();return Yt===null?a.memoizedState=n:Bf(a,Yt.memoizedState,n)},useTransition:function(){var n=Ac(ui)[0],a=qr().memoizedState;return[n,a]},useMutableSource:Sf,useSyncExternalStore:Tf,useId:Uf,unstable_isNewReconciler:!1};function on(n,a){if(n&&n.defaultProps){a=ye({},a),n=n.defaultProps;for(var l in n)a[l]===void 0&&(a[l]=n[l]);return a}return a}function jc(n,a,l,f){a=n.memoizedState,l=l(f,a),l=l==null?a:ye({},a,l),n.memoizedState=l,n.lanes===0&&(n.updateQueue.baseState=l)}var Nl={isMounted:function(n){return(n=n._reactInternals)?P(n)===n:!1},enqueueSetState:function(n,a,l){n=n._reactInternals;var f=Tr(),h=fa(n),v=Bn(f,h);v.payload=a,l!=null&&(v.callback=l),a=la(n,v,h),a!==null&&(fn(a,n,h,f),vl(a,n,h))},enqueueReplaceState:function(n,a,l){n=n._reactInternals;var f=Tr(),h=fa(n),v=Bn(f,h);v.tag=1,v.payload=a,l!=null&&(v.callback=l),a=la(n,v,h),a!==null&&(fn(a,n,h,f),vl(a,n,h))},enqueueForceUpdate:function(n,a){n=n._reactInternals;var l=Tr(),f=fa(n),h=Bn(l,f);h.tag=2,a!=null&&(h.callback=a),a=la(n,h,f),a!==null&&(fn(a,n,f,l),vl(a,n,f))}};function Hf(n,a,l,f,h,v,S){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(f,v,S):a.prototype&&a.prototype.isPureReactComponent?!Qs(l,f)||!Qs(h,v):!0}function Vf(n,a,l){var f=!1,h=aa,v=a.contextType;return typeof v=="object"&&v!==null?v=Yr(v):(h=br(a)?Aa:xr.current,f=a.contextTypes,v=(f=f!=null)?ls(n,h):aa),a=new a(l,v),n.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=Nl,n.stateNode=a,a._reactInternals=n,f&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=h,n.__reactInternalMemoizedMaskedChildContext=v),a}function Gf(n,a,l,f){n=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(l,f),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(l,f),a.state!==n&&Nl.enqueueReplaceState(a,a.state,null)}function Pc(n,a,l,f){var h=n.stateNode;h.props=l,h.state=n.memoizedState,h.refs={},gc(n);var v=a.contextType;typeof v=="object"&&v!==null?h.context=Yr(v):(v=br(a)?Aa:xr.current,h.context=ls(n,v)),h.state=n.memoizedState,v=a.getDerivedStateFromProps,typeof v=="function"&&(jc(n,a,v,l),h.state=n.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof h.getSnapshotBeforeUpdate=="function"||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(a=h.state,typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount(),a!==h.state&&Nl.enqueueReplaceState(h,h.state,null),gl(n,l,h,f),h.state=n.memoizedState),typeof h.componentDidMount=="function"&&(n.flags|=4194308)}function xs(n,a){try{var l="",f=a;do l+=U(f),f=f.return;while(f);var h=l}catch(v){h=`
Error generating stack: `+v.message+`
`+v.stack}return{value:n,source:a,stack:h,digest:null}}function Oc(n,a,l){return{value:n,source:null,stack:l??null,digest:a??null}}function Rc(n,a){try{console.error(a.value)}catch(l){setTimeout(function(){throw l})}}var im=typeof WeakMap=="function"?WeakMap:Map;function Xf(n,a,l){l=Bn(-1,l),l.tag=3,l.payload={element:null};var f=a.value;return l.callback=function(){Pl||(Pl=!0,Yc=f),Rc(n,a)},l}function Kf(n,a,l){l=Bn(-1,l),l.tag=3;var f=n.type.getDerivedStateFromError;if(typeof f=="function"){var h=a.value;l.payload=function(){return f(h)},l.callback=function(){Rc(n,a)}}var v=n.stateNode;return v!==null&&typeof v.componentDidCatch=="function"&&(l.callback=function(){Rc(n,a),typeof f!="function"&&(ca===null?ca=new Set([this]):ca.add(this));var S=a.stack;this.componentDidCatch(a.value,{componentStack:S!==null?S:""})}),l}function Yf(n,a,l){var f=n.pingCache;if(f===null){f=n.pingCache=new im;var h=new Set;f.set(a,h)}else h=f.get(a),h===void 0&&(h=new Set,f.set(a,h));h.has(l)||(h.add(l),n=wm.bind(null,n,a,l),a.then(n,n))}function qf(n){do{var a;if((a=n.tag===13)&&(a=n.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return n;n=n.return}while(n!==null);return null}function Qf(n,a,l,f,h){return(n.mode&1)===0?(n===a?n.flags|=65536:(n.flags|=128,l.flags|=131072,l.flags&=-52805,l.tag===1&&(l.alternate===null?l.tag=17:(a=Bn(-1,1),a.tag=2,la(l,a,1))),l.lanes|=1),n):(n.flags|=65536,n.lanes=h,n)}var lm=J.ReactCurrentOwner,Fr=!1;function Sr(n,a,l,f){a.child=n===null?vf(a,null,l,f):fs(a,n.child,l,f)}function Jf(n,a,l,f,h){l=l.render;var v=a.ref;return hs(a,h),f=Nc(n,a,l,f,v,h),l=kc(),n!==null&&!Fr?(a.updateQueue=n.updateQueue,a.flags&=-2053,n.lanes&=~h,Un(n,a,h)):(Rt&&l&&oc(a),a.flags|=1,Sr(n,a,f,h),a.child)}function Zf(n,a,l,f,h){if(n===null){var v=l.type;return typeof v=="function"&&!ru(v)&&v.defaultProps===void 0&&l.compare===null&&l.defaultProps===void 0?(a.tag=15,a.type=v,ed(n,a,v,f,h)):(n=Ll(l.type,null,f,a,a.mode,h),n.ref=a.ref,n.return=a,a.child=n)}if(v=n.child,(n.lanes&h)===0){var S=v.memoizedProps;if(l=l.compare,l=l!==null?l:Qs,l(S,f)&&n.ref===a.ref)return Un(n,a,h)}return a.flags|=1,n=ha(v,f),n.ref=a.ref,n.return=a,a.child=n}function ed(n,a,l,f,h){if(n!==null){var v=n.memoizedProps;if(Qs(v,f)&&n.ref===a.ref)if(Fr=!1,a.pendingProps=f=v,(n.lanes&h)!==0)(n.flags&131072)!==0&&(Fr=!0);else return a.lanes=n.lanes,Un(n,a,h)}return Dc(n,a,l,f,h)}function td(n,a,l){var f=a.pendingProps,h=f.children,v=n!==null?n.memoizedState:null;if(f.mode==="hidden")if((a.mode&1)===0)a.memoizedState={baseLanes:0,cachePool:null,transitions:null},At(vs,Ur),Ur|=l;else{if((l&1073741824)===0)return n=v!==null?v.baseLanes|l:l,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:n,cachePool:null,transitions:null},a.updateQueue=null,At(vs,Ur),Ur|=n,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},f=v!==null?v.baseLanes:l,At(vs,Ur),Ur|=f}else v!==null?(f=v.baseLanes|l,a.memoizedState=null):f=l,At(vs,Ur),Ur|=f;return Sr(n,a,h,l),a.child}function rd(n,a){var l=a.ref;(n===null&&l!==null||n!==null&&n.ref!==l)&&(a.flags|=512,a.flags|=2097152)}function Dc(n,a,l,f,h){var v=br(l)?Aa:xr.current;return v=ls(a,v),hs(a,h),l=Nc(n,a,l,f,v,h),f=kc(),n!==null&&!Fr?(a.updateQueue=n.updateQueue,a.flags&=-2053,n.lanes&=~h,Un(n,a,h)):(Rt&&f&&oc(a),a.flags|=1,Sr(n,a,l,h),a.child)}function nd(n,a,l,f,h){if(br(l)){var v=!0;cl(a)}else v=!1;if(hs(a,h),a.stateNode===null)Cl(n,a),Vf(a,l,f),Pc(a,l,f,h),f=!0;else if(n===null){var S=a.stateNode,D=a.memoizedProps;S.props=D;var G=S.context,fe=l.contextType;typeof fe=="object"&&fe!==null?fe=Yr(fe):(fe=br(l)?Aa:xr.current,fe=ls(a,fe));var _e=l.getDerivedStateFromProps,ke=typeof _e=="function"||typeof S.getSnapshotBeforeUpdate=="function";ke||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(D!==f||G!==fe)&&Gf(a,S,f,fe),ia=!1;var we=a.memoizedState;S.state=we,gl(a,f,S,h),G=a.memoizedState,D!==f||we!==G||Ar.current||ia?(typeof _e=="function"&&(jc(a,l,_e,f),G=a.memoizedState),(D=ia||Hf(a,l,D,f,we,G,fe))?(ke||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(a.flags|=4194308)):(typeof S.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=f,a.memoizedState=G),S.props=f,S.state=G,S.context=fe,f=D):(typeof S.componentDidMount=="function"&&(a.flags|=4194308),f=!1)}else{S=a.stateNode,yf(n,a),D=a.memoizedProps,fe=a.type===a.elementType?D:on(a.type,D),S.props=fe,ke=a.pendingProps,we=S.context,G=l.contextType,typeof G=="object"&&G!==null?G=Yr(G):(G=br(l)?Aa:xr.current,G=ls(a,G));var Me=l.getDerivedStateFromProps;(_e=typeof Me=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(D!==ke||we!==G)&&Gf(a,S,f,G),ia=!1,we=a.memoizedState,S.state=we,gl(a,f,S,h);var ze=a.memoizedState;D!==ke||we!==ze||Ar.current||ia?(typeof Me=="function"&&(jc(a,l,Me,f),ze=a.memoizedState),(fe=ia||Hf(a,l,fe,f,we,ze,G)||!1)?(_e||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(f,ze,G),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(f,ze,G)),typeof S.componentDidUpdate=="function"&&(a.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof S.componentDidUpdate!="function"||D===n.memoizedProps&&we===n.memoizedState||(a.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||D===n.memoizedProps&&we===n.memoizedState||(a.flags|=1024),a.memoizedProps=f,a.memoizedState=ze),S.props=f,S.state=ze,S.context=G,f=fe):(typeof S.componentDidUpdate!="function"||D===n.memoizedProps&&we===n.memoizedState||(a.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||D===n.memoizedProps&&we===n.memoizedState||(a.flags|=1024),f=!1)}return Ic(n,a,l,f,v,h)}function Ic(n,a,l,f,h,v){rd(n,a);var S=(a.flags&128)!==0;if(!f&&!S)return h&&of(a,l,!1),Un(n,a,v);f=a.stateNode,lm.current=a;var D=S&&typeof l.getDerivedStateFromError!="function"?null:f.render();return a.flags|=1,n!==null&&S?(a.child=fs(a,n.child,null,v),a.child=fs(a,null,D,v)):Sr(n,a,D,v),a.memoizedState=f.state,h&&of(a,l,!0),a.child}function ad(n){var a=n.stateNode;a.pendingContext?sf(n,a.pendingContext,a.pendingContext!==a.context):a.context&&sf(n,a.context,!1),yc(n,a.containerInfo)}function sd(n,a,l,f,h){return us(),dc(h),a.flags|=256,Sr(n,a,l,f),a.child}var Mc={dehydrated:null,treeContext:null,retryLane:0};function Lc(n){return{baseLanes:n,cachePool:null,transitions:null}}function id(n,a,l){var f=a.pendingProps,h=Dt.current,v=!1,S=(a.flags&128)!==0,D;if((D=S)||(D=n!==null&&n.memoizedState===null?!1:(h&2)!==0),D?(v=!0,a.flags&=-129):(n===null||n.memoizedState!==null)&&(h|=1),At(Dt,h&1),n===null)return fc(a),n=a.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?((a.mode&1)===0?a.lanes=1:n.data==="$!"?a.lanes=8:a.lanes=1073741824,null):(S=f.children,n=f.fallback,v?(f=a.mode,v=a.child,S={mode:"hidden",children:S},(f&1)===0&&v!==null?(v.childLanes=0,v.pendingProps=S):v=Bl(S,f,0,null),n=La(n,f,l,null),v.return=a,n.return=a,v.sibling=n,a.child=v,a.child.memoizedState=Lc(l),a.memoizedState=Mc,n):Bc(a,S));if(h=n.memoizedState,h!==null&&(D=h.dehydrated,D!==null))return om(n,a,S,f,D,h,l);if(v){v=f.fallback,S=a.mode,h=n.child,D=h.sibling;var G={mode:"hidden",children:f.children};return(S&1)===0&&a.child!==h?(f=a.child,f.childLanes=0,f.pendingProps=G,a.deletions=null):(f=ha(h,G),f.subtreeFlags=h.subtreeFlags&14680064),D!==null?v=ha(D,v):(v=La(v,S,l,null),v.flags|=2),v.return=a,f.return=a,f.sibling=v,a.child=f,f=v,v=a.child,S=n.child.memoizedState,S=S===null?Lc(l):{baseLanes:S.baseLanes|l,cachePool:null,transitions:S.transitions},v.memoizedState=S,v.childLanes=n.childLanes&~l,a.memoizedState=Mc,f}return v=n.child,n=v.sibling,f=ha(v,{mode:"visible",children:f.children}),(a.mode&1)===0&&(f.lanes=l),f.return=a,f.sibling=null,n!==null&&(l=a.deletions,l===null?(a.deletions=[n],a.flags|=16):l.push(n)),a.child=f,a.memoizedState=null,f}function Bc(n,a){return a=Bl({mode:"visible",children:a},n.mode,0,null),a.return=n,n.child=a}function kl(n,a,l,f){return f!==null&&dc(f),fs(a,n.child,null,l),n=Bc(a,a.pendingProps.children),n.flags|=2,a.memoizedState=null,n}function om(n,a,l,f,h,v,S){if(l)return a.flags&256?(a.flags&=-257,f=Oc(Error(t(422))),kl(n,a,S,f)):a.memoizedState!==null?(a.child=n.child,a.flags|=128,null):(v=f.fallback,h=a.mode,f=Bl({mode:"visible",children:f.children},h,0,null),v=La(v,h,S,null),v.flags|=2,f.return=a,v.return=a,f.sibling=v,a.child=f,(a.mode&1)!==0&&fs(a,n.child,null,S),a.child.memoizedState=Lc(S),a.memoizedState=Mc,v);if((a.mode&1)===0)return kl(n,a,S,null);if(h.data==="$!"){if(f=h.nextSibling&&h.nextSibling.dataset,f)var D=f.dgst;return f=D,v=Error(t(419)),f=Oc(v,f,void 0),kl(n,a,S,f)}if(D=(S&n.childLanes)!==0,Fr||D){if(f=tr,f!==null){switch(S&-S){case 4:h=2;break;case 16:h=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:h=32;break;case 536870912:h=268435456;break;default:h=0}h=(h&(f.suspendedLanes|S))!==0?0:h,h!==0&&h!==v.retryLane&&(v.retryLane=h,Ln(n,h),fn(f,n,h,-1))}return tu(),f=Oc(Error(t(421))),kl(n,a,S,f)}return h.data==="$?"?(a.flags|=128,a.child=n.child,a=_m.bind(null,n),h._reactRetry=a,null):(n=v.treeContext,Br=ra(h.nextSibling),Lr=a,Rt=!0,ln=null,n!==null&&(Xr[Kr++]=In,Xr[Kr++]=Mn,Xr[Kr++]=ba,In=n.id,Mn=n.overflow,ba=a),a=Bc(a,f.children),a.flags|=4096,a)}function ld(n,a,l){n.lanes|=a;var f=n.alternate;f!==null&&(f.lanes|=a),mc(n.return,a,l)}function Uc(n,a,l,f,h){var v=n.memoizedState;v===null?n.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:f,tail:l,tailMode:h}:(v.isBackwards=a,v.rendering=null,v.renderingStartTime=0,v.last=f,v.tail=l,v.tailMode=h)}function od(n,a,l){var f=a.pendingProps,h=f.revealOrder,v=f.tail;if(Sr(n,a,f.children,l),f=Dt.current,(f&2)!==0)f=f&1|2,a.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=a.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&ld(n,l,a);else if(n.tag===19)ld(n,l,a);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===a)break e;for(;n.sibling===null;){if(n.return===null||n.return===a)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}f&=1}if(At(Dt,f),(a.mode&1)===0)a.memoizedState=null;else switch(h){case"forwards":for(l=a.child,h=null;l!==null;)n=l.alternate,n!==null&&yl(n)===null&&(h=l),l=l.sibling;l=h,l===null?(h=a.child,a.child=null):(h=l.sibling,l.sibling=null),Uc(a,!1,h,l,v);break;case"backwards":for(l=null,h=a.child,a.child=null;h!==null;){if(n=h.alternate,n!==null&&yl(n)===null){a.child=h;break}n=h.sibling,h.sibling=l,l=h,h=n}Uc(a,!0,l,null,v);break;case"together":Uc(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function Cl(n,a){(a.mode&1)===0&&n!==null&&(n.alternate=null,a.alternate=null,a.flags|=2)}function Un(n,a,l){if(n!==null&&(a.dependencies=n.dependencies),Ra|=a.lanes,(l&a.childLanes)===0)return null;if(n!==null&&a.child!==n.child)throw Error(t(153));if(a.child!==null){for(n=a.child,l=ha(n,n.pendingProps),a.child=l,l.return=a;n.sibling!==null;)n=n.sibling,l=l.sibling=ha(n,n.pendingProps),l.return=a;l.sibling=null}return a.child}function cm(n,a,l){switch(a.tag){case 3:ad(a),us();break;case 5:Ef(a);break;case 1:br(a.type)&&cl(a);break;case 4:yc(a,a.stateNode.containerInfo);break;case 10:var f=a.type._context,h=a.memoizedProps.value;At(xl,f._currentValue),f._currentValue=h;break;case 13:if(f=a.memoizedState,f!==null)return f.dehydrated!==null?(At(Dt,Dt.current&1),a.flags|=128,null):(l&a.child.childLanes)!==0?id(n,a,l):(At(Dt,Dt.current&1),n=Un(n,a,l),n!==null?n.sibling:null);At(Dt,Dt.current&1);break;case 19:if(f=(l&a.childLanes)!==0,(n.flags&128)!==0){if(f)return od(n,a,l);a.flags|=128}if(h=a.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),At(Dt,Dt.current),f)break;return null;case 22:case 23:return a.lanes=0,td(n,a,l)}return Un(n,a,l)}var cd,zc,ud,fd;cd=function(n,a){for(var l=a.child;l!==null;){if(l.tag===5||l.tag===6)n.appendChild(l.stateNode);else if(l.tag!==4&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return;l=l.return}l.sibling.return=l.return,l=l.sibling}},zc=function(){},ud=function(n,a,l,f){var h=n.memoizedProps;if(h!==f){n=a.stateNode,Pa(En.current);var v=null;switch(l){case"input":h=We(n,h),f=We(n,f),v=[];break;case"select":h=ye({},h,{value:void 0}),f=ye({},f,{value:void 0}),v=[];break;case"textarea":h=ct(n,h),f=ct(n,f),v=[];break;default:typeof h.onClick!="function"&&typeof f.onClick=="function"&&(n.onclick=il)}Je(l,f);var S;l=null;for(fe in h)if(!f.hasOwnProperty(fe)&&h.hasOwnProperty(fe)&&h[fe]!=null)if(fe==="style"){var D=h[fe];for(S in D)D.hasOwnProperty(S)&&(l||(l={}),l[S]="")}else fe!=="dangerouslySetInnerHTML"&&fe!=="children"&&fe!=="suppressContentEditableWarning"&&fe!=="suppressHydrationWarning"&&fe!=="autoFocus"&&(i.hasOwnProperty(fe)?v||(v=[]):(v=v||[]).push(fe,null));for(fe in f){var G=f[fe];if(D=h?.[fe],f.hasOwnProperty(fe)&&G!==D&&(G!=null||D!=null))if(fe==="style")if(D){for(S in D)!D.hasOwnProperty(S)||G&&G.hasOwnProperty(S)||(l||(l={}),l[S]="");for(S in G)G.hasOwnProperty(S)&&D[S]!==G[S]&&(l||(l={}),l[S]=G[S])}else l||(v||(v=[]),v.push(fe,l)),l=G;else fe==="dangerouslySetInnerHTML"?(G=G?G.__html:void 0,D=D?D.__html:void 0,G!=null&&D!==G&&(v=v||[]).push(fe,G)):fe==="children"?typeof G!="string"&&typeof G!="number"||(v=v||[]).push(fe,""+G):fe!=="suppressContentEditableWarning"&&fe!=="suppressHydrationWarning"&&(i.hasOwnProperty(fe)?(G!=null&&fe==="onScroll"&&Ft("scroll",n),v||D===G||(v=[])):(v=v||[]).push(fe,G))}l&&(v=v||[]).push("style",l);var fe=v;(a.updateQueue=fe)&&(a.flags|=4)}},fd=function(n,a,l,f){l!==f&&(a.flags|=4)};function di(n,a){if(!Rt)switch(n.tailMode){case"hidden":a=n.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?n.tail=null:l.sibling=null;break;case"collapsed":l=n.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?a||n.tail===null?n.tail=null:n.tail.sibling=null:f.sibling=null}}function vr(n){var a=n.alternate!==null&&n.alternate.child===n.child,l=0,f=0;if(a)for(var h=n.child;h!==null;)l|=h.lanes|h.childLanes,f|=h.subtreeFlags&14680064,f|=h.flags&14680064,h.return=n,h=h.sibling;else for(h=n.child;h!==null;)l|=h.lanes|h.childLanes,f|=h.subtreeFlags,f|=h.flags,h.return=n,h=h.sibling;return n.subtreeFlags|=f,n.childLanes=l,a}function um(n,a,l){var f=a.pendingProps;switch(cc(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return vr(a),null;case 1:return br(a.type)&&ol(),vr(a),null;case 3:return f=a.stateNode,ps(),jt(Ar),jt(xr),Ec(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(n===null||n.child===null)&&(hl(a)?a.flags|=4:n===null||n.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,ln!==null&&(Jc(ln),ln=null))),zc(n,a),vr(a),null;case 5:wc(a);var h=Pa(li.current);if(l=a.type,n!==null&&a.stateNode!=null)ud(n,a,l,f,h),n.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!f){if(a.stateNode===null)throw Error(t(166));return vr(a),null}if(n=Pa(En.current),hl(a)){f=a.stateNode,l=a.type;var v=a.memoizedProps;switch(f[_n]=a,f[ri]=v,n=(a.mode&1)!==0,l){case"dialog":Ft("cancel",f),Ft("close",f);break;case"iframe":case"object":case"embed":Ft("load",f);break;case"video":case"audio":for(h=0;h<Zs.length;h++)Ft(Zs[h],f);break;case"source":Ft("error",f);break;case"img":case"image":case"link":Ft("error",f),Ft("load",f);break;case"details":Ft("toggle",f);break;case"input":ot(f,v),Ft("invalid",f);break;case"select":f._wrapperState={wasMultiple:!!v.multiple},Ft("invalid",f);break;case"textarea":ut(f,v),Ft("invalid",f)}Je(l,v),h=null;for(var S in v)if(v.hasOwnProperty(S)){var D=v[S];S==="children"?typeof D=="string"?f.textContent!==D&&(v.suppressHydrationWarning!==!0&&sl(f.textContent,D,n),h=["children",D]):typeof D=="number"&&f.textContent!==""+D&&(v.suppressHydrationWarning!==!0&&sl(f.textContent,D,n),h=["children",""+D]):i.hasOwnProperty(S)&&D!=null&&S==="onScroll"&&Ft("scroll",f)}switch(l){case"input":Se(f),Ot(f,v,!0);break;case"textarea":Se(f),ft(f);break;case"select":case"option":break;default:typeof v.onClick=="function"&&(f.onclick=il)}f=h,a.updateQueue=f,f!==null&&(a.flags|=4)}else{S=h.nodeType===9?h:h.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=rn(l)),n==="http://www.w3.org/1999/xhtml"?l==="script"?(n=S.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof f.is=="string"?n=S.createElement(l,{is:f.is}):(n=S.createElement(l),l==="select"&&(S=n,f.multiple?S.multiple=!0:f.size&&(S.size=f.size))):n=S.createElementNS(n,l),n[_n]=a,n[ri]=f,cd(n,a,!1,!1),a.stateNode=n;e:{switch(S=$t(l,f),l){case"dialog":Ft("cancel",n),Ft("close",n),h=f;break;case"iframe":case"object":case"embed":Ft("load",n),h=f;break;case"video":case"audio":for(h=0;h<Zs.length;h++)Ft(Zs[h],n);h=f;break;case"source":Ft("error",n),h=f;break;case"img":case"image":case"link":Ft("error",n),Ft("load",n),h=f;break;case"details":Ft("toggle",n),h=f;break;case"input":ot(n,f),h=We(n,f),Ft("invalid",n);break;case"option":h=f;break;case"select":n._wrapperState={wasMultiple:!!f.multiple},h=ye({},f,{value:void 0}),Ft("invalid",n);break;case"textarea":ut(n,f),h=ct(n,f),Ft("invalid",n);break;default:h=f}Je(l,h),D=h;for(v in D)if(D.hasOwnProperty(v)){var G=D[v];v==="style"?Ge(n,G):v==="dangerouslySetInnerHTML"?(G=G?G.__html:void 0,G!=null&&Ea(n,G)):v==="children"?typeof G=="string"?(l!=="textarea"||G!=="")&&Gr(n,G):typeof G=="number"&&Gr(n,""+G):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(i.hasOwnProperty(v)?G!=null&&v==="onScroll"&&Ft("scroll",n):G!=null&&O(n,v,G,S))}switch(l){case"input":Se(n),Ot(n,f,!1);break;case"textarea":Se(n),ft(n);break;case"option":f.value!=null&&n.setAttribute("value",""+Te(f.value));break;case"select":n.multiple=!!f.multiple,v=f.value,v!=null?Ke(n,!!f.multiple,v,!1):f.defaultValue!=null&&Ke(n,!!f.multiple,f.defaultValue,!0);break;default:typeof h.onClick=="function"&&(n.onclick=il)}switch(l){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}}f&&(a.flags|=4)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return vr(a),null;case 6:if(n&&a.stateNode!=null)fd(n,a,n.memoizedProps,f);else{if(typeof f!="string"&&a.stateNode===null)throw Error(t(166));if(l=Pa(li.current),Pa(En.current),hl(a)){if(f=a.stateNode,l=a.memoizedProps,f[_n]=a,(v=f.nodeValue!==l)&&(n=Lr,n!==null))switch(n.tag){case 3:sl(f.nodeValue,l,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&sl(f.nodeValue,l,(n.mode&1)!==0)}v&&(a.flags|=4)}else f=(l.nodeType===9?l:l.ownerDocument).createTextNode(f),f[_n]=a,a.stateNode=f}return vr(a),null;case 13:if(jt(Dt),f=a.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Rt&&Br!==null&&(a.mode&1)!==0&&(a.flags&128)===0)pf(),us(),a.flags|=98560,v=!1;else if(v=hl(a),f!==null&&f.dehydrated!==null){if(n===null){if(!v)throw Error(t(318));if(v=a.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(t(317));v[_n]=a}else us(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;vr(a),v=!1}else ln!==null&&(Jc(ln),ln=null),v=!0;if(!v)return a.flags&65536?a:null}return(a.flags&128)!==0?(a.lanes=l,a):(f=f!==null,f!==(n!==null&&n.memoizedState!==null)&&f&&(a.child.flags|=8192,(a.mode&1)!==0&&(n===null||(Dt.current&1)!==0?qt===0&&(qt=3):tu())),a.updateQueue!==null&&(a.flags|=4),vr(a),null);case 4:return ps(),zc(n,a),n===null&&ei(a.stateNode.containerInfo),vr(a),null;case 10:return xc(a.type._context),vr(a),null;case 17:return br(a.type)&&ol(),vr(a),null;case 19:if(jt(Dt),v=a.memoizedState,v===null)return vr(a),null;if(f=(a.flags&128)!==0,S=v.rendering,S===null)if(f)di(v,!1);else{if(qt!==0||n!==null&&(n.flags&128)!==0)for(n=a.child;n!==null;){if(S=yl(n),S!==null){for(a.flags|=128,di(v,!1),f=S.updateQueue,f!==null&&(a.updateQueue=f,a.flags|=4),a.subtreeFlags=0,f=l,l=a.child;l!==null;)v=l,n=f,v.flags&=14680066,S=v.alternate,S===null?(v.childLanes=0,v.lanes=n,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=S.childLanes,v.lanes=S.lanes,v.child=S.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=S.memoizedProps,v.memoizedState=S.memoizedState,v.updateQueue=S.updateQueue,v.type=S.type,n=S.dependencies,v.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),l=l.sibling;return At(Dt,Dt.current&1|2),a.child}n=n.sibling}v.tail!==null&&Ce()>gs&&(a.flags|=128,f=!0,di(v,!1),a.lanes=4194304)}else{if(!f)if(n=yl(S),n!==null){if(a.flags|=128,f=!0,l=n.updateQueue,l!==null&&(a.updateQueue=l,a.flags|=4),di(v,!0),v.tail===null&&v.tailMode==="hidden"&&!S.alternate&&!Rt)return vr(a),null}else 2*Ce()-v.renderingStartTime>gs&&l!==1073741824&&(a.flags|=128,f=!0,di(v,!1),a.lanes=4194304);v.isBackwards?(S.sibling=a.child,a.child=S):(l=v.last,l!==null?l.sibling=S:a.child=S,v.last=S)}return v.tail!==null?(a=v.tail,v.rendering=a,v.tail=a.sibling,v.renderingStartTime=Ce(),a.sibling=null,l=Dt.current,At(Dt,f?l&1|2:l&1),a):(vr(a),null);case 22:case 23:return eu(),f=a.memoizedState!==null,n!==null&&n.memoizedState!==null!==f&&(a.flags|=8192),f&&(a.mode&1)!==0?(Ur&1073741824)!==0&&(vr(a),a.subtreeFlags&6&&(a.flags|=8192)):vr(a),null;case 24:return null;case 25:return null}throw Error(t(156,a.tag))}function fm(n,a){switch(cc(a),a.tag){case 1:return br(a.type)&&ol(),n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 3:return ps(),jt(Ar),jt(xr),Ec(),n=a.flags,(n&65536)!==0&&(n&128)===0?(a.flags=n&-65537|128,a):null;case 5:return wc(a),null;case 13:if(jt(Dt),n=a.memoizedState,n!==null&&n.dehydrated!==null){if(a.alternate===null)throw Error(t(340));us()}return n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 19:return jt(Dt),null;case 4:return ps(),null;case 10:return xc(a.type._context),null;case 22:case 23:return eu(),null;case 24:return null;default:return null}}var Al=!1,gr=!1,dm=typeof WeakSet=="function"?WeakSet:Set,Be=null;function ms(n,a){var l=n.ref;if(l!==null)if(typeof l=="function")try{l(null)}catch(f){Mt(n,a,f)}else l.current=null}function Wc(n,a,l){try{l()}catch(f){Mt(n,a,f)}}var dd=!1;function hm(n,a){if(ec=Ki,n=$0(),Go(n)){if("selectionStart"in n)var l={start:n.selectionStart,end:n.selectionEnd};else e:{l=(l=n.ownerDocument)&&l.defaultView||window;var f=l.getSelection&&l.getSelection();if(f&&f.rangeCount!==0){l=f.anchorNode;var h=f.anchorOffset,v=f.focusNode;f=f.focusOffset;try{l.nodeType,v.nodeType}catch{l=null;break e}var S=0,D=-1,G=-1,fe=0,_e=0,ke=n,we=null;t:for(;;){for(var Me;ke!==l||h!==0&&ke.nodeType!==3||(D=S+h),ke!==v||f!==0&&ke.nodeType!==3||(G=S+f),ke.nodeType===3&&(S+=ke.nodeValue.length),(Me=ke.firstChild)!==null;)we=ke,ke=Me;for(;;){if(ke===n)break t;if(we===l&&++fe===h&&(D=S),we===v&&++_e===f&&(G=S),(Me=ke.nextSibling)!==null)break;ke=we,we=ke.parentNode}ke=Me}l=D===-1||G===-1?null:{start:D,end:G}}else l=null}l=l||{start:0,end:0}}else l=null;for(tc={focusedElem:n,selectionRange:l},Ki=!1,Be=a;Be!==null;)if(a=Be,n=a.child,(a.subtreeFlags&1028)!==0&&n!==null)n.return=a,Be=n;else for(;Be!==null;){a=Be;try{var ze=a.alternate;if((a.flags&1024)!==0)switch(a.tag){case 0:case 11:case 15:break;case 1:if(ze!==null){var $e=ze.memoizedProps,Wt=ze.memoizedState,ae=a.stateNode,Q=ae.getSnapshotBeforeUpdate(a.elementType===a.type?$e:on(a.type,$e),Wt);ae.__reactInternalSnapshotBeforeUpdate=Q}break;case 3:var se=a.stateNode.containerInfo;se.nodeType===1?se.textContent="":se.nodeType===9&&se.documentElement&&se.removeChild(se.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(be){Mt(a,a.return,be)}if(n=a.sibling,n!==null){n.return=a.return,Be=n;break}Be=a.return}return ze=dd,dd=!1,ze}function hi(n,a,l){var f=a.updateQueue;if(f=f!==null?f.lastEffect:null,f!==null){var h=f=f.next;do{if((h.tag&n)===n){var v=h.destroy;h.destroy=void 0,v!==void 0&&Wc(a,l,v)}h=h.next}while(h!==f)}}function bl(n,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var l=a=a.next;do{if((l.tag&n)===n){var f=l.create;l.destroy=f()}l=l.next}while(l!==a)}}function $c(n){var a=n.ref;if(a!==null){var l=n.stateNode;n.tag,n=l,typeof a=="function"?a(n):a.current=n}}function hd(n){var a=n.alternate;a!==null&&(n.alternate=null,hd(a)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(a=n.stateNode,a!==null&&(delete a[_n],delete a[ri],delete a[sc],delete a[Y1],delete a[q1])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function pd(n){return n.tag===5||n.tag===3||n.tag===4}function xd(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||pd(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Hc(n,a,l){var f=n.tag;if(f===5||f===6)n=n.stateNode,a?l.nodeType===8?l.parentNode.insertBefore(n,a):l.insertBefore(n,a):(l.nodeType===8?(a=l.parentNode,a.insertBefore(n,l)):(a=l,a.appendChild(n)),l=l._reactRootContainer,l!=null||a.onclick!==null||(a.onclick=il));else if(f!==4&&(n=n.child,n!==null))for(Hc(n,a,l),n=n.sibling;n!==null;)Hc(n,a,l),n=n.sibling}function Vc(n,a,l){var f=n.tag;if(f===5||f===6)n=n.stateNode,a?l.insertBefore(n,a):l.appendChild(n);else if(f!==4&&(n=n.child,n!==null))for(Vc(n,a,l),n=n.sibling;n!==null;)Vc(n,a,l),n=n.sibling}var lr=null,cn=!1;function oa(n,a,l){for(l=l.child;l!==null;)md(n,a,l),l=l.sibling}function md(n,a,l){if(Zt&&typeof Zt.onCommitFiberUnmount=="function")try{Zt.onCommitFiberUnmount(wn,l)}catch{}switch(l.tag){case 5:gr||ms(l,a);case 6:var f=lr,h=cn;lr=null,oa(n,a,l),lr=f,cn=h,lr!==null&&(cn?(n=lr,l=l.stateNode,n.nodeType===8?n.parentNode.removeChild(l):n.removeChild(l)):lr.removeChild(l.stateNode));break;case 18:lr!==null&&(cn?(n=lr,l=l.stateNode,n.nodeType===8?ac(n.parentNode,l):n.nodeType===1&&ac(n,l),Vs(n)):ac(lr,l.stateNode));break;case 4:f=lr,h=cn,lr=l.stateNode.containerInfo,cn=!0,oa(n,a,l),lr=f,cn=h;break;case 0:case 11:case 14:case 15:if(!gr&&(f=l.updateQueue,f!==null&&(f=f.lastEffect,f!==null))){h=f=f.next;do{var v=h,S=v.destroy;v=v.tag,S!==void 0&&((v&2)!==0||(v&4)!==0)&&Wc(l,a,S),h=h.next}while(h!==f)}oa(n,a,l);break;case 1:if(!gr&&(ms(l,a),f=l.stateNode,typeof f.componentWillUnmount=="function"))try{f.props=l.memoizedProps,f.state=l.memoizedState,f.componentWillUnmount()}catch(D){Mt(l,a,D)}oa(n,a,l);break;case 21:oa(n,a,l);break;case 22:l.mode&1?(gr=(f=gr)||l.memoizedState!==null,oa(n,a,l),gr=f):oa(n,a,l);break;default:oa(n,a,l)}}function vd(n){var a=n.updateQueue;if(a!==null){n.updateQueue=null;var l=n.stateNode;l===null&&(l=n.stateNode=new dm),a.forEach(function(f){var h=Em.bind(null,n,f);l.has(f)||(l.add(f),f.then(h,h))})}}function un(n,a){var l=a.deletions;if(l!==null)for(var f=0;f<l.length;f++){var h=l[f];try{var v=n,S=a,D=S;e:for(;D!==null;){switch(D.tag){case 5:lr=D.stateNode,cn=!1;break e;case 3:lr=D.stateNode.containerInfo,cn=!0;break e;case 4:lr=D.stateNode.containerInfo,cn=!0;break e}D=D.return}if(lr===null)throw Error(t(160));md(v,S,h),lr=null,cn=!1;var G=h.alternate;G!==null&&(G.return=null),h.return=null}catch(fe){Mt(h,a,fe)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)gd(a,n),a=a.sibling}function gd(n,a){var l=n.alternate,f=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(un(a,n),Tn(n),f&4){try{hi(3,n,n.return),bl(3,n)}catch($e){Mt(n,n.return,$e)}try{hi(5,n,n.return)}catch($e){Mt(n,n.return,$e)}}break;case 1:un(a,n),Tn(n),f&512&&l!==null&&ms(l,l.return);break;case 5:if(un(a,n),Tn(n),f&512&&l!==null&&ms(l,l.return),n.flags&32){var h=n.stateNode;try{Gr(h,"")}catch($e){Mt(n,n.return,$e)}}if(f&4&&(h=n.stateNode,h!=null)){var v=n.memoizedProps,S=l!==null?l.memoizedProps:v,D=n.type,G=n.updateQueue;if(n.updateQueue=null,G!==null)try{D==="input"&&v.type==="radio"&&v.name!=null&&rt(h,v),$t(D,S);var fe=$t(D,v);for(S=0;S<G.length;S+=2){var _e=G[S],ke=G[S+1];_e==="style"?Ge(h,ke):_e==="dangerouslySetInnerHTML"?Ea(h,ke):_e==="children"?Gr(h,ke):O(h,_e,ke,fe)}switch(D){case"input":Oe(h,v);break;case"textarea":it(h,v);break;case"select":var we=h._wrapperState.wasMultiple;h._wrapperState.wasMultiple=!!v.multiple;var Me=v.value;Me!=null?Ke(h,!!v.multiple,Me,!1):we!==!!v.multiple&&(v.defaultValue!=null?Ke(h,!!v.multiple,v.defaultValue,!0):Ke(h,!!v.multiple,v.multiple?[]:"",!1))}h[ri]=v}catch($e){Mt(n,n.return,$e)}}break;case 6:if(un(a,n),Tn(n),f&4){if(n.stateNode===null)throw Error(t(162));h=n.stateNode,v=n.memoizedProps;try{h.nodeValue=v}catch($e){Mt(n,n.return,$e)}}break;case 3:if(un(a,n),Tn(n),f&4&&l!==null&&l.memoizedState.isDehydrated)try{Vs(a.containerInfo)}catch($e){Mt(n,n.return,$e)}break;case 4:un(a,n),Tn(n);break;case 13:un(a,n),Tn(n),h=n.child,h.flags&8192&&(v=h.memoizedState!==null,h.stateNode.isHidden=v,!v||h.alternate!==null&&h.alternate.memoizedState!==null||(Kc=Ce())),f&4&&vd(n);break;case 22:if(_e=l!==null&&l.memoizedState!==null,n.mode&1?(gr=(fe=gr)||_e,un(a,n),gr=fe):un(a,n),Tn(n),f&8192){if(fe=n.memoizedState!==null,(n.stateNode.isHidden=fe)&&!_e&&(n.mode&1)!==0)for(Be=n,_e=n.child;_e!==null;){for(ke=Be=_e;Be!==null;){switch(we=Be,Me=we.child,we.tag){case 0:case 11:case 14:case 15:hi(4,we,we.return);break;case 1:ms(we,we.return);var ze=we.stateNode;if(typeof ze.componentWillUnmount=="function"){f=we,l=we.return;try{a=f,ze.props=a.memoizedProps,ze.state=a.memoizedState,ze.componentWillUnmount()}catch($e){Mt(f,l,$e)}}break;case 5:ms(we,we.return);break;case 22:if(we.memoizedState!==null){_d(ke);continue}}Me!==null?(Me.return=we,Be=Me):_d(ke)}_e=_e.sibling}e:for(_e=null,ke=n;;){if(ke.tag===5){if(_e===null){_e=ke;try{h=ke.stateNode,fe?(v=h.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none"):(D=ke.stateNode,G=ke.memoizedProps.style,S=G!=null&&G.hasOwnProperty("display")?G.display:null,D.style.display=Ye("display",S))}catch($e){Mt(n,n.return,$e)}}}else if(ke.tag===6){if(_e===null)try{ke.stateNode.nodeValue=fe?"":ke.memoizedProps}catch($e){Mt(n,n.return,$e)}}else if((ke.tag!==22&&ke.tag!==23||ke.memoizedState===null||ke===n)&&ke.child!==null){ke.child.return=ke,ke=ke.child;continue}if(ke===n)break e;for(;ke.sibling===null;){if(ke.return===null||ke.return===n)break e;_e===ke&&(_e=null),ke=ke.return}_e===ke&&(_e=null),ke.sibling.return=ke.return,ke=ke.sibling}}break;case 19:un(a,n),Tn(n),f&4&&vd(n);break;case 21:break;default:un(a,n),Tn(n)}}function Tn(n){var a=n.flags;if(a&2){try{e:{for(var l=n.return;l!==null;){if(pd(l)){var f=l;break e}l=l.return}throw Error(t(160))}switch(f.tag){case 5:var h=f.stateNode;f.flags&32&&(Gr(h,""),f.flags&=-33);var v=xd(n);Vc(n,v,h);break;case 3:case 4:var S=f.stateNode.containerInfo,D=xd(n);Hc(n,D,S);break;default:throw Error(t(161))}}catch(G){Mt(n,n.return,G)}n.flags&=-3}a&4096&&(n.flags&=-4097)}function pm(n,a,l){Be=n,yd(n)}function yd(n,a,l){for(var f=(n.mode&1)!==0;Be!==null;){var h=Be,v=h.child;if(h.tag===22&&f){var S=h.memoizedState!==null||Al;if(!S){var D=h.alternate,G=D!==null&&D.memoizedState!==null||gr;D=Al;var fe=gr;if(Al=S,(gr=G)&&!fe)for(Be=h;Be!==null;)S=Be,G=S.child,S.tag===22&&S.memoizedState!==null?Ed(h):G!==null?(G.return=S,Be=G):Ed(h);for(;v!==null;)Be=v,yd(v),v=v.sibling;Be=h,Al=D,gr=fe}wd(n)}else(h.subtreeFlags&8772)!==0&&v!==null?(v.return=h,Be=v):wd(n)}}function wd(n){for(;Be!==null;){var a=Be;if((a.flags&8772)!==0){var l=a.alternate;try{if((a.flags&8772)!==0)switch(a.tag){case 0:case 11:case 15:gr||bl(5,a);break;case 1:var f=a.stateNode;if(a.flags&4&&!gr)if(l===null)f.componentDidMount();else{var h=a.elementType===a.type?l.memoizedProps:on(a.type,l.memoizedProps);f.componentDidUpdate(h,l.memoizedState,f.__reactInternalSnapshotBeforeUpdate)}var v=a.updateQueue;v!==null&&_f(a,v,f);break;case 3:var S=a.updateQueue;if(S!==null){if(l=null,a.child!==null)switch(a.child.tag){case 5:l=a.child.stateNode;break;case 1:l=a.child.stateNode}_f(a,S,l)}break;case 5:var D=a.stateNode;if(l===null&&a.flags&4){l=D;var G=a.memoizedProps;switch(a.type){case"button":case"input":case"select":case"textarea":G.autoFocus&&l.focus();break;case"img":G.src&&(l.src=G.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(a.memoizedState===null){var fe=a.alternate;if(fe!==null){var _e=fe.memoizedState;if(_e!==null){var ke=_e.dehydrated;ke!==null&&Vs(ke)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}gr||a.flags&512&&$c(a)}catch(we){Mt(a,a.return,we)}}if(a===n){Be=null;break}if(l=a.sibling,l!==null){l.return=a.return,Be=l;break}Be=a.return}}function _d(n){for(;Be!==null;){var a=Be;if(a===n){Be=null;break}var l=a.sibling;if(l!==null){l.return=a.return,Be=l;break}Be=a.return}}function Ed(n){for(;Be!==null;){var a=Be;try{switch(a.tag){case 0:case 11:case 15:var l=a.return;try{bl(4,a)}catch(G){Mt(a,l,G)}break;case 1:var f=a.stateNode;if(typeof f.componentDidMount=="function"){var h=a.return;try{f.componentDidMount()}catch(G){Mt(a,h,G)}}var v=a.return;try{$c(a)}catch(G){Mt(a,v,G)}break;case 5:var S=a.return;try{$c(a)}catch(G){Mt(a,S,G)}}}catch(G){Mt(a,a.return,G)}if(a===n){Be=null;break}var D=a.sibling;if(D!==null){D.return=a.return,Be=D;break}Be=a.return}}var xm=Math.ceil,Fl=J.ReactCurrentDispatcher,Gc=J.ReactCurrentOwner,Qr=J.ReactCurrentBatchConfig,ht=0,tr=null,Vt=null,or=0,Ur=0,vs=na(0),qt=0,pi=null,Ra=0,jl=0,Xc=0,xi=null,jr=null,Kc=0,gs=1/0,zn=null,Pl=!1,Yc=null,ca=null,Ol=!1,ua=null,Rl=0,mi=0,qc=null,Dl=-1,Il=0;function Tr(){return(ht&6)!==0?Ce():Dl!==-1?Dl:Dl=Ce()}function fa(n){return(n.mode&1)===0?1:(ht&2)!==0&&or!==0?or&-or:J1.transition!==null?(Il===0&&(Il=p0()),Il):(n=wt,n!==0||(n=window.event,n=n===void 0?16:S0(n.type)),n)}function fn(n,a,l,f){if(50<mi)throw mi=0,qc=null,Error(t(185));Us(n,l,f),((ht&2)===0||n!==tr)&&(n===tr&&((ht&2)===0&&(jl|=l),qt===4&&da(n,or)),Pr(n,f),l===1&&ht===0&&(a.mode&1)===0&&(gs=Ce()+500,ul&&sa()))}function Pr(n,a){var l=n.callbackNode;Jx(n,a);var f=Vi(n,n===tr?or:0);if(f===0)l!==null&&Re(l),n.callbackNode=null,n.callbackPriority=0;else if(a=f&-f,n.callbackPriority!==a){if(l!=null&&Re(l),a===1)n.tag===0?Q1(Td.bind(null,n)):cf(Td.bind(null,n)),X1(function(){(ht&6)===0&&sa()}),l=null;else{switch(x0(f)){case 1:l=kt;break;case 4:l=Ct;break;case 16:l=Ut;break;case 536870912:l=Yn;break;default:l=Ut}l=Pd(l,Sd.bind(null,n))}n.callbackPriority=a,n.callbackNode=l}}function Sd(n,a){if(Dl=-1,Il=0,(ht&6)!==0)throw Error(t(327));var l=n.callbackNode;if(ys()&&n.callbackNode!==l)return null;var f=Vi(n,n===tr?or:0);if(f===0)return null;if((f&30)!==0||(f&n.expiredLanes)!==0||a)a=Ml(n,f);else{a=f;var h=ht;ht|=2;var v=kd();(tr!==n||or!==a)&&(zn=null,gs=Ce()+500,Ia(n,a));do try{gm();break}catch(D){Nd(n,D)}while(!0);pc(),Fl.current=v,ht=h,Vt!==null?a=0:(tr=null,or=0,a=qt)}if(a!==0){if(a===2&&(h=Fo(n),h!==0&&(f=h,a=Qc(n,h))),a===1)throw l=pi,Ia(n,0),da(n,f),Pr(n,Ce()),l;if(a===6)da(n,f);else{if(h=n.current.alternate,(f&30)===0&&!mm(h)&&(a=Ml(n,f),a===2&&(v=Fo(n),v!==0&&(f=v,a=Qc(n,v))),a===1))throw l=pi,Ia(n,0),da(n,f),Pr(n,Ce()),l;switch(n.finishedWork=h,n.finishedLanes=f,a){case 0:case 1:throw Error(t(345));case 2:Ma(n,jr,zn);break;case 3:if(da(n,f),(f&130023424)===f&&(a=Kc+500-Ce(),10<a)){if(Vi(n,0)!==0)break;if(h=n.suspendedLanes,(h&f)!==f){Tr(),n.pingedLanes|=n.suspendedLanes&h;break}n.timeoutHandle=nc(Ma.bind(null,n,jr,zn),a);break}Ma(n,jr,zn);break;case 4:if(da(n,f),(f&4194240)===f)break;for(a=n.eventTimes,h=-1;0<f;){var S=31-zt(f);v=1<<S,S=a[S],S>h&&(h=S),f&=~v}if(f=h,f=Ce()-f,f=(120>f?120:480>f?480:1080>f?1080:1920>f?1920:3e3>f?3e3:4320>f?4320:1960*xm(f/1960))-f,10<f){n.timeoutHandle=nc(Ma.bind(null,n,jr,zn),f);break}Ma(n,jr,zn);break;case 5:Ma(n,jr,zn);break;default:throw Error(t(329))}}}return Pr(n,Ce()),n.callbackNode===l?Sd.bind(null,n):null}function Qc(n,a){var l=xi;return n.current.memoizedState.isDehydrated&&(Ia(n,a).flags|=256),n=Ml(n,a),n!==2&&(a=jr,jr=l,a!==null&&Jc(a)),n}function Jc(n){jr===null?jr=n:jr.push.apply(jr,n)}function mm(n){for(var a=n;;){if(a.flags&16384){var l=a.updateQueue;if(l!==null&&(l=l.stores,l!==null))for(var f=0;f<l.length;f++){var h=l[f],v=h.getSnapshot;h=h.value;try{if(!sn(v(),h))return!1}catch{return!1}}}if(l=a.child,a.subtreeFlags&16384&&l!==null)l.return=a,a=l;else{if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function da(n,a){for(a&=~Xc,a&=~jl,n.suspendedLanes|=a,n.pingedLanes&=~a,n=n.expirationTimes;0<a;){var l=31-zt(a),f=1<<l;n[l]=-1,a&=~f}}function Td(n){if((ht&6)!==0)throw Error(t(327));ys();var a=Vi(n,0);if((a&1)===0)return Pr(n,Ce()),null;var l=Ml(n,a);if(n.tag!==0&&l===2){var f=Fo(n);f!==0&&(a=f,l=Qc(n,f))}if(l===1)throw l=pi,Ia(n,0),da(n,a),Pr(n,Ce()),l;if(l===6)throw Error(t(345));return n.finishedWork=n.current.alternate,n.finishedLanes=a,Ma(n,jr,zn),Pr(n,Ce()),null}function Zc(n,a){var l=ht;ht|=1;try{return n(a)}finally{ht=l,ht===0&&(gs=Ce()+500,ul&&sa())}}function Da(n){ua!==null&&ua.tag===0&&(ht&6)===0&&ys();var a=ht;ht|=1;var l=Qr.transition,f=wt;try{if(Qr.transition=null,wt=1,n)return n()}finally{wt=f,Qr.transition=l,ht=a,(ht&6)===0&&sa()}}function eu(){Ur=vs.current,jt(vs)}function Ia(n,a){n.finishedWork=null,n.finishedLanes=0;var l=n.timeoutHandle;if(l!==-1&&(n.timeoutHandle=-1,G1(l)),Vt!==null)for(l=Vt.return;l!==null;){var f=l;switch(cc(f),f.tag){case 1:f=f.type.childContextTypes,f!=null&&ol();break;case 3:ps(),jt(Ar),jt(xr),Ec();break;case 5:wc(f);break;case 4:ps();break;case 13:jt(Dt);break;case 19:jt(Dt);break;case 10:xc(f.type._context);break;case 22:case 23:eu()}l=l.return}if(tr=n,Vt=n=ha(n.current,null),or=Ur=a,qt=0,pi=null,Xc=jl=Ra=0,jr=xi=null,ja!==null){for(a=0;a<ja.length;a++)if(l=ja[a],f=l.interleaved,f!==null){l.interleaved=null;var h=f.next,v=l.pending;if(v!==null){var S=v.next;v.next=h,f.next=S}l.pending=f}ja=null}return n}function Nd(n,a){do{var l=Vt;try{if(pc(),wl.current=Tl,_l){for(var f=It.memoizedState;f!==null;){var h=f.queue;h!==null&&(h.pending=null),f=f.next}_l=!1}if(Oa=0,er=Yt=It=null,oi=!1,ci=0,Gc.current=null,l===null||l.return===null){qt=1,pi=a,Vt=null;break}e:{var v=n,S=l.return,D=l,G=a;if(a=or,D.flags|=32768,G!==null&&typeof G=="object"&&typeof G.then=="function"){var fe=G,_e=D,ke=_e.tag;if((_e.mode&1)===0&&(ke===0||ke===11||ke===15)){var we=_e.alternate;we?(_e.updateQueue=we.updateQueue,_e.memoizedState=we.memoizedState,_e.lanes=we.lanes):(_e.updateQueue=null,_e.memoizedState=null)}var Me=qf(S);if(Me!==null){Me.flags&=-257,Qf(Me,S,D,v,a),Me.mode&1&&Yf(v,fe,a),a=Me,G=fe;var ze=a.updateQueue;if(ze===null){var $e=new Set;$e.add(G),a.updateQueue=$e}else ze.add(G);break e}else{if((a&1)===0){Yf(v,fe,a),tu();break e}G=Error(t(426))}}else if(Rt&&D.mode&1){var Wt=qf(S);if(Wt!==null){(Wt.flags&65536)===0&&(Wt.flags|=256),Qf(Wt,S,D,v,a),dc(xs(G,D));break e}}v=G=xs(G,D),qt!==4&&(qt=2),xi===null?xi=[v]:xi.push(v),v=S;do{switch(v.tag){case 3:v.flags|=65536,a&=-a,v.lanes|=a;var ae=Xf(v,G,a);wf(v,ae);break e;case 1:D=G;var Q=v.type,se=v.stateNode;if((v.flags&128)===0&&(typeof Q.getDerivedStateFromError=="function"||se!==null&&typeof se.componentDidCatch=="function"&&(ca===null||!ca.has(se)))){v.flags|=65536,a&=-a,v.lanes|=a;var be=Kf(v,D,a);wf(v,be);break e}}v=v.return}while(v!==null)}Ad(l)}catch(Ve){a=Ve,Vt===l&&l!==null&&(Vt=l=l.return);continue}break}while(!0)}function kd(){var n=Fl.current;return Fl.current=Tl,n===null?Tl:n}function tu(){(qt===0||qt===3||qt===2)&&(qt=4),tr===null||(Ra&268435455)===0&&(jl&268435455)===0||da(tr,or)}function Ml(n,a){var l=ht;ht|=2;var f=kd();(tr!==n||or!==a)&&(zn=null,Ia(n,a));do try{vm();break}catch(h){Nd(n,h)}while(!0);if(pc(),ht=l,Fl.current=f,Vt!==null)throw Error(t(261));return tr=null,or=0,qt}function vm(){for(;Vt!==null;)Cd(Vt)}function gm(){for(;Vt!==null&&!Le();)Cd(Vt)}function Cd(n){var a=jd(n.alternate,n,Ur);n.memoizedProps=n.pendingProps,a===null?Ad(n):Vt=a,Gc.current=null}function Ad(n){var a=n;do{var l=a.alternate;if(n=a.return,(a.flags&32768)===0){if(l=um(l,a,Ur),l!==null){Vt=l;return}}else{if(l=fm(l,a),l!==null){l.flags&=32767,Vt=l;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{qt=6,Vt=null;return}}if(a=a.sibling,a!==null){Vt=a;return}Vt=a=n}while(a!==null);qt===0&&(qt=5)}function Ma(n,a,l){var f=wt,h=Qr.transition;try{Qr.transition=null,wt=1,ym(n,a,l,f)}finally{Qr.transition=h,wt=f}return null}function ym(n,a,l,f){do ys();while(ua!==null);if((ht&6)!==0)throw Error(t(327));l=n.finishedWork;var h=n.finishedLanes;if(l===null)return null;if(n.finishedWork=null,n.finishedLanes=0,l===n.current)throw Error(t(177));n.callbackNode=null,n.callbackPriority=0;var v=l.lanes|l.childLanes;if(Zx(n,v),n===tr&&(Vt=tr=null,or=0),(l.subtreeFlags&2064)===0&&(l.flags&2064)===0||Ol||(Ol=!0,Pd(Ut,function(){return ys(),null})),v=(l.flags&15990)!==0,(l.subtreeFlags&15990)!==0||v){v=Qr.transition,Qr.transition=null;var S=wt;wt=1;var D=ht;ht|=4,Gc.current=null,hm(n,l),gd(l,n),B1(tc),Ki=!!ec,tc=ec=null,n.current=l,pm(l),Ae(),ht=D,wt=S,Qr.transition=v}else n.current=l;if(Ol&&(Ol=!1,ua=n,Rl=h),v=n.pendingLanes,v===0&&(ca=null),Ls(l.stateNode),Pr(n,Ce()),a!==null)for(f=n.onRecoverableError,l=0;l<a.length;l++)h=a[l],f(h.value,{componentStack:h.stack,digest:h.digest});if(Pl)throw Pl=!1,n=Yc,Yc=null,n;return(Rl&1)!==0&&n.tag!==0&&ys(),v=n.pendingLanes,(v&1)!==0?n===qc?mi++:(mi=0,qc=n):mi=0,sa(),null}function ys(){if(ua!==null){var n=x0(Rl),a=Qr.transition,l=wt;try{if(Qr.transition=null,wt=16>n?16:n,ua===null)var f=!1;else{if(n=ua,ua=null,Rl=0,(ht&6)!==0)throw Error(t(331));var h=ht;for(ht|=4,Be=n.current;Be!==null;){var v=Be,S=v.child;if((Be.flags&16)!==0){var D=v.deletions;if(D!==null){for(var G=0;G<D.length;G++){var fe=D[G];for(Be=fe;Be!==null;){var _e=Be;switch(_e.tag){case 0:case 11:case 15:hi(8,_e,v)}var ke=_e.child;if(ke!==null)ke.return=_e,Be=ke;else for(;Be!==null;){_e=Be;var we=_e.sibling,Me=_e.return;if(hd(_e),_e===fe){Be=null;break}if(we!==null){we.return=Me,Be=we;break}Be=Me}}}var ze=v.alternate;if(ze!==null){var $e=ze.child;if($e!==null){ze.child=null;do{var Wt=$e.sibling;$e.sibling=null,$e=Wt}while($e!==null)}}Be=v}}if((v.subtreeFlags&2064)!==0&&S!==null)S.return=v,Be=S;else e:for(;Be!==null;){if(v=Be,(v.flags&2048)!==0)switch(v.tag){case 0:case 11:case 15:hi(9,v,v.return)}var ae=v.sibling;if(ae!==null){ae.return=v.return,Be=ae;break e}Be=v.return}}var Q=n.current;for(Be=Q;Be!==null;){S=Be;var se=S.child;if((S.subtreeFlags&2064)!==0&&se!==null)se.return=S,Be=se;else e:for(S=Q;Be!==null;){if(D=Be,(D.flags&2048)!==0)try{switch(D.tag){case 0:case 11:case 15:bl(9,D)}}catch(Ve){Mt(D,D.return,Ve)}if(D===S){Be=null;break e}var be=D.sibling;if(be!==null){be.return=D.return,Be=be;break e}Be=D.return}}if(ht=h,sa(),Zt&&typeof Zt.onPostCommitFiberRoot=="function")try{Zt.onPostCommitFiberRoot(wn,n)}catch{}f=!0}return f}finally{wt=l,Qr.transition=a}}return!1}function bd(n,a,l){a=xs(l,a),a=Xf(n,a,1),n=la(n,a,1),a=Tr(),n!==null&&(Us(n,1,a),Pr(n,a))}function Mt(n,a,l){if(n.tag===3)bd(n,n,l);else for(;a!==null;){if(a.tag===3){bd(a,n,l);break}else if(a.tag===1){var f=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(ca===null||!ca.has(f))){n=xs(l,n),n=Kf(a,n,1),a=la(a,n,1),n=Tr(),a!==null&&(Us(a,1,n),Pr(a,n));break}}a=a.return}}function wm(n,a,l){var f=n.pingCache;f!==null&&f.delete(a),a=Tr(),n.pingedLanes|=n.suspendedLanes&l,tr===n&&(or&l)===l&&(qt===4||qt===3&&(or&130023424)===or&&500>Ce()-Kc?Ia(n,0):Xc|=l),Pr(n,a)}function Fd(n,a){a===0&&((n.mode&1)===0?a=1:(a=Hi,Hi<<=1,(Hi&130023424)===0&&(Hi=4194304)));var l=Tr();n=Ln(n,a),n!==null&&(Us(n,a,l),Pr(n,l))}function _m(n){var a=n.memoizedState,l=0;a!==null&&(l=a.retryLane),Fd(n,l)}function Em(n,a){var l=0;switch(n.tag){case 13:var f=n.stateNode,h=n.memoizedState;h!==null&&(l=h.retryLane);break;case 19:f=n.stateNode;break;default:throw Error(t(314))}f!==null&&f.delete(a),Fd(n,l)}var jd;jd=function(n,a,l){if(n!==null)if(n.memoizedProps!==a.pendingProps||Ar.current)Fr=!0;else{if((n.lanes&l)===0&&(a.flags&128)===0)return Fr=!1,cm(n,a,l);Fr=(n.flags&131072)!==0}else Fr=!1,Rt&&(a.flags&1048576)!==0&&uf(a,dl,a.index);switch(a.lanes=0,a.tag){case 2:var f=a.type;Cl(n,a),n=a.pendingProps;var h=ls(a,xr.current);hs(a,l),h=Nc(null,a,f,n,h,l);var v=kc();return a.flags|=1,typeof h=="object"&&h!==null&&typeof h.render=="function"&&h.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,br(f)?(v=!0,cl(a)):v=!1,a.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,gc(a),h.updater=Nl,a.stateNode=h,h._reactInternals=a,Pc(a,f,n,l),a=Ic(null,a,f,!0,v,l)):(a.tag=0,Rt&&v&&oc(a),Sr(null,a,h,l),a=a.child),a;case 16:f=a.elementType;e:{switch(Cl(n,a),n=a.pendingProps,h=f._init,f=h(f._payload),a.type=f,h=a.tag=Tm(f),n=on(f,n),h){case 0:a=Dc(null,a,f,n,l);break e;case 1:a=nd(null,a,f,n,l);break e;case 11:a=Jf(null,a,f,n,l);break e;case 14:a=Zf(null,a,f,on(f.type,n),l);break e}throw Error(t(306,f,""))}return a;case 0:return f=a.type,h=a.pendingProps,h=a.elementType===f?h:on(f,h),Dc(n,a,f,h,l);case 1:return f=a.type,h=a.pendingProps,h=a.elementType===f?h:on(f,h),nd(n,a,f,h,l);case 3:e:{if(ad(a),n===null)throw Error(t(387));f=a.pendingProps,v=a.memoizedState,h=v.element,yf(n,a),gl(a,f,null,l);var S=a.memoizedState;if(f=S.element,v.isDehydrated)if(v={element:f,isDehydrated:!1,cache:S.cache,pendingSuspenseBoundaries:S.pendingSuspenseBoundaries,transitions:S.transitions},a.updateQueue.baseState=v,a.memoizedState=v,a.flags&256){h=xs(Error(t(423)),a),a=sd(n,a,f,l,h);break e}else if(f!==h){h=xs(Error(t(424)),a),a=sd(n,a,f,l,h);break e}else for(Br=ra(a.stateNode.containerInfo.firstChild),Lr=a,Rt=!0,ln=null,l=vf(a,null,f,l),a.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(us(),f===h){a=Un(n,a,l);break e}Sr(n,a,f,l)}a=a.child}return a;case 5:return Ef(a),n===null&&fc(a),f=a.type,h=a.pendingProps,v=n!==null?n.memoizedProps:null,S=h.children,rc(f,h)?S=null:v!==null&&rc(f,v)&&(a.flags|=32),rd(n,a),Sr(n,a,S,l),a.child;case 6:return n===null&&fc(a),null;case 13:return id(n,a,l);case 4:return yc(a,a.stateNode.containerInfo),f=a.pendingProps,n===null?a.child=fs(a,null,f,l):Sr(n,a,f,l),a.child;case 11:return f=a.type,h=a.pendingProps,h=a.elementType===f?h:on(f,h),Jf(n,a,f,h,l);case 7:return Sr(n,a,a.pendingProps,l),a.child;case 8:return Sr(n,a,a.pendingProps.children,l),a.child;case 12:return Sr(n,a,a.pendingProps.children,l),a.child;case 10:e:{if(f=a.type._context,h=a.pendingProps,v=a.memoizedProps,S=h.value,At(xl,f._currentValue),f._currentValue=S,v!==null)if(sn(v.value,S)){if(v.children===h.children&&!Ar.current){a=Un(n,a,l);break e}}else for(v=a.child,v!==null&&(v.return=a);v!==null;){var D=v.dependencies;if(D!==null){S=v.child;for(var G=D.firstContext;G!==null;){if(G.context===f){if(v.tag===1){G=Bn(-1,l&-l),G.tag=2;var fe=v.updateQueue;if(fe!==null){fe=fe.shared;var _e=fe.pending;_e===null?G.next=G:(G.next=_e.next,_e.next=G),fe.pending=G}}v.lanes|=l,G=v.alternate,G!==null&&(G.lanes|=l),mc(v.return,l,a),D.lanes|=l;break}G=G.next}}else if(v.tag===10)S=v.type===a.type?null:v.child;else if(v.tag===18){if(S=v.return,S===null)throw Error(t(341));S.lanes|=l,D=S.alternate,D!==null&&(D.lanes|=l),mc(S,l,a),S=v.sibling}else S=v.child;if(S!==null)S.return=v;else for(S=v;S!==null;){if(S===a){S=null;break}if(v=S.sibling,v!==null){v.return=S.return,S=v;break}S=S.return}v=S}Sr(n,a,h.children,l),a=a.child}return a;case 9:return h=a.type,f=a.pendingProps.children,hs(a,l),h=Yr(h),f=f(h),a.flags|=1,Sr(n,a,f,l),a.child;case 14:return f=a.type,h=on(f,a.pendingProps),h=on(f.type,h),Zf(n,a,f,h,l);case 15:return ed(n,a,a.type,a.pendingProps,l);case 17:return f=a.type,h=a.pendingProps,h=a.elementType===f?h:on(f,h),Cl(n,a),a.tag=1,br(f)?(n=!0,cl(a)):n=!1,hs(a,l),Vf(a,f,h),Pc(a,f,h,l),Ic(null,a,f,!0,n,l);case 19:return od(n,a,l);case 22:return td(n,a,l)}throw Error(t(156,a.tag))};function Pd(n,a){return Ne(n,a)}function Sm(n,a,l,f){this.tag=n,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Jr(n,a,l,f){return new Sm(n,a,l,f)}function ru(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Tm(n){if(typeof n=="function")return ru(n)?1:0;if(n!=null){if(n=n.$$typeof,n===X)return 11;if(n===W)return 14}return 2}function ha(n,a){var l=n.alternate;return l===null?(l=Jr(n.tag,a,n.key,n.mode),l.elementType=n.elementType,l.type=n.type,l.stateNode=n.stateNode,l.alternate=n,n.alternate=l):(l.pendingProps=a,l.type=n.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=n.flags&14680064,l.childLanes=n.childLanes,l.lanes=n.lanes,l.child=n.child,l.memoizedProps=n.memoizedProps,l.memoizedState=n.memoizedState,l.updateQueue=n.updateQueue,a=n.dependencies,l.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},l.sibling=n.sibling,l.index=n.index,l.ref=n.ref,l}function Ll(n,a,l,f,h,v){var S=2;if(f=n,typeof n=="function")ru(n)&&(S=1);else if(typeof n=="string")S=5;else e:switch(n){case z:return La(l.children,h,v,a);case re:S=8,h|=8;break;case V:return n=Jr(12,l,a,h|2),n.elementType=V,n.lanes=v,n;case K:return n=Jr(13,l,a,h),n.elementType=K,n.lanes=v,n;case ne:return n=Jr(19,l,a,h),n.elementType=ne,n.lanes=v,n;case me:return Bl(l,h,v,a);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case M:S=10;break e;case L:S=9;break e;case X:S=11;break e;case W:S=14;break e;case Z:S=16,f=null;break e}throw Error(t(130,n==null?n:typeof n,""))}return a=Jr(S,l,a,h),a.elementType=n,a.type=f,a.lanes=v,a}function La(n,a,l,f){return n=Jr(7,n,f,a),n.lanes=l,n}function Bl(n,a,l,f){return n=Jr(22,n,f,a),n.elementType=me,n.lanes=l,n.stateNode={isHidden:!1},n}function nu(n,a,l){return n=Jr(6,n,null,a),n.lanes=l,n}function au(n,a,l){return a=Jr(4,n.children!==null?n.children:[],n.key,a),a.lanes=l,a.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},a}function Nm(n,a,l,f,h){this.tag=a,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=jo(0),this.expirationTimes=jo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jo(0),this.identifierPrefix=f,this.onRecoverableError=h,this.mutableSourceEagerHydrationData=null}function su(n,a,l,f,h,v,S,D,G){return n=new Nm(n,a,l,D,G),a===1?(a=1,v===!0&&(a|=8)):a=0,v=Jr(3,null,null,a),n.current=v,v.stateNode=n,v.memoizedState={element:f,isDehydrated:l,cache:null,transitions:null,pendingSuspenseBoundaries:null},gc(v),n}function km(n,a,l){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:de,key:f==null?null:""+f,children:n,containerInfo:a,implementation:l}}function Od(n){if(!n)return aa;n=n._reactInternals;e:{if(P(n)!==n||n.tag!==1)throw Error(t(170));var a=n;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(br(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(t(171))}if(n.tag===1){var l=n.type;if(br(l))return lf(n,l,a)}return a}function Rd(n,a,l,f,h,v,S,D,G){return n=su(l,f,!0,n,h,v,S,D,G),n.context=Od(null),l=n.current,f=Tr(),h=fa(l),v=Bn(f,h),v.callback=a??null,la(l,v,h),n.current.lanes=h,Us(n,h,f),Pr(n,f),n}function Ul(n,a,l,f){var h=a.current,v=Tr(),S=fa(h);return l=Od(l),a.context===null?a.context=l:a.pendingContext=l,a=Bn(v,S),a.payload={element:n},f=f===void 0?null:f,f!==null&&(a.callback=f),n=la(h,a,S),n!==null&&(fn(n,h,S,v),vl(n,h,S)),S}function zl(n){return n=n.current,n.child?(n.child.tag===5,n.child.stateNode):null}function Dd(n,a){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var l=n.retryLane;n.retryLane=l!==0&&l<a?l:a}}function iu(n,a){Dd(n,a),(n=n.alternate)&&Dd(n,a)}function Cm(){return null}var Id=typeof reportError=="function"?reportError:function(n){console.error(n)};function lu(n){this._internalRoot=n}Wl.prototype.render=lu.prototype.render=function(n){var a=this._internalRoot;if(a===null)throw Error(t(409));Ul(n,a,null,null)},Wl.prototype.unmount=lu.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var a=n.containerInfo;Da(function(){Ul(null,n,null,null)}),a[Rn]=null}};function Wl(n){this._internalRoot=n}Wl.prototype.unstable_scheduleHydration=function(n){if(n){var a=g0();n={blockedOn:null,target:n,priority:a};for(var l=0;l<Zn.length&&a!==0&&a<Zn[l].priority;l++);Zn.splice(l,0,n),l===0&&_0(n)}};function ou(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function $l(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function Md(){}function Am(n,a,l,f,h){if(h){if(typeof f=="function"){var v=f;f=function(){var fe=zl(S);v.call(fe)}}var S=Rd(a,f,n,0,null,!1,!1,"",Md);return n._reactRootContainer=S,n[Rn]=S.current,ei(n.nodeType===8?n.parentNode:n),Da(),S}for(;h=n.lastChild;)n.removeChild(h);if(typeof f=="function"){var D=f;f=function(){var fe=zl(G);D.call(fe)}}var G=su(n,0,!1,null,null,!1,!1,"",Md);return n._reactRootContainer=G,n[Rn]=G.current,ei(n.nodeType===8?n.parentNode:n),Da(function(){Ul(a,G,l,f)}),G}function Hl(n,a,l,f,h){var v=l._reactRootContainer;if(v){var S=v;if(typeof h=="function"){var D=h;h=function(){var G=zl(S);D.call(G)}}Ul(a,S,n,h)}else S=Am(l,a,n,h,f);return zl(S)}m0=function(n){switch(n.tag){case 3:var a=n.stateNode;if(a.current.memoizedState.isDehydrated){var l=Bs(a.pendingLanes);l!==0&&(Po(a,l|1),Pr(a,Ce()),(ht&6)===0&&(gs=Ce()+500,sa()))}break;case 13:Da(function(){var f=Ln(n,1);if(f!==null){var h=Tr();fn(f,n,1,h)}}),iu(n,1)}},Oo=function(n){if(n.tag===13){var a=Ln(n,134217728);if(a!==null){var l=Tr();fn(a,n,134217728,l)}iu(n,134217728)}},v0=function(n){if(n.tag===13){var a=fa(n),l=Ln(n,a);if(l!==null){var f=Tr();fn(l,n,a,f)}iu(n,a)}},g0=function(){return wt},y0=function(n,a){var l=wt;try{return wt=n,a()}finally{wt=l}},Er=function(n,a,l){switch(a){case"input":if(Oe(n,l),a=l.name,l.type==="radio"&&a!=null){for(l=n;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll("input[name="+JSON.stringify(""+a)+'][type="radio"]'),a=0;a<l.length;a++){var f=l[a];if(f!==n&&f.form===n.form){var h=ll(f);if(!h)throw Error(t(90));De(f),Oe(f,h)}}}break;case"textarea":it(n,l);break;case"select":a=l.value,a!=null&&Ke(n,!!l.multiple,a,!1)}},jn=Zc,Pn=Da;var bm={usingClientEntryPoint:!1,Events:[ni,ss,ll,ir,Sa,Zc]},vi={findFiberByHostInstance:Ca,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Fm={bundleType:vi.bundleType,version:vi.version,rendererPackageName:vi.rendererPackageName,rendererConfig:vi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:J.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=ce(n),n===null?null:n.stateNode},findFiberByHostInstance:vi.findFiberByHostInstance||Cm,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Vl.isDisabled&&Vl.supportsFiber)try{wn=Vl.inject(Fm),Zt=Vl}catch{}}return Or.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bm,Or.createPortal=function(n,a){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ou(a))throw Error(t(200));return km(n,a,null,l)},Or.createRoot=function(n,a){if(!ou(n))throw Error(t(299));var l=!1,f="",h=Id;return a!=null&&(a.unstable_strictMode===!0&&(l=!0),a.identifierPrefix!==void 0&&(f=a.identifierPrefix),a.onRecoverableError!==void 0&&(h=a.onRecoverableError)),a=su(n,1,!1,null,null,l,!1,f,h),n[Rn]=a.current,ei(n.nodeType===8?n.parentNode:n),new lu(a)},Or.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var a=n._reactInternals;if(a===void 0)throw typeof n.render=="function"?Error(t(188)):(n=Object.keys(n).join(","),Error(t(268,n)));return n=ce(a),n=n===null?null:n.stateNode,n},Or.flushSync=function(n){return Da(n)},Or.hydrate=function(n,a,l){if(!$l(a))throw Error(t(200));return Hl(null,n,a,!0,l)},Or.hydrateRoot=function(n,a,l){if(!ou(n))throw Error(t(405));var f=l!=null&&l.hydratedSources||null,h=!1,v="",S=Id;if(l!=null&&(l.unstable_strictMode===!0&&(h=!0),l.identifierPrefix!==void 0&&(v=l.identifierPrefix),l.onRecoverableError!==void 0&&(S=l.onRecoverableError)),a=Rd(a,null,n,1,l??null,h,!1,v,S),n[Rn]=a.current,ei(n),f)for(n=0;n<f.length;n++)l=f[n],h=l._getVersion,h=h(l._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[l,h]:a.mutableSourceEagerHydrationData.push(l,h);return new Wl(a)},Or.render=function(n,a,l){if(!$l(a))throw Error(t(200));return Hl(null,n,a,!1,l)},Or.unmountComponentAtNode=function(n){if(!$l(n))throw Error(t(40));return n._reactRootContainer?(Da(function(){Hl(null,null,n,!1,function(){n._reactRootContainer=null,n[Rn]=null})}),!0):!1},Or.unstable_batchedUpdates=Zc,Or.unstable_renderSubtreeIntoContainer=function(n,a,l,f){if(!$l(l))throw Error(t(200));if(n==null||n._reactInternals===void 0)throw Error(t(38));return Hl(n,a,l,!1,f)},Or.version="18.3.1-next-f1338f8080-20240426",Or}var Vd;function Lm(){if(Vd)return fu.exports;Vd=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(r){console.error(r)}}return e(),fu.exports=Mm(),fu.exports}var Gd;function Bm(){if(Gd)return Gl;Gd=1;var e=Lm();return Gl.createRoot=e.createRoot,Gl.hydrateRoot=e.hydrateRoot,Gl}var Um=Bm();const zm=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),qh=(...e)=>e.filter((r,t,s)=>!!r&&r.trim()!==""&&s.indexOf(r)===t).join(" ").trim();var Wm={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const $m=H.forwardRef(({color:e="currentColor",size:r=24,strokeWidth:t=2,absoluteStrokeWidth:s,className:i="",children:o,iconNode:u,...d},x)=>H.createElement("svg",{ref:x,...Wm,width:r,height:r,stroke:e,strokeWidth:s?Number(t)*24/Number(r):t,className:qh("lucide",i),...d},[...u.map(([p,m])=>H.createElement(p,m)),...Array.isArray(o)?o:[o]]));const at=(e,r)=>{const t=H.forwardRef(({className:s,...i},o)=>H.createElement($m,{ref:o,iconNode:r,className:qh(`lucide-${zm(e)}`,s),...i}));return t.displayName=`${e}`,t};const wo=at("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);const Hm=at("Barcode",[["path",{d:"M3 5v14",key:"1nt18q"}],["path",{d:"M8 5v14",key:"1ybrkv"}],["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"M17 5v14",key:"ycjyhj"}],["path",{d:"M21 5v14",key:"nzette"}]]);const Vm=at("Boxes",[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]]);const Gm=at("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);const Xm=at("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);const Bu=at("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);const Uu=at("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);const Ii=at("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);const zu=at("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);const Xd=at("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);const Km=at("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);const Ym=at("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);const qm=at("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);const Qh=at("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);const Jh=at("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const Qm=at("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);const Jm=at("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);const Kd=at("LibraryBig",[["rect",{width:"8",height:"18",x:"3",y:"3",rx:"1",key:"oynpb5"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M20.4 18.9c.2.5-.1 1.1-.6 1.3l-1.9.7c-.5.2-1.1-.1-1.3-.6L11.1 5.1c-.2-.5.1-1.1.6-1.3l1.9-.7c.5-.2 1.1.1 1.3.6Z",key:"1qboyk"}]]);const Zm=at("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);const An=at("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);const ev=at("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);const tv=at("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);const rv=at("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);const nv=at("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);const av=at("PackageSearch",[["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}],["circle",{cx:"18.5",cy:"15.5",r:"2.5",key:"b5zd12"}],["path",{d:"M20.27 17.27 22 19",key:"1l4muz"}]]);const sv=at("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);const Zh=at("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);const Ua=at("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);const ep=at("RefreshCcw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]);const Wu=at("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);const Cs=at("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);const Au=at("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);const iv=at("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);const ro=at("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const lv=at("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const ov=at("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);const za=at("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);const cv=at("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);const Yd=at("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);const pu=at("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);const uv=at("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);const tp=at("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function fv(){return dv(new Date)}function xu(){const e=new Date,r=x=>x.toString().padStart(2,"0"),t=e.getFullYear(),s=r(e.getMonth()+1),i=r(e.getDate()),o=r(e.getHours()),u=r(e.getMinutes()),d=r(e.getSeconds());return`${t}${s}${i}_${o}${u}${d}`}function dv(e){const r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),t=r.getUTCDay()||7;r.setUTCDate(r.getUTCDate()+4-t);const s=new Date(Date.UTC(r.getUTCFullYear(),0,1));return`S${Math.ceil(((r.getTime()-s.getTime())/864e5+1)/7)}-${r.getUTCFullYear()}`}const Xe="/api";let bu=localStorage.getItem("token"),Fu=localStorage.getItem("refresh_token");function Ei(e){bu=e,e?localStorage.setItem("token",e):localStorage.removeItem("token")}function no(e){Fu=e,e?localStorage.setItem("refresh_token",e):localStorage.removeItem("refresh_token")}function ju(e={}){return bu&&(e.Authorization=`Bearer ${bu}`),e}async function gt(e,r={}){const t={...r};t.headers=ju(r.headers);let s=await fetch(e,t);if(s.status===401&&Fu){const i=await fetch(`${Xe}/refresh`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:Fu})});if(i.ok){const o=await i.json();Ei(o.token),no(o.refresh_token),t.headers=ju(r.headers),s=await fetch(e,t)}else Ei(null),no(null),window.dispatchEvent(new Event("auth:logout"))}return s}async function hv(e,r){const t=await fetch(`${Xe}/login`,{method:"POST",headers:ju({"Content-Type":"application/json"}),body:JSON.stringify({email:e,password:r})});if(!t.ok)throw new Error(await yt(t));return t.json()}async function yt(e){const r=await e.json().catch(()=>({}));return r.message||r.error||"Une erreur est survenue"}async function bt(e,r,t){const s={method:e};t!==void 0&&(s.headers={"Content-Type":"application/json"},s.body=JSON.stringify(t));const i=await gt(r,s);if(!i.ok)throw new Error(await yt(i));if(!(e==="DELETE"&&i.status===204))return i.json()}function $u(e){const r=new URLSearchParams;e?.supplierId&&r.set("supplier_id",String(e.supplierId)),e?.brandId&&r.set("brand_id",String(e.brandId)),e?.productId&&r.set("product_id",String(e.productId)),e?.startWeek&&r.set("start_week",e.startWeek),e?.endWeek&&r.set("end_week",e.endWeek);const t=r.toString();return t?`?${t}`:""}async function pv(){const e=await gt(`${Xe}/`);if(!e.ok)throw new Error("Impossible de communiquer avec l'API.");return e.json()}async function Pu(){const e=await gt(`${Xe}/products`);if(!e.ok)throw new Error(await yt(e));return e.json()}async function xv(e,r={}){const t=await gt(`${Xe}/supplier_api/${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!t.ok)throw new Error(await yt(t));return t.json()}async function mv(e=20){const r=new URLSearchParams({limit:String(e)}),t=await gt(`${Xe}/supplier_api/reports?${r.toString()}`);if(!t.ok)throw new Error(await yt(t));return t.json()}async function vv(e){return bt("POST",`${Xe}/products`,e)}async function gv(){const e=await gt(`${Xe}/supplier_api/config`);if(!e.ok)throw new Error(await yt(e));return e.json()}async function yv(e,r){return bt("POST",`${Xe}/supplier_api/${e}/apis`,r)}async function wv(e,r){return bt("PATCH",`${Xe}/supplier_api/apis/${e}`,r)}async function _v(e){return bt("DELETE",`${Xe}/supplier_api/apis/${e}`)}async function Ev(e,r){return bt("POST",`${Xe}/supplier_api/apis/${e}/endpoints`,r)}async function Sv(e,r){return bt("PATCH",`${Xe}/supplier_api/endpoints/${e}`,r)}async function Tv(e){return bt("DELETE",`${Xe}/supplier_api/endpoints/${e}`)}async function Nv(e){return bt("POST",`${Xe}/supplier_api/apis/${e}/mapping`,{})}async function kv(e,r){return bt("POST",`${Xe}/supplier_api/mappings/${e}/fields`,r)}async function Cv(e,r){return bt("PATCH",`${Xe}/supplier_api/fields/${e}`,r)}async function Av(e){return bt("DELETE",`${Xe}/supplier_api/fields/${e}`)}async function qd(e,r){return bt("PUT",`${Xe}/products/${e}`,r)}async function bv(e){return bt("PUT",`${Xe}/products/bulk_update`,e)}async function Fv(e){return bt("DELETE",`${Xe}/products/${e}`)}async function jv(e){return bt("POST",`${Xe}/products/bulk_delete`,{ids:e})}async function Pv(){const e=await gt(`${Xe}/calculate_products`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error(await yt(e));return e.json()}async function Ov(){const e=await gt(`${Xe}/product_price_summary`);if(!e.ok)throw new Error(await yt(e));return e.json()}async function Rv(){const e=await gt(`${Xe}/search_catalog`);if(!e.ok)throw new Error(await yt(e));return e.json()}async function _o(){const e=await gt(`${Xe}/references/suppliers`);if(!e.ok)throw new Error(await yt(e));return e.json()}async function Ou(e){const r=await gt(`${Xe}/references/${e}`);if(!r.ok)throw new Error(await yt(r));return r.json()}async function rp(e,r,t){return bt("PUT",`${Xe}/references/${e}/${r}`,t)}async function np(e,r){return bt("POST",`${Xe}/references/${e}`,r)}async function ap(e,r){return bt("DELETE",`${Xe}/references/${e}/${r}`)}async function Dv(){const e=await gt(`${Xe}/users`);if(!e.ok)throw new Error(await yt(e));return e.json()}async function Iv(e,r){return bt("PUT",`${Xe}/users/${e}`,r)}async function Mv(e){return bt("POST",`${Xe}/users`,e)}async function Lv(e){return bt("DELETE",`${Xe}/users/${e}`)}async function Hu(){const e=await gt(`${Xe}/references/brands`);if(!e.ok)throw new Error(await yt(e));return e.json()}async function Vu(){const e=await gt(`${Xe}/references/colors`);if(!e.ok)throw new Error(await yt(e));return e.json()}async function sp(){const e=await gt(`${Xe}/references/memory_options`);if(!e.ok)throw new Error(await yt(e));return e.json()}async function ip(){const e=await gt(`${Xe}/references/ram_options`);if(!e.ok)throw new Error(await yt(e));return e.json()}async function lp(){const e=await gt(`${Xe}/references/norme_options`);if(!e.ok)throw new Error(await yt(e));return e.json()}async function op(){const e=await gt(`${Xe}/references/device_types`);if(!e.ok)throw new Error(await yt(e));return e.json()}async function Qd(e){const r=$u(e),t=await gt(`${Xe}/price_stats${r}`);if(!t.ok)throw new Error(await yt(t));return t.json()}async function Bv(e){const r=$u(e),t=await gt(`${Xe}/brand_supplier_average${r}`);if(!t.ok)throw new Error(await yt(t));return t.json()}async function Uv(e){const r=$u(e),t=await gt(`${Xe}/product_supplier_average${r}`);if(!t.ok)throw new Error(await yt(t));return t.json()}async function zv(){const e=await gt(`${Xe}/graph_settings`);if(!e.ok)throw new Error(await yt(e));return e.json()}async function Wv(e,r){return bt("PUT",`${Xe}/graph_settings/${e}`,{visible:r})}async function $v(){const e=await gt(`${Xe}/odoo/config`);if(!e.ok)throw new Error(await yt(e));return e.json()}async function Hv(e){return bt("PUT",`${Xe}/odoo/config`,e)}async function Vv(){const e=await gt(`${Xe}/odoo/test`,{method:"POST"});if(!e.ok)throw new Error(await yt(e));return e.json()}async function Gv(){const e=await gt(`${Xe}/odoo/sync`,{method:"POST"});if(!e.ok)throw new Error(await yt(e));return e.json()}async function Xv(e=20){const r=new URLSearchParams({limit:String(e)}),t=await gt(`${Xe}/odoo/jobs?${r.toString()}`);if(!t.ok)throw new Error(await yt(t));return t.json()}async function Jd(e){const r=await gt(`${Xe}/odoo/jobs/${e}`);if(!r.ok)throw new Error(await yt(r));return r.json()}async function Zd(e){return bt("PUT",`${Xe}/odoo/auto-sync`,e)}async function Kv(e,r){const t={};e&&(t.supplier_id=e),r&&(t.limit=r);const s=new AbortController,i=setTimeout(()=>s.abort(),300*1e3);try{const o=await gt(`${Xe}/matching/run`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),signal:s.signal});if(!o.ok)throw new Error(await yt(o));return o.json()}finally{clearTimeout(i)}}async function Yv(e){const r=new URLSearchParams;e?.supplier_id&&r.set("supplier_id",String(e.supplier_id)),e?.page&&r.set("page",String(e.page)),r.set("per_page",String(e.per_page));const t=r.toString(),s=await gt(`${Xe}/matching/pending${t?`?${t}`:""}`);if(!s.ok)throw new Error(await yt(s));return s.json()}async function qv(e,r){return bt("POST",`${Xe}/matching/validate`,{pending_match_id:e,product_id:r})}async function Qv(e,r=!1){return bt("POST",`${Xe}/matching/reject`,{pending_match_id:e,create_product:r})}async function Jv(){const e=await gt(`${Xe}/matching/stats`);if(!e.ok)throw new Error(await yt(e));return e.json()}const cp=H.createContext(void 0);function Zv({children:e}){const[r,t]=H.useState([]),s=(i,o="success")=>{const u=Date.now()+Math.random();t(d=>[...d,{id:u,message:i,type:o}]),setTimeout(()=>{t(d=>d.filter(x=>x.id!==u))},5e3)};return c.jsxs(cp.Provider,{value:{notify:s},children:[e,c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:r.map(i=>c.jsx("div",{className:`px-4 py-2 rounded shadow-lg text-[var(--color-text-primary)] ${i.type==="error"?"bg-red-600":i.type==="info"?"bg-blue-600":"bg-green-600"}`,children:i.message},i.id))})]})}function Fn(){const e=H.useContext(cp);if(!e)throw new Error("useNotification must be used within NotificationProvider");return e.notify}const eh=[{key:"brands",label:"Marques"},{key:"colors",label:"Couleurs"},{key:"memory_options",label:"Options mmoire"},{key:"device_types",label:"Types d'appareil"},{key:"ram_options",label:"Options RAM"},{key:"norme_options",label:"Normes"},{key:"exclusions",label:"Exclusions"},{key:"suppliers",label:"Fournisseurs"},{key:"format_imports",label:"Format import"}];function eg({isVisible:e,onClose:r}){const[t,s]=H.useState(null),[i,o]=H.useState([]),[u,d]=H.useState([]),x=Fn();H.useEffect(()=>{e&&t&&p(t)},[e,t]),H.useEffect(()=>{t==="format_imports"&&_o().then(g=>d(g)).catch(()=>d([]))},[t]);const p=async g=>{try{const _=await Ou(g);o(_)}catch{o([])}},m=(g,_,b)=>{o(I=>I.map(O=>O.id===g?{...O,[_]:b}:O))},w=async g=>{const _=i.find(I=>I.id===g);if(!_)return;const b={..._};delete b.id;try{g<0?(await np(t,b),x("Entre cre","success")):(await rp(t,g,b),x("Entre mise  jour","success")),await p(t)}catch(I){const O=I instanceof Error?I.message:"Erreur";x(O,"error")}},y=async g=>{try{g<0?o(_=>_.filter(b=>b.id!==g)):(await ap(t,g),x("Entre supprime","success"),await p(t))}catch{}},E=()=>{const g=i.length>0?Object.keys(i[0]).filter(b=>b!=="id"):[],_={id:Date.now()*-1};g.forEach(b=>_[b]=""),o(b=>[...b,_])};if(!e)return null;const N=i.length>0?Object.keys(i[0]).filter(g=>g!=="id"):[];return c.jsxs("div",{children:[!t&&c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:eh.map(g=>c.jsx("button",{onClick:()=>s(g.key),className:"card p-6 hover:bg-[var(--color-bg-elevated)] flex items-center justify-center font-semibold transition-colors",children:g.label},g.key))}),t&&c.jsxs("div",{children:[c.jsxs("div",{className:"card p-4 mb-6 flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("button",{onClick:()=>s(null),className:"btn btn-secondary text-sm",children:[c.jsx(wo,{className:"w-4 h-4"}),c.jsx("span",{children:"Retour"})]}),c.jsx("h3",{className:"text-xl font-semibold",children:eh.find(g=>g.key===t)?.label})]}),c.jsxs("button",{onClick:E,className:"btn btn-primary text-sm",children:[c.jsx(Ua,{className:"w-4 h-4"}),c.jsx("span",{children:"Ajouter"})]})]}),c.jsxs("div",{className:"card overflow-hidden",children:[N.length>0&&c.jsxs("div",{className:"flex items-center space-x-2 font-semibold px-4 py-3 border-b border-[var(--color-border-subtle)]",children:[c.jsx("span",{className:"w-10 text-[var(--color-text-muted)]",children:"ID"}),N.map(g=>c.jsx("span",{className:"flex-1 capitalize text-sm",children:g},g)),c.jsx("span",{className:"w-20"})]}),c.jsx("div",{className:"divide-y divide-[var(--color-border-subtle)]",children:i.map(g=>c.jsxs("div",{className:"flex items-center space-x-2 px-4 py-2",children:[c.jsx("span",{className:"w-10 text-[var(--color-text-muted)] text-sm",children:g.id>0?g.id:"-"}),N.map(_=>t==="format_imports"&&_==="supplier_id"?c.jsxs("select",{value:g[_]??"",onChange:b=>m(g.id,_,b.target.value),className:"flex-1 px-2 py-1 bg-[var(--color-bg-input)] text-[var(--color-text-primary)] rounded text-sm",children:[c.jsx("option",{value:"",children:"--"}),u.map(b=>c.jsx("option",{value:b.id,children:b.name},b.id))]},_):c.jsx("input",{value:g[_]??"",placeholder:_,onChange:b=>m(g.id,_,b.target.value),className:"flex-1 px-2 py-1 bg-[var(--color-bg-input)] text-[var(--color-text-primary)] rounded placeholder:italic text-sm"},_)),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("button",{onClick:()=>w(g.id),className:"btn btn-primary p-1.5",children:c.jsx(Cs,{className:"w-4 h-4"})}),c.jsx("button",{onClick:()=>y(g.id),className:"btn btn-secondary p-1.5 text-red-500",children:c.jsx(za,{className:"w-4 h-4"})})]})]},g.id))})]})]})]})}const tg=new Set(["price","selling_price","purchase_price","recommended_price"]),rg=new Set(["quantity","stock"]),up=["supplier_sku","price","quantity"],th=new Map(up.map((e,r)=>[e,r])),ng=["GET","POST","PUT","PATCH","DELETE"],ag=[{value:"none",label:"Aucune"},{value:"api_key",label:"API Key"},{value:"basic",label:"Basic"},{value:"oauth2",label:"OAuth2"}],rh="Impossible de rcuprer la configuration API.";let sg=-1;function ig(e){return{id:sg--,target_field:e,source_path:"",transform:null}}function fp(e){const r=[...e??[]],t=new Set(r.map(s=>(s.target_field||"").trim().toLowerCase()).filter(Boolean));for(const s of up)t.has(s)||r.push(ig(s));return r.sort((s,i)=>{const o=(s.target_field||"").trim().toLowerCase(),u=(i.target_field||"").trim().toLowerCase(),d=th.get(o),x=th.get(u);return d!==void 0&&x!==void 0?d-x:d!==void 0?-1:x!==void 0?1:0}),r}function ws(e){return e?{...e,fields:fp(e.fields)}:null}function lg(e){const r=(e.target_field||"").toLowerCase();return tg.has(r)?"price":rg.has(r)?"quantity":"other"}function og(e){return e?fp(e).map(r=>({...r,category:lg(r)})):[]}function cg({category:e}){const r={price:{label:"Prix",className:"bg-emerald-500/10 text-emerald-300 border-emerald-500/40"},quantity:{label:"Quantit",className:"bg-sky-500/10 text-sky-300 border-sky-500/40"},other:{label:"Autre",className:"bg-[var(--color-bg-input)]/40 text-[var(--color-text-secondary)] border-zinc-500/40"}},{label:t,className:s}=r[e];return c.jsx("span",{className:`text-xs font-semibold uppercase tracking-wide px-2 py-1 rounded border ${s}`,children:t})}function ug({isVisible:e,onClose:r}){const t=Fn(),[s,i]=H.useState([]),[o,u]=H.useState(!1),[d,x]=H.useState(null),p=H.useCallback((M,L)=>{const X=M instanceof Error?M.message:L;return t(X,"error"),X},[t]),m=H.useCallback(async()=>{const M=await gv(),L=(Array.isArray(M)?M:[]).map(X=>({...X,apis:X.apis.map(K=>({...K,mapping:ws(K.mapping)}))}));i(L)},[]),w=H.useCallback(async()=>{u(!0),x(null);try{await m()}catch(M){const L=p(M,rh);x(L)}finally{u(!1)}},[m,p]),y=H.useCallback(async()=>{try{await m(),x(null)}catch(M){const L=p(M,rh);x(L)}},[m,p]);H.useEffect(()=>{e&&w()},[e,w]);const E=M=>{const X={id:-Math.floor(Date.now()+Math.random()*1e3),base_url:"",auth_type:"none",rate_limit_per_min:null,endpoints:[],mapping:null};i(K=>K.map(ne=>ne.id===M?{...ne,apis:[...ne.apis,X]}:ne))},N=(M,L,X,K)=>{i(ne=>ne.map(W=>W.id!==M?W:{...W,apis:W.apis.map(Z=>{if(Z.id!==L)return Z;if(X==="base_url")return{...Z,base_url:K};if(X==="auth_type")return{...Z,auth_type:K};if(K==="")return{...Z,rate_limit_per_min:null};const me=Number(K);return{...Z,rate_limit_per_min:Number.isNaN(me)?Z.rate_limit_per_min??null:me}})}))},g=async(M,L)=>{const X=(L.base_url||"").trim();if(!X){t("La base URL est obligatoire.","error");return}const K={base_url:X,auth_type:L.auth_type??"none",rate_limit_per_min:typeof L.rate_limit_per_min=="number"?L.rate_limit_per_min:null};try{L.id<0?(await yv(M,K),t("API cre avec succs.","success")):(await wv(L.id,K),t("API mise  jour.","success")),await y()}catch(ne){p(ne,"Impossible d'enregistrer cette API.")}},_=async(M,L)=>{if(L.id<0){i(X=>X.map(K=>K.id===M?{...K,apis:K.apis.filter(ne=>ne.id!==L.id)}:K));return}try{await _v(L.id),t("API supprime.","success"),await y()}catch(X){p(X,"Impossible de supprimer cette API.")}},b=(M,L)=>{if(L.id<0){t("Enregistrez l'API avant d'ajouter un endpoint.","info");return}const K={id:-Math.floor(Date.now()+Math.random()*1e3),name:"",method:"GET",path:"",items_path:""};i(ne=>ne.map(W=>W.id!==M?W:{...W,apis:W.apis.map(Z=>Z.id===L.id?{...Z,endpoints:[...Z.endpoints,K]}:Z)}))},I=(M,L,X,K,ne)=>{i(W=>W.map(Z=>Z.id!==M?Z:{...Z,apis:Z.apis.map(me=>me.id!==L?me:{...me,endpoints:me.endpoints.map(R=>R.id!==X?R:K==="name"?{...R,name:ne}:K==="method"?{...R,method:ne.toUpperCase()}:K==="path"?{...R,path:ne}:{...R,items_path:ne})})}))},O=async(M,L,X)=>{const K=(X.name||"").trim(),ne=(X.path||"").trim();if(!K||!ne){t("Le nom et le chemin sont obligatoires.","error");return}const W={name:K,method:(X.method||"GET").toUpperCase(),path:ne,items_path:(X.items_path||"").trim()||null};try{X.id<0?(await Ev(L,W),t("Endpoint cr.","success")):(await Sv(X.id,W),t("Endpoint mis  jour.","success")),await y()}catch(Z){p(Z,"Impossible d'enregistrer cet endpoint.")}},J=async(M,L,X)=>{if(X.id<0){i(K=>K.map(ne=>ne.id!==M?ne:{...ne,apis:ne.apis.map(W=>W.id===L.id?{...W,endpoints:W.endpoints.filter(Z=>Z.id!==X.id)}:W)}));return}try{await Tv(X.id),t("Endpoint supprim.","success"),await y()}catch(K){p(K,"Impossible de supprimer cet endpoint.")}},he=H.useCallback(async(M,L)=>{if(L.mapping)return L.mapping.id;if(L.id<0)return t("Enregistrez l'API avant d'ajouter un mapping.","info"),null;try{const X=await Nv(L.id),K=ws({...X,fields:X.fields??[]});return i(ne=>ne.map(W=>W.id!==M?W:{...W,apis:W.apis.map(Z=>Z.id===L.id?{...Z,mapping:K}:Z)})),t("Mapping initialis.","info"),X.id}catch(X){return p(X,"Impossible de crer un mapping pour cette API."),null}},[t,p]),de=async(M,L)=>{const X=await he(M,L);if(!X)return;const ne={id:-Math.floor(Date.now()+Math.random()*1e3),target_field:"",source_path:"",transform:null};i(W=>W.map(Z=>Z.id!==M?Z:{...Z,apis:Z.apis.map(me=>{if(me.id!==L.id)return me;const R=me.mapping?ws({...me.mapping,fields:[...me.mapping.fields,ne]}):ws({id:X,version:1,is_active:!0,fields:[ne]});return{...me,mapping:R}})}))},z=(M,L,X,K,ne)=>{i(W=>W.map(Z=>Z.id!==M?Z:{...Z,apis:Z.apis.map(me=>me.id!==L||!me.mapping?me:{...me,mapping:ws({...me.mapping,fields:me.mapping.fields.map(R=>R.id!==X?R:K==="target_field"?{...R,target_field:ne}:{...R,source_path:ne})})})}))},re=async(M,L,X)=>{if(!L.mapping){t("Aucun mapping actif pour cette API.","error");return}const K=(X.target_field||"").trim(),ne=(X.source_path||"").trim();if(!K||!ne){t("Les champs cible et source sont obligatoires.","error");return}const W={target_field:K,source_path:ne,transform:X.transform??null};try{X.id<0?(await kv(L.mapping.id,W),t("Champ ajout.","success")):(await Cv(X.id,W),t("Champ mis  jour.","success")),await y()}catch(Z){p(Z,"Impossible d'enregistrer ce champ.")}},V=async(M,L,X)=>{if(L.mapping){if(X.id<0){i(K=>K.map(ne=>ne.id!==M?ne:{...ne,apis:ne.apis.map(W=>W.id===L.id&&W.mapping?{...W,mapping:ws({...W.mapping,fields:W.mapping.fields.filter(Z=>Z.id!==X.id)})}:W)}));return}try{await Av(X.id),t("Champ supprim.","success"),await y()}catch(K){p(K,"Impossible de supprimer ce champ.")}}};return e?c.jsxs("div",{className:"space-y-6",children:[o&&c.jsx("p",{className:"text-sm text-[var(--color-text-muted)]",children:"Chargement des configurations"}),d&&c.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-400 bg-[var(--color-bg-elevated)] border border-red-500/30 px-4 py-3 rounded-md",children:[c.jsx(zu,{className:"w-5 h-5"}),c.jsx("span",{children:d})]}),!o&&!d&&s.length===0&&c.jsx("p",{className:"text-sm text-[var(--color-text-muted)] italic",children:"Aucun fournisseur ne possde de configuration API pour le moment."}),c.jsx("div",{className:"space-y-10",children:s.map(M=>c.jsxs("div",{className:"space-y-5",children:[c.jsxs("div",{className:"flex items-center gap-3 border-b border-[var(--color-border-subtle)] pb-3",children:[c.jsx("div",{className:"p-2 rounded-md bg-[#B8860B]/10 text-[#B8860B]",children:c.jsx(iv,{className:"w-5 h-5"})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-xs uppercase text-[var(--color-text-muted)] tracking-wide",children:"Fournisseur"}),c.jsx("h3",{className:"text-lg font-semibold text-[var(--color-text-primary)]",children:M.name})]}),c.jsxs("button",{onClick:()=>E(M.id),className:"btn btn-primary text-sm",children:[c.jsx(Ua,{className:"w-4 h-4"}),c.jsx("span",{children:"Ajouter une API"})]})]}),M.apis.length>0?c.jsx("div",{className:"space-y-6",children:M.apis.map(L=>{const X=og(L.mapping?.fields);return c.jsxs("div",{className:"bg-[var(--color-bg-subtle)] border border-[#B8860B]/20 rounded-lg",children:[c.jsxs("div",{className:"px-5 py-4 flex flex-col gap-4 border-b border-[var(--color-border-subtle)]",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsx("label",{className:"text-xs uppercase tracking-wide text-[var(--color-text-muted)]",children:"Base URL"}),c.jsx("input",{value:L.base_url,onChange:K=>N(M.id,L.id,"base_url",K.target.value),placeholder:"https://api.fournisseur.com",className:"px-3 py-2 rounded-md bg-[var(--color-bg-surface)] border border-[var(--color-border-default)] text-[var(--color-text-primary)] placeholder:text-[var(--color-text-muted)]"})]}),c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsx("label",{className:"text-xs uppercase tracking-wide text-[var(--color-text-muted)]",children:"Authentification"}),c.jsx("select",{value:L.auth_type??"none",onChange:K=>N(M.id,L.id,"auth_type",K.target.value),className:"px-3 py-2 rounded-md bg-[var(--color-bg-surface)] border border-[var(--color-border-default)] text-[var(--color-text-primary)]",children:ag.map(K=>c.jsx("option",{value:K.value,children:K.label},K.value))})]}),c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsx("label",{className:"text-xs uppercase tracking-wide text-[var(--color-text-muted)]",children:"Limite/minute"}),c.jsx("input",{type:"number",min:0,value:L.rate_limit_per_min??"",onChange:K=>N(M.id,L.id,"rate_limit_per_min",K.target.value),placeholder:"Illimit",className:"px-3 py-2 rounded-md bg-[var(--color-bg-surface)] border border-[var(--color-border-default)] text-[var(--color-text-primary)] placeholder:text-[var(--color-text-muted)]"})]})]}),c.jsxs("div",{className:"flex items-center justify-end gap-2",children:[c.jsxs("button",{onClick:()=>g(M.id,L),className:"btn btn-primary text-sm",children:[c.jsx(Cs,{className:"w-4 h-4"}),c.jsx("span",{children:L.id<0?"Crer":"Enregistrer"})]}),c.jsxs("button",{onClick:()=>_(M.id,L),className:"btn btn-secondary text-sm text-red-500",children:[c.jsx(za,{className:"w-4 h-4"}),c.jsx("span",{children:"Supprimer"})]})]})]}),c.jsxs("div",{className:"p-5 space-y-6",children:[c.jsxs("section",{className:"space-y-3",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h4",{className:"text-sm text-[var(--color-text-muted)] uppercase tracking-wide",children:"Endpoints"}),c.jsxs("button",{onClick:()=>b(M.id,L),className:"btn btn-secondary text-sm",children:[c.jsx(Ua,{className:"w-4 h-4"}),c.jsx("span",{children:"Ajouter un endpoint"})]})]}),L.endpoints.length>0?c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full text-sm text-left text-[var(--color-text-secondary)] border border-[var(--color-border-subtle)] rounded-md overflow-hidden",children:[c.jsx("thead",{className:"bg-[var(--color-bg-surface)]/80 text-xs uppercase tracking-wide text-[var(--color-text-muted)]",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-2 font-medium",children:"Nom"}),c.jsx("th",{className:"px-4 py-2 font-medium",children:"Mthode"}),c.jsx("th",{className:"px-4 py-2 font-medium",children:"Chemin"}),c.jsx("th",{className:"px-4 py-2 font-medium",children:"Chemin items"}),c.jsx("th",{className:"px-4 py-2 font-medium text-right",children:"Actions"})]})}),c.jsx("tbody",{children:L.endpoints.map(K=>c.jsxs("tr",{className:"border-t border-[var(--color-border-subtle)] even:bg-[var(--color-bg-faint)]",children:[c.jsx("td",{className:"px-4 py-2",children:c.jsx("input",{value:K.name,onChange:ne=>I(M.id,L.id,K.id,"name",ne.target.value),placeholder:"Nom",className:"w-full px-2 py-1 rounded bg-[var(--color-bg-surface)] border border-[var(--color-border-default)] text-[var(--color-text-primary)] placeholder:text-[var(--color-text-muted)]"})}),c.jsx("td",{className:"px-4 py-2",children:c.jsx("select",{value:K.method,onChange:ne=>I(M.id,L.id,K.id,"method",ne.target.value),className:"px-2 py-1 rounded bg-[var(--color-bg-surface)] border border-[var(--color-border-default)] text-[var(--color-text-primary)]",children:ng.map(ne=>c.jsx("option",{value:ne,children:ne},ne))})}),c.jsx("td",{className:"px-4 py-2",children:c.jsx("input",{value:K.path,onChange:ne=>I(M.id,L.id,K.id,"path",ne.target.value),placeholder:"/v1/products",className:"w-full px-2 py-1 rounded bg-[var(--color-bg-surface)] border border-[var(--color-border-default)] text-[var(--color-text-primary)] placeholder:text-[var(--color-text-muted)]"})}),c.jsx("td",{className:"px-4 py-2",children:c.jsx("input",{value:K.items_path??"",onChange:ne=>I(M.id,L.id,K.id,"items_path",ne.target.value),placeholder:"data.items",className:"w-full px-2 py-1 rounded bg-[var(--color-bg-surface)] border border-[var(--color-border-default)] text-[var(--color-text-primary)] placeholder:text-[var(--color-text-muted)]"})}),c.jsx("td",{className:"px-4 py-2",children:c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx("button",{onClick:()=>O(M.id,L.id,K),className:"btn btn-primary p-1.5",children:c.jsx(Cs,{className:"w-4 h-4"})}),c.jsx("button",{onClick:()=>J(M.id,L,K),className:"btn btn-secondary p-1.5 text-red-500",children:c.jsx(za,{className:"w-4 h-4"})})]})})]},K.id))})]})}):c.jsx("p",{className:"text-sm text-[var(--color-text-muted)] italic",children:"Aucun endpoint configur. Ajoutez-en un pour commencer."})]}),c.jsxs("section",{className:"space-y-3",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex flex-col",children:[c.jsx("h4",{className:"text-sm text-[var(--color-text-muted)] uppercase tracking-wide",children:"Mapping des champs"}),L.mapping&&c.jsxs("div",{className:"flex items-center gap-2 text-xs uppercase tracking-wide text-[var(--color-text-muted)]",children:[c.jsxs("span",{className:"px-2 py-1 rounded-full border border-[var(--color-border-default)] bg-[var(--color-bg-surface)]/70",children:["Version ",L.mapping.version]}),L.mapping.is_active?c.jsx("span",{className:"px-2 py-1 rounded-full border border-emerald-500/40 bg-emerald-500/10 text-emerald-300",children:"Actif"}):c.jsx("span",{className:"px-2 py-1 rounded-full border border-[var(--color-border-default)] bg-[var(--color-bg-surface)]/70",children:"Inactif"})]}),c.jsxs("p",{className:"text-xs text-[var(--color-text-muted)] mt-1",children:["Champs obligatoires: ",c.jsx("code",{className:"text-[var(--color-text-secondary)]",children:"supplier_sku"}),","," ",c.jsx("code",{className:"text-[var(--color-text-secondary)]",children:"price"})," et"," ",c.jsx("code",{className:"text-[var(--color-text-secondary)]",children:"quantity"}),"."]})]}),c.jsxs("button",{onClick:()=>de(M.id,L),className:"btn btn-secondary text-sm",children:[c.jsx(Ua,{className:"w-4 h-4"}),c.jsx("span",{children:"Ajouter un champ"})]})]}),X.length>0?c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full text-sm text-left text-[var(--color-text-secondary)] border border-[var(--color-border-subtle)] rounded-md overflow-hidden",children:[c.jsx("thead",{className:"bg-[var(--color-bg-surface)]/80 text-xs uppercase tracking-wide text-[var(--color-text-muted)]",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-2 font-medium",children:"Champ cible"}),c.jsx("th",{className:"px-4 py-2 font-medium",children:"Source"}),c.jsx("th",{className:"px-4 py-2 font-medium",children:"Type"}),c.jsx("th",{className:"px-4 py-2 font-medium text-right",children:"Actions"})]})}),c.jsx("tbody",{children:X.map(K=>c.jsxs("tr",{className:"border-t border-[var(--color-border-subtle)] even:bg-[var(--color-bg-faint)]",children:[c.jsx("td",{className:"px-4 py-2",children:c.jsx("input",{value:K.target_field,onChange:ne=>z(M.id,L.id,K.id,"target_field",ne.target.value),placeholder:"supplier_sku",className:"w-full px-2 py-1 rounded bg-[var(--color-bg-surface)] border border-[var(--color-border-default)] text-[var(--color-text-primary)] placeholder:text-[var(--color-text-muted)]"})}),c.jsx("td",{className:"px-4 py-2",children:c.jsx("input",{value:K.source_path,onChange:ne=>z(M.id,L.id,K.id,"source_path",ne.target.value),placeholder:"data.price",className:"w-full px-2 py-1 rounded bg-[var(--color-bg-surface)] border border-[var(--color-border-default)] text-[var(--color-text-primary)] placeholder:text-[var(--color-text-muted)]"})}),c.jsx("td",{className:"px-4 py-2",children:c.jsx(cg,{category:K.category})}),c.jsx("td",{className:"px-4 py-2",children:c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx("button",{onClick:()=>re(M.id,L,K),className:"btn btn-primary p-1.5",children:c.jsx(Cs,{className:"w-4 h-4"})}),c.jsx("button",{onClick:()=>V(M.id,L,K),className:"btn btn-secondary p-1.5 text-red-500",children:c.jsx(za,{className:"w-4 h-4"})})]})})]},K.id))})]})}):c.jsx("p",{className:"text-sm text-[var(--color-text-muted)] italic",children:"Aucun mapping actif pour cette API. Ajoutez un champ pour dmarrer le mapping."})]})]})]},L.id)})}):c.jsx("p",{className:"text-sm text-[var(--color-text-muted)] italic",children:"Aucun API configur pour ce fournisseur."})]},M.id))})]}):null}const nh=[{key:"color_translations",label:"Cohrence des couleurs"}];function fg({isVisible:e,onClose:r}){const[t,s]=H.useState(null),[i,o]=H.useState([]),[u,d]=H.useState([]),x=Fn();H.useEffect(()=>{e&&t&&p(t)},[e,t]);const p=async _=>{try{if(_==="color_translations"){const[b,I]=await Promise.all([Ou(_),Vu()]);d(I);const O=b.map(J=>{const he=I.find(de=>de.color===J.color_target);return{...J,color_target_id:he?he.id:""}});o(O)}else{const b=await Ou(_);o(b)}}catch{o([])}},m=(_,b,I)=>{o(O=>O.map(J=>{if(J.id!==_)return J;const he={...J,[b]:I};if(t==="color_translations"&&b==="color_target_id"){const de=u.find(z=>String(z.id)===I);de&&(he.color_target=de.color)}return he}))},w=async _=>{const b=i.find(O=>O.id===_);if(!b)return;const I={...b};delete I.id;try{_<0?(await np(t,I),x("Entre cre","success")):(await rp(t,_,I),x("Entre mise  jour","success")),await p(t)}catch{}},y=async _=>{try{_<0?o(b=>b.filter(I=>I.id!==_)):(await ap(t,_),x("Entre supprime","success"),await p(t))}catch{}},E=()=>{const _=i.length>0?Object.keys(i[0]).filter(I=>I!=="id"):[],b={id:Date.now()*-1};_.forEach(I=>b[I]=""),t==="color_translations"&&(b.color_target_id=u[0]?.id??"",b.color_target=u[0]?.color??""),o(I=>[...I,b])};if(!e)return null;const N=i.length>0?Object.keys(i[0]).filter(_=>_!=="id"):[],g=t==="color_translations"?N.filter(_=>_!=="color_target_id"&&_!=="color_target"):N;return c.jsxs("div",{children:[!t&&c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:nh.map(_=>c.jsx("button",{onClick:()=>s(_.key),className:"card p-6 hover:bg-[var(--color-bg-elevated)] flex items-center justify-center font-semibold transition-colors",children:_.label},_.key))}),t&&c.jsxs("div",{children:[c.jsxs("div",{className:"card p-4 mb-6 flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("button",{onClick:()=>s(null),className:"btn btn-secondary text-sm",children:[c.jsx(wo,{className:"w-4 h-4"}),c.jsx("span",{children:"Retour"})]}),c.jsx("h3",{className:"text-xl font-semibold",children:nh.find(_=>_.key===t)?.label})]}),c.jsxs("button",{onClick:E,className:"btn btn-primary text-sm",children:[c.jsx(Ua,{className:"w-4 h-4"}),c.jsx("span",{children:"Ajouter"})]})]}),c.jsx("div",{className:"card overflow-hidden",children:c.jsx("div",{className:"divide-y divide-[var(--color-border-subtle)]",children:i.map(_=>c.jsxs("div",{className:"flex items-center space-x-2 px-4 py-2",children:[c.jsx("span",{className:"w-10 text-[var(--color-text-muted)] text-sm",children:_.id>0?_.id:"-"}),g.map(b=>c.jsx("input",{value:_[b]??"",placeholder:b,onChange:I=>m(_.id,b,I.target.value),className:"flex-1 px-2 py-1 bg-[var(--color-bg-input)] text-[var(--color-text-primary)] rounded placeholder:italic text-sm"},b)),t==="color_translations"&&c.jsx("select",{value:_.color_target_id??"",onChange:b=>m(_.id,"color_target_id",b.target.value),className:"flex-1 px-2 py-1 bg-[var(--color-bg-input)] text-[var(--color-text-primary)] rounded text-sm",children:u.map(b=>c.jsx("option",{value:b.id,children:b.color},b.id))}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("button",{onClick:()=>w(_.id),className:"btn btn-primary p-1.5",children:c.jsx(Cs,{className:"w-4 h-4"})}),c.jsx("button",{onClick:()=>y(_.id),className:"btn btn-secondary p-1.5 text-red-500",children:c.jsx(za,{className:"w-4 h-4"})})]})]},_.id))})})]})]})}function dg({isVisible:e,onClose:r}){const[t,s]=H.useState([]),i=Fn();H.useEffect(()=>{e&&o()},[e]);const o=async()=>{try{const m=await Dv();s(m)}catch{s([])}},u=(m,w,y)=>{s(E=>E.map(N=>N.id===m?{...N,[w]:y}:N))},d=async m=>{const w=t.find(y=>y.id===m);if(w)try{m<0?(await Mv({username:w.username,role:w.role,first_name:w.first_name,last_name:w.last_name,email:w.email}),i("Utilisateur cr","success")):(await Iv(m,{username:w.username,role:w.role,first_name:w.first_name,last_name:w.last_name,email:w.email}),i("Utilisateur mis  jour","success")),await o()}catch{}},x=async m=>{if(m<0){s(w=>w.filter(y=>y.id!==m));return}if(window.confirm("Supprimer cet utilisateur ?"))try{await Lv(m),i("Utilisateur supprim","success"),await o()}catch{}},p=()=>{s(m=>[...m,{id:Date.now()*-1,username:"",role:"client",first_name:"",last_name:"",email:""}])};return e?c.jsxs("div",{children:[c.jsxs("div",{className:"card p-4 mb-6 flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[c.jsx("h3",{className:"text-xl font-semibold",children:"Gestion des utilisateurs"}),c.jsxs("button",{onClick:p,className:"btn btn-primary text-sm",children:[c.jsx(Ua,{className:"w-4 h-4"}),c.jsx("span",{children:"Ajouter"})]})]}),c.jsxs("div",{className:"card overflow-hidden",children:[c.jsxs("div",{className:"hidden md:flex items-center space-x-2 font-semibold px-4 py-3 border-b border-[var(--color-border-subtle)]",children:[c.jsx("span",{className:"w-10 text-[var(--color-text-muted)] text-sm",children:"ID"}),c.jsx("span",{className:"flex-1 text-sm",children:"Username"}),c.jsx("span",{className:"flex-1 text-sm",children:"Nom"}),c.jsx("span",{className:"flex-1 text-sm",children:"Prnom"}),c.jsx("span",{className:"flex-1 text-sm",children:"Email"}),c.jsx("span",{className:"w-40 text-sm",children:"Rle"}),c.jsx("span",{className:"w-20"})]}),c.jsx("div",{className:"divide-y divide-[var(--color-border-subtle)]",children:t.map(m=>c.jsxs("div",{className:"flex items-center space-x-2 px-4 py-2",children:[c.jsx("span",{className:"w-10 text-[var(--color-text-muted)] text-sm",children:m.id>0?m.id:"-"}),c.jsx("input",{value:m.username,onChange:w=>u(m.id,"username",w.target.value),placeholder:"username",className:"flex-1 px-2 py-1 bg-[var(--color-bg-input)] text-[var(--color-text-primary)] rounded text-sm"}),c.jsx("input",{value:m.last_name,onChange:w=>u(m.id,"last_name",w.target.value),placeholder:"nom",className:"flex-1 px-2 py-1 bg-[var(--color-bg-input)] text-[var(--color-text-primary)] rounded text-sm"}),c.jsx("input",{value:m.first_name,onChange:w=>u(m.id,"first_name",w.target.value),placeholder:"prnom",className:"flex-1 px-2 py-1 bg-[var(--color-bg-input)] text-[var(--color-text-primary)] rounded text-sm"}),c.jsx("input",{value:m.email,onChange:w=>u(m.id,"email",w.target.value),placeholder:"email",className:"flex-1 px-2 py-1 bg-[var(--color-bg-input)] text-[var(--color-text-primary)] rounded text-sm"}),c.jsxs("select",{value:m.role,onChange:w=>u(m.id,"role",w.target.value),className:"w-40 px-2 py-1 bg-[var(--color-bg-input)] text-[var(--color-text-primary)] rounded text-sm",children:[c.jsx("option",{value:"client",children:"client"}),c.jsx("option",{value:"admin",children:"admin"})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("button",{onClick:()=>d(m.id),className:"btn btn-primary p-1.5",children:c.jsx(Cs,{className:"w-4 h-4"})}),c.jsx("button",{onClick:()=>x(m.id),className:"btn btn-secondary p-1.5 text-red-500",children:c.jsx(cv,{className:"w-4 h-4"})})]})]},m.id))})]})]}):null}const hg=[{key:"references",label:"Tables rfrence"},{key:"translations",label:"Cohrence des tables"},{key:"apis",label:"API fournisseurs"},{key:"users",label:"Utilisateurs"}];function pg(){const[e,r]=H.useState("references");return c.jsxs("div",{children:[c.jsxs("div",{className:"mb-8",children:[c.jsxs("h1",{className:"text-3xl font-semibold text-[var(--color-text-heading)] flex items-center gap-3",children:[c.jsx(ro,{className:"w-8 h-8 text-[#B8860B]"}),"Administration"]}),c.jsx("p",{className:"text-[var(--color-text-muted)] mt-1",children:"Grez les tables de rfrence, la cohrence des donnes, les API fournisseurs et les utilisateurs."})]}),c.jsx("div",{className:"border-b border-[var(--color-border-subtle)] mb-6",children:c.jsx("nav",{className:"flex gap-4",children:hg.map(t=>c.jsx("button",{type:"button",onClick:()=>r(t.key),className:`px-2 pb-3 text-sm font-medium transition-colors border-b-2 ${e===t.key?"border-[#B8860B] text-[var(--color-text-heading)]":"border-transparent text-[var(--color-text-muted)] hover:text-[var(--color-text-secondary)]"}`,children:t.label},t.key))})}),e==="references"&&c.jsx(eg,{isVisible:!0,onClose:()=>r("references")}),e==="translations"&&c.jsx(fg,{isVisible:!0,onClose:()=>r("translations")}),e==="apis"&&c.jsx(ug,{isVisible:!0,onClose:()=>r("apis")}),e==="users"&&c.jsx(dg,{isVisible:!0,onClose:()=>r("users")})]})}function xg(){const e=Fn(),[r,t]=H.useState([]),[s,i]=H.useState(),[o,u]=H.useState(!1),[d,x]=H.useState(null),[p,m]=H.useState(50),[w,y]=H.useState([]),[E,N]=H.useState(0),[g,_]=H.useState(1),b=10,[I,O]=H.useState(null),[J,he]=H.useState(null),[de,z]=H.useState(!1);H.useEffect(()=>{_o().then(ne=>t(ne)).catch(()=>{}),V()},[]),H.useEffect(()=>{re()},[g,s]);function re(){z(!0),Yv({supplier_id:s,page:g,per_page:b}).then(ne=>{y(ne.items),N(ne.total)}).catch(()=>e("Erreur lors du chargement des matchs en attente","error")).finally(()=>z(!1))}function V(){Jv().then(O).catch(()=>{})}async function M(){u(!0),x(null),he(null);try{const ne=await Kv(s,p);x(ne),e(`Rapprochement termine : ${ne.auto_matched} matches, ${ne.pending_review} en attente, ${ne.auto_created} crees`,"success"),re(),V()}catch(ne){let W;ne instanceof DOMException&&ne.name==="AbortError"?W="Le rapprochement a pris trop de temps (timeout). Essayez avec un seul fournisseur.":ne instanceof TypeError&&ne.message==="Failed to fetch"?W="Impossible de contacter le serveur. Verifiez votre connexion ou que le backend est demarre.":ne instanceof Error?W=ne.message:W="Erreur inconnue lors du rapprochement",he(W),e(W,"error")}finally{u(!1)}}async function L(ne,W){try{await qv(ne.id,W.product_id),e(`Match valide : ${ne.source_label}`,"success"),re(),V()}catch(Z){const me=Z instanceof Error?Z.message:"Erreur";e(me,"error")}}async function X(ne,W){try{await Qv(ne.id,W),e(W?`Nouveau produit cree depuis : ${ne.source_label}`:`Match rejete : ${ne.source_label}`,"success"),re(),V()}catch(Z){const me=Z instanceof Error?Z.message:"Erreur";e(me,"error")}}const K=Math.ceil(E/b);return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"card",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[c.jsx(Zm,{className:"w-5 h-5 text-[#B8860B]"}),c.jsx("h2",{className:"text-lg font-semibold text-[var(--color-text-heading)]",children:"Rapprochement LLM"})]}),c.jsx("p",{className:"text-sm text-[var(--color-text-muted)] mb-4",children:"Associez automatiquement les produits fournisseurs au referentiel en utilisant l'extraction par IA."}),c.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[c.jsxs("select",{value:s??"",onChange:ne=>{const W=ne.target.value;i(W?Number(W):void 0),_(1)},className:"rounded-md border border-[var(--color-border-default)] bg-[var(--color-bg-elevated)] text-[var(--color-text-primary)] px-3 py-2 text-sm",children:[c.jsx("option",{value:"",children:"Tous les fournisseurs"}),r.map(ne=>c.jsx("option",{value:ne.id,children:ne.name},ne.id))]}),c.jsxs("select",{value:p??"",onChange:ne=>{const W=ne.target.value;m(W?Number(W):void 0)},className:"rounded-md border border-[var(--color-border-default)] bg-[var(--color-bg-elevated)] text-[var(--color-text-primary)] px-3 py-2 text-sm",children:[c.jsx("option",{value:"50",children:"50 produits"}),c.jsx("option",{value:"100",children:"100 produits"}),c.jsx("option",{value:"200",children:"200 produits"}),c.jsx("option",{value:"",children:"Tous"})]}),c.jsxs("button",{type:"button",onClick:M,disabled:o,className:"btn btn-primary flex items-center gap-2",children:[o?c.jsx(An,{className:"w-4 h-4 animate-spin"}):c.jsx(Zh,{className:"w-4 h-4"}),o?"Rapprochement en cours...":"Lancer le rapprochement"]})]}),J&&!o&&c.jsxs("div",{className:"mt-4 flex items-start gap-2 p-3 rounded-md bg-[var(--color-bg-elevated)] border border-red-500/30",children:[c.jsx(pu,{className:"w-5 h-5 text-red-400 mt-0.5 shrink-0"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-red-400",children:"Echec du rapprochement"}),c.jsx("p",{className:"text-sm text-red-400/80 mt-1",children:J})]})]}),d&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"mt-4 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-6 gap-3",children:[c.jsx(Nn,{label:"Matches auto",value:d.auto_matched}),c.jsx(Nn,{label:"En attente",value:d.pending_review}),c.jsx(Nn,{label:"Crees",value:d.auto_created}),c.jsx(Nn,{label:"Depuis cache",value:d.from_cache}),c.jsx(Nn,{label:"Erreurs",value:d.errors}),c.jsx(Nn,{label:"Cout estime",value:`${d.cost_estimate.toFixed(4)} `})]}),d.remaining>0&&c.jsxs("div",{className:"mt-3 flex items-center gap-2 p-3 rounded-md bg-[var(--color-bg-elevated)] border border-[var(--color-border-subtle)]",children:[c.jsx(pu,{className:"w-4 h-4 text-[#B8860B] shrink-0"}),c.jsxs("p",{className:"text-sm text-[var(--color-text-primary)]",children:[d.remaining," produit",d.remaining>1?"s":""," restant",d.remaining>1?"s":""," a traiter. Relancez le rapprochement pour continuer."]})]}),d.errors>0&&d.error_message&&c.jsxs("div",{className:"mt-3 flex items-start gap-2 p-3 rounded-md bg-[var(--color-bg-elevated)] border border-red-500/30",children:[c.jsx(pu,{className:"w-4 h-4 text-red-400 mt-0.5 shrink-0"}),c.jsx("p",{className:"text-sm text-red-400",children:d.error_message})]})]})]}),I&&c.jsxs("div",{className:"card",children:[c.jsx("h3",{className:"text-sm font-semibold text-[var(--color-text-heading)] mb-3",children:"Statistiques"}),c.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[c.jsx(Nn,{label:"En cache",value:I.total_cached}),c.jsx(Nn,{label:"En attente",value:I.total_pending}),c.jsx(Nn,{label:"Auto-matches",value:I.total_auto_matched}),c.jsx(Nn,{label:"Taux de cache",value:`${I.cache_hit_rate}%`})]})]}),c.jsxs("div",{className:"card overflow-hidden",children:[c.jsxs("div",{className:"p-4 flex items-center justify-between",children:[c.jsxs("h3",{className:"text-sm font-semibold text-[var(--color-text-heading)]",children:["Matchs en attente (",E,")"]}),K>1&&c.jsxs("div",{className:"flex items-center gap-2 text-sm text-[var(--color-text-muted)]",children:[c.jsx("button",{type:"button",disabled:g<=1,onClick:()=>_(ne=>ne-1),className:"p-1 rounded hover:bg-[var(--color-bg-elevated)] disabled:opacity-30",children:c.jsx(Uu,{className:"w-4 h-4"})}),c.jsxs("span",{children:[g," / ",K]}),c.jsx("button",{type:"button",disabled:g>=K,onClick:()=>_(ne=>ne+1),className:"p-1 rounded hover:bg-[var(--color-bg-elevated)] disabled:opacity-30",children:c.jsx(Ii,{className:"w-4 h-4"})})]})]}),de?c.jsx("div",{className:"p-8 flex justify-center",children:c.jsx(An,{className:"w-6 h-6 animate-spin text-[var(--color-text-muted)]"})}):w.length===0?c.jsx("div",{className:"p-8 text-center text-sm text-[var(--color-text-muted)]",children:"Aucun match en attente de validation."}):c.jsx("div",{className:"divide-y divide-[var(--color-border-subtle)]",children:w.map(ne=>c.jsx(mg,{pm:ne,onValidate:L,onReject:X},ne.id))})]})]})}function Nn({label:e,value:r}){return c.jsxs("div",{className:"bg-[var(--color-bg-elevated)] rounded-md p-3 text-center",children:[c.jsx("div",{className:"text-lg font-bold text-[var(--color-text-heading)]",children:r}),c.jsx("div",{className:"text-xs text-[var(--color-text-muted)]",children:e})]})}function mg({pm:e,onValidate:r,onReject:t}){const s=e.extracted_attributes,i=[s.brand,s.model_family,s.storage,s.color,s.region].filter(Boolean);return c.jsxs("div",{className:"p-4 space-y-3",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-medium text-[var(--color-text-primary)]",children:e.source_label}),e.supplier_name&&c.jsx("div",{className:"text-xs text-[var(--color-text-muted)]",children:e.supplier_name})]}),c.jsx("div",{className:"flex flex-wrap gap-1.5",children:i.map((o,u)=>c.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-md text-xs font-medium bg-[var(--color-bg-elevated)] text-[var(--color-text-secondary)] border border-[var(--color-border-subtle)]",children:o},u))}),e.candidates.length>0&&c.jsx("div",{className:"space-y-1.5",children:e.candidates.map((o,u)=>c.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[c.jsxs("div",{className:"flex items-center gap-2 min-w-[120px]",children:[c.jsx("div",{className:"w-16 h-2 rounded-full bg-[var(--color-bg-elevated)] overflow-hidden",children:c.jsx("div",{className:"h-full rounded-full bg-[#B8860B]",style:{width:`${o.score}%`}})}),c.jsxs("span",{className:"text-xs text-[var(--color-text-muted)] w-8",children:[o.score,"%"]})]}),c.jsx("span",{className:"text-[var(--color-text-primary)] flex-1 truncate",children:o.product_name}),c.jsxs("button",{type:"button",onClick:()=>r(e,o),className:"btn btn-primary text-xs py-1 px-2 flex items-center gap-1",title:"Valider ce match",children:[c.jsx(Xm,{className:"w-3 h-3"}),"Valider"]})]},u))}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("button",{type:"button",onClick:()=>t(e,!0),className:"btn btn-secondary text-xs py-1 px-2 flex items-center gap-1",children:[c.jsx(Ua,{className:"w-3 h-3"}),"Creer produit"]}),c.jsxs("button",{type:"button",onClick:()=>t(e,!1),className:"btn btn-secondary text-xs py-1 px-2 flex items-center gap-1",children:[c.jsx(tp,{className:"w-3 h-3"}),"Ignorer"]})]})]})}const vg=[{label:"15 min",value:15},{label:"1 heure",value:60},{label:"6 heures",value:360},{label:"12 heures",value:720},{label:"24 heures",value:1440}];function gg(e,r){if(!e||!r)return"-";const t=new Date(r).getTime()-new Date(e).getTime();if(t<1e3)return`${t}ms`;const s=Math.floor(t/1e3);if(s<60)return`${s}s`;const i=Math.floor(s/60),o=s%60;return`${i}min ${o}s`}function yg(e){return e?new Date(e).toLocaleString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-"}function wg(){const e=Fn(),[r,t]=H.useState(null),[s,i]=H.useState({url:"",database:"",login:"",password:""}),[o,u]=H.useState(!1),[d,x]=H.useState(!1),[p,m]=H.useState(!1),[w,y]=H.useState(null),[E,N]=H.useState(!1),[g,_]=H.useState(null),[b,I]=H.useState(!1),[O,J]=H.useState(1440),[he,de]=H.useState([]),[z,re]=H.useState(null),[V,M]=H.useState(null);H.useEffect(()=>{$v().then(R=>{t(R),R.configured&&(i({url:R.url||"",database:R.database||"",login:R.login||"",password:R.password||""}),I(R.auto_sync_enabled||!1),J(R.auto_sync_interval_minutes||1440))}).catch(()=>t({configured:!1})),L()},[]);const L=()=>{Xv(20).then(de).catch(()=>de([]))},X=async()=>{u(!0);try{await Hv(s),e("Configuration sauvegarde","success"),t({...r,configured:!0,...s}),y(null)}catch(R){e(R.message||"Erreur de sauvegarde","error")}finally{u(!1)}},K=async()=>{m(!0),y(null);try{const R=await Vv();y({version:R.server_version,count:R.product_count}),e("Connexion russie","success")}catch(R){e(R.message||"chec de la connexion","error")}finally{m(!1)}},ne=async()=>{N(!0),_(null);try{const{job_id:R}=await Gv();e("Synchronisation lance","success");const ve=async()=>{try{const ye=await Jd(R);if(ye.status==="running")setTimeout(ve,3e3);else if(_(ye),N(!1),L(),ye.status==="success"){const Y=[`${ye.created_count} crs`,`${ye.updated_count} mis  jour`];ye.deleted_count>0&&Y.push(`${ye.deleted_count} supprims`),e(`Synchronisation termine : ${Y.join(", ")}`,"success")}else e(ye.error_message||"Synchronisation choue","error")}catch{N(!1)}};setTimeout(ve,3e3)}catch(R){e(R.message||"Erreur de synchronisation","error"),N(!1)}},W=async()=>{const R=!b;try{await Zd({enabled:R,interval_minutes:O}),I(R),e(R?"Synchronisation automatique active":"Synchronisation automatique dsactive","success")}catch(ve){e(ve.message||"Erreur","error")}},Z=async R=>{if(J(R),b)try{await Zd({interval_minutes:R})}catch(ve){e(ve.message||"Erreur","error")}},me=async R=>{if(z===R){re(null),M(null);return}re(R);try{const ve=await Jd(R);M(ve)}catch{M(null)}};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"card",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[c.jsx(ro,{className:"w-5 h-5 text-[#B8860B]"}),c.jsx("h2",{className:"text-lg font-semibold text-[var(--color-text-heading)]",children:"Configuration Odoo"})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-[var(--color-text-secondary)] mb-1",children:"URL Odoo"}),c.jsx("input",{type:"url",className:"w-full px-3 py-2 rounded-md border border-[var(--color-border-default)] bg-[var(--color-bg-input)] text-[var(--color-text-primary)] text-sm",placeholder:"https://odoo.monentreprise.fr",value:s.url,onChange:R=>i({...s,url:R.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-[var(--color-text-secondary)] mb-1",children:"Base de donnes"}),c.jsx("input",{type:"text",className:"w-full px-3 py-2 rounded-md border border-[var(--color-border-default)] bg-[var(--color-bg-input)] text-[var(--color-text-primary)] text-sm",placeholder:"nom_base",value:s.database,onChange:R=>i({...s,database:R.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-[var(--color-text-secondary)] mb-1",children:"Identifiant"}),c.jsx("input",{type:"text",className:"w-full px-3 py-2 rounded-md border border-[var(--color-border-default)] bg-[var(--color-bg-input)] text-[var(--color-text-primary)] text-sm",placeholder:"admin",value:s.login,onChange:R=>i({...s,login:R.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-[var(--color-text-secondary)] mb-1",children:"Mot de passe"}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:d?"text":"password",className:"w-full px-3 pr-10 py-2 rounded-md border border-[var(--color-border-default)] bg-[var(--color-bg-input)] text-[var(--color-text-primary)] text-sm",placeholder:"",value:s.password,onChange:R=>i({...s,password:R.target.value})}),c.jsx("button",{type:"button",onClick:()=>x(!d),className:"absolute right-3 top-1/2 -translate-y-1/2 text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)] transition-colors",children:d?c.jsx(Qh,{className:"w-4 h-4"}):c.jsx(Jh,{className:"w-4 h-4"})})]})]})]}),c.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-4",children:[c.jsxs("button",{type:"button",className:"btn btn-primary",onClick:X,disabled:o||!s.url||!s.database||!s.login,children:[o?c.jsx(An,{className:"w-4 h-4 animate-spin mr-2"}):null,"Enregistrer"]}),c.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:K,disabled:p||!r?.configured,children:[p?c.jsx(An,{className:"w-4 h-4 animate-spin mr-2"}):c.jsx(uv,{className:"w-4 h-4 mr-2"}),"Tester la connexion"]})]}),w&&c.jsxs("div",{className:"mt-3 flex items-center gap-3 text-sm text-[var(--color-text-secondary)]",children:[c.jsx(Xd,{className:"w-4 h-4 text-green-500"}),c.jsxs("span",{children:["Serveur Odoo ",c.jsx("strong",{children:w.version}),"  ",w.count," produits actifs"]})]}),r?.configured&&c.jsx("div",{className:"mt-5 pt-4 border-t border-[var(--color-border-subtle)]",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[c.jsx("input",{type:"checkbox",checked:b,onChange:W,className:"w-4 h-4 rounded accent-[#B8860B]"}),c.jsx("span",{className:"text-sm font-medium text-[var(--color-text-secondary)]",children:"Synchronisation automatique"})]}),c.jsx("select",{className:"px-2 py-1 rounded-md border border-[var(--color-border-default)] bg-[var(--color-bg-input)] text-sm text-[var(--color-text-primary)]",value:O,onChange:R=>Z(Number(R.target.value)),disabled:!b,children:vg.map(R=>c.jsx("option",{value:R.value,children:R.label},R.value))})]})})]}),c.jsxs("div",{className:"card",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[c.jsx(qm,{className:"w-5 h-5 text-[#B8860B]"}),c.jsx("h2",{className:"text-lg font-semibold text-[var(--color-text-heading)]",children:"Synchronisation"})]}),c.jsxs("button",{type:"button",className:"btn btn-primary",onClick:ne,disabled:E||!r?.configured,children:[E?c.jsx(An,{className:"w-4 h-4 animate-spin mr-2"}):c.jsx(Zh,{className:"w-4 h-4 mr-2"}),E?"Synchronisation en cours...":"Lancer la synchronisation Odoo"]}),g&&c.jsxs("div",{className:"mt-4 grid grid-cols-2 sm:grid-cols-5 gap-3",children:[c.jsxs("div",{className:"text-center p-3 rounded-lg bg-green-500/10",children:[c.jsx("div",{className:"text-2xl font-bold text-green-500",children:g.created_count}),c.jsx("div",{className:"text-xs text-[var(--color-text-muted)]",children:"Crs"})]}),c.jsxs("div",{className:"text-center p-3 rounded-lg bg-blue-500/10",children:[c.jsx("div",{className:"text-2xl font-bold text-blue-400",children:g.updated_count}),c.jsx("div",{className:"text-xs text-[var(--color-text-muted)]",children:"Mis  jour"})]}),c.jsxs("div",{className:"text-center p-3 rounded-lg bg-[var(--color-bg-elevated)]",children:[c.jsx("div",{className:"text-2xl font-bold text-[var(--color-text-muted)]",children:g.unchanged_count}),c.jsx("div",{className:"text-xs text-[var(--color-text-muted)]",children:"Inchangs"})]}),c.jsxs("div",{className:"text-center p-3 rounded-lg bg-orange-500/10",children:[c.jsx("div",{className:"text-2xl font-bold text-orange-400",children:g.deleted_count}),c.jsx("div",{className:"text-xs text-[var(--color-text-muted)]",children:"Supprims"})]}),c.jsxs("div",{className:"text-center p-3 rounded-lg bg-red-500/10",children:[c.jsx("div",{className:"text-2xl font-bold text-red-400",children:g.error_count}),c.jsx("div",{className:"text-xs text-[var(--color-text-muted)]",children:"Erreurs"})]})]})]}),c.jsxs("div",{className:"card",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[c.jsx(Ym,{className:"w-5 h-5 text-[#B8860B]"}),c.jsx("h2",{className:"text-lg font-semibold text-[var(--color-text-heading)]",children:"Historique des synchronisations"})]}),he.length===0?c.jsx("p",{className:"text-sm text-[var(--color-text-muted)]",children:"Aucune synchronisation effectue."}):c.jsx("div",{className:"divide-y divide-[var(--color-border-subtle)]",children:he.map(R=>c.jsxs("div",{children:[c.jsxs("button",{type:"button",className:"w-full flex items-center justify-between py-3 text-left hover:bg-[var(--color-bg-elevated)] transition-colors px-2 rounded-md",onClick:()=>me(R.id),children:[c.jsxs("div",{className:"flex items-center gap-3",children:[R.status==="success"?c.jsx(Xd,{className:"w-4 h-4 text-green-500 flex-shrink-0"}):R.status==="running"?c.jsx(An,{className:"w-4 h-4 text-[#B8860B] animate-spin flex-shrink-0"}):c.jsx(Km,{className:"w-4 h-4 text-red-400 flex-shrink-0"}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm text-[var(--color-text-primary)]",children:yg(R.started_at)}),c.jsxs("span",{className:"text-xs text-[var(--color-text-muted)] ml-2",children:["(",R.trigger==="auto"?"auto":"manuel",")"]})]})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[R.status==="success"&&c.jsxs(c.Fragment,{children:[c.jsxs("span",{className:"text-green-500",children:[R.created_count," crs"]}),c.jsxs("span",{className:"text-blue-400",children:[R.updated_count," MAJ"]}),c.jsxs("span",{className:"text-[var(--color-text-muted)]",children:[R.unchanged_count," id."]}),R.deleted_count>0&&c.jsxs("span",{className:"text-orange-400",children:[R.deleted_count," suppr."]}),R.error_count>0&&c.jsxs("span",{className:"text-red-400",children:[R.error_count," err."]})]}),R.status==="running"&&c.jsx("span",{className:"text-[#B8860B]",children:"En cours..."}),R.status==="failed"&&c.jsx("span",{className:"text-red-400",children:"chec"})]}),c.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:gg(R.started_at,R.ended_at)}),z===R.id?c.jsx(Bu,{className:"w-4 h-4 text-[var(--color-text-muted)]"}):c.jsx(Ii,{className:"w-4 h-4 text-[var(--color-text-muted)]"})]})]}),z===R.id&&V&&c.jsxs("div",{className:"px-4 pb-4 space-y-3",children:[V.error_message&&c.jsx("div",{className:"p-2 rounded-md bg-[var(--color-bg-elevated)] border border-red-500/30 text-red-400 text-sm",children:V.error_message}),c.jsxs("div",{className:"text-xs text-[var(--color-text-muted)]",children:["Total produits Odoo : ",V.total_odoo_products]}),V.report_created&&V.report_created.length>0&&c.jsx(Xl,{title:"Produits crs",items:V.report_created,color:"text-green-500"}),V.report_updated&&V.report_updated.length>0&&c.jsx(Xl,{title:"Produits mis  jour",items:V.report_updated,color:"text-blue-400"}),V.report_deleted&&V.report_deleted.length>0&&c.jsx(Xl,{title:"Produits supprims",items:V.report_deleted,color:"text-orange-400"}),V.report_errors&&V.report_errors.length>0&&c.jsx(Xl,{title:"Erreurs",items:V.report_errors,color:"text-red-400"})]})]},R.id))})]})]})}function Xl({title:e,items:r,color:t}){const[s,i]=H.useState(!1);return c.jsxs("div",{children:[c.jsxs("button",{type:"button",className:`text-xs font-medium ${t} flex items-center gap-1`,onClick:()=>i(!s),children:[s?c.jsx(Bu,{className:"w-3 h-3"}):c.jsx(Ii,{className:"w-3 h-3"}),e," (",r.length,")"]}),s&&c.jsx("div",{className:"mt-1 max-h-48 overflow-y-auto text-xs space-y-0.5",children:r.map((o,u)=>c.jsxs("div",{className:"flex gap-2 text-[var(--color-text-secondary)] py-0.5",children:[c.jsxs("span",{className:"text-[var(--color-text-muted)] w-12 flex-shrink-0",children:["#",o.odoo_id]}),c.jsx("span",{className:"truncate",children:o.name}),o.ean&&c.jsx("span",{className:"text-[var(--color-text-muted)] flex-shrink-0",children:o.ean}),o.error&&c.jsx("span",{className:"text-red-400 flex-shrink-0",children:o.error})]},u))})]})}function ah(e){if(!e)return"Non renseign";const r=e.field_count??0,t=r>1?"champs":"champ",s=e.is_active?"":" (inactif)";return`v${e.version}  ${r} ${t}${s}`}function _g(e,r){return(e.items??e.rows??[]).map(s=>({supplier_id:e.supplier_id,supplier:e.supplier||r,description:s.description??s.model??"",quantity:s.quantity??0,selling_price:s.selling_price??0,ean:s.ean??null,part_number:s.part_number??null,supplier_sku:s.supplier_sku??null}))}function Eg(){const[e,r]=H.useState([]),[t,s]=H.useState(null),[i,o]=H.useState([]),[u,d]=H.useState({}),[x,p]=H.useState(null),m=Fn();H.useEffect(()=>{_o().then(g=>r(Array.isArray(g)?g:[])).catch(()=>r([]))},[]);const w=H.useMemo(()=>{const g=e.map(_=>[_.id,_.name]);return Object.fromEntries(g)},[e]),y=async g=>{s(g),p(null);try{const _=await xv(g),b=w[g]||_.supplier||"Fournisseur",I=_g(_,b);o(he=>[...he.filter(z=>z.supplier_id!==g),...I]),d(he=>({...he,[g]:_.mapping??null}));const O=_.temporary_import_count??_.items?.length??_.rows?.length??I.length,J=ah(_.mapping??null);m(`Synchronisation russie pour ${b} (${O} articles)  Mapping ${J}`,"success")}catch(_){const b=_ instanceof Error?_.message:"Impossible de contacter l'API fournisseur";p(b),m(b,"error")}finally{s(null)}},E=i.length>0,N=H.useMemo(()=>{const g=new Map;return i.forEach(_=>{const b=g.get(_.supplier_id);b?b.items.push(_):g.set(_.supplier_id,{supplier:_.supplier,items:[_],mapping:u[_.supplier_id]??null})}),Array.from(g.entries()).map(([_,b])=>({supplier_id:_,supplier:b.supplier,items:b.items,mapping:b.mapping??u[_]??null}))},[i,u]);return c.jsx("section",{className:"mt-6",children:c.jsxs("div",{className:"card",children:[c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6",children:[c.jsxs("div",{children:[c.jsxs("h2",{className:"text-2xl font-semibold flex items-center gap-2",children:[c.jsx(lv,{className:"w-6 h-6 text-[#B8860B]"}),"Synchronisation des fournisseurs"]}),c.jsx("p",{className:"text-sm text-[var(--color-text-muted)] mt-1",children:"Rcuprez les prix et quantits en temps rel depuis les APIs fournisseurs pour alimenter la table temporaire."})]}),E&&c.jsxs("button",{onClick:()=>{o([]),d({})},className:"btn btn-secondary flex items-center gap-2",children:[c.jsx(za,{className:"w-4 h-4"}),"Vider la table"]})]}),c.jsx("div",{className:"flex flex-wrap gap-3",children:e.map(g=>c.jsxs("button",{onClick:()=>y(g.id),disabled:t===g.id,className:`btn px-4 py-2 flex items-center gap-2 ${t===g.id?"opacity-70 cursor-wait":""}`,children:[t===g.id?c.jsx(An,{className:"w-4 h-4 animate-spin"}):c.jsx(ep,{className:"w-4 h-4"}),c.jsxs("span",{className:"text-left",children:["Lancer synchronisation donne ",g.name]})]},g.id))}),x&&c.jsxs("div",{className:"mt-6 p-4 rounded-md border border-red-500/30 bg-red-500/10 text-sm text-red-300 flex items-center gap-2",children:[c.jsx(zu,{className:"w-5 h-5"}),c.jsx("span",{children:x})]}),c.jsx("div",{className:"mt-8",children:E?c.jsx("div",{className:"space-y-6",children:N.map(({supplier_id:g,supplier:_,items:b,mapping:I})=>c.jsxs("div",{className:"border border-[var(--color-border-subtle)] rounded-md bg-[var(--color-bg-subtle)] divide-y divide-[var(--color-border-subtle)]",children:[c.jsxs("div",{className:"px-5 py-4 flex flex-wrap items-center justify-between gap-3",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-[var(--color-text-muted)] uppercase tracking-wide",children:"Fournisseur"}),c.jsx("h3",{className:"text-lg font-semibold text-[var(--color-text-heading)]",children:_})]}),c.jsxs("div",{className:"text-sm text-[var(--color-text-muted)] text-right space-y-1",children:[c.jsxs("p",{children:[b.length," article",b.length>1?"s":""]}),c.jsxs("p",{children:["Mapping :"," ",c.jsx("span",{className:"font-medium text-[var(--color-text-secondary)]",children:ah(I)})]})]})]}),c.jsx("div",{className:"p-5 space-y-4",children:b.map((O,J)=>c.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between bg-[var(--color-bg-faint)] rounded-md p-4",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx("p",{className:"text-base font-medium text-[var(--color-text-heading)]",children:O.description||""}),c.jsxs("div",{className:"text-sm text-[var(--color-text-muted)] flex flex-wrap gap-3",children:[c.jsxs("span",{children:["EAN : ",O.ean||""]}),c.jsxs("span",{children:["Part Number : ",O.part_number||""]}),c.jsxs("span",{children:["SKU fournisseur : ",O.supplier_sku||""]})]})]}),c.jsxs("div",{className:"text-sm text-[var(--color-text-secondary)] text-right space-y-1 min-w-[120px]",children:[c.jsxs("p",{className:"text-lg font-semibold text-[var(--color-text-primary)]",children:[(O.selling_price??0).toLocaleString("fr-FR",{minimumFractionDigits:2,maximumFractionDigits:2})," ",""]}),c.jsxs("p",{children:["Quantit : ",O.quantity??0]})]})]},`${O.supplier_id}-${O.ean??O.part_number??O.supplier_sku??J}`))})]},g))}):c.jsx("div",{className:"px-4 py-6 text-center text-sm text-[var(--color-text-muted)] border border-dashed border-[var(--color-border-subtle)] rounded-md",children:"Aucune donne temporaire. Lancez une synchronisation pour remplir la table."})})]})})}function Sg(e){if(!e)return"Non renseign";const r=e.field_count??0,t=r>1?"champs":"champ",s=e.is_active?"":" (inactif)";return`v${e.version}  ${r} ${t}${s}`}function mu(e){if(!e)return"";const r=new Date(e);return Number.isNaN(r.getTime())?"":new Intl.DateTimeFormat("fr-FR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).format(r)}function vu({title:e,items:r,emptyMessage:t,showPrice:s}){return c.jsxs("div",{className:"p-5 rounded-md bg-[var(--color-bg-subtle)] border border-[var(--color-border-subtle)]",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h4",{className:"text-sm font-semibold text-[var(--color-text-secondary)] uppercase tracking-wide",children:e}),c.jsxs("span",{className:"text-xs text-[var(--color-text-muted)]",children:[r.length," lment",r.length>1?"s":""]})]}),r.length===0?c.jsx("p",{className:"text-sm text-[var(--color-text-muted)]",children:t}):c.jsx("ul",{className:"space-y-3 max-h-80 overflow-y-auto pr-2",children:r.map((i,o)=>{const u=i.product_id??`${i.ean||""}-${i.part_number||""}-${o}`,d=i.product_name||i.description||i.part_number||i.ean||`Entre ${o+1}`;return c.jsxs("li",{className:"flex items-start justify-between gap-4 border border-[var(--color-border-subtle)] rounded-md px-3 py-2 bg-[var(--color-bg-faint)]",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-sm font-medium text-[var(--color-text-heading)] truncate",title:d,children:d}),c.jsxs("div",{className:"text-xs text-[var(--color-text-muted)] space-x-2 mt-1",children:[i.ean?c.jsxs("span",{children:["EAN : ",i.ean]}):null,i.part_number?c.jsxs("span",{children:["Rf : ",i.part_number]}):null,i.supplier_sku?c.jsxs("span",{children:["SKU fournisseur : ",i.supplier_sku]}):null]}),i.reason?c.jsx("p",{className:"text-xs text-[var(--color-text-muted)] mt-2 leading-relaxed whitespace-pre-line",children:i.reason}):null]}),s&&i.price!=null?c.jsxs("span",{className:"text-sm font-semibold text-[var(--color-text-primary)] min-w-[80px] text-right",children:[i.price.toLocaleString("fr-FR",{minimumFractionDigits:2,maximumFractionDigits:2})," ",""]}):null]},u||`entry-${o}`)})})]})}function Tg({items:e}){const[r,t]=H.useState(!1),s=H.useMemo(()=>Array.isArray(e)?e:[],[e]),i=H.useMemo(()=>r?s:s.slice(0,3),[s,r]);return c.jsxs("div",{className:"p-5 rounded-md bg-[var(--color-bg-subtle)] border border-[var(--color-border-subtle)]",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h4",{className:"text-sm font-semibold text-[var(--color-text-secondary)] uppercase tracking-wide",children:"Donnes brutes de l'API"}),c.jsxs("span",{className:"text-xs text-[var(--color-text-muted)]",children:[s.length," lment",s.length>1?"s":""]})]}),s.length===0?c.jsx("p",{className:"text-sm text-[var(--color-text-muted)]",children:"Aucun chantillon de donnes brutes n'a t enregistr pour cette synchronisation."}):c.jsxs("div",{className:"space-y-3",children:[c.jsx("pre",{className:"text-xs text-left text-[var(--color-text-secondary)] bg-[var(--color-bg-subtle)] border border-[var(--color-border-subtle)] rounded-md p-4 overflow-x-auto whitespace-pre-wrap break-words max-h-80",children:i.map(o=>JSON.stringify(o,null,2)).join(`

`)}),s.length>3?c.jsx("button",{type:"button",onClick:()=>t(o=>!o),className:"text-xs font-medium text-[#B8860B] hover:underline",children:r?"Rduire l'aperu":"Afficher toutes les donnes brutes"}):null]})]})}function Ng(){const[e,r]=H.useState([]),[t,s]=H.useState(!1),[i,o]=H.useState(null),[u,d]=H.useState([]),x=H.useCallback(y=>{d(E=>E.includes(y)?E.filter(N=>N!==y):[...E,y])},[]),p=H.useCallback(async()=>{s(!0),o(null);try{const y=await mv();r(Array.isArray(y)?y:[])}catch(y){const E=y instanceof Error?y.message:"Impossible de charger les rapports de synchronisation.";o(E)}finally{s(!1)}},[]);H.useEffect(()=>{p()},[p]);const m=e.length>0,w=H.useMemo(()=>{if(!m)return"Consultez ici les rsultats dtaills de chaque synchronisation effectue.";const[y]=e;return y?.started_at?`Dernire mise  jour : ${mu(y.started_at)}`:"Historique des synchronisations API fournisseurs."},[m,e]);return c.jsx("section",{className:"mt-6",children:c.jsxs("div",{className:"card",children:[c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6",children:[c.jsxs("div",{children:[c.jsxs("h2",{className:"text-2xl font-semibold flex items-center gap-2",children:[c.jsx(Qm,{className:"w-6 h-6 text-[#B8860B]"}),"Rapports de synchronisation"]}),c.jsx("p",{className:"text-sm text-[var(--color-text-muted)] mt-1",children:w})]}),c.jsxs("button",{onClick:p,disabled:t,className:`btn btn-secondary flex items-center gap-2 ${t?"opacity-70 cursor-wait":""}`,children:[t?c.jsx(An,{className:"w-4 h-4 animate-spin"}):c.jsx(ep,{className:"w-4 h-4"}),"Actualiser"]})]}),i?c.jsxs("div",{className:"p-4 rounded-md border border-red-500/30 bg-red-500/10 text-sm text-red-300 flex items-center gap-2 mb-6",children:[c.jsx(zu,{className:"w-5 h-5"}),c.jsx("span",{children:i})]}):null,t&&!m?c.jsxs("div",{className:"py-20 text-center text-sm text-[var(--color-text-muted)] flex flex-col items-center gap-3",children:[c.jsx(An,{className:"w-5 h-5 animate-spin text-[#B8860B]"}),c.jsx("span",{children:"Chargement des rapports..."})]}):null,!t&&!m?c.jsx("div",{className:"py-20 text-center text-sm text-[var(--color-text-muted)]",children:"Aucun rapport n'est disponible pour le moment. Lancez une synchronisation pour gnrer un premier rapport."}):null,c.jsx("div",{className:"space-y-6",children:e.map(y=>{const E=u.includes(y.job_id),N=[{title:"Produits mis  jour",count:y.updated_products.length,highlight:!0},{title:"Produits base non trouvs",count:y.database_missing_products.length},{title:"Produits API non appairs",count:y.api_missing_products.length}];return c.jsxs("div",{className:"border border-[var(--color-border-subtle)] rounded-md bg-[var(--color-bg-subtle)] px-6 py-5",children:[c.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-start md:justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-zinc-500 uppercase tracking-wide",children:"Fournisseur"}),c.jsx("h3",{className:"text-lg font-semibold text-[var(--color-text-heading)]",children:y.supplier||"Fournisseur"}),c.jsx("div",{className:"mt-3 grid gap-3 sm:grid-cols-3",children:N.map(g=>c.jsxs("div",{className:"rounded-md border border-[var(--color-border-subtle)] bg-[var(--color-bg-faint)] px-3 py-2",children:[c.jsx("p",{className:"text-[11px] uppercase tracking-wide text-zinc-500",children:g.title}),c.jsx("p",{className:`text-lg font-semibold ${g.highlight?"text-[var(--color-text-heading)]":"text-[var(--color-text-secondary)]"}`,children:g.count})]},g.title))})]}),c.jsxs("div",{className:"flex flex-col items-start gap-4 md:items-end",children:[c.jsxs("div",{className:"text-xs text-[var(--color-text-muted)] space-y-1 md:text-right",children:[c.jsxs("p",{children:["Dbut :"," ",c.jsx("span",{className:"font-medium text-[var(--color-text-secondary)]",children:mu(y.started_at)})]}),c.jsxs("p",{children:["Fin :"," ",c.jsx("span",{className:"font-medium text-[var(--color-text-secondary)]",children:mu(y.ended_at)})]}),c.jsxs("p",{children:["Mapping :"," ",c.jsx("span",{className:"font-medium text-[var(--color-text-secondary)]",children:Sg(y.mapping??null)})]})]}),c.jsx("button",{type:"button",onClick:()=>x(y.job_id),"aria-expanded":E,className:"btn btn-secondary text-xs",children:E?"Masquer le dtail":"Afficher le dtail"})]})]}),E?c.jsxs("div",{className:"mt-6 space-y-5",children:[c.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[c.jsx(vu,{title:"Produits mis  jour",items:y.updated_products,emptyMessage:"Aucun produit mis  jour lors de cette synchronisation.",showPrice:!0}),c.jsx(vu,{title:"Produits base non trouvs",items:y.database_missing_products,emptyMessage:"Tous les produits lis ont t retrouvs dans l'API."}),c.jsx(vu,{title:"Produits API non appairs",items:y.api_missing_products,emptyMessage:"Tous les articles de l'API ont t associs  la base produits."})]}),c.jsx(Tg,{items:y.api_raw_items})]}):null]},y.job_id)})})]})})}function sh(){const[e,r]=H.useState("odoo");return c.jsxs("div",{children:[c.jsxs("div",{className:"mb-8",children:[c.jsxs("h1",{className:"text-3xl font-semibold text-[var(--color-text-heading)] flex items-center gap-3",children:[c.jsx(Wu,{className:"w-8 h-8 text-[#B8860B]"}),"Synchronisation"]}),c.jsx("p",{className:"text-[var(--color-text-muted)] mt-1",children:"Synchronisez les donnes fournisseurs et consultez les rapports."})]}),c.jsx("div",{className:"border-b border-[var(--color-border-subtle)] mb-6",children:c.jsxs("nav",{className:"flex gap-4","aria-label":"Import navigation",children:[c.jsx("button",{type:"button",onClick:()=>r("odoo"),className:`px-2 pb-3 text-sm font-medium transition-colors border-b-2 ${e==="odoo"?"border-[#B8860B] text-[var(--color-text-heading)]":"border-transparent text-[var(--color-text-muted)] hover:text-[var(--color-text-secondary)]"}`,children:"Odoo"}),c.jsx("button",{type:"button",onClick:()=>r("matching"),className:`px-2 pb-3 text-sm font-medium transition-colors border-b-2 ${e==="matching"?"border-[#B8860B] text-[var(--color-text-heading)]":"border-transparent text-[var(--color-text-muted)] hover:text-[var(--color-text-secondary)]"}`,children:"Rapprochement"})]})}),e==="sync"&&c.jsx(Eg,{}),e==="report"&&c.jsx(Ng,{}),e==="odoo"&&c.jsx(wg,{}),e==="matching"&&c.jsx(xg,{})]})}function kg({onLogin:e}){const[r,t]=H.useState(""),[s,i]=H.useState(""),[o,u]=H.useState(!1),[d,x]=H.useState(!1),p=Fn(),m=async w=>{w.preventDefault(),u(!0);try{const y=await hv(r,s);e(y.role,y.token,y.refresh_token)}catch(y){p(y.message||"Erreur de connexion","error")}finally{u(!1)}};return c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[var(--color-bg-surface)] text-[var(--color-text-primary)] px-4",children:c.jsxs("div",{className:"w-full max-w-sm",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("span",{className:"text-3xl font-bold tracking-tight text-[#B8860B]",children:"AJT Pro"}),c.jsx("p",{className:"text-sm text-[var(--color-text-muted)] mt-2",children:"Connectez-vous pour accder  votre espace"})]}),c.jsxs("form",{onSubmit:m,className:"card space-y-5",children:[c.jsx("h2",{className:"text-lg font-semibold text-[var(--color-text-heading)] text-center",children:"Connexion"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-medium text-[var(--color-text-muted)] mb-1.5",children:"Email"}),c.jsxs("div",{className:"relative",children:[c.jsx(rv,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-muted)]"}),c.jsx("input",{type:"email",placeholder:"votre@email.com",value:r,onChange:w=>t(w.target.value),required:!0,className:"w-full pl-10 pr-3 py-2.5 bg-[var(--color-bg-input)] border border-[var(--color-border-strong)] rounded-md text-sm text-[var(--color-text-primary)] placeholder:text-[var(--color-text-muted)] focus:border-[#B8860B] focus:outline-none transition-colors"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-medium text-[var(--color-text-muted)] mb-1.5",children:"Mot de passe"}),c.jsxs("div",{className:"relative",children:[c.jsx(ev,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-muted)]"}),c.jsx("input",{type:d?"text":"password",placeholder:"Votre mot de passe",value:s,onChange:w=>i(w.target.value),required:!0,className:"w-full pl-10 pr-10 py-2.5 bg-[var(--color-bg-input)] border border-[var(--color-border-strong)] rounded-md text-sm text-[var(--color-text-primary)] placeholder:text-[var(--color-text-muted)] focus:border-[#B8860B] focus:outline-none transition-colors"}),c.jsx("button",{type:"button",onClick:()=>x(!d),className:"absolute right-3 top-1/2 -translate-y-1/2 text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)] transition-colors",children:d?c.jsx(Qh,{className:"w-4 h-4"}):c.jsx(Jh,{className:"w-4 h-4"})})]})]})]}),c.jsx("button",{type:"submit",disabled:o,className:"btn btn-primary w-full text-sm",children:o?"Connexion...":"Se connecter"})]})]})})}var ao={};ao.version="0.18.5";var dp=1252,Cg=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],hp=function(e){Cg.indexOf(e)!=-1&&(dp=e)};function Ag(){hp(1252)}var bi=function(e){hp(e)};function bg(){bi(1200),Ag()}var Kl=function(r){return String.fromCharCode(r)},ih=function(r){return String.fromCharCode(r)},so,ma="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Fi(e){for(var r="",t=0,s=0,i=0,o=0,u=0,d=0,x=0,p=0;p<e.length;)t=e.charCodeAt(p++),o=t>>2,s=e.charCodeAt(p++),u=(t&3)<<4|s>>4,i=e.charCodeAt(p++),d=(s&15)<<2|i>>6,x=i&63,isNaN(s)?d=x=64:isNaN(i)&&(x=64),r+=ma.charAt(o)+ma.charAt(u)+ma.charAt(d)+ma.charAt(x);return r}function Vn(e){var r="",t=0,s=0,i=0,o=0,u=0,d=0,x=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var p=0;p<e.length;)o=ma.indexOf(e.charAt(p++)),u=ma.indexOf(e.charAt(p++)),t=o<<2|u>>4,r+=String.fromCharCode(t),d=ma.indexOf(e.charAt(p++)),s=(u&15)<<4|d>>2,d!==64&&(r+=String.fromCharCode(s)),x=ma.indexOf(e.charAt(p++)),i=(d&3)<<6|x,x!==64&&(r+=String.fromCharCode(i));return r}var vt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Xn=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}})();function $a(e){return vt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function lh(e){return vt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var xn=function(r){return vt?Xn(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function Eo(e){if(typeof ArrayBuffer>"u")return xn(e);for(var r=new ArrayBuffer(e.length),t=new Uint8Array(r),s=0;s!=e.length;++s)t[s]=e.charCodeAt(s)&255;return r}function Mi(e){if(Array.isArray(e))return e.map(function(s){return String.fromCharCode(s)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function Fg(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var fr=vt?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:Xn(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var s=new Uint8Array(t),i=0;for(r=0,t=0;r<e.length;t+=i,++r)if(i=e[r].length,e[r]instanceof Uint8Array)s.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";s.set(new Uint8Array(e[r]),t)}return s}return[].concat.apply([],e.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function jg(e){for(var r=[],t=0,s=e.length+250,i=$a(e.length+255),o=0;o<e.length;++o){var u=e.charCodeAt(o);if(u<128)i[t++]=u;else if(u<2048)i[t++]=192|u>>6&31,i[t++]=128|u&63;else if(u>=55296&&u<57344){u=(u&1023)+64;var d=e.charCodeAt(++o)&1023;i[t++]=240|u>>8&7,i[t++]=128|u>>2&63,i[t++]=128|d>>6&15|(u&3)<<4,i[t++]=128|d&63}else i[t++]=224|u>>12&15,i[t++]=128|u>>6&63,i[t++]=128|u&63;t>s&&(r.push(i.slice(0,t)),t=0,i=$a(65535),s=65530)}return r.push(i.slice(0,t)),fr(r)}var Si=/\u0000/g,Yl=/[\u0001-\u0006]/g;function As(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function mn(e,r){var t=""+e;return t.length>=r?t:Lt("0",r-t.length)+t}function Gu(e,r){var t=""+e;return t.length>=r?t:Lt(" ",r-t.length)+t}function io(e,r){var t=""+e;return t.length>=r?t:t+Lt(" ",r-t.length)}function Pg(e,r){var t=""+Math.round(e);return t.length>=r?t:Lt("0",r-t.length)+t}function Og(e,r){var t=""+e;return t.length>=r?t:Lt("0",r-t.length)+t}var oh=Math.pow(2,32);function _s(e,r){if(e>oh||e<-oh)return Pg(e,r);var t=Math.round(e);return Og(t,r)}function lo(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var ch=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],gu=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Rg(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Bt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},uh={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Dg={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function oo(e,r,t){for(var s=e<0?-1:1,i=e*s,o=0,u=1,d=0,x=1,p=0,m=0,w=Math.floor(i);p<r&&(w=Math.floor(i),d=w*u+o,m=w*p+x,!(i-w<5e-8));)i=1/(i-w),o=u,u=d,x=p,p=m;if(m>r&&(p>r?(m=x,d=o):(m=p,d=u)),!t)return[0,s*d,m];var y=Math.floor(s*d/m);return[y,s*d-y*m,m]}function ql(e,r,t){if(e>2958465||e<0)return null;var s=e|0,i=Math.floor(86400*(e-s)),o=0,u=[],d={D:s,T:i,u:86400*(e-s)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(d.u)<1e-6&&(d.u=0),r&&r.date1904&&(s+=1462),d.u>.9999&&(d.u=0,++i==86400&&(d.T=i=0,++s,++d.D)),s===60)u=t?[1317,10,29]:[1900,2,29],o=3;else if(s===0)u=t?[1317,8,29]:[1900,1,0],o=6;else{s>60&&--s;var x=new Date(1900,0,1);x.setDate(x.getDate()+s-1),u=[x.getFullYear(),x.getMonth()+1,x.getDate()],o=x.getDay(),s<60&&(o=(o+6)%7),t&&(o=Wg(x,u))}return d.y=u[0],d.m=u[1],d.d=u[2],d.S=i%60,i=Math.floor(i/60),d.M=i%60,i=Math.floor(i/60),d.H=i,d.q=o,d}var pp=new Date(1899,11,31,0,0,0),Ig=pp.getTime(),Mg=new Date(1900,2,1,0,0,0);function xp(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=Mg&&(t+=1440*60*1e3),(t-(Ig+(e.getTimezoneOffset()-pp.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Xu(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Lg(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Bg(e){var r=e<0?12:11,t=Xu(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function Ug(e){var r=Xu(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function zg(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=Bg(e):r===10?t=e.toFixed(10).substr(0,12):t=Ug(e),Xu(Lg(t.toUpperCase()))}function Ru(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):zg(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ga(14,xp(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function Wg(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function $g(e,r,t,s){var i="",o=0,u=0,d=t.y,x,p=0;switch(e){case 98:d=t.y+543;case 121:switch(r.length){case 1:case 2:x=d%100,p=2;break;default:x=d%1e4,p=4;break}break;case 109:switch(r.length){case 1:case 2:x=t.m,p=r.length;break;case 3:return gu[t.m-1][1];case 5:return gu[t.m-1][0];default:return gu[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:x=t.d,p=r.length;break;case 3:return ch[t.q][0];default:return ch[t.q][1]}break;case 104:switch(r.length){case 1:case 2:x=1+(t.H+11)%12,p=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:x=t.H,p=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:x=t.M,p=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?mn(t.S,r.length):(s>=2?u=s===3?1e3:100:u=s===1?10:1,o=Math.round(u*(t.S+t.u)),o>=60*u&&(o=0),r==="s"?o===0?"0":""+o/u:(i=mn(o,2+s),r==="ss"?i.substr(0,2):"."+i.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":x=t.D*24+t.H;break;case"[m]":case"[mm]":x=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":x=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}p=r.length===3?1:2;break;case 101:x=d,p=1;break}var m=p>0?mn(x,p):"";return m}function va(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,s=e.substr(0,t);t!=e.length;t+=r)s+=(s.length>0?",":"")+e.substr(t,r);return s}var mp=/%/g;function Hg(e,r,t){var s=r.replace(mp,""),i=r.length-s.length;return Wn(e,s,t*Math.pow(10,2*i))+Lt("%",i)}function Vg(e,r,t){for(var s=r.length-1;r.charCodeAt(s-1)===44;)--s;return Wn(e,r.substr(0,s),t/Math.pow(10,3*(r.length-s)))}function vp(e,r){var t,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+vp(e,-r);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%i;if(o<0&&(o+=i),t=(r/Math.pow(10,o)).toPrecision(s+1+(i+o)%i),t.indexOf("e")===-1){var u=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(u-t.length+o):t+="E+"+(u-o);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,x,p,m){return x+p+m.substr(0,(i+o)%i)+"."+m.substr(o)+"E"})}else t=r.toExponential(s);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var gp=/# (\?+)( ?)\/( ?)(\d+)/;function Gg(e,r,t){var s=parseInt(e[4],10),i=Math.round(r*s),o=Math.floor(i/s),u=i-o*s,d=s;return t+(o===0?"":""+o)+" "+(u===0?Lt(" ",e[1].length+1+e[4].length):Gu(u,e[1].length)+e[2]+"/"+e[3]+mn(d,e[4].length))}function Xg(e,r,t){return t+(r===0?"":""+r)+Lt(" ",e[1].length+2+e[4].length)}var yp=/^#*0*\.([0#]+)/,wp=/\).*[0#]/,_p=/\(###\) ###\\?-####/;function Nr(e){for(var r="",t,s=0;s!=e.length;++s)switch(t=e.charCodeAt(s)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function fh(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function dh(e,r){var t=e-Math.floor(e),s=Math.pow(10,r);return r<(""+Math.round(t*s)).length?0:Math.round(t*s)}function Kg(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function Yg(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Zr(e,r,t){if(e.charCodeAt(0)===40&&!r.match(wp)){var s=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Zr("n",s,t):"("+Zr("n",s,-t)+")"}if(r.charCodeAt(r.length-1)===44)return Vg(e,r,t);if(r.indexOf("%")!==-1)return Hg(e,r,t);if(r.indexOf("E")!==-1)return vp(r,t);if(r.charCodeAt(0)===36)return"$"+Zr(e,r.substr(r.charAt(1)==" "?2:1),t);var i,o,u,d,x=Math.abs(t),p=t<0?"-":"";if(r.match(/^00+$/))return p+_s(x,r.length);if(r.match(/^[#?]+$/))return i=_s(t,0),i==="0"&&(i=""),i.length>r.length?i:Nr(r.substr(0,r.length-i.length))+i;if(o=r.match(gp))return Gg(o,x,p);if(r.match(/^#+0+$/))return p+_s(x,r.length-r.indexOf("0"));if(o=r.match(yp))return i=fh(t,o[1].length).replace(/^([^\.]+)$/,"$1."+Nr(o[1])).replace(/\.$/,"."+Nr(o[1])).replace(/\.(\d*)$/,function(N,g){return"."+g+Lt("0",Nr(o[1]).length-g.length)}),r.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return p+fh(x,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return p+va(_s(x,0));if(o=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Zr(e,r,-t):va(""+(Math.floor(t)+Kg(t,o[1].length)))+"."+mn(dh(t,o[1].length),o[1].length);if(o=r.match(/^#,#*,#0/))return Zr(e,r.replace(/^#,#*,/,""),t);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return i=As(Zr(e,r.replace(/[\\-]/g,""),t)),u=0,As(As(r.replace(/\\/g,"")).replace(/[0#]/g,function(N){return u<i.length?i.charAt(u++):N==="0"?"0":""}));if(r.match(_p))return i=Zr(e,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var m="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(o[4].length,7),d=oo(x,Math.pow(10,u)-1,!1),i=""+p,m=Wn("n",o[1],d[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),i+=m+o[2]+"/"+o[3],m=io(d[2],u),m.length<o[4].length&&(m=Nr(o[4].substr(o[4].length-m.length))+m),i+=m,i;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(Math.max(o[1].length,o[4].length),7),d=oo(x,Math.pow(10,u)-1,!0),p+(d[0]||(d[1]?"":"0"))+" "+(d[1]?Gu(d[1],u)+o[2]+"/"+o[3]+io(d[2],u):Lt(" ",2*u+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return i=_s(t,0),r.length<=i.length?i:Nr(r.substr(0,r.length-i.length))+i;if(o=r.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),u=i.indexOf(".");var w=r.indexOf(".")-u,y=r.length-i.length-w;return Nr(r.substr(0,w)+i+r.substr(r.length-y))}if(o=r.match(/^00,000\.([#0]*0)$/))return u=dh(t,o[1].length),t<0?"-"+Zr(e,r,-t):va(Yg(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(N){return"00,"+(N.length<3?mn(0,3-N.length):"")+N})+"."+mn(u,o[1].length);switch(r){case"###,##0.00":return Zr(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var E=va(_s(x,0));return E!=="0"?p+E:"";case"###,###.00":return Zr(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Zr(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function qg(e,r,t){for(var s=r.length-1;r.charCodeAt(s-1)===44;)--s;return Wn(e,r.substr(0,s),t/Math.pow(10,3*(r.length-s)))}function Qg(e,r,t){var s=r.replace(mp,""),i=r.length-s.length;return Wn(e,s,t*Math.pow(10,2*i))+Lt("%",i)}function Ep(e,r){var t,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Ep(e,-r);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%i;if(o<0&&(o+=i),t=(r/Math.pow(10,o)).toPrecision(s+1+(i+o)%i),!t.match(/[Ee]/)){var u=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(u-t.length+o):t+="E+"+(u-o),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,x,p,m){return x+p+m.substr(0,(i+o)%i)+"."+m.substr(o)+"E"})}else t=r.toExponential(s);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function kn(e,r,t){if(e.charCodeAt(0)===40&&!r.match(wp)){var s=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?kn("n",s,t):"("+kn("n",s,-t)+")"}if(r.charCodeAt(r.length-1)===44)return qg(e,r,t);if(r.indexOf("%")!==-1)return Qg(e,r,t);if(r.indexOf("E")!==-1)return Ep(r,t);if(r.charCodeAt(0)===36)return"$"+kn(e,r.substr(r.charAt(1)==" "?2:1),t);var i,o,u,d,x=Math.abs(t),p=t<0?"-":"";if(r.match(/^00+$/))return p+mn(x,r.length);if(r.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>r.length?i:Nr(r.substr(0,r.length-i.length))+i;if(o=r.match(gp))return Xg(o,x,p);if(r.match(/^#+0+$/))return p+mn(x,r.length-r.indexOf("0"));if(o=r.match(yp))return i=(""+t).replace(/^([^\.]+)$/,"$1."+Nr(o[1])).replace(/\.$/,"."+Nr(o[1])),i=i.replace(/\.(\d*)$/,function(N,g){return"."+g+Lt("0",Nr(o[1]).length-g.length)}),r.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return p+(""+x).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return p+va(""+x);if(o=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+kn(e,r,-t):va(""+t)+"."+Lt("0",o[1].length);if(o=r.match(/^#,#*,#0/))return kn(e,r.replace(/^#,#*,/,""),t);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return i=As(kn(e,r.replace(/[\\-]/g,""),t)),u=0,As(As(r.replace(/\\/g,"")).replace(/[0#]/g,function(N){return u<i.length?i.charAt(u++):N==="0"?"0":""}));if(r.match(_p))return i=kn(e,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var m="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(o[4].length,7),d=oo(x,Math.pow(10,u)-1,!1),i=""+p,m=Wn("n",o[1],d[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),i+=m+o[2]+"/"+o[3],m=io(d[2],u),m.length<o[4].length&&(m=Nr(o[4].substr(o[4].length-m.length))+m),i+=m,i;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(Math.max(o[1].length,o[4].length),7),d=oo(x,Math.pow(10,u)-1,!0),p+(d[0]||(d[1]?"":"0"))+" "+(d[1]?Gu(d[1],u)+o[2]+"/"+o[3]+io(d[2],u):Lt(" ",2*u+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return i=""+t,r.length<=i.length?i:Nr(r.substr(0,r.length-i.length))+i;if(o=r.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),u=i.indexOf(".");var w=r.indexOf(".")-u,y=r.length-i.length-w;return Nr(r.substr(0,w)+i+r.substr(r.length-y))}if(o=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+kn(e,r,-t):va(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(N){return"00,"+(N.length<3?mn(0,3-N.length):"")+N})+"."+mn(0,o[1].length);switch(r){case"###,###":case"##,###":case"#,###":var E=va(""+x);return E!=="0"?p+E:"";default:if(r.match(/\.[0#?]*$/))return kn(e,r.slice(0,r.lastIndexOf(".")),t)+Nr(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function Wn(e,r,t){return(t|0)===t?kn(e,r,t):Zr(e,r,t)}function Jg(e){for(var r=[],t=!1,s=0,i=0;s<e.length;++s)switch(e.charCodeAt(s)){case 34:t=!t;break;case 95:case 42:case 92:++s;break;case 59:r[r.length]=e.substr(i,s-i),i=s+1}if(r[r.length]=e.substr(i),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var Sp=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Tp(e){for(var r=0,t="",s="";r<e.length;)switch(t=e.charAt(r)){case"G":lo(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="/")return!0;++r;break;case"[":for(s=t;e.charAt(r++)!=="]"&&r<e.length;)s+=e.charAt(r);if(s.match(Sp))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function Zg(e,r,t,s){for(var i=[],o="",u=0,d="",x="t",p,m,w,y="H";u<e.length;)switch(d=e.charAt(u)){case"G":if(!lo(e,u))throw new Error("unrecognized character "+d+" in "+e);i[i.length]={t:"G",v:"General"},u+=7;break;case'"':for(o="";(w=e.charCodeAt(++u))!==34&&u<e.length;)o+=String.fromCharCode(w);i[i.length]={t:"t",v:o},++u;break;case"\\":var E=e.charAt(++u),N=E==="("||E===")"?E:"t";i[i.length]={t:N,v:E},++u;break;case"_":i[i.length]={t:"t",v:" "},u+=2;break;case"@":i[i.length]={t:"T",v:r},++u;break;case"B":case"b":if(e.charAt(u+1)==="1"||e.charAt(u+1)==="2"){if(p==null&&(p=ql(r,t,e.charAt(u+1)==="2"),p==null))return"";i[i.length]={t:"X",v:e.substr(u,2)},x=d,u+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||p==null&&(p=ql(r,t),p==null))return"";for(o=d;++u<e.length&&e.charAt(u).toLowerCase()===d;)o+=d;d==="m"&&x.toLowerCase()==="h"&&(d="M"),d==="h"&&(d=y),i[i.length]={t:d,v:o},x=d;break;case"A":case"a":case"":var g={t:d,v:d};if(p==null&&(p=ql(r,t)),e.substr(u,3).toUpperCase()==="A/P"?(p!=null&&(g.v=p.H>=12?"P":"A"),g.t="T",y="h",u+=3):e.substr(u,5).toUpperCase()==="AM/PM"?(p!=null&&(g.v=p.H>=12?"PM":"AM"),g.t="T",u+=5,y="h"):e.substr(u,5).toUpperCase()==="/"?(p!=null&&(g.v=p.H>=12?"":""),g.t="T",u+=5,y="h"):(g.t="t",++u),p==null&&g.t==="T")return"";i[i.length]=g,x=d;break;case"[":for(o=d;e.charAt(u++)!=="]"&&u<e.length;)o+=e.charAt(u);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(Sp)){if(p==null&&(p=ql(r,t),p==null))return"";i[i.length]={t:"Z",v:o.toLowerCase()},x=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",Tp(e)||(i[i.length]={t:"t",v:o}));break;case".":if(p!=null){for(o=d;++u<e.length&&(d=e.charAt(u))==="0";)o+=d;i[i.length]={t:"s",v:o};break}case"0":case"#":for(o=d;++u<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(u))>-1;)o+=d;i[i.length]={t:"n",v:o};break;case"?":for(o=d;e.charAt(++u)===d;)o+=d;i[i.length]={t:d,v:o},x=d;break;case"*":++u,(e.charAt(u)==" "||e.charAt(u)=="*")&&++u;break;case"(":case")":i[i.length]={t:s===1?"t":d,v:d},++u;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=d;u<e.length&&"0123456789".indexOf(e.charAt(++u))>-1;)o+=e.charAt(u);i[i.length]={t:"D",v:o};break;case" ":i[i.length]={t:d,v:d},++u;break;case"$":i[i.length]={t:"t",v:"$"},++u;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(d)===-1)throw new Error("unrecognized character "+d+" in "+e);i[i.length]={t:"t",v:d},++u;break}var _=0,b=0,I;for(u=i.length-1,x="t";u>=0;--u)switch(i[u].t){case"h":case"H":i[u].t=y,x="h",_<1&&(_=1);break;case"s":(I=i[u].v.match(/\.0+$/))&&(b=Math.max(b,I[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":x=i[u].t;break;case"m":x==="s"&&(i[u].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&i[u].v.match(/[Hh]/)&&(_=1),_<2&&i[u].v.match(/[Mm]/)&&(_=2),_<3&&i[u].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:p.u>=.5&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M),p.M>=60&&(p.M=0,++p.H);break;case 2:p.u>=.5&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M);break}var O="",J;for(u=0;u<i.length;++u)switch(i[u].t){case"t":case"T":case" ":case"D":break;case"X":i[u].v="",i[u].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[u].v=$g(i[u].t.charCodeAt(0),i[u].v,p,b),i[u].t="t";break;case"n":case"?":for(J=u+1;i[J]!=null&&((d=i[J].t)==="?"||d==="D"||(d===" "||d==="t")&&i[J+1]!=null&&(i[J+1].t==="?"||i[J+1].t==="t"&&i[J+1].v==="/")||i[u].t==="("&&(d===" "||d==="n"||d===")")||d==="t"&&(i[J].v==="/"||i[J].v===" "&&i[J+1]!=null&&i[J+1].t=="?"));)i[u].v+=i[J].v,i[J]={v:"",t:";"},++J;O+=i[u].v,u=J-1;break;case"G":i[u].t="t",i[u].v=Ru(r,t);break}var he="",de,z;if(O.length>0){O.charCodeAt(0)==40?(de=r<0&&O.charCodeAt(0)===45?-r:r,z=Wn("n",O,de)):(de=r<0&&s>1?-r:r,z=Wn("n",O,de),de<0&&i[0]&&i[0].t=="t"&&(z=z.substr(1),i[0].v="-"+i[0].v)),J=z.length-1;var re=i.length;for(u=0;u<i.length;++u)if(i[u]!=null&&i[u].t!="t"&&i[u].v.indexOf(".")>-1){re=u;break}var V=i.length;if(re===i.length&&z.indexOf("E")===-1){for(u=i.length-1;u>=0;--u)i[u]==null||"n?".indexOf(i[u].t)===-1||(J>=i[u].v.length-1?(J-=i[u].v.length,i[u].v=z.substr(J+1,i[u].v.length)):J<0?i[u].v="":(i[u].v=z.substr(0,J+1),J=-1),i[u].t="t",V=u);J>=0&&V<i.length&&(i[V].v=z.substr(0,J+1)+i[V].v)}else if(re!==i.length&&z.indexOf("E")===-1){for(J=z.indexOf(".")-1,u=re;u>=0;--u)if(!(i[u]==null||"n?".indexOf(i[u].t)===-1)){for(m=i[u].v.indexOf(".")>-1&&u===re?i[u].v.indexOf(".")-1:i[u].v.length-1,he=i[u].v.substr(m+1);m>=0;--m)J>=0&&(i[u].v.charAt(m)==="0"||i[u].v.charAt(m)==="#")&&(he=z.charAt(J--)+he);i[u].v=he,i[u].t="t",V=u}for(J>=0&&V<i.length&&(i[V].v=z.substr(0,J+1)+i[V].v),J=z.indexOf(".")+1,u=re;u<i.length;++u)if(!(i[u]==null||"n?(".indexOf(i[u].t)===-1&&u!==re)){for(m=i[u].v.indexOf(".")>-1&&u===re?i[u].v.indexOf(".")+1:0,he=i[u].v.substr(0,m);m<i[u].v.length;++m)J<z.length&&(he+=z.charAt(J++));i[u].v=he,i[u].t="t",V=u}}}for(u=0;u<i.length;++u)i[u]!=null&&"n?".indexOf(i[u].t)>-1&&(de=s>1&&r<0&&u>0&&i[u-1].v==="-"?-r:r,i[u].v=Wn(i[u].t,i[u].v,de),i[u].t="t");var M="";for(u=0;u!==i.length;++u)i[u]!=null&&(M+=i[u].v);return M}var hh=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function ph(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function e2(e,r){var t=Jg(e),s=t.length,i=t[s-1].indexOf("@");if(s<4&&i>-1&&--s,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var o=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[s,o];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var u=t[0].match(hh),d=t[1].match(hh);return ph(r,u)?[s,t[0]]:ph(r,d)?[s,t[1]]:[s,t[u!=null&&d!=null?2:1]]}return[s,o]}function ga(e,r,t){t==null&&(t={});var s="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?s=t.dateNF:s=e;break;case"number":e==14&&t.dateNF?s=t.dateNF:s=(t.table!=null?t.table:Bt)[e],s==null&&(s=t.table&&t.table[uh[e]]||Bt[uh[e]]),s==null&&(s=Dg[e]||"General");break}if(lo(s,0))return Ru(r,t);r instanceof Date&&(r=xp(r,t.date1904));var i=e2(s,r);if(lo(i[1]))return Ru(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return Zg(i[1],r,t,i[0])}function Np(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(Bt[t]==null){r<0&&(r=t);continue}if(Bt[t]==e){r=t;break}}r<0&&(r=391)}return Bt[r]=e,r}function So(e){for(var r=0;r!=392;++r)e[r]!==void 0&&Np(e[r],r)}function To(){Bt=Rg()}var kp=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function t2(e){var r=typeof e=="number"?Bt[e]:e;return r=r.replace(kp,"(\\d+)"),new RegExp("^"+r+"$")}function r2(e,r,t){var s=-1,i=-1,o=-1,u=-1,d=-1,x=-1;(r.match(kp)||[]).forEach(function(w,y){var E=parseInt(t[y+1],10);switch(w.toLowerCase().charAt(0)){case"y":s=E;break;case"d":o=E;break;case"h":u=E;break;case"s":x=E;break;case"m":u>=0?d=E:i=E;break}}),x>=0&&d==-1&&i>=0&&(d=i,i=-1);var p=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);p.length==7&&(p="0"+p),p.length==8&&(p="20"+p);var m=("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2)+":"+("00"+(x>=0?x:0)).slice(-2);return u==-1&&d==-1&&x==-1?p:s==-1&&i==-1&&o==-1?m:p+"T"+m}var n2=(function(){var e={};e.version="1.2.0";function r(){for(var z=0,re=new Array(256),V=0;V!=256;++V)z=V,z=z&1?-306674912^z>>>1:z>>>1,z=z&1?-306674912^z>>>1:z>>>1,z=z&1?-306674912^z>>>1:z>>>1,z=z&1?-306674912^z>>>1:z>>>1,z=z&1?-306674912^z>>>1:z>>>1,z=z&1?-306674912^z>>>1:z>>>1,z=z&1?-306674912^z>>>1:z>>>1,z=z&1?-306674912^z>>>1:z>>>1,re[V]=z;return typeof Int32Array<"u"?new Int32Array(re):re}var t=r();function s(z){var re=0,V=0,M=0,L=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(M=0;M!=256;++M)L[M]=z[M];for(M=0;M!=256;++M)for(V=z[M],re=256+M;re<4096;re+=256)V=L[re]=V>>>8^z[V&255];var X=[];for(M=1;M!=16;++M)X[M-1]=typeof Int32Array<"u"?L.subarray(M*256,M*256+256):L.slice(M*256,M*256+256);return X}var i=s(t),o=i[0],u=i[1],d=i[2],x=i[3],p=i[4],m=i[5],w=i[6],y=i[7],E=i[8],N=i[9],g=i[10],_=i[11],b=i[12],I=i[13],O=i[14];function J(z,re){for(var V=re^-1,M=0,L=z.length;M<L;)V=V>>>8^t[(V^z.charCodeAt(M++))&255];return~V}function he(z,re){for(var V=re^-1,M=z.length-15,L=0;L<M;)V=O[z[L++]^V&255]^I[z[L++]^V>>8&255]^b[z[L++]^V>>16&255]^_[z[L++]^V>>>24]^g[z[L++]]^N[z[L++]]^E[z[L++]]^y[z[L++]]^w[z[L++]]^m[z[L++]]^p[z[L++]]^x[z[L++]]^d[z[L++]]^u[z[L++]]^o[z[L++]]^t[z[L++]];for(M+=15;L<M;)V=V>>>8^t[(V^z[L++])&255];return~V}function de(z,re){for(var V=re^-1,M=0,L=z.length,X=0,K=0;M<L;)X=z.charCodeAt(M++),X<128?V=V>>>8^t[(V^X)&255]:X<2048?(V=V>>>8^t[(V^(192|X>>6&31))&255],V=V>>>8^t[(V^(128|X&63))&255]):X>=55296&&X<57344?(X=(X&1023)+64,K=z.charCodeAt(M++)&1023,V=V>>>8^t[(V^(240|X>>8&7))&255],V=V>>>8^t[(V^(128|X>>2&63))&255],V=V>>>8^t[(V^(128|K>>6&15|(X&3)<<4))&255],V=V>>>8^t[(V^(128|K&63))&255]):(V=V>>>8^t[(V^(224|X>>12&15))&255],V=V>>>8^t[(V^(128|X>>6&63))&255],V=V>>>8^t[(V^(128|X&63))&255]);return~V}return e.table=t,e.bstr=J,e.buf=he,e.str=de,e})(),Nt=(function(){var r={};r.version="1.2.1";function t(T,F){for(var C=T.split("/"),A=F.split("/"),j=0,P=0,le=Math.min(C.length,A.length);j<le;++j){if(P=C[j].length-A[j].length)return P;if(C[j]!=A[j])return C[j]<A[j]?-1:1}return C.length-A.length}function s(T){if(T.charAt(T.length-1)=="/")return T.slice(0,-1).indexOf("/")===-1?T:s(T.slice(0,-1));var F=T.lastIndexOf("/");return F===-1?T:T.slice(0,F+1)}function i(T){if(T.charAt(T.length-1)=="/")return i(T.slice(0,-1));var F=T.lastIndexOf("/");return F===-1?T:T.slice(F+1)}function o(T,F){typeof F=="string"&&(F=new Date(F));var C=F.getHours();C=C<<6|F.getMinutes(),C=C<<5|F.getSeconds()>>>1,T.write_shift(2,C);var A=F.getFullYear()-1980;A=A<<4|F.getMonth()+1,A=A<<5|F.getDate(),T.write_shift(2,A)}function u(T){var F=T.read_shift(2)&65535,C=T.read_shift(2)&65535,A=new Date,j=C&31;C>>>=5;var P=C&15;C>>>=4,A.setMilliseconds(0),A.setFullYear(C+1980),A.setMonth(P-1),A.setDate(j);var le=F&31;F>>>=5;var xe=F&63;return F>>>=6,A.setHours(F),A.setMinutes(xe),A.setSeconds(le<<1),A}function d(T){Wr(T,0);for(var F={},C=0;T.l<=T.length-4;){var A=T.read_shift(2),j=T.read_shift(2),P=T.l+j,le={};A===21589&&(C=T.read_shift(1),C&1&&(le.mtime=T.read_shift(4)),j>5&&(C&2&&(le.atime=T.read_shift(4)),C&4&&(le.ctime=T.read_shift(4))),le.mtime&&(le.mt=new Date(le.mtime*1e3))),T.l=P,F[A]=le}return F}var x;function p(){return x||(x={})}function m(T,F){if(T[0]==80&&T[1]==75)return Er(T,F);if((T[0]|32)==109&&(T[1]|32)==105)return Ta(T,F);if(T.length<512)throw new Error("CFB file size "+T.length+" < 512");var C=3,A=512,j=0,P=0,le=0,xe=0,ie=0,ce=[],ue=T.slice(0,512);Wr(ue,0);var Ne=w(ue);switch(C=Ne[0],C){case 3:A=512;break;case 4:A=4096;break;case 0:if(Ne[1]==0)return Er(T,F);default:throw new Error("Major Version: Expected 3 or 4 saw "+C)}A!==512&&(ue=T.slice(0,A),Wr(ue,28));var Re=T.slice(0,A);y(ue,C);var Le=ue.read_shift(4,"i");if(C===3&&Le!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Le);ue.l+=4,le=ue.read_shift(4,"i"),ue.l+=4,ue.chk("00100000","Mini Stream Cutoff Size: "),xe=ue.read_shift(4,"i"),j=ue.read_shift(4,"i"),ie=ue.read_shift(4,"i"),P=ue.read_shift(4,"i");for(var Ae=-1,Ce=0;Ce<109&&(Ae=ue.read_shift(4,"i"),!(Ae<0));++Ce)ce[Ce]=Ae;var tt=E(T,A);_(ie,P,tt,A,ce);var kt=I(tt,le,ce,A);kt[le].name="!Directory",j>0&&xe!==K&&(kt[xe].name="!MiniFAT"),kt[ce[0]].name="!FAT",kt.fat_addrs=ce,kt.ssz=A;var Ct={},Ut=[],ka=[],Yn=[];O(le,kt,tt,Ut,j,Ct,ka,xe),N(ka,Yn,Ut),Ut.shift();var wn={FileIndex:ka,FullPaths:Yn};return F&&F.raw&&(wn.raw={header:Re,sectors:tt}),wn}function w(T){if(T[T.l]==80&&T[T.l+1]==75)return[0,0];T.chk(ne,"Header Signature: "),T.l+=16;var F=T.read_shift(2,"u");return[T.read_shift(2,"u"),F]}function y(T,F){var C=9;switch(T.l+=2,C=T.read_shift(2)){case 9:if(F!=3)throw new Error("Sector Shift: Expected 9 saw "+C);break;case 12:if(F!=4)throw new Error("Sector Shift: Expected 12 saw "+C);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+C)}T.chk("0600","Mini Sector Shift: "),T.chk("000000000000","Reserved: ")}function E(T,F){for(var C=Math.ceil(T.length/F)-1,A=[],j=1;j<C;++j)A[j-1]=T.slice(j*F,(j+1)*F);return A[C-1]=T.slice(C*F),A}function N(T,F,C){for(var A=0,j=0,P=0,le=0,xe=0,ie=C.length,ce=[],ue=[];A<ie;++A)ce[A]=ue[A]=A,F[A]=C[A];for(;xe<ue.length;++xe)A=ue[xe],j=T[A].L,P=T[A].R,le=T[A].C,ce[A]===A&&(j!==-1&&ce[j]!==j&&(ce[A]=ce[j]),P!==-1&&ce[P]!==P&&(ce[A]=ce[P])),le!==-1&&(ce[le]=A),j!==-1&&A!=ce[A]&&(ce[j]=ce[A],ue.lastIndexOf(j)<xe&&ue.push(j)),P!==-1&&A!=ce[A]&&(ce[P]=ce[A],ue.lastIndexOf(P)<xe&&ue.push(P));for(A=1;A<ie;++A)ce[A]===A&&(P!==-1&&ce[P]!==P?ce[A]=ce[P]:j!==-1&&ce[j]!==j&&(ce[A]=ce[j]));for(A=1;A<ie;++A)if(T[A].type!==0){if(xe=A,xe!=ce[xe])do xe=ce[xe],F[A]=F[xe]+"/"+F[A];while(xe!==0&&ce[xe]!==-1&&xe!=ce[xe]);ce[A]=-1}for(F[0]+="/",A=1;A<ie;++A)T[A].type!==2&&(F[A]+="/")}function g(T,F,C){for(var A=T.start,j=T.size,P=[],le=A;C&&j>0&&le>=0;)P.push(F.slice(le*X,le*X+X)),j-=X,le=Ba(C,le*4);return P.length===0?pe(0):fr(P).slice(0,T.size)}function _(T,F,C,A,j){var P=K;if(T===K){if(F!==0)throw new Error("DIFAT chain shorter than expected")}else if(T!==-1){var le=C[T],xe=(A>>>2)-1;if(!le)return;for(var ie=0;ie<xe&&(P=Ba(le,ie*4))!==K;++ie)j.push(P);_(Ba(le,A-4),F-1,C,A,j)}}function b(T,F,C,A,j){var P=[],le=[];j||(j=[]);var xe=A-1,ie=0,ce=0;for(ie=F;ie>=0;){j[ie]=!0,P[P.length]=ie,le.push(T[ie]);var ue=C[Math.floor(ie*4/A)];if(ce=ie*4&xe,A<4+ce)throw new Error("FAT boundary crossed: "+ie+" 4 "+A);if(!T[ue])break;ie=Ba(T[ue],ce)}return{nodes:P,data:Eh([le])}}function I(T,F,C,A){var j=T.length,P=[],le=[],xe=[],ie=[],ce=A-1,ue=0,Ne=0,Re=0,Le=0;for(ue=0;ue<j;++ue)if(xe=[],Re=ue+F,Re>=j&&(Re-=j),!le[Re]){ie=[];var Ae=[];for(Ne=Re;Ne>=0;){Ae[Ne]=!0,le[Ne]=!0,xe[xe.length]=Ne,ie.push(T[Ne]);var Ce=C[Math.floor(Ne*4/A)];if(Le=Ne*4&ce,A<4+Le)throw new Error("FAT boundary crossed: "+Ne+" 4 "+A);if(!T[Ce]||(Ne=Ba(T[Ce],Le),Ae[Ne]))break}P[Re]={nodes:xe,data:Eh([ie])}}return P}function O(T,F,C,A,j,P,le,xe){for(var ie=0,ce=A.length?2:0,ue=F[T].data,Ne=0,Re=0,Le;Ne<ue.length;Ne+=128){var Ae=ue.slice(Ne,Ne+128);Wr(Ae,64),Re=Ae.read_shift(2),Le=Ju(Ae,0,Re-ce),A.push(Le);var Ce={name:Le,type:Ae.read_shift(1),color:Ae.read_shift(1),L:Ae.read_shift(4,"i"),R:Ae.read_shift(4,"i"),C:Ae.read_shift(4,"i"),clsid:Ae.read_shift(16),state:Ae.read_shift(4,"i"),start:0,size:0},tt=Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2);tt!==0&&(Ce.ct=J(Ae,Ae.l-8));var kt=Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2);kt!==0&&(Ce.mt=J(Ae,Ae.l-8)),Ce.start=Ae.read_shift(4,"i"),Ce.size=Ae.read_shift(4,"i"),Ce.size<0&&Ce.start<0&&(Ce.size=Ce.type=0,Ce.start=K,Ce.name=""),Ce.type===5?(ie=Ce.start,j>0&&ie!==K&&(F[ie].name="!StreamData")):Ce.size>=4096?(Ce.storage="fat",F[Ce.start]===void 0&&(F[Ce.start]=b(C,Ce.start,F.fat_addrs,F.ssz)),F[Ce.start].name=Ce.name,Ce.content=F[Ce.start].data.slice(0,Ce.size)):(Ce.storage="minifat",Ce.size<0?Ce.size=0:ie!==K&&Ce.start!==K&&F[ie]&&(Ce.content=g(Ce,F[ie].data,(F[xe]||{}).data))),Ce.content&&Wr(Ce.content,0),P[Le]=Ce,le.push(Ce)}}function J(T,F){return new Date((Hr(T,F+4)/1e7*Math.pow(2,32)+Hr(T,F)/1e7-11644473600)*1e3)}function he(T,F){return p(),m(x.readFileSync(T),F)}function de(T,F){var C=F&&F.type;switch(C||vt&&Buffer.isBuffer(T)&&(C="buffer"),C||"base64"){case"file":return he(T,F);case"base64":return m(xn(Vn(T)),F);case"binary":return m(xn(T),F)}return m(T,F)}function z(T,F){var C=F||{},A=C.root||"Root Entry";if(T.FullPaths||(T.FullPaths=[]),T.FileIndex||(T.FileIndex=[]),T.FullPaths.length!==T.FileIndex.length)throw new Error("inconsistent CFB structure");T.FullPaths.length===0&&(T.FullPaths[0]=A+"/",T.FileIndex[0]={name:A,type:5}),C.CLSID&&(T.FileIndex[0].clsid=C.CLSID),re(T)}function re(T){var F="Sh33tJ5";if(!Nt.find(T,"/"+F)){var C=pe(4);C[0]=55,C[1]=C[3]=50,C[2]=54,T.FileIndex.push({name:F,type:2,content:C,size:4,L:69,R:69,C:69}),T.FullPaths.push(T.FullPaths[0]+F),V(T)}}function V(T,F){z(T);for(var C=!1,A=!1,j=T.FullPaths.length-1;j>=0;--j){var P=T.FileIndex[j];switch(P.type){case 0:A?C=!0:(T.FileIndex.pop(),T.FullPaths.pop());break;case 1:case 2:case 5:A=!0,isNaN(P.R*P.L*P.C)&&(C=!0),P.R>-1&&P.L>-1&&P.R==P.L&&(C=!0);break;default:C=!0;break}}if(!(!C&&!F)){var le=new Date(1987,1,19),xe=0,ie=Object.create?Object.create(null):{},ce=[];for(j=0;j<T.FullPaths.length;++j)ie[T.FullPaths[j]]=!0,T.FileIndex[j].type!==0&&ce.push([T.FullPaths[j],T.FileIndex[j]]);for(j=0;j<ce.length;++j){var ue=s(ce[j][0]);A=ie[ue],A||(ce.push([ue,{name:i(ue).replace("/",""),type:1,clsid:Z,ct:le,mt:le,content:null}]),ie[ue]=!0)}for(ce.sort(function(Le,Ae){return t(Le[0],Ae[0])}),T.FullPaths=[],T.FileIndex=[],j=0;j<ce.length;++j)T.FullPaths[j]=ce[j][0],T.FileIndex[j]=ce[j][1];for(j=0;j<ce.length;++j){var Ne=T.FileIndex[j],Re=T.FullPaths[j];if(Ne.name=i(Re).replace("/",""),Ne.L=Ne.R=Ne.C=-(Ne.color=1),Ne.size=Ne.content?Ne.content.length:0,Ne.start=0,Ne.clsid=Ne.clsid||Z,j===0)Ne.C=ce.length>1?1:-1,Ne.size=0,Ne.type=5;else if(Re.slice(-1)=="/"){for(xe=j+1;xe<ce.length&&s(T.FullPaths[xe])!=Re;++xe);for(Ne.C=xe>=ce.length?-1:xe,xe=j+1;xe<ce.length&&s(T.FullPaths[xe])!=s(Re);++xe);Ne.R=xe>=ce.length?-1:xe,Ne.type=1}else s(T.FullPaths[j+1]||"")==s(Re)&&(Ne.R=j+1),Ne.type=2}}}function M(T,F){var C=F||{};if(C.fileType=="mad")return yn(T,C);if(V(T),C.fileType==="zip")return Jt(T,C);var A=(function(Le){for(var Ae=0,Ce=0,tt=0;tt<Le.FileIndex.length;++tt){var kt=Le.FileIndex[tt];if(kt.content){var Ct=kt.content.length;Ct>0&&(Ct<4096?Ae+=Ct+63>>6:Ce+=Ct+511>>9)}}for(var Ut=Le.FullPaths.length+3>>2,ka=Ae+7>>3,Yn=Ae+127>>7,wn=ka+Ce+Ut+Yn,Zt=wn+127>>7,Ls=Zt<=109?0:Math.ceil((Zt-109)/127);wn+Zt+Ls+127>>7>Zt;)Ls=++Zt<=109?0:Math.ceil((Zt-109)/127);var zt=[1,Ls,Zt,Yn,Ut,Ce,Ae,0];return Le.FileIndex[0].size=Ae<<6,zt[7]=(Le.FileIndex[0].start=zt[0]+zt[1]+zt[2]+zt[3]+zt[4]+zt[5])+(zt[6]+7>>3),zt})(T),j=pe(A[7]<<9),P=0,le=0;{for(P=0;P<8;++P)j.write_shift(1,W[P]);for(P=0;P<8;++P)j.write_shift(2,0);for(j.write_shift(2,62),j.write_shift(2,3),j.write_shift(2,65534),j.write_shift(2,9),j.write_shift(2,6),P=0;P<3;++P)j.write_shift(2,0);for(j.write_shift(4,0),j.write_shift(4,A[2]),j.write_shift(4,A[0]+A[1]+A[2]+A[3]-1),j.write_shift(4,0),j.write_shift(4,4096),j.write_shift(4,A[3]?A[0]+A[1]+A[2]-1:K),j.write_shift(4,A[3]),j.write_shift(-4,A[1]?A[0]-1:K),j.write_shift(4,A[1]),P=0;P<109;++P)j.write_shift(-4,P<A[2]?A[1]+P:-1)}if(A[1])for(le=0;le<A[1];++le){for(;P<236+le*127;++P)j.write_shift(-4,P<A[2]?A[1]+P:-1);j.write_shift(-4,le===A[1]-1?K:le+1)}var xe=function(Le){for(le+=Le;P<le-1;++P)j.write_shift(-4,P+1);Le&&(++P,j.write_shift(-4,K))};for(le=P=0,le+=A[1];P<le;++P)j.write_shift(-4,me.DIFSECT);for(le+=A[2];P<le;++P)j.write_shift(-4,me.FATSECT);xe(A[3]),xe(A[4]);for(var ie=0,ce=0,ue=T.FileIndex[0];ie<T.FileIndex.length;++ie)ue=T.FileIndex[ie],ue.content&&(ce=ue.content.length,!(ce<4096)&&(ue.start=le,xe(ce+511>>9)));for(xe(A[6]+7>>3);j.l&511;)j.write_shift(-4,me.ENDOFCHAIN);for(le=P=0,ie=0;ie<T.FileIndex.length;++ie)ue=T.FileIndex[ie],ue.content&&(ce=ue.content.length,!(!ce||ce>=4096)&&(ue.start=le,xe(ce+63>>6)));for(;j.l&511;)j.write_shift(-4,me.ENDOFCHAIN);for(P=0;P<A[4]<<2;++P){var Ne=T.FullPaths[P];if(!Ne||Ne.length===0){for(ie=0;ie<17;++ie)j.write_shift(4,0);for(ie=0;ie<3;++ie)j.write_shift(4,-1);for(ie=0;ie<12;++ie)j.write_shift(4,0);continue}ue=T.FileIndex[P],P===0&&(ue.start=ue.size?ue.start-1:K);var Re=P===0&&C.root||ue.name;if(ce=2*(Re.length+1),j.write_shift(64,Re,"utf16le"),j.write_shift(2,ce),j.write_shift(1,ue.type),j.write_shift(1,ue.color),j.write_shift(-4,ue.L),j.write_shift(-4,ue.R),j.write_shift(-4,ue.C),ue.clsid)j.write_shift(16,ue.clsid,"hex");else for(ie=0;ie<4;++ie)j.write_shift(4,0);j.write_shift(4,ue.state||0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,ue.start),j.write_shift(4,ue.size),j.write_shift(4,0)}for(P=1;P<T.FileIndex.length;++P)if(ue=T.FileIndex[P],ue.size>=4096)if(j.l=ue.start+1<<9,vt&&Buffer.isBuffer(ue.content))ue.content.copy(j,j.l,0,ue.size),j.l+=ue.size+511&-512;else{for(ie=0;ie<ue.size;++ie)j.write_shift(1,ue.content[ie]);for(;ie&511;++ie)j.write_shift(1,0)}for(P=1;P<T.FileIndex.length;++P)if(ue=T.FileIndex[P],ue.size>0&&ue.size<4096)if(vt&&Buffer.isBuffer(ue.content))ue.content.copy(j,j.l,0,ue.size),j.l+=ue.size+63&-64;else{for(ie=0;ie<ue.size;++ie)j.write_shift(1,ue.content[ie]);for(;ie&63;++ie)j.write_shift(1,0)}if(vt)j.l=j.length;else for(;j.l<j.length;)j.write_shift(1,0);return j}function L(T,F){var C=T.FullPaths.map(function(ie){return ie.toUpperCase()}),A=C.map(function(ie){var ce=ie.split("/");return ce[ce.length-(ie.slice(-1)=="/"?2:1)]}),j=!1;F.charCodeAt(0)===47?(j=!0,F=C[0].slice(0,-1)+F):j=F.indexOf("/")!==-1;var P=F.toUpperCase(),le=j===!0?C.indexOf(P):A.indexOf(P);if(le!==-1)return T.FileIndex[le];var xe=!P.match(Yl);for(P=P.replace(Si,""),xe&&(P=P.replace(Yl,"!")),le=0;le<C.length;++le)if((xe?C[le].replace(Yl,"!"):C[le]).replace(Si,"")==P||(xe?A[le].replace(Yl,"!"):A[le]).replace(Si,"")==P)return T.FileIndex[le];return null}var X=64,K=-2,ne="d0cf11e0a1b11ae1",W=[208,207,17,224,161,177,26,225],Z="00000000000000000000000000000000",me={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:K,FREESECT:-1,HEADER_SIGNATURE:ne,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Z,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function R(T,F,C){p();var A=M(T,C);x.writeFileSync(F,A)}function ve(T){for(var F=new Array(T.length),C=0;C<T.length;++C)F[C]=String.fromCharCode(T[C]);return F.join("")}function ye(T,F){var C=M(T,F);switch(F&&F.type||"buffer"){case"file":return p(),x.writeFileSync(F.filename,C),C;case"binary":return typeof C=="string"?C:ve(C);case"base64":return Fi(typeof C=="string"?C:ve(C));case"buffer":if(vt)return Buffer.isBuffer(C)?C:Xn(C);case"array":return typeof C=="string"?xn(C):C}return C}var Y;function k(T){try{var F=T.InflateRaw,C=new F;if(C._processChunk(new Uint8Array([3,0]),C._finishFlushFlag),C.bytesRead)Y=T;else throw new Error("zlib does not expose bytesRead")}catch(A){console.error("cannot use native zlib: "+(A.message||A))}}function q(T,F){if(!Y)return Ie(T,F);var C=Y.InflateRaw,A=new C,j=A._processChunk(T.slice(T.l),A._finishFlushFlag);return T.l+=A.bytesRead,j}function B(T){return Y?Y.deflateRawSync(T):Gr(T)}var U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],oe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ee=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Te(T){var F=(T<<1|T<<11)&139536|(T<<5|T<<15)&558144;return(F>>16|F>>8|F)&255}for(var ee=typeof Uint8Array<"u",te=ee?new Uint8Array(256):[],Se=0;Se<256;++Se)te[Se]=Te(Se);function De(T,F){var C=te[T&255];return F<=8?C>>>8-F:(C=C<<8|te[T>>8&255],F<=16?C>>>16-F:(C=C<<8|te[T>>16&255],C>>>24-F))}function et(T,F){var C=F&7,A=F>>>3;return(T[A]|(C<=6?0:T[A+1]<<8))>>>C&3}function We(T,F){var C=F&7,A=F>>>3;return(T[A]|(C<=5?0:T[A+1]<<8))>>>C&7}function ot(T,F){var C=F&7,A=F>>>3;return(T[A]|(C<=4?0:T[A+1]<<8))>>>C&15}function rt(T,F){var C=F&7,A=F>>>3;return(T[A]|(C<=3?0:T[A+1]<<8))>>>C&31}function Oe(T,F){var C=F&7,A=F>>>3;return(T[A]|(C<=1?0:T[A+1]<<8))>>>C&127}function Ot(T,F,C){var A=F&7,j=F>>>3,P=(1<<C)-1,le=T[j]>>>A;return C<8-A||(le|=T[j+1]<<8-A,C<16-A)||(le|=T[j+2]<<16-A,C<24-A)||(le|=T[j+3]<<24-A),le&P}function Ue(T,F,C){var A=F&7,j=F>>>3;return A<=5?T[j]|=(C&7)<<A:(T[j]|=C<<A&255,T[j+1]=(C&7)>>8-A),F+3}function He(T,F,C){var A=F&7,j=F>>>3;return C=(C&1)<<A,T[j]|=C,F+1}function Ke(T,F,C){var A=F&7,j=F>>>3;return C<<=A,T[j]|=C&255,C>>>=8,T[j+1]=C,F+8}function ct(T,F,C){var A=F&7,j=F>>>3;return C<<=A,T[j]|=C&255,C>>>=8,T[j+1]=C&255,T[j+2]=C>>>8,F+16}function ut(T,F){var C=T.length,A=2*C>F?2*C:F+5,j=0;if(C>=F)return T;if(vt){var P=lh(A);if(T.copy)T.copy(P);else for(;j<T.length;++j)P[j]=T[j];return P}else if(ee){var le=new Uint8Array(A);if(le.set)le.set(T);else for(;j<C;++j)le[j]=T[j];return le}return T.length=A,T}function it(T){for(var F=new Array(T),C=0;C<T;++C)F[C]=0;return F}function ft(T,F,C){var A=1,j=0,P=0,le=0,xe=0,ie=T.length,ce=ee?new Uint16Array(32):it(32);for(P=0;P<32;++P)ce[P]=0;for(P=ie;P<C;++P)T[P]=0;ie=T.length;var ue=ee?new Uint16Array(ie):it(ie);for(P=0;P<ie;++P)ce[j=T[P]]++,A<j&&(A=j),ue[P]=0;for(ce[0]=0,P=1;P<=A;++P)ce[P+16]=xe=xe+ce[P-1]<<1;for(P=0;P<ie;++P)xe=T[P],xe!=0&&(ue[P]=ce[xe+16]++);var Ne=0;for(P=0;P<ie;++P)if(Ne=T[P],Ne!=0)for(xe=De(ue[P],A)>>A-Ne,le=(1<<A+4-Ne)-1;le>=0;--le)F[xe|le<<Ne]=Ne&15|P<<4;return A}var rn=ee?new Uint16Array(512):it(512),nn=ee?new Uint16Array(32):it(32);if(!ee){for(var _r=0;_r<512;++_r)rn[_r]=0;for(_r=0;_r<32;++_r)nn[_r]=0}(function(){for(var T=[],F=0;F<32;F++)T.push(5);ft(T,nn,32);var C=[];for(F=0;F<=143;F++)C.push(8);for(;F<=255;F++)C.push(9);for(;F<=279;F++)C.push(7);for(;F<=287;F++)C.push(8);ft(C,rn,288)})();var Ea=(function(){for(var F=ee?new Uint8Array(32768):[],C=0,A=0;C<Ee.length-1;++C)for(;A<Ee[C+1];++A)F[A]=C;for(;A<32768;++A)F[A]=29;var j=ee?new Uint8Array(259):[];for(C=0,A=0;C<oe.length-1;++C)for(;A<oe[C+1];++A)j[A]=C;function P(xe,ie){for(var ce=0;ce<xe.length;){var ue=Math.min(65535,xe.length-ce),Ne=ce+ue==xe.length;for(ie.write_shift(1,+Ne),ie.write_shift(2,ue),ie.write_shift(2,~ue&65535);ue-- >0;)ie[ie.l++]=xe[ce++]}return ie.l}function le(xe,ie){for(var ce=0,ue=0,Ne=ee?new Uint16Array(32768):[];ue<xe.length;){var Re=Math.min(65535,xe.length-ue);if(Re<10){for(ce=Ue(ie,ce,+(ue+Re==xe.length)),ce&7&&(ce+=8-(ce&7)),ie.l=ce/8|0,ie.write_shift(2,Re),ie.write_shift(2,~Re&65535);Re-- >0;)ie[ie.l++]=xe[ue++];ce=ie.l*8;continue}ce=Ue(ie,ce,+(ue+Re==xe.length)+2);for(var Le=0;Re-- >0;){var Ae=xe[ue];Le=(Le<<5^Ae)&32767;var Ce=-1,tt=0;if((Ce=Ne[Le])&&(Ce|=ue&-32768,Ce>ue&&(Ce-=32768),Ce<ue))for(;xe[Ce+tt]==xe[ue+tt]&&tt<250;)++tt;if(tt>2){Ae=j[tt],Ae<=22?ce=Ke(ie,ce,te[Ae+1]>>1)-1:(Ke(ie,ce,3),ce+=5,Ke(ie,ce,te[Ae-23]>>5),ce+=3);var kt=Ae<8?0:Ae-4>>2;kt>0&&(ct(ie,ce,tt-oe[Ae]),ce+=kt),Ae=F[ue-Ce],ce=Ke(ie,ce,te[Ae]>>3),ce-=3;var Ct=Ae<4?0:Ae-2>>1;Ct>0&&(ct(ie,ce,ue-Ce-Ee[Ae]),ce+=Ct);for(var Ut=0;Ut<tt;++Ut)Ne[Le]=ue&32767,Le=(Le<<5^xe[ue])&32767,++ue;Re-=tt-1}else Ae<=143?Ae=Ae+48:ce=He(ie,ce,1),ce=Ke(ie,ce,te[Ae]),Ne[Le]=ue&32767,++ue}ce=Ke(ie,ce,0)-1}return ie.l=(ce+7)/8|0,ie.l}return function(ie,ce){return ie.length<8?P(ie,ce):le(ie,ce)}})();function Gr(T){var F=pe(50+Math.floor(T.length*1.1)),C=Ea(T,F);return F.slice(0,C)}var gn=ee?new Uint16Array(32768):it(32768),Pe=ee?new Uint16Array(32768):it(32768),Ye=ee?new Uint16Array(128):it(128),Ge=1,nt=1;function Je(T,F){var C=rt(T,F)+257;F+=5;var A=rt(T,F)+1;F+=5;var j=ot(T,F)+4;F+=4;for(var P=0,le=ee?new Uint8Array(19):it(19),xe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ie=1,ce=ee?new Uint8Array(8):it(8),ue=ee?new Uint8Array(8):it(8),Ne=le.length,Re=0;Re<j;++Re)le[U[Re]]=P=We(T,F),ie<P&&(ie=P),ce[P]++,F+=3;var Le=0;for(ce[0]=0,Re=1;Re<=ie;++Re)ue[Re]=Le=Le+ce[Re-1]<<1;for(Re=0;Re<Ne;++Re)(Le=le[Re])!=0&&(xe[Re]=ue[Le]++);var Ae=0;for(Re=0;Re<Ne;++Re)if(Ae=le[Re],Ae!=0){Le=te[xe[Re]]>>8-Ae;for(var Ce=(1<<7-Ae)-1;Ce>=0;--Ce)Ye[Le|Ce<<Ae]=Ae&7|Re<<3}var tt=[];for(ie=1;tt.length<C+A;)switch(Le=Ye[Oe(T,F)],F+=Le&7,Le>>>=3){case 16:for(P=3+et(T,F),F+=2,Le=tt[tt.length-1];P-- >0;)tt.push(Le);break;case 17:for(P=3+We(T,F),F+=3;P-- >0;)tt.push(0);break;case 18:for(P=11+Oe(T,F),F+=7;P-- >0;)tt.push(0);break;default:tt.push(Le),ie<Le&&(ie=Le);break}var kt=tt.slice(0,C),Ct=tt.slice(C);for(Re=C;Re<286;++Re)kt[Re]=0;for(Re=A;Re<30;++Re)Ct[Re]=0;return Ge=ft(kt,gn,286),nt=ft(Ct,Pe,30),F}function $t(T,F){if(T[0]==3&&!(T[1]&3))return[$a(F),2];for(var C=0,A=0,j=lh(F||1<<18),P=0,le=j.length>>>0,xe=0,ie=0;(A&1)==0;){if(A=We(T,C),C+=3,A>>>1)A>>1==1?(xe=9,ie=5):(C=Je(T,C),xe=Ge,ie=nt);else{C&7&&(C+=8-(C&7));var ce=T[C>>>3]|T[(C>>>3)+1]<<8;if(C+=32,ce>0)for(!F&&le<P+ce&&(j=ut(j,P+ce),le=j.length);ce-- >0;)j[P++]=T[C>>>3],C+=8;continue}for(;;){!F&&le<P+32767&&(j=ut(j,P+32767),le=j.length);var ue=Ot(T,C,xe),Ne=A>>>1==1?rn[ue]:gn[ue];if(C+=Ne&15,Ne>>>=4,(Ne>>>8&255)===0)j[P++]=Ne;else{if(Ne==256)break;Ne-=257;var Re=Ne<8?0:Ne-4>>2;Re>5&&(Re=0);var Le=P+oe[Ne];Re>0&&(Le+=Ot(T,C,Re),C+=Re),ue=Ot(T,C,ie),Ne=A>>>1==1?nn[ue]:Pe[ue],C+=Ne&15,Ne>>>=4;var Ae=Ne<4?0:Ne-2>>1,Ce=Ee[Ne];for(Ae>0&&(Ce+=Ot(T,C,Ae),C+=Ae),!F&&le<Le&&(j=ut(j,Le+100),le=j.length);P<Le;)j[P]=j[P-Ce],++P}}}return F?[j,C+7>>>3]:[j.slice(0,P),C+7>>>3]}function Ie(T,F){var C=T.slice(T.l||0),A=$t(C,F);return T.l+=A[1],A[0]}function dt(T,F){if(T)typeof console<"u"&&console.error(F);else throw new Error(F)}function Er(T,F){var C=T;Wr(C,0);var A=[],j=[],P={FileIndex:A,FullPaths:j};z(P,{root:F.root});for(var le=C.length-4;(C[le]!=80||C[le+1]!=75||C[le+2]!=5||C[le+3]!=6)&&le>=0;)--le;C.l=le+4,C.l+=4;var xe=C.read_shift(2);C.l+=6;var ie=C.read_shift(4);for(C.l=ie,le=0;le<xe;++le){C.l+=20;var ce=C.read_shift(4),ue=C.read_shift(4),Ne=C.read_shift(2),Re=C.read_shift(2),Le=C.read_shift(2);C.l+=8;var Ae=C.read_shift(4),Ce=d(C.slice(C.l+Ne,C.l+Ne+Re));C.l+=Ne+Re+Le;var tt=C.l;C.l=Ae+4,Ht(C,ce,ue,P,Ce),C.l=tt}return P}function Ht(T,F,C,A,j){T.l+=2;var P=T.read_shift(2),le=T.read_shift(2),xe=u(T);if(P&8257)throw new Error("Unsupported ZIP encryption");for(var ie=T.read_shift(4),ce=T.read_shift(4),ue=T.read_shift(4),Ne=T.read_shift(2),Re=T.read_shift(2),Le="",Ae=0;Ae<Ne;++Ae)Le+=String.fromCharCode(T[T.l++]);if(Re){var Ce=d(T.slice(T.l,T.l+Re));(Ce[21589]||{}).mt&&(xe=Ce[21589].mt),((j||{})[21589]||{}).mt&&(xe=j[21589].mt)}T.l+=Re;var tt=T.slice(T.l,T.l+ce);switch(le){case 8:tt=q(T,ue);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+le)}var kt=!1;P&8&&(ie=T.read_shift(4),ie==134695760&&(ie=T.read_shift(4),kt=!0),ce=T.read_shift(4),ue=T.read_shift(4)),ce!=F&&dt(kt,"Bad compressed size: "+F+" != "+ce),ue!=C&&dt(kt,"Bad uncompressed size: "+C+" != "+ue),an(A,Le,tt,{unsafe:!0,mt:xe})}function Jt(T,F){var C=F||{},A=[],j=[],P=pe(1),le=C.compression?8:0,xe=0,ie=0,ce=0,ue=0,Ne=0,Re=T.FullPaths[0],Le=Re,Ae=T.FileIndex[0],Ce=[],tt=0;for(ie=1;ie<T.FullPaths.length;++ie)if(Le=T.FullPaths[ie].slice(Re.length),Ae=T.FileIndex[ie],!(!Ae.size||!Ae.content||Le=="Sh33tJ5")){var kt=ue,Ct=pe(Le.length);for(ce=0;ce<Le.length;++ce)Ct.write_shift(1,Le.charCodeAt(ce)&127);Ct=Ct.slice(0,Ct.l),Ce[Ne]=n2.buf(Ae.content,0);var Ut=Ae.content;le==8&&(Ut=B(Ut)),P=pe(30),P.write_shift(4,67324752),P.write_shift(2,20),P.write_shift(2,xe),P.write_shift(2,le),Ae.mt?o(P,Ae.mt):P.write_shift(4,0),P.write_shift(-4,Ce[Ne]),P.write_shift(4,Ut.length),P.write_shift(4,Ae.content.length),P.write_shift(2,Ct.length),P.write_shift(2,0),ue+=P.length,A.push(P),ue+=Ct.length,A.push(Ct),ue+=Ut.length,A.push(Ut),P=pe(46),P.write_shift(4,33639248),P.write_shift(2,0),P.write_shift(2,20),P.write_shift(2,xe),P.write_shift(2,le),P.write_shift(4,0),P.write_shift(-4,Ce[Ne]),P.write_shift(4,Ut.length),P.write_shift(4,Ae.content.length),P.write_shift(2,Ct.length),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(4,0),P.write_shift(4,kt),tt+=P.l,j.push(P),tt+=Ct.length,j.push(Ct),++Ne}return P=pe(22),P.write_shift(4,101010256),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(2,Ne),P.write_shift(2,Ne),P.write_shift(4,tt),P.write_shift(4,ue),P.write_shift(2,0),fr([fr(A),fr(j),P])}var mt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ir(T,F){if(T.ctype)return T.ctype;var C=T.name||"",A=C.match(/\.([^\.]+)$/);return A&&mt[A[1]]||F&&(A=(C=F).match(/[\.\\]([^\.\\])+$/),A&&mt[A[1]])?mt[A[1]]:"application/octet-stream"}function Sa(T){for(var F=Fi(T),C=[],A=0;A<F.length;A+=76)C.push(F.slice(A,A+76));return C.join(`\r
`)+`\r
`}function jn(T){var F=T.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ce){var ue=ce.charCodeAt(0).toString(16).toUpperCase();return"="+(ue.length==1?"0"+ue:ue)});F=F.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),F.charAt(0)==`
`&&(F="=0D"+F.slice(1)),F=F.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var C=[],A=F.split(`\r
`),j=0;j<A.length;++j){var P=A[j];if(P.length==0){C.push("");continue}for(var le=0;le<P.length;){var xe=76,ie=P.slice(le,le+xe);ie.charAt(xe-1)=="="?xe--:ie.charAt(xe-2)=="="?xe-=2:ie.charAt(xe-3)=="="&&(xe-=3),ie=P.slice(le,le+xe),le+=xe,le<P.length&&(ie+="="),C.push(ie)}}return C.join(`\r
`)}function Pn(T){for(var F=[],C=0;C<T.length;++C){for(var A=T[C];C<=T.length&&A.charAt(A.length-1)=="=";)A=A.slice(0,A.length-1)+T[++C];F.push(A)}for(var j=0;j<F.length;++j)F[j]=F[j].replace(/[=][0-9A-Fa-f]{2}/g,function(P){return String.fromCharCode(parseInt(P.slice(1),16))});return xn(F.join(`\r
`))}function On(T,F,C){for(var A="",j="",P="",le,xe=0;xe<10;++xe){var ie=F[xe];if(!ie||ie.match(/^\s*$/))break;var ce=ie.match(/^(.*?):\s*([^\s].*)$/);if(ce)switch(ce[1].toLowerCase()){case"content-location":A=ce[2].trim();break;case"content-type":P=ce[2].trim();break;case"content-transfer-encoding":j=ce[2].trim();break}}switch(++xe,j.toLowerCase()){case"base64":le=xn(Vn(F.slice(xe).join("")));break;case"quoted-printable":le=Pn(F.slice(xe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+j)}var ue=an(T,A.slice(C.length),le,{unsafe:!0});P&&(ue.ctype=P)}function Ta(T,F){if(ve(T.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var C=F&&F.root||"",A=(vt&&Buffer.isBuffer(T)?T.toString("binary"):ve(T)).split(`\r
`),j=0,P="";for(j=0;j<A.length;++j)if(P=A[j],!!/^Content-Location:/i.test(P)&&(P=P.slice(P.indexOf("file")),C||(C=P.slice(0,P.lastIndexOf("/")+1)),P.slice(0,C.length)!=C))for(;C.length>0&&(C=C.slice(0,C.length-1),C=C.slice(0,C.lastIndexOf("/")+1),P.slice(0,C.length)!=C););var le=(A[1]||"").match(/boundary="(.*?)"/);if(!le)throw new Error("MAD cannot find boundary");var xe="--"+(le[1]||""),ie=[],ce=[],ue={FileIndex:ie,FullPaths:ce};z(ue);var Ne,Re=0;for(j=0;j<A.length;++j){var Le=A[j];Le!==xe&&Le!==xe+"--"||(Re++&&On(ue,A.slice(Ne,j),C),Ne=j)}return ue}function yn(T,F){var C=F||{},A=C.boundary||"SheetJS";A="------="+A;for(var j=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+A.slice(2)+'"',"","",""],P=T.FullPaths[0],le=P,xe=T.FileIndex[0],ie=1;ie<T.FullPaths.length;++ie)if(le=T.FullPaths[ie].slice(P.length),xe=T.FileIndex[ie],!(!xe.size||!xe.content||le=="Sh33tJ5")){le=le.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(tt){return"_x"+tt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(tt){return"_u"+tt.charCodeAt(0).toString(16)+"_"});for(var ce=xe.content,ue=vt&&Buffer.isBuffer(ce)?ce.toString("binary"):ve(ce),Ne=0,Re=Math.min(1024,ue.length),Le=0,Ae=0;Ae<=Re;++Ae)(Le=ue.charCodeAt(Ae))>=32&&Le<128&&++Ne;var Ce=Ne>=Re*4/5;j.push(A),j.push("Content-Location: "+(C.root||"file:///C:/SheetJS/")+le),j.push("Content-Transfer-Encoding: "+(Ce?"quoted-printable":"base64")),j.push("Content-Type: "+ir(xe,le)),j.push(""),j.push(Ce?jn(ue):Sa(ue))}return j.push(A+`--\r
`),j.join(`\r
`)}function Kn(T){var F={};return z(F,T),F}function an(T,F,C,A){var j=A&&A.unsafe;j||z(T);var P=!j&&Nt.find(T,F);if(!P){var le=T.FullPaths[0];F.slice(0,le.length)==le?le=F:(le.slice(-1)!="/"&&(le+="/"),le=(le+F).replace("//","/")),P={name:i(F),type:2},T.FileIndex.push(P),T.FullPaths.push(le),j||Nt.utils.cfb_gc(T)}return P.content=C,P.size=C?C.length:0,A&&(A.CLSID&&(P.clsid=A.CLSID),A.mt&&(P.mt=A.mt),A.ct&&(P.ct=A.ct)),P}function Ms(T,F){z(T);var C=Nt.find(T,F);if(C){for(var A=0;A<T.FileIndex.length;++A)if(T.FileIndex[A]==C)return T.FileIndex.splice(A,1),T.FullPaths.splice(A,1),!0}return!1}function Na(T,F,C){z(T);var A=Nt.find(T,F);if(A){for(var j=0;j<T.FileIndex.length;++j)if(T.FileIndex[j]==A)return T.FileIndex[j].name=i(C),T.FullPaths[j]=C,!0}return!1}function Qa(T){V(T,!0)}return r.find=L,r.read=de,r.parse=m,r.write=ye,r.writeFile=R,r.utils={cfb_new:Kn,cfb_add:an,cfb_del:Ms,cfb_mov:Na,cfb_gc:Qa,ReadShift:Ni,CheckField:Hp,prep_blob:Wr,bconcat:fr,use_zlib:k,_deflateRaw:Gr,_inflateRaw:Ie,consts:me},r})();function a2(e){return typeof e=="string"?Eo(e):Array.isArray(e)?Fg(e):e}function Li(e,r,t){if(typeof Deno<"u"){if(t&&typeof r=="string")switch(t){case"utf8":r=new TextEncoder(t).encode(r);break;case"binary":r=Eo(r);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(e,r)}var s=t=="utf8"?Pi(r):r;if(typeof IE_SaveFile<"u")return IE_SaveFile(s,e);if(typeof Blob<"u"){var i=new Blob([a2(s)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:e,saveAs:!0});var u=document.createElement("a");if(u.download!=null)return u.download=e,u.href=o,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var d=File(e);return d.open("w"),d.encoding="binary",Array.isArray(r)&&(r=Mi(r)),d.write(r),d.close(),r}catch(x){if(!x.message||!x.message.match(/onstruct/))throw x}throw new Error("cannot save file "+e)}function pr(e){for(var r=Object.keys(e),t=[],s=0;s<r.length;++s)Object.prototype.hasOwnProperty.call(e,r[s])&&t.push(r[s]);return t}function xh(e,r){for(var t=[],s=pr(e),i=0;i!==s.length;++i)t[e[s[i]][r]]==null&&(t[e[s[i]][r]]=s[i]);return t}function Ku(e){for(var r=[],t=pr(e),s=0;s!==t.length;++s)r[e[t[s]]]=t[s];return r}function No(e){for(var r=[],t=pr(e),s=0;s!==t.length;++s)r[e[t[s]]]=parseInt(t[s],10);return r}function s2(e){for(var r=[],t=pr(e),s=0;s!==t.length;++s)r[e[t[s]]]==null&&(r[e[t[s]]]=[]),r[e[t[s]]].push(t[s]);return r}var co=new Date(1899,11,30,0,0,0);function Dr(e,r){var t=e.getTime(),s=co.getTime()+(e.getTimezoneOffset()-co.getTimezoneOffset())*6e4;return(t-s)/(1440*60*1e3)}var Cp=new Date,i2=co.getTime()+(Cp.getTimezoneOffset()-co.getTimezoneOffset())*6e4,mh=Cp.getTimezoneOffset();function Ap(e){var r=new Date;return r.setTime(e*24*60*60*1e3+i2),r.getTimezoneOffset()!==mh&&r.setTime(r.getTime()+(r.getTimezoneOffset()-mh)*6e4),r}var vh=new Date("2017-02-19T19:06:09.000Z"),bp=isNaN(vh.getFullYear())?new Date("2/19/17"):vh,l2=bp.getFullYear()==2017;function Cr(e,r){var t=new Date(e);if(l2)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(bp.getFullYear()==1917&&!isNaN(t.getFullYear())){var s=t.getFullYear();return e.indexOf(""+s)>-1||t.setFullYear(t.getFullYear()+100),t}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function ko(e,r){if(vt&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(o){return t[o]||o})}catch{}for(var s=[],i=0;i!=e.length;++i)s.push(String.fromCharCode(e[i]));return s.join("")}function Ir(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=Ir(e[t]));return r}function Lt(e,r){for(var t="";t.length<r;)t+=e;return t}function $n(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,s=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(s))||(s=s.replace(/[(](.*)[)]/,function(i,o){return t=-t,o}),!isNaN(r=Number(s)))?r/t:r}var o2=["january","february","march","april","may","june","july","august","september","october","november","december"];function ji(e){var r=new Date(e),t=new Date(NaN),s=r.getYear(),i=r.getMonth(),o=r.getDate();if(isNaN(o))return t;var u=e.toLowerCase();if(u.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(u=u.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),u.length>3&&o2.indexOf(u)==-1)return t}else if(u.match(/[a-z]/))return t;return s<0||s>8099?t:(i>0||o>1)&&s!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}function st(e,r,t){if(e.FullPaths){if(typeof t=="string"){var s;return vt?s=Xn(t):s=jg(t),Nt.utils.cfb_add(e,r,s)}Nt.utils.cfb_add(e,r,t)}else e.file(r,t)}function Yu(){return Nt.utils.cfb_new()}var Kt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,c2={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},qu=Ku(c2),Qu=/[&<>'"]/g,u2=/[\u0000-\u0008\u000b-\u001f]/g;function St(e){var r=e+"";return r.replace(Qu,function(t){return qu[t]}).replace(u2,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function gh(e){return St(e).replace(/ /g,"_x0020_")}var Fp=/[\u0000-\u001f]/g;function f2(e){var r=e+"";return r.replace(Qu,function(t){return qu[t]}).replace(/\n/g,"<br/>").replace(Fp,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function d2(e){var r=e+"";return r.replace(Qu,function(t){return qu[t]}).replace(Fp,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function h2(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function p2(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function yu(e){for(var r="",t=0,s=0,i=0,o=0,u=0,d=0;t<e.length;){if(s=e.charCodeAt(t++),s<128){r+=String.fromCharCode(s);continue}if(i=e.charCodeAt(t++),s>191&&s<224){u=(s&31)<<6,u|=i&63,r+=String.fromCharCode(u);continue}if(o=e.charCodeAt(t++),s<240){r+=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63);continue}u=e.charCodeAt(t++),d=((s&7)<<18|(i&63)<<12|(o&63)<<6|u&63)-65536,r+=String.fromCharCode(55296+(d>>>10&1023)),r+=String.fromCharCode(56320+(d&1023))}return r}function yh(e){var r=$a(2*e.length),t,s,i=1,o=0,u=0,d;for(s=0;s<e.length;s+=i)i=1,(d=e.charCodeAt(s))<128?t=d:d<224?(t=(d&31)*64+(e.charCodeAt(s+1)&63),i=2):d<240?(t=(d&15)*4096+(e.charCodeAt(s+1)&63)*64+(e.charCodeAt(s+2)&63),i=3):(i=4,t=(d&7)*262144+(e.charCodeAt(s+1)&63)*4096+(e.charCodeAt(s+2)&63)*64+(e.charCodeAt(s+3)&63),t-=65536,u=55296+(t>>>10&1023),t=56320+(t&1023)),u!==0&&(r[o++]=u&255,r[o++]=u>>>8,u=0),r[o++]=t%256,r[o++]=t>>>8;return r.slice(0,o).toString("ucs2")}function wh(e){return Xn(e,"binary").toString("utf8")}var Ql="foo bar baz",Ti=vt&&(wh(Ql)==yu(Ql)&&wh||yh(Ql)==yu(Ql)&&yh)||yu,Pi=vt?function(e){return Xn(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,s=0,i=0;t<e.length;)switch(s=e.charCodeAt(t++),!0){case s<128:r.push(String.fromCharCode(s));break;case s<2048:r.push(String.fromCharCode(192+(s>>6))),r.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,i=e.charCodeAt(t++)-56320+(s<<10),r.push(String.fromCharCode(240+(i>>18&7))),r.push(String.fromCharCode(144+(i>>12&63))),r.push(String.fromCharCode(128+(i>>6&63))),r.push(String.fromCharCode(128+(i&63)));break;default:r.push(String.fromCharCode(224+(s>>12))),r.push(String.fromCharCode(128+(s>>6&63))),r.push(String.fromCharCode(128+(s&63)))}return r.join("")},x2=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var s=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)s=s.replace(e[i][0],e[i][1]);return s}})(),jp=/(^\s|\s$|\n)/;function dr(e,r){return"<"+e+(r.match(jp)?' xml:space="preserve"':"")+">"+r+"</"+e+">"}function Oi(e){return pr(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function Fe(e,r,t){return"<"+e+(t!=null?Oi(t):"")+(r!=null?(r.match(jp)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function Du(e,r){try{return e.toISOString().replace(/\.\d*/,"")}catch(t){if(r)throw t}return""}function m2(e,r){switch(typeof e){case"string":var t=Fe("vt:lpwstr",St(e));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return Fe((e|0)==e?"vt:i4":"vt:r8",St(String(e)));case"boolean":return Fe("vt:bool",e?"true":"false")}if(e instanceof Date)return Fe("vt:filetime",Du(e));throw new Error("Unable to serialize "+e)}var nr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Os=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],$r={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function v2(e,r){for(var t=1-2*(e[r+7]>>>7),s=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),i=e[r+6]&15,o=5;o>=0;--o)i=i*256+e[r+o];return s==2047?i==0?t*(1/0):NaN:(s==0?s=-1022:(s-=1023,i+=Math.pow(2,52)),t*Math.pow(2,s-52)*i)}function g2(e,r,t){var s=(r<0||1/r==-1/0?1:0)<<7,i=0,o=0,u=s?-r:r;isFinite(u)?u==0?i=o=0:(i=Math.floor(Math.log(u)/Math.LN2),o=u*Math.pow(2,52-i),i<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?i=-1022:(o-=Math.pow(2,52),i+=1023)):(i=2047,o=isNaN(r)?26985:0);for(var d=0;d<=5;++d,o/=256)e[t+d]=o&255;e[t+6]=(i&15)<<4|o&15,e[t+7]=i>>4|s}var _h=function(e){for(var r=[],t=10240,s=0;s<e[0].length;++s)if(e[0][s])for(var i=0,o=e[0][s].length;i<o;i+=t)r.push.apply(r,e[0][s].slice(i,i+t));return r},Eh=vt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:Xn(r)})):_h(e)}:_h,Sh=function(e,r,t){for(var s=[],i=r;i<t;i+=2)s.push(String.fromCharCode(_i(e,i)));return s.join("").replace(Si,"")},Ju=vt?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(Si,""):Sh(e,r,t)}:Sh,Th=function(e,r,t){for(var s=[],i=r;i<r+t;++i)s.push(("0"+e[i].toString(16)).slice(-2));return s.join("")},Pp=vt?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):Th(e,r,t)}:Th,Nh=function(e,r,t){for(var s=[],i=r;i<t;i++)s.push(String.fromCharCode(Ns(e,i)));return s.join("")},Bi=vt?function(r,t,s){return Buffer.isBuffer(r)?r.toString("utf8",t,s):Nh(r,t,s)}:Nh,Op=function(e,r){var t=Hr(e,r);return t>0?Bi(e,r+4,r+4+t-1):""},Rp=Op,Dp=function(e,r){var t=Hr(e,r);return t>0?Bi(e,r+4,r+4+t-1):""},Ip=Dp,Mp=function(e,r){var t=2*Hr(e,r);return t>0?Bi(e,r+4,r+4+t-1):""},Lp=Mp,Bp=function(r,t){var s=Hr(r,t);return s>0?Ju(r,t+4,t+4+s):""},Up=Bp,zp=function(e,r){var t=Hr(e,r);return t>0?Bi(e,r+4,r+4+t):""},Wp=zp,$p=function(e,r){return v2(e,r)},uo=$p,Zu=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};vt&&(Rp=function(r,t){if(!Buffer.isBuffer(r))return Op(r,t);var s=r.readUInt32LE(t);return s>0?r.toString("utf8",t+4,t+4+s-1):""},Ip=function(r,t){if(!Buffer.isBuffer(r))return Dp(r,t);var s=r.readUInt32LE(t);return s>0?r.toString("utf8",t+4,t+4+s-1):""},Lp=function(r,t){if(!Buffer.isBuffer(r))return Mp(r,t);var s=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+s-1)},Up=function(r,t){if(!Buffer.isBuffer(r))return Bp(r,t);var s=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+s)},Wp=function(r,t){if(!Buffer.isBuffer(r))return zp(r,t);var s=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+s)},uo=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):$p(r,t)},Zu=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var Ns=function(e,r){return e[r]},_i=function(e,r){return e[r+1]*256+e[r]},y2=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},Hr=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},Ba=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},w2=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function Ni(e,r){var t="",s,i,o=[],u,d,x,p;switch(r){case"dbcs":if(p=this.l,vt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(x=0;x<e;++x)t+=String.fromCharCode(_i(this,p)),p+=2;e*=2;break;case"utf8":t=Bi(this,this.l,this.l+e);break;case"utf16le":e*=2,t=Ju(this,this.l,this.l+e);break;case"wstr":return Ni.call(this,e,"dbcs");case"lpstr-ansi":t=Rp(this,this.l),e=4+Hr(this,this.l);break;case"lpstr-cp":t=Ip(this,this.l),e=4+Hr(this,this.l);break;case"lpwstr":t=Lp(this,this.l),e=4+2*Hr(this,this.l);break;case"lpp4":e=4+Hr(this,this.l),t=Up(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Hr(this,this.l),t=Wp(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(u=Ns(this,this.l+e++))!==0;)o.push(Kl(u));t=o.join("");break;case"_wstr":for(e=0,t="";(u=_i(this,this.l+e))!==0;)o.push(Kl(u)),e+=2;e+=2,t=o.join("");break;case"dbcs-cont":for(t="",p=this.l,x=0;x<e;++x){if(this.lens&&this.lens.indexOf(p)!==-1)return u=Ns(this,p),this.l=p+1,d=Ni.call(this,e-x,u?"dbcs-cont":"sbcs-cont"),o.join("")+d;o.push(Kl(_i(this,p))),p+=2}t=o.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",p=this.l,x=0;x!=e;++x){if(this.lens&&this.lens.indexOf(p)!==-1)return u=Ns(this,p),this.l=p+1,d=Ni.call(this,e-x,u?"dbcs-cont":"sbcs-cont"),o.join("")+d;o.push(Kl(Ns(this,p))),p+=1}t=o.join("");break;default:switch(e){case 1:return s=Ns(this,this.l),this.l++,s;case 2:return s=(r==="i"?y2:_i)(this,this.l),this.l+=2,s;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(s=(e>0?Ba:w2)(this,this.l),this.l+=4,s):(i=Hr(this,this.l),this.l+=4,i);case 8:case-8:if(r==="f")return e==8?i=uo(this,this.l):i=uo([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:t=Pp(this,this.l,e);break}}return this.l+=e,t}var _2=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},E2=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},S2=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function T2(e,r,t){var s=0,i=0;if(t==="dbcs"){for(i=0;i!=r.length;++i)S2(this,r.charCodeAt(i),this.l+2*i);s=2*r.length}else if(t==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=r.length;++i)this[this.l+i]=r.charCodeAt(i)&255;s=r.length}else if(t==="hex"){for(;i<e;++i)this[this.l++]=parseInt(r.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var o=Math.min(this.l+e,this.length);for(i=0;i<Math.min(r.length,e);++i){var u=r.charCodeAt(i);this[this.l++]=u&255,this[this.l++]=u>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:s=1,this[this.l]=r&255;break;case 2:s=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:s=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:s=4,_2(this,r,this.l);break;case 8:if(s=8,t==="f"){g2(this,r,this.l);break}case 16:break;case-4:s=4,E2(this,r,this.l);break}return this.l+=s,this}function Hp(e,r){var t=Pp(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function Wr(e,r){e.l=r,e.read_shift=Ni,e.chk=Hp,e.write_shift=T2}function bn(e,r){e.l+=r}function pe(e){var r=$a(e);return Wr(r,0),r}function Rr(){var e=[],r=vt?256:2048,t=function(p){var m=pe(p);return Wr(m,0),m},s=t(r),i=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&e.push(s),s=null)},o=function(p){return s&&p<s.length-s.l?s:(i(),s=t(Math.max(p+1,r)))},u=function(){return i(),fr(e)},d=function(p){i(),s=p,s.l==null&&(s.l=s.length),o(r)};return{next:o,push:d,end:u,_bufs:e}}function ge(e,r,t,s){var i=+r,o;if(!isNaN(i)){s||(s=vS[i].p||(t||[]).length||0),o=1+(i>=128?1:0)+1,s>=128&&++o,s>=16384&&++o,s>=2097152&&++o;var u=e.next(o);i<=127?u.write_shift(1,i):(u.write_shift(1,(i&127)+128),u.write_shift(1,i>>7));for(var d=0;d!=4;++d)if(s>=128)u.write_shift(1,(s&127)+128),s>>=7;else{u.write_shift(1,s);break}s>0&&Zu(t)&&e.push(t)}}function ki(e,r,t){var s=Ir(e);if(r.s?(s.cRel&&(s.c+=r.s.c),s.rRel&&(s.r+=r.s.r)):(s.cRel&&(s.c+=r.c),s.rRel&&(s.r+=r.r)),!t||t.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function kh(e,r,t){var s=Ir(e);return s.s=ki(s.s,r.s,t),s.e=ki(s.e,r.s,t),s}function Ci(e,r){if(e.cRel&&e.c<0)for(e=Ir(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=Ir(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=Tt(e);return!e.cRel&&e.cRel!=null&&(t=C2(t)),!e.rRel&&e.rRel!=null&&(t=N2(t)),t}function wu(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+yr(e.s.c)+":"+(e.e.cRel?"":"$")+yr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+hr(e.s.r)+":"+(e.e.rRel?"":"$")+hr(e.e.r):Ci(e.s,r.biff)+":"+Ci(e.e,r.biff)}function e0(e){return parseInt(k2(e),10)-1}function hr(e){return""+(e+1)}function N2(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function k2(e){return e.replace(/\$(\d+)$/,"$1")}function t0(e){for(var r=A2(e),t=0,s=0;s!==r.length;++s)t=26*t+r.charCodeAt(s)-64;return t-1}function yr(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function C2(e){return e.replace(/^([A-Z])/,"$$$1")}function A2(e){return e.replace(/^\$([A-Z])/,"$1")}function b2(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ar(e){for(var r=0,t=0,s=0;s<e.length;++s){var i=e.charCodeAt(s);i>=48&&i<=57?r=10*r+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:r-1}}function Tt(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function Vr(e){var r=e.indexOf(":");return r==-1?{s:ar(e),e:ar(e)}:{s:ar(e.slice(0,r)),e:ar(e.slice(r+1))}}function Xt(e,r){return typeof r>"u"||typeof r=="number"?Xt(e.s,e.e):(typeof e!="string"&&(e=Tt(e)),typeof r!="string"&&(r=Tt(r)),e==r?e:e+":"+r)}function Pt(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,s=0,i=0,o=e.length;for(t=0;s<o&&!((i=e.charCodeAt(s)-64)<1||i>26);++s)t=26*t+i;for(r.s.c=--t,t=0;s<o&&!((i=e.charCodeAt(s)-48)<0||i>9);++s)t=10*t+i;if(r.s.r=--t,s===o||i!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++s,t=0;s!=o&&!((i=e.charCodeAt(s)-64)<1||i>26);++s)t=26*t+i;for(r.e.c=--t,t=0;s!=o&&!((i=e.charCodeAt(s)-48)<0||i>9);++s)t=10*t+i;return r.e.r=--t,r}function Ch(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=ga(e.z,t?Dr(r):r)}catch{}try{return e.w=ga((e.XF||{}).numFmtId||(t?14:0),t?Dr(r):r)}catch{return""+r}}function Gn(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?Ui[e.v]||e.v:r==null?Ch(e,e.v):Ch(e,r))}function Ga(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",s={};return s[t]=e,{SheetNames:[t],Sheets:s}}function Vp(e,r,t){var s=t||{},i=e?Array.isArray(e):s.dense,o=e||(i?[]:{}),u=0,d=0;if(o&&s.origin!=null){if(typeof s.origin=="number")u=s.origin;else{var x=typeof s.origin=="string"?ar(s.origin):s.origin;u=x.r,d=x.c}o["!ref"]||(o["!ref"]="A1:A1")}var p={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var m=Pt(o["!ref"]);p.s.c=m.s.c,p.s.r=m.s.r,p.e.c=Math.max(p.e.c,m.e.c),p.e.r=Math.max(p.e.r,m.e.r),u==-1&&(p.e.r=u=m.e.r+1)}for(var w=0;w!=r.length;++w)if(r[w]){if(!Array.isArray(r[w]))throw new Error("aoa_to_sheet expects an array of arrays");for(var y=0;y!=r[w].length;++y)if(!(typeof r[w][y]>"u")){var E={v:r[w][y]},N=u+w,g=d+y;if(p.s.r>N&&(p.s.r=N),p.s.c>g&&(p.s.c=g),p.e.r<N&&(p.e.r=N),p.e.c<g&&(p.e.c=g),r[w][y]&&typeof r[w][y]=="object"&&!Array.isArray(r[w][y])&&!(r[w][y]instanceof Date))E=r[w][y];else if(Array.isArray(E.v)&&(E.f=r[w][y][1],E.v=E.v[0]),E.v===null)if(E.f)E.t="n";else if(s.nullError)E.t="e",E.v=0;else if(s.sheetStubs)E.t="z";else continue;else typeof E.v=="number"?E.t="n":typeof E.v=="boolean"?E.t="b":E.v instanceof Date?(E.z=s.dateNF||Bt[14],s.cellDates?(E.t="d",E.w=ga(E.z,Dr(E.v))):(E.t="n",E.v=Dr(E.v),E.w=ga(E.z,E.v))):E.t="s";if(i)o[N]||(o[N]=[]),o[N][g]&&o[N][g].z&&(E.z=o[N][g].z),o[N][g]=E;else{var _=Tt({c:g,r:N});o[_]&&o[_].z&&(E.z=o[_].z),o[_]=E}}}return p.s.c<1e7&&(o["!ref"]=Xt(p)),o}function Rs(e,r){return Vp(null,e,r)}function F2(e){return e.read_shift(4,"i")}function vn(e,r){return r||(r=pe(4)),r.write_shift(4,e),r}function wr(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function sr(e,r){var t=!1;return r==null&&(t=!0,r=pe(4+2*e.length)),r.write_shift(4,e.length),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}function j2(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function P2(e,r){return r||(r=pe(4)),r.write_shift(2,0),r.write_shift(2,0),r}function r0(e,r){var t=e.l,s=e.read_shift(1),i=wr(e),o=[],u={t:i,h:i};if((s&1)!==0){for(var d=e.read_shift(4),x=0;x!=d;++x)o.push(j2(e));u.r=o}else u.r=[{ich:0,ifnt:0}];return e.l=t+r,u}function O2(e,r){var t=!1;return r==null&&(t=!0,r=pe(15+4*e.t.length)),r.write_shift(1,0),sr(e.t,r),t?r.slice(0,r.l):r}var R2=r0;function D2(e,r){var t=!1;return r==null&&(t=!0,r=pe(23+4*e.t.length)),r.write_shift(1,1),sr(e.t,r),r.write_shift(4,1),P2({},r),t?r.slice(0,r.l):r}function tn(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function Xa(e,r){return r==null&&(r=pe(8)),r.write_shift(-4,e.c),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}function Ka(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}function Ya(e,r){return r==null&&(r=pe(4)),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}var I2=wr,Gp=sr;function n0(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}function fo(e,r){var t=!1;return r==null&&(t=!0,r=pe(127)),r.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}var M2=wr,Iu=n0,a0=fo;function Xp(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,s=r[0]&2;e.l+=4;var i=s===0?uo([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):Ba(r,0)>>2;return t?i/100:i}function Kp(e,r){r==null&&(r=pe(4));var t=0,s=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?s=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(s=1,t=1),s)r.write_shift(-4,((t?i:e)<<2)+(t+2));else throw new Error("unsupported RkNumber "+e)}function Yp(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}function L2(e,r){return r||(r=pe(16)),r.write_shift(4,e.s.r),r.write_shift(4,e.e.r),r.write_shift(4,e.s.c),r.write_shift(4,e.e.c),r}var qa=Yp,Ds=L2;function Is(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Ha(e,r){return(r||pe(8)).write_shift(8,e,"f")}function B2(e){var r={},t=e.read_shift(1),s=t>>>1,i=e.read_shift(1),o=e.read_shift(2,"i"),u=e.read_shift(1),d=e.read_shift(1),x=e.read_shift(1);switch(e.l++,s){case 0:r.auto=1;break;case 1:r.index=i;var p=K2[i];p&&(r.rgb=Lh(p));break;case 2:r.rgb=Lh([u,d,x]);break;case 3:r.theme=i;break}return o!=0&&(r.tint=o>0?o/32767:o/32768),r}function ho(e,r){if(r||(r=pe(8)),!e||e.auto)return r.write_shift(4,0),r.write_shift(4,0),r;e.index!=null?(r.write_shift(1,2),r.write_shift(1,e.index)):e.theme!=null?(r.write_shift(1,6),r.write_shift(1,e.theme)):(r.write_shift(1,5),r.write_shift(1,0));var t=e.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),r.write_shift(2,t),!e.rgb||e.theme!=null)r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);else{var s=e.rgb||"FFFFFF";typeof s=="number"&&(s=("000000"+s.toString(16)).slice(-6)),r.write_shift(1,parseInt(s.slice(0,2),16)),r.write_shift(1,parseInt(s.slice(2,4),16)),r.write_shift(1,parseInt(s.slice(4,6),16)),r.write_shift(1,255)}return r}function U2(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function z2(e,r){r||(r=pe(2));var t=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return r.write_shift(1,t),r.write_shift(1,0),r}var qp=2,zr=3,Jl=11,po=19,Zl=64,W2=65,$2=71,H2=4108,V2=4126,ur=80,Ah={1:{n:"CodePage",t:qp},2:{n:"Category",t:ur},3:{n:"PresentationFormat",t:ur},4:{n:"ByteCount",t:zr},5:{n:"LineCount",t:zr},6:{n:"ParagraphCount",t:zr},7:{n:"SlideCount",t:zr},8:{n:"NoteCount",t:zr},9:{n:"HiddenCount",t:zr},10:{n:"MultimediaClipCount",t:zr},11:{n:"ScaleCrop",t:Jl},12:{n:"HeadingPairs",t:H2},13:{n:"TitlesOfParts",t:V2},14:{n:"Manager",t:ur},15:{n:"Company",t:ur},16:{n:"LinksUpToDate",t:Jl},17:{n:"CharacterCount",t:zr},19:{n:"SharedDoc",t:Jl},22:{n:"HyperlinksChanged",t:Jl},23:{n:"AppVersion",t:zr,p:"version"},24:{n:"DigSig",t:W2},26:{n:"ContentType",t:ur},27:{n:"ContentStatus",t:ur},28:{n:"Language",t:ur},29:{n:"Version",t:ur},255:{},2147483648:{n:"Locale",t:po},2147483651:{n:"Behavior",t:po},1919054434:{}},bh={1:{n:"CodePage",t:qp},2:{n:"Title",t:ur},3:{n:"Subject",t:ur},4:{n:"Author",t:ur},5:{n:"Keywords",t:ur},6:{n:"Comments",t:ur},7:{n:"Template",t:ur},8:{n:"LastAuthor",t:ur},9:{n:"RevNumber",t:ur},10:{n:"EditTime",t:Zl},11:{n:"LastPrinted",t:Zl},12:{n:"CreatedDate",t:Zl},13:{n:"ModifiedDate",t:Zl},14:{n:"PageCount",t:zr},15:{n:"WordCount",t:zr},16:{n:"CharCount",t:zr},17:{n:"Thumbnail",t:$2},18:{n:"Application",t:ur},19:{n:"DocSecurity",t:zr},255:{},2147483648:{n:"Locale",t:po},2147483651:{n:"Behavior",t:po},1919054434:{}};function G2(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var X2=G2([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),K2=Ir(X2),Ui={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Y2={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},eo={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Qp(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Jp(e,r){var t=s2(Y2),s=[],i;s[s.length]=Kt,s[s.length]=Fe("Types",null,{xmlns:nr.CT,"xmlns:xsd":nr.xsd,"xmlns:xsi":nr.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(x){return Fe("Default",null,{Extension:x[0],ContentType:x[1]})}));var o=function(x){e[x]&&e[x].length>0&&(i=e[x][0],s[s.length]=Fe("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:eo[x][r.bookType]||eo[x].xlsx}))},u=function(x){(e[x]||[]).forEach(function(p){s[s.length]=Fe("Override",null,{PartName:(p[0]=="/"?"":"/")+p,ContentType:eo[x][r.bookType]||eo[x].xlsx})})},d=function(x){(e[x]||[]).forEach(function(p){s[s.length]=Fe("Override",null,{PartName:(p[0]=="/"?"":"/")+p,ContentType:t[x][0]})})};return o("workbooks"),u("sheets"),u("charts"),d("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(d),d("vba"),d("comments"),d("threadedcomments"),d("drawings"),u("metadata"),d("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var xt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Zp(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function bs(e){var r=[Kt,Fe("Relationships",null,{xmlns:nr.RELS})];return pr(e["!id"]).forEach(function(t){r[r.length]=Fe("Relationship",null,e["!id"][t])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function Et(e,r,t,s,i,o){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),r<0)for(r=e["!idx"];e["!id"]["rId"+r];++r);if(e["!idx"]=r+1,i.Id="rId"+r,i.Type=s,i.Target=t,[xt.HLINK,xt.XPATH,xt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+r);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,r}function q2(e){var r=[Kt];r.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),r.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<e.length;++t)r.push('  <manifest:file-entry manifest:full-path="'+e[t][0]+'" manifest:media-type="'+e[t][1]+`"/>
`);return r.push("</manifest:manifest>"),r.join("")}function Fh(e,r,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+r+`"/>
`,`  </rdf:Description>
`].join("")}function Q2(e,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+`"/>
`,`  </rdf:Description>
`].join("")}function J2(e){var r=[Kt];r.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=e.length;++t)r.push(Fh(e[t][0],e[t][1])),r.push(Q2("",e[t][0]));return r.push(Fh("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}function ex(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+ao.version+"</meta:generator></office:meta></office:document-meta>"}var Wa=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function _u(e,r,t,s,i){i[e]!=null||r==null||r===""||(i[e]=r,r=St(r),s[s.length]=t?Fe(e,r,t):dr(e,r))}function tx(e,r){var t=r||{},s=[Kt,Fe("cp:coreProperties",null,{"xmlns:cp":nr.CORE_PROPS,"xmlns:dc":nr.dc,"xmlns:dcterms":nr.dcterms,"xmlns:dcmitype":nr.dcmitype,"xmlns:xsi":nr.xsi})],i={};if(!e&&!t.Props)return s.join("");e&&(e.CreatedDate!=null&&_u("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Du(e.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},s,i),e.ModifiedDate!=null&&_u("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Du(e.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},s,i));for(var o=0;o!=Wa.length;++o){var u=Wa[o],d=t.Props&&t.Props[u[1]]!=null?t.Props[u[1]]:e?e[u[1]]:null;d===!0?d="1":d===!1?d="0":typeof d=="number"&&(d=String(d)),d!=null&&_u(u[0],d,null,s,i)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var Fs=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],rx=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function nx(e){var r=[],t=Fe;return e||(e={}),e.Application="SheetJS",r[r.length]=Kt,r[r.length]=Fe("Properties",null,{xmlns:nr.EXT_PROPS,"xmlns:vt":nr.vt}),Fs.forEach(function(s){if(e[s[1]]!==void 0){var i;switch(s[2]){case"string":i=St(String(e[s[1]]));break;case"bool":i=e[s[1]]?"true":"false";break}i!==void 0&&(r[r.length]=t(s[0],i))}}),r[r.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=t("TitlesOfParts",t("vt:vector",e.SheetNames.map(function(s){return"<vt:lpstr>"+St(s)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}function ax(e){var r=[Kt,Fe("Properties",null,{xmlns:nr.CUST_PROPS,"xmlns:vt":nr.vt})];if(!e)return r.join("");var t=1;return pr(e).forEach(function(i){++t,r[r.length]=Fe("property",m2(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:St(i)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var jh={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Z2(e,r){var t=[];return pr(jh).map(function(s){for(var i=0;i<Wa.length;++i)if(Wa[i][1]==s)return Wa[i];for(i=0;i<Fs.length;++i)if(Fs[i][1]==s)return Fs[i];throw s}).forEach(function(s){if(e[s[1]]!=null){var i=r&&r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e[s[1]];s[2]==="date"&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"Z")),typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),t.push(dr(jh[s[1]]||s[1],i))}}),Fe("DocumentProperties",t.join(""),{xmlns:$r.o})}function ey(e,r){var t=["Worksheets","SheetNames"],s="CustomDocumentProperties",i=[];return e&&pr(e).forEach(function(o){if(Object.prototype.hasOwnProperty.call(e,o)){for(var u=0;u<Wa.length;++u)if(o==Wa[u][1])return;for(u=0;u<Fs.length;++u)if(o==Fs[u][1])return;for(u=0;u<t.length;++u)if(o==t[u])return;var d=e[o],x="string";typeof d=="number"?(x="float",d=String(d)):d===!0||d===!1?(x="boolean",d=d?"1":"0"):d=String(d),i.push(Fe(gh(o),d,{"dt:dt":x}))}}),r&&pr(r).forEach(function(o){if(Object.prototype.hasOwnProperty.call(r,o)&&!(e&&Object.prototype.hasOwnProperty.call(e,o))){var u=r[o],d="string";typeof u=="number"?(d="float",u=String(u)):u===!0||u===!1?(d="boolean",u=u?"1":"0"):u instanceof Date?(d="dateTime.tz",u=u.toISOString()):u=String(u),i.push(Fe(gh(o),u,{"dt:dt":d}))}}),"<"+s+' xmlns="'+$r.o+'">'+i.join("")+"</"+s+">"}function ty(e){var r=typeof e=="string"?new Date(Date.parse(e)):e,t=r.getTime()/1e3+11644473600,s=t%Math.pow(2,32),i=(t-s)/Math.pow(2,32);s*=1e7,i*=1e7;var o=s/Math.pow(2,32)|0;o>0&&(s=s%Math.pow(2,32),i+=o);var u=pe(8);return u.write_shift(4,s),u.write_shift(4,i),u}function Ph(e,r){var t=pe(4),s=pe(4);switch(t.write_shift(4,e==80?31:e),e){case 3:s.write_shift(-4,r);break;case 5:s=pe(8),s.write_shift(8,r,"f");break;case 11:s.write_shift(4,r?1:0);break;case 64:s=ty(r);break;case 31:case 80:for(s=pe(4+2*(r.length+1)+(r.length%2?0:2)),s.write_shift(4,r.length+1),s.write_shift(0,r,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}return fr([t,s])}var sx=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function ry(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Oh(e,r,t){var s=pe(8),i=[],o=[],u=8,d=0,x=pe(8),p=pe(8);if(x.write_shift(4,2),x.write_shift(4,1200),p.write_shift(4,1),o.push(x),i.push(p),u+=8+x.length,!r){p=pe(8),p.write_shift(4,0),i.unshift(p);var m=[pe(4)];for(m[0].write_shift(4,e.length),d=0;d<e.length;++d){var w=e[d][0];for(x=pe(8+2*(w.length+1)+(w.length%2?0:2)),x.write_shift(4,d+2),x.write_shift(4,w.length+1),x.write_shift(0,w,"dbcs");x.l!=x.length;)x.write_shift(1,0);m.push(x)}x=fr(m),o.unshift(x),u+=8+x.length}for(d=0;d<e.length;++d)if(!(r&&!r[e[d][0]])&&!(sx.indexOf(e[d][0])>-1||rx.indexOf(e[d][0])>-1)&&e[d][1]!=null){var y=e[d][1],E=0;if(r){E=+r[e[d][0]];var N=t[E];if(N.p=="version"&&typeof y=="string"){var g=y.split(".");y=(+g[0]<<16)+(+g[1]||0)}x=Ph(N.t,y)}else{var _=ry(y);_==-1&&(_=31,y=String(y)),x=Ph(_,y)}o.push(x),p=pe(8),p.write_shift(4,r?E:2+d),i.push(p),u+=8+x.length}var b=8*(o.length+1);for(d=0;d<o.length;++d)i[d].write_shift(4,b),b+=o[d].length;return s.write_shift(4,u),s.write_shift(4,o.length),fr([s].concat(i).concat(o))}function Rh(e,r,t,s,i,o){var u=pe(i?68:48),d=[u];u.write_shift(2,65534),u.write_shift(2,0),u.write_shift(4,842412599),u.write_shift(16,Nt.utils.consts.HEADER_CLSID,"hex"),u.write_shift(4,i?2:1),u.write_shift(16,r,"hex"),u.write_shift(4,i?68:48);var x=Oh(e,t,s);if(d.push(x),i){var p=Oh(i,null,null);u.write_shift(16,o,"hex"),u.write_shift(4,68+x.length),d.push(p)}return fr(d)}function ny(e,r){r||(r=pe(e));for(var t=0;t<e;++t)r.write_shift(1,0);return r}function ay(e,r){return e.read_shift(r)===1}function kr(e,r){return r||(r=pe(2)),r.write_shift(2,+!!e),r}function ix(e){return e.read_shift(2,"u")}function en(e,r){return r||(r=pe(2)),r.write_shift(2,e),r}function lx(e,r,t){return t||(t=pe(2)),t.write_shift(1,r=="e"?+e:+!!e),t.write_shift(1,r=="e"?1:0),t}function ox(e,r,t){var s=e.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var o=e.read_shift(1);o&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var u=s?e.read_shift(s,i):"";return u}function sy(e){var r=e.t||"",t=pe(3);t.write_shift(2,r.length),t.write_shift(1,1);var s=pe(2*r.length);s.write_shift(2*r.length,r,"utf16le");var i=[t,s];return fr(i)}function iy(e,r,t){var s;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var i=e.read_shift(1);return i===0?s=e.read_shift(r,"sbcs-cont"):s=e.read_shift(r,"dbcs-cont"),s}function ly(e,r,t){var s=e.read_shift(t&&t.biff==2?1:2);return s===0?(e.l++,""):iy(e,s,t)}function oy(e,r,t){if(t.biff>5)return ly(e,r,t);var s=e.read_shift(1);return s===0?(e.l++,""):e.read_shift(s,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function cx(e,r,t){return t||(t=pe(3+2*e.length)),t.write_shift(2,e.length),t.write_shift(1,1),t.write_shift(31,e,"utf16le"),t}function Dh(e,r){r||(r=pe(6+e.length*2)),r.write_shift(4,1+e.length);for(var t=0;t<e.length;++t)r.write_shift(2,e.charCodeAt(t));return r.write_shift(2,0),r}function cy(e){var r=pe(512),t=0,s=e.Target;s.slice(0,7)=="file://"&&(s=s.slice(7));var i=s.indexOf("#"),o=i>-1?31:23;switch(s.charAt(0)){case"#":o=28;break;case".":o&=-3;break}r.write_shift(4,2),r.write_shift(4,o);var u=[8,6815827,6619237,4849780,83];for(t=0;t<u.length;++t)r.write_shift(4,u[t]);if(o==28)s=s.slice(1),Dh(s,r);else if(o&2){for(u="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<u.length;++t)r.write_shift(1,parseInt(u[t],16));var d=i>-1?s.slice(0,i):s;for(r.write_shift(4,2*(d.length+1)),t=0;t<d.length;++t)r.write_shift(2,d.charCodeAt(t));r.write_shift(2,0),o&8&&Dh(i>-1?s.slice(i+1):"",r)}else{for(u="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<u.length;++t)r.write_shift(1,parseInt(u[t],16));for(var x=0;s.slice(x*3,x*3+3)=="../"||s.slice(x*3,x*3+3)=="..\\";)++x;for(r.write_shift(2,x),r.write_shift(4,s.length-3*x+1),t=0;t<s.length-3*x;++t)r.write_shift(1,s.charCodeAt(t+3*x)&255);for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),t=0;t<6;++t)r.write_shift(4,0)}return r.slice(0,r.l)}function Va(e,r,t,s){return s||(s=pe(6)),s.write_shift(2,e),s.write_shift(2,r),s.write_shift(2,t||0),s}function uy(e,r,t){var s=t.biff>8?4:2,i=e.read_shift(s),o=e.read_shift(s,"i"),u=e.read_shift(s,"i");return[i,o,u]}function fy(e){var r=e.read_shift(2),t=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2);return{s:{c:s,r},e:{c:i,r:t}}}function ux(e,r){return r||(r=pe(8)),r.write_shift(2,e.s.r),r.write_shift(2,e.e.r),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c),r}function s0(e,r,t){var s=1536,i=16;switch(t.bookType){case"biff8":break;case"biff5":s=1280,i=8;break;case"biff4":s=4,i=6;break;case"biff3":s=3,i=6;break;case"biff2":s=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var o=pe(i);return o.write_shift(2,s),o.write_shift(2,r),i>4&&o.write_shift(2,29282),i>6&&o.write_shift(2,1997),i>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function dy(e,r){var t=!r||r.biff==8,s=pe(t?112:54);for(s.write_shift(r.biff==8?2:1,7),t&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(t?0:536870912));s.l<s.length;)s.write_shift(1,t?0:32);return s}function hy(e,r){var t=!r||r.biff>=8?2:1,s=pe(8+t*e.name.length);s.write_shift(4,e.pos),s.write_shift(1,e.hs||0),s.write_shift(1,e.dt),s.write_shift(1,e.name.length),r.biff>=8&&s.write_shift(1,1),s.write_shift(t*e.name.length,e.name,r.biff<8?"sbcs":"utf16le");var i=s.slice(0,s.l);return i.l=s.l,i}function py(e,r){var t=pe(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var s=[],i=0;i<e.length;++i)s[i]=sy(e[i]);var o=fr([t].concat(s));return o.parts=[t.length].concat(s.map(function(u){return u.length})),o}function xy(){var e=pe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function my(e){var r=pe(18),t=1718;return e&&e.RTL&&(t|=64),r.write_shift(2,t),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}function vy(e,r){var t=e.name||"Arial",s=r&&r.biff==5,i=s?15+t.length:16+2*t.length,o=pe(i);return o.write_shift(2,e.sz*20),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,t.length),s||o.write_shift(1,1),o.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le"),o}function gy(e,r,t,s){var i=pe(10);return Va(e,r,s,i),i.write_shift(4,t),i}function yy(e,r,t,s,i){var o=!i||i.biff==8,u=pe(8+ +o+(1+o)*t.length);return Va(e,r,s,u),u.write_shift(2,t.length),o&&u.write_shift(1,1),u.write_shift((1+o)*t.length,t,o?"utf16le":"sbcs"),u}function wy(e,r,t,s){var i=t&&t.biff==5;s||(s=pe(i?3+r.length:5+2*r.length)),s.write_shift(2,e),s.write_shift(i?1:2,r.length),i||s.write_shift(1,1),s.write_shift((i?1:2)*r.length,r,i?"sbcs":"utf16le");var o=s.length>s.l?s.slice(0,s.l):s;return o.l==null&&(o.l=o.length),o}function _y(e,r){var t=r.biff==8||!r.biff?4:2,s=pe(2*t+6);return s.write_shift(t,e.s.r),s.write_shift(t,e.e.r+1),s.write_shift(2,e.s.c),s.write_shift(2,e.e.c+1),s.write_shift(2,0),s}function Ih(e,r,t,s){var i=t&&t.biff==5;s||(s=pe(i?16:20)),s.write_shift(2,0),e.style?(s.write_shift(2,e.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,e.numFmtId||0),s.write_shift(2,r<<4));var o=0;return e.numFmtId>0&&i&&(o|=1024),s.write_shift(4,o),s.write_shift(4,0),i||s.write_shift(4,0),s.write_shift(2,0),s}function Ey(e){var r=pe(8);return r.write_shift(4,0),r.write_shift(2,0),r.write_shift(2,0),r}function Sy(e,r,t,s,i,o){var u=pe(8);return Va(e,r,s,u),lx(t,o,u),u}function Ty(e,r,t,s){var i=pe(14);return Va(e,r,s,i),Ha(t,i),i}function Ny(e,r,t){if(t.biff<8)return ky(e,r,t);for(var s=[],i=e.l+r,o=e.read_shift(t.biff>8?4:2);o--!==0;)s.push(uy(e,t.biff>8?12:6,t));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return s}function ky(e,r,t){e[e.l+1]==3&&e[e.l]++;var s=ox(e,r,t);return s.charCodeAt(0)==3?s.slice(1):s}function Cy(e){var r=pe(2+e.length*8);r.write_shift(2,e.length);for(var t=0;t<e.length;++t)ux(e[t],r);return r}function Ay(e){var r=pe(24),t=ar(e[0]);r.write_shift(2,t.r),r.write_shift(2,t.r),r.write_shift(2,t.c),r.write_shift(2,t.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)r.write_shift(1,parseInt(s[i],16));return fr([r,cy(e[1])])}function by(e){var r=e[1].Tooltip,t=pe(10+2*(r.length+1));t.write_shift(2,2048);var s=ar(e[0]);t.write_shift(2,s.r),t.write_shift(2,s.r),t.write_shift(2,s.c),t.write_shift(2,s.c);for(var i=0;i<r.length;++i)t.write_shift(2,r.charCodeAt(i));return t.write_shift(2,0),t}function Fy(e){return e||(e=pe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function jy(e,r,t){if(!t.cellStyles)return bn(e,r);var s=t&&t.biff>=12?4:2,i=e.read_shift(s),o=e.read_shift(s),u=e.read_shift(s),d=e.read_shift(s),x=e.read_shift(2);s==2&&(e.l+=2);var p={s:i,e:o,w:u,ixfe:d,flags:x};return(t.biff>=5||!t.biff)&&(p.level=x>>8&7),p}function Py(e,r){var t=pe(12);t.write_shift(2,r),t.write_shift(2,r),t.write_shift(2,e.width*256),t.write_shift(2,0);var s=0;return e.hidden&&(s|=1),t.write_shift(1,s),s=e.level||0,t.write_shift(1,s),t.write_shift(2,0),t}function Oy(e){for(var r=pe(2*e),t=0;t<e;++t)r.write_shift(2,t+1);return r}function Ry(e,r,t){var s=pe(15);return Wi(s,e,r),s.write_shift(8,t,"f"),s}function Dy(e,r,t){var s=pe(9);return Wi(s,e,r),s.write_shift(2,t),s}var Iy=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=Ku({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(d,x){var p=[],m=$a(1);switch(x.type){case"base64":m=xn(Vn(d));break;case"binary":m=xn(d);break;case"buffer":case"array":m=d;break}Wr(m,0);var w=m.read_shift(1),y=!!(w&136),E=!1,N=!1;switch(w){case 2:break;case 3:break;case 48:E=!0,y=!0;break;case 49:E=!0,y=!0;break;case 131:break;case 139:break;case 140:N=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+w.toString(16))}var g=0,_=521;w==2&&(g=m.read_shift(2)),m.l+=3,w!=2&&(g=m.read_shift(4)),g>1048576&&(g=1e6),w!=2&&(_=m.read_shift(2));var b=m.read_shift(2),I=x.codepage||1252;w!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(I=e[m[m.l]]),m.l+=1,m.l+=2),N&&(m.l+=36);for(var O=[],J={},he=Math.min(m.length,w==2?521:_-10-(E?264:0)),de=N?32:11;m.l<he&&m[m.l]!=13;)switch(J={},J.name=so.utils.decode(I,m.slice(m.l,m.l+de)).replace(/[\u0000\r\n].*$/g,""),m.l+=de,J.type=String.fromCharCode(m.read_shift(1)),w!=2&&!N&&(J.offset=m.read_shift(4)),J.len=m.read_shift(1),w==2&&(J.offset=m.read_shift(2)),J.dec=m.read_shift(1),J.name.length&&O.push(J),w!=2&&(m.l+=N?13:14),J.type){case"B":(!E||J.len!=8)&&x.WTF&&console.log("Skipping "+J.name+":"+J.type);break;case"G":case"P":x.WTF&&console.log("Skipping "+J.name+":"+J.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+J.type)}if(m[m.l]!==13&&(m.l=_-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=_;var z=0,re=0;for(p[0]=[],re=0;re!=O.length;++re)p[0][re]=O[re].name;for(;g-- >0;){if(m[m.l]===42){m.l+=b;continue}for(++m.l,p[++z]=[],re=0,re=0;re!=O.length;++re){var V=m.slice(m.l,m.l+O[re].len);m.l+=O[re].len,Wr(V,0);var M=so.utils.decode(I,V);switch(O[re].type){case"C":M.trim().length&&(p[z][re]=M.replace(/\s+$/,""));break;case"D":M.length===8?p[z][re]=new Date(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8)):p[z][re]=M;break;case"F":p[z][re]=parseFloat(M.trim());break;case"+":case"I":p[z][re]=N?V.read_shift(-4,"i")^2147483648:V.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":p[z][re]=!0;break;case"N":case"F":p[z][re]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+w.toString(16));p[z][re]="##MEMO##"+(N?parseInt(M.trim(),10):V.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(p[z][re]=+M||0);break;case"@":p[z][re]=new Date(V.read_shift(-8,"f")-621356832e5);break;case"T":p[z][re]=new Date((V.read_shift(4)-2440588)*864e5+V.read_shift(4));break;case"Y":p[z][re]=V.read_shift(4,"i")/1e4+V.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":p[z][re]=-V.read_shift(-8,"f");break;case"B":if(E&&O[re].len==8){p[z][re]=V.read_shift(8,"f");break}case"G":case"P":V.l+=O[re].len;break;case"0":if(O[re].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+O[re].type)}}}if(w!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return x&&x.sheetRows&&(p=p.slice(0,x.sheetRows)),x.DBF=O,p}function s(d,x){var p=x||{};p.dateNF||(p.dateNF="yyyymmdd");var m=Rs(t(d,p),p);return m["!cols"]=p.DBF.map(function(w){return{wch:w.len,DBF:w}}),delete p.DBF,m}function i(d,x){try{return Ga(s(d,x),x)}catch(p){if(x&&x.WTF)throw p}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function u(d,x){var p=x||{};if(+p.codepage>=0&&bi(+p.codepage),p.type=="string")throw new Error("Cannot write DBF to JS string");var m=Rr(),w=yo(d,{header:1,raw:!0,cellDates:!0}),y=w[0],E=w.slice(1),N=d["!cols"]||[],g=0,_=0,b=0,I=1;for(g=0;g<y.length;++g){if(((N[g]||{}).DBF||{}).name){y[g]=N[g].DBF.name,++b;continue}if(y[g]!=null){if(++b,typeof y[g]=="number"&&(y[g]=y[g].toString(10)),typeof y[g]!="string")throw new Error("DBF Invalid column name "+y[g]+" |"+typeof y[g]+"|");if(y.indexOf(y[g])!==g){for(_=0;_<1024;++_)if(y.indexOf(y[g]+"_"+_)==-1){y[g]+="_"+_;break}}}}var O=Pt(d["!ref"]),J=[],he=[],de=[];for(g=0;g<=O.e.c-O.s.c;++g){var z="",re="",V=0,M=[];for(_=0;_<E.length;++_)E[_][g]!=null&&M.push(E[_][g]);if(M.length==0||y[g]==null){J[g]="?";continue}for(_=0;_<M.length;++_){switch(typeof M[_]){case"number":re="B";break;case"string":re="C";break;case"boolean":re="L";break;case"object":re=M[_]instanceof Date?"D":"C";break;default:re="C"}V=Math.max(V,String(M[_]).length),z=z&&z!=re?"C":re}V>250&&(V=250),re=((N[g]||{}).DBF||{}).type,re=="C"&&N[g].DBF.len>V&&(V=N[g].DBF.len),z=="B"&&re=="N"&&(z="N",de[g]=N[g].DBF.dec,V=N[g].DBF.len),he[g]=z=="C"||re=="N"?V:o[z]||0,I+=he[g],J[g]=z}var L=m.next(32);for(L.write_shift(4,318902576),L.write_shift(4,E.length),L.write_shift(2,296+32*b),L.write_shift(2,I),g=0;g<4;++g)L.write_shift(4,0);for(L.write_shift(4,0|(+r[dp]||3)<<8),g=0,_=0;g<y.length;++g)if(y[g]!=null){var X=m.next(32),K=(y[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);X.write_shift(1,K,"sbcs"),X.write_shift(1,J[g]=="?"?"C":J[g],"sbcs"),X.write_shift(4,_),X.write_shift(1,he[g]||o[J[g]]||0),X.write_shift(1,de[g]||0),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(1,0),X.write_shift(4,0),X.write_shift(4,0),_+=he[g]||o[J[g]]||0}var ne=m.next(264);for(ne.write_shift(4,13),g=0;g<65;++g)ne.write_shift(4,0);for(g=0;g<E.length;++g){var W=m.next(I);for(W.write_shift(1,0),_=0;_<y.length;++_)if(y[_]!=null)switch(J[_]){case"L":W.write_shift(1,E[g][_]==null?63:E[g][_]?84:70);break;case"B":W.write_shift(8,E[g][_]||0,"f");break;case"N":var Z="0";for(typeof E[g][_]=="number"&&(Z=E[g][_].toFixed(de[_]||0)),b=0;b<he[_]-Z.length;++b)W.write_shift(1,32);W.write_shift(1,Z,"sbcs");break;case"D":E[g][_]?(W.write_shift(4,("0000"+E[g][_].getFullYear()).slice(-4),"sbcs"),W.write_shift(2,("00"+(E[g][_].getMonth()+1)).slice(-2),"sbcs"),W.write_shift(2,("00"+E[g][_].getDate()).slice(-2),"sbcs")):W.write_shift(8,"00000000","sbcs");break;case"C":var me=String(E[g][_]!=null?E[g][_]:"").slice(0,he[_]);for(W.write_shift(1,me,"sbcs"),b=0;b<he[_]-me.length;++b)W.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:i,to_sheet:s,from_sheet:u}})(),My=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+pr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(y,E){var N=e[E];return typeof N=="number"?ih(N):N},s=function(y,E,N){var g=E.charCodeAt(0)-32<<4|N.charCodeAt(0)-48;return g==59?y:ih(g)};e["|"]=254;function i(y,E){switch(E.type){case"base64":return o(Vn(y),E);case"binary":return o(y,E);case"buffer":return o(vt&&Buffer.isBuffer(y)?y.toString("binary"):Mi(y),E);case"array":return o(ko(y),E)}throw new Error("Unrecognized type "+E.type)}function o(y,E){var N=y.split(/[\n\r]+/),g=-1,_=-1,b=0,I=0,O=[],J=[],he=null,de={},z=[],re=[],V=[],M=0,L;for(+E.codepage>=0&&bi(+E.codepage);b!==N.length;++b){M=0;var X=N[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(r,t),K=X.replace(/;;/g,"\0").split(";").map(function(U){return U.replace(/\u0000/g,";")}),ne=K[0],W;if(X.length>0)switch(ne){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":K[1].charAt(0)=="P"&&J.push(X.slice(3).replace(/;;/g,";"));break;case"C":var Z=!1,me=!1,R=!1,ve=!1,ye=-1,Y=-1;for(I=1;I<K.length;++I)switch(K[I].charAt(0)){case"A":break;case"X":_=parseInt(K[I].slice(1))-1,me=!0;break;case"Y":for(g=parseInt(K[I].slice(1))-1,me||(_=0),L=O.length;L<=g;++L)O[L]=[];break;case"K":W=K[I].slice(1),W.charAt(0)==='"'?W=W.slice(1,W.length-1):W==="TRUE"?W=!0:W==="FALSE"?W=!1:isNaN($n(W))?isNaN(ji(W).getDate())||(W=Cr(W)):(W=$n(W),he!==null&&Tp(he)&&(W=Ap(W))),Z=!0;break;case"E":ve=!0;var k=Dw(K[I].slice(1),{r:g,c:_});O[g][_]=[O[g][_],k];break;case"S":R=!0,O[g][_]=[O[g][_],"S5S"];break;case"G":break;case"R":ye=parseInt(K[I].slice(1))-1;break;case"C":Y=parseInt(K[I].slice(1))-1;break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+X)}if(Z&&(O[g][_]&&O[g][_].length==2?O[g][_][0]=W:O[g][_]=W,he=null),R){if(ve)throw new Error("SYLK shared formula cannot have own formula");var q=ye>-1&&O[ye][Y];if(!q||!q[1])throw new Error("SYLK shared formula cannot find base");O[g][_][1]=Iw(q[1],{r:g-ye,c:_-Y})}break;case"F":var B=0;for(I=1;I<K.length;++I)switch(K[I].charAt(0)){case"X":_=parseInt(K[I].slice(1))-1,++B;break;case"Y":for(g=parseInt(K[I].slice(1))-1,L=O.length;L<=g;++L)O[L]=[];break;case"M":M=parseInt(K[I].slice(1))/20;break;case"F":break;case"G":break;case"P":he=J[parseInt(K[I].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(V=K[I].slice(1).split(" "),L=parseInt(V[0],10);L<=parseInt(V[1],10);++L)M=parseInt(V[2],10),re[L-1]=M===0?{hidden:!0}:{wch:M},i0(re[L-1]);break;case"C":_=parseInt(K[I].slice(1))-1,re[_]||(re[_]={});break;case"R":g=parseInt(K[I].slice(1))-1,z[g]||(z[g]={}),M>0?(z[g].hpt=M,z[g].hpx=xx(M)):M===0&&(z[g].hidden=!0);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+X)}B<1&&(he=null);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+X)}}return z.length>0&&(de["!rows"]=z),re.length>0&&(de["!cols"]=re),E&&E.sheetRows&&(O=O.slice(0,E.sheetRows)),[O,de]}function u(y,E){var N=i(y,E),g=N[0],_=N[1],b=Rs(g,E);return pr(_).forEach(function(I){b[I]=_[I]}),b}function d(y,E){return Ga(u(y,E),E)}function x(y,E,N,g){var _="C;Y"+(N+1)+";X"+(g+1)+";K";switch(y.t){case"n":_+=y.v||0,y.f&&!y.F&&(_+=";E"+o0(y.f,{r:N,c:g}));break;case"b":_+=y.v?"TRUE":"FALSE";break;case"e":_+=y.w||y.v;break;case"d":_+='"'+(y.w||y.v)+'"';break;case"s":_+='"'+y.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function p(y,E){E.forEach(function(N,g){var _="F;W"+(g+1)+" "+(g+1)+" ";N.hidden?_+="0":(typeof N.width=="number"&&!N.wpx&&(N.wpx=xo(N.width)),typeof N.wpx=="number"&&!N.wch&&(N.wch=mo(N.wpx)),typeof N.wch=="number"&&(_+=Math.round(N.wch))),_.charAt(_.length-1)!=" "&&y.push(_)})}function m(y,E){E.forEach(function(N,g){var _="F;";N.hidden?_+="M0;":N.hpt?_+="M"+20*N.hpt+";":N.hpx&&(_+="M"+20*vo(N.hpx)+";"),_.length>2&&y.push(_+"R"+(g+1))})}function w(y,E){var N=["ID;PWXL;N;E"],g=[],_=Pt(y["!ref"]),b,I=Array.isArray(y),O=`\r
`;N.push("P;PGeneral"),N.push("F;P0;DG0G8;M255"),y["!cols"]&&p(N,y["!cols"]),y["!rows"]&&m(N,y["!rows"]),N.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var J=_.s.r;J<=_.e.r;++J)for(var he=_.s.c;he<=_.e.c;++he){var de=Tt({r:J,c:he});b=I?(y[J]||[])[he]:y[de],!(!b||b.v==null&&(!b.f||b.F))&&g.push(x(b,y,J,he))}return N.join(O)+O+g.join(O)+O+"E"+O}return{to_workbook:d,to_sheet:u,from_sheet:w}})(),Ly=(function(){function e(o,u){switch(u.type){case"base64":return r(Vn(o),u);case"binary":return r(o,u);case"buffer":return r(vt&&Buffer.isBuffer(o)?o.toString("binary"):Mi(o),u);case"array":return r(ko(o),u)}throw new Error("Unrecognized type "+u.type)}function r(o,u){for(var d=o.split(`
`),x=-1,p=-1,m=0,w=[];m!==d.length;++m){if(d[m].trim()==="BOT"){w[++x]=[],p=0;continue}if(!(x<0)){var y=d[m].trim().split(","),E=y[0],N=y[1];++m;for(var g=d[m]||"";(g.match(/["]/g)||[]).length&1&&m<d.length-1;)g+=`
`+d[++m];switch(g=g.trim(),+E){case-1:if(g==="BOT"){w[++x]=[],p=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?w[x][p]=!0:g==="FALSE"?w[x][p]=!1:isNaN($n(N))?isNaN(ji(N).getDate())?w[x][p]=N:w[x][p]=Cr(N):w[x][p]=$n(N),++p;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),w[x][p++]=g!==""?g:null;break}if(g==="EOD")break}}return u&&u.sheetRows&&(w=w.slice(0,u.sheetRows)),w}function t(o,u){return Rs(e(o,u),u)}function s(o,u){return Ga(t(o,u),u)}var i=(function(){var o=function(x,p,m,w,y){x.push(p),x.push(m+","+w),x.push('"'+y.replace(/"/g,'""')+'"')},u=function(x,p,m,w){x.push(p+","+m),x.push(p==1?'"'+w.replace(/"/g,'""')+'"':w)};return function(x){var p=[],m=Pt(x["!ref"]),w,y=Array.isArray(x);o(p,"TABLE",0,1,"sheetjs"),o(p,"VECTORS",0,m.e.r-m.s.r+1,""),o(p,"TUPLES",0,m.e.c-m.s.c+1,""),o(p,"DATA",0,0,"");for(var E=m.s.r;E<=m.e.r;++E){u(p,-1,0,"BOT");for(var N=m.s.c;N<=m.e.c;++N){var g=Tt({r:E,c:N});if(w=y?(x[E]||[])[N]:x[g],!w){u(p,1,0,"");continue}switch(w.t){case"n":var _=w.w;!_&&w.v!=null&&(_=w.v),_==null?w.f&&!w.F?u(p,1,0,"="+w.f):u(p,1,0,""):u(p,0,_,"V");break;case"b":u(p,0,w.v?1:0,w.v?"TRUE":"FALSE");break;case"s":u(p,1,0,isNaN(w.v)?w.v:'="'+w.v+'"');break;case"d":w.w||(w.w=ga(w.z||Bt[14],Dr(Cr(w.v)))),u(p,0,w.w,"V");break;default:u(p,1,0,"")}}}u(p,-1,0,"EOD");var b=`\r
`,I=p.join(b);return I}})();return{to_workbook:s,to_sheet:t,from_sheet:i}})(),fx=(function(){function e(w){return w.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(w){return w.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(w,y){for(var E=w.split(`
`),N=-1,g=-1,_=0,b=[];_!==E.length;++_){var I=E[_].trim().split(":");if(I[0]==="cell"){var O=ar(I[1]);if(b.length<=O.r)for(N=b.length;N<=O.r;++N)b[N]||(b[N]=[]);switch(N=O.r,g=O.c,I[2]){case"t":b[N][g]=e(I[3]);break;case"v":b[N][g]=+I[3];break;case"vtf":var J=I[I.length-1];case"vtc":I[3]==="nl"?b[N][g]=!!+I[4]:b[N][g]=+I[4],I[2]=="vtf"&&(b[N][g]=[b[N][g],J])}}}return y&&y.sheetRows&&(b=b.slice(0,y.sheetRows)),b}function s(w,y){return Rs(t(w,y),y)}function i(w,y){return Ga(s(w,y),y)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),u=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,d=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),x="--SocialCalcSpreadsheetControlSave--";function p(w){if(!w||!w["!ref"])return"";for(var y=[],E=[],N,g="",_=Vr(w["!ref"]),b=Array.isArray(w),I=_.s.r;I<=_.e.r;++I)for(var O=_.s.c;O<=_.e.c;++O)if(g=Tt({r:I,c:O}),N=b?(w[I]||[])[O]:w[g],!(!N||N.v==null||N.t==="z")){switch(E=["cell",g,"t"],N.t){case"s":case"str":E.push(r(N.v));break;case"n":N.f?(E[2]="vtf",E[3]="n",E[4]=N.v,E[5]=r(N.f)):(E[2]="v",E[3]=N.v);break;case"b":E[2]="vt"+(N.f?"f":"c"),E[3]="nl",E[4]=N.v?"1":"0",E[5]=r(N.f||(N.v?"TRUE":"FALSE"));break;case"d":var J=Dr(Cr(N.v));E[2]="vtc",E[3]="nd",E[4]=""+J,E[5]=N.w||ga(N.z||Bt[14],J);break;case"e":continue}y.push(E.join(":"))}return y.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),y.push("valueformat:1:text-wiki"),y.join(`
`)}function m(w){return[o,u,d,u,p(w),x].join(`
`)}return{to_workbook:i,to_sheet:s,from_sheet:m}})(),By=(function(){function e(m,w,y,E,N){N.raw?w[y][E]=m:m===""||(m==="TRUE"?w[y][E]=!0:m==="FALSE"?w[y][E]=!1:isNaN($n(m))?isNaN(ji(m).getDate())?w[y][E]=m:w[y][E]=Cr(m):w[y][E]=$n(m))}function r(m,w){var y=w||{},E=[];if(!m||m.length===0)return E;for(var N=m.split(/[\r\n]/),g=N.length-1;g>=0&&N[g].length===0;)--g;for(var _=10,b=0,I=0;I<=g;++I)b=N[I].indexOf(" "),b==-1?b=N[I].length:b++,_=Math.max(_,b);for(I=0;I<=g;++I){E[I]=[];var O=0;for(e(N[I].slice(0,_).trim(),E,I,O,y),O=1;O<=(N[I].length-_)/10+1;++O)e(N[I].slice(_+(O-1)*10,_+O*10).trim(),E,I,O,y)}return y.sheetRows&&(E=E.slice(0,y.sheetRows)),E}var t={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function i(m){for(var w={},y=!1,E=0,N=0;E<m.length;++E)(N=m.charCodeAt(E))==34?y=!y:!y&&N in t&&(w[N]=(w[N]||0)+1);N=[];for(E in w)Object.prototype.hasOwnProperty.call(w,E)&&N.push([w[E],E]);if(!N.length){w=s;for(E in w)Object.prototype.hasOwnProperty.call(w,E)&&N.push([w[E],E])}return N.sort(function(g,_){return g[0]-_[0]||s[g[1]]-s[_[1]]}),t[N.pop()[1]]||44}function o(m,w){var y=w||{},E="",N=y.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(E=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(E=m.charAt(4),m=m.slice(6)):E=i(m.slice(0,1024)):y&&y.FS?E=y.FS:E=i(m.slice(0,1024));var _=0,b=0,I=0,O=0,J=0,he=E.charCodeAt(0),de=!1,z=0,re=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var V=y.dateNF!=null?t2(y.dateNF):null;function M(){var L=m.slice(O,J),X={};if(L.charAt(0)=='"'&&L.charAt(L.length-1)=='"'&&(L=L.slice(1,-1).replace(/""/g,'"')),L.length===0)X.t="z";else if(y.raw)X.t="s",X.v=L;else if(L.trim().length===0)X.t="s",X.v=L;else if(L.charCodeAt(0)==61)L.charCodeAt(1)==34&&L.charCodeAt(L.length-1)==34?(X.t="s",X.v=L.slice(2,-1).replace(/""/g,'"')):Mw(L)?(X.t="n",X.f=L.slice(1)):(X.t="s",X.v=L);else if(L=="TRUE")X.t="b",X.v=!0;else if(L=="FALSE")X.t="b",X.v=!1;else if(!isNaN(I=$n(L)))X.t="n",y.cellText!==!1&&(X.w=L),X.v=I;else if(!isNaN(ji(L).getDate())||V&&L.match(V)){X.z=y.dateNF||Bt[14];var K=0;V&&L.match(V)&&(L=r2(L,y.dateNF,L.match(V)||[]),K=1),y.cellDates?(X.t="d",X.v=Cr(L,K)):(X.t="n",X.v=Dr(Cr(L,K))),y.cellText!==!1&&(X.w=ga(X.z,X.v instanceof Date?Dr(X.v):X.v)),y.cellNF||delete X.z}else X.t="s",X.v=L;if(X.t=="z"||(y.dense?(N[_]||(N[_]=[]),N[_][b]=X):N[Tt({c:b,r:_})]=X),O=J+1,re=m.charCodeAt(O),g.e.c<b&&(g.e.c=b),g.e.r<_&&(g.e.r=_),z==he)++b;else if(b=0,++_,y.sheetRows&&y.sheetRows<=_)return!0}e:for(;J<m.length;++J)switch(z=m.charCodeAt(J)){case 34:re===34&&(de=!de);break;case he:case 10:case 13:if(!de&&M())break e;break}return J-O>0&&M(),N["!ref"]=Xt(g),N}function u(m,w){return!(w&&w.PRN)||w.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?o(m,w):Rs(r(m,w),w)}function d(m,w){var y="",E=w.type=="string"?[0,0,0,0]:QS(m,w);switch(w.type){case"base64":y=Vn(m);break;case"binary":y=m;break;case"buffer":w.codepage==65001?y=m.toString("utf8"):w.codepage&&typeof so<"u"||(y=vt&&Buffer.isBuffer(m)?m.toString("binary"):Mi(m));break;case"array":y=ko(m);break;case"string":y=m;break;default:throw new Error("Unrecognized type "+w.type)}return E[0]==239&&E[1]==187&&E[2]==191?y=Ti(y.slice(3)):w.type!="string"&&w.type!="buffer"&&w.codepage==65001?y=Ti(y):w.type=="binary"&&typeof so<"u",y.slice(0,19)=="socialcalc:version:"?fx.to_sheet(w.type=="string"?y:Ti(y),w):u(y,w)}function x(m,w){return Ga(d(m,w),w)}function p(m){for(var w=[],y=Pt(m["!ref"]),E,N=Array.isArray(m),g=y.s.r;g<=y.e.r;++g){for(var _=[],b=y.s.c;b<=y.e.c;++b){var I=Tt({r:g,c:b});if(E=N?(m[g]||[])[b]:m[I],!E||E.v==null){_.push("          ");continue}for(var O=(E.w||(Gn(E),E.w)||"").slice(0,10);O.length<10;)O+=" ";_.push(O+(b===0?" ":""))}w.push(_.join(""))}return w.join(`
`)}return{to_workbook:x,to_sheet:d,from_sheet:p}})(),Mh=(function(){function e(k,q,B){if(k){Wr(k,k.l||0);for(var U=B.Enum||ye;k.l<k.length;){var oe=k.read_shift(2),Ee=U[oe]||U[65535],Te=k.read_shift(2),ee=k.l+Te,te=Ee.f&&Ee.f(k,Te,B);if(k.l=ee,q(te,Ee,oe))return}}}function r(k,q){switch(q.type){case"base64":return t(xn(Vn(k)),q);case"binary":return t(xn(k),q);case"buffer":case"array":return t(k,q)}throw"Unsupported type "+q.type}function t(k,q){if(!k)return k;var B=q||{},U=B.dense?[]:{},oe="Sheet1",Ee="",Te=0,ee={},te=[],Se=[],De={s:{r:0,c:0},e:{r:0,c:0}},et=B.sheetRows||0;if(k[2]==0&&(k[3]==8||k[3]==9)&&k.length>=16&&k[14]==5&&k[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(k[2]==2)B.Enum=ye,e(k,function(Oe,Ot,Ue){switch(Ue){case 0:B.vers=Oe,Oe>=4096&&(B.qpro=!0);break;case 6:De=Oe;break;case 204:Oe&&(Ee=Oe);break;case 222:Ee=Oe;break;case 15:case 51:B.qpro||(Oe[1].v=Oe[1].v.slice(1));case 13:case 14:case 16:Ue==14&&(Oe[2]&112)==112&&(Oe[2]&15)>1&&(Oe[2]&15)<15&&(Oe[1].z=B.dateNF||Bt[14],B.cellDates&&(Oe[1].t="d",Oe[1].v=Ap(Oe[1].v))),B.qpro&&Oe[3]>Te&&(U["!ref"]=Xt(De),ee[oe]=U,te.push(oe),U=B.dense?[]:{},De={s:{r:0,c:0},e:{r:0,c:0}},Te=Oe[3],oe=Ee||"Sheet"+(Te+1),Ee="");var He=B.dense?(U[Oe[0].r]||[])[Oe[0].c]:U[Tt(Oe[0])];if(He){He.t=Oe[1].t,He.v=Oe[1].v,Oe[1].z!=null&&(He.z=Oe[1].z),Oe[1].f!=null&&(He.f=Oe[1].f);break}B.dense?(U[Oe[0].r]||(U[Oe[0].r]=[]),U[Oe[0].r][Oe[0].c]=Oe[1]):U[Tt(Oe[0])]=Oe[1];break}},B);else if(k[2]==26||k[2]==14)B.Enum=Y,k[2]==14&&(B.qpro=!0,k.l=0),e(k,function(Oe,Ot,Ue){switch(Ue){case 204:oe=Oe;break;case 22:Oe[1].v=Oe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Oe[3]>Te&&(U["!ref"]=Xt(De),ee[oe]=U,te.push(oe),U=B.dense?[]:{},De={s:{r:0,c:0},e:{r:0,c:0}},Te=Oe[3],oe="Sheet"+(Te+1)),et>0&&Oe[0].r>=et)break;B.dense?(U[Oe[0].r]||(U[Oe[0].r]=[]),U[Oe[0].r][Oe[0].c]=Oe[1]):U[Tt(Oe[0])]=Oe[1],De.e.c<Oe[0].c&&(De.e.c=Oe[0].c),De.e.r<Oe[0].r&&(De.e.r=Oe[0].r);break;case 27:Oe[14e3]&&(Se[Oe[14e3][0]]=Oe[14e3][1]);break;case 1537:Se[Oe[0]]=Oe[1],Oe[0]==Te&&(oe=Oe[1]);break}},B);else throw new Error("Unrecognized LOTUS BOF "+k[2]);if(U["!ref"]=Xt(De),ee[Ee||oe]=U,te.push(Ee||oe),!Se.length)return{SheetNames:te,Sheets:ee};for(var We={},ot=[],rt=0;rt<Se.length;++rt)ee[te[rt]]?(ot.push(Se[rt]||te[rt]),We[Se[rt]]=ee[Se[rt]]||ee[te[rt]]):(ot.push(Se[rt]),We[Se[rt]]={"!ref":"A1"});return{SheetNames:ot,Sheets:We}}function s(k,q){var B=q||{};if(+B.codepage>=0&&bi(+B.codepage),B.type=="string")throw new Error("Cannot write WK1 to JS string");var U=Rr(),oe=Pt(k["!ref"]),Ee=Array.isArray(k),Te=[];je(U,0,o(1030)),je(U,6,x(oe));for(var ee=Math.min(oe.e.r,8191),te=oe.s.r;te<=ee;++te)for(var Se=hr(te),De=oe.s.c;De<=oe.e.c;++De){te===oe.s.r&&(Te[De]=yr(De));var et=Te[De]+Se,We=Ee?(k[te]||[])[De]:k[et];if(!(!We||We.t=="z"))if(We.t=="n")(We.v|0)==We.v&&We.v>=-32768&&We.v<=32767?je(U,13,E(te,De,We.v)):je(U,14,g(te,De,We.v));else{var ot=Gn(We);je(U,15,w(te,De,ot.slice(0,239)))}}return je(U,1),U.end()}function i(k,q){var B=q||{};if(+B.codepage>=0&&bi(+B.codepage),B.type=="string")throw new Error("Cannot write WK3 to JS string");var U=Rr();je(U,0,u(k));for(var oe=0,Ee=0;oe<k.SheetNames.length;++oe)(k.Sheets[k.SheetNames[oe]]||{})["!ref"]&&je(U,27,ve(k.SheetNames[oe],Ee++));var Te=0;for(oe=0;oe<k.SheetNames.length;++oe){var ee=k.Sheets[k.SheetNames[oe]];if(!(!ee||!ee["!ref"])){for(var te=Pt(ee["!ref"]),Se=Array.isArray(ee),De=[],et=Math.min(te.e.r,8191),We=te.s.r;We<=et;++We)for(var ot=hr(We),rt=te.s.c;rt<=te.e.c;++rt){We===te.s.r&&(De[rt]=yr(rt));var Oe=De[rt]+ot,Ot=Se?(ee[We]||[])[rt]:ee[Oe];if(!(!Ot||Ot.t=="z"))if(Ot.t=="n")je(U,23,M(We,rt,Te,Ot.v));else{var Ue=Gn(Ot);je(U,22,z(We,rt,Te,Ue.slice(0,239)))}}++Te}}return je(U,1),U.end()}function o(k){var q=pe(2);return q.write_shift(2,k),q}function u(k){var q=pe(26);q.write_shift(2,4096),q.write_shift(2,4),q.write_shift(4,0);for(var B=0,U=0,oe=0,Ee=0;Ee<k.SheetNames.length;++Ee){var Te=k.SheetNames[Ee],ee=k.Sheets[Te];if(!(!ee||!ee["!ref"])){++oe;var te=Vr(ee["!ref"]);B<te.e.r&&(B=te.e.r),U<te.e.c&&(U=te.e.c)}}return B>8191&&(B=8191),q.write_shift(2,B),q.write_shift(1,oe),q.write_shift(1,U),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(1,1),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(4,0),q}function d(k,q,B){var U={s:{c:0,r:0},e:{c:0,r:0}};return q==8&&B.qpro?(U.s.c=k.read_shift(1),k.l++,U.s.r=k.read_shift(2),U.e.c=k.read_shift(1),k.l++,U.e.r=k.read_shift(2),U):(U.s.c=k.read_shift(2),U.s.r=k.read_shift(2),q==12&&B.qpro&&(k.l+=2),U.e.c=k.read_shift(2),U.e.r=k.read_shift(2),q==12&&B.qpro&&(k.l+=2),U.s.c==65535&&(U.s.c=U.e.c=U.s.r=U.e.r=0),U)}function x(k){var q=pe(8);return q.write_shift(2,k.s.c),q.write_shift(2,k.s.r),q.write_shift(2,k.e.c),q.write_shift(2,k.e.r),q}function p(k,q,B){var U=[{c:0,r:0},{t:"n",v:0},0,0];return B.qpro&&B.vers!=20768?(U[0].c=k.read_shift(1),U[3]=k.read_shift(1),U[0].r=k.read_shift(2),k.l+=2):(U[2]=k.read_shift(1),U[0].c=k.read_shift(2),U[0].r=k.read_shift(2)),U}function m(k,q,B){var U=k.l+q,oe=p(k,q,B);if(oe[1].t="s",B.vers==20768){k.l++;var Ee=k.read_shift(1);return oe[1].v=k.read_shift(Ee,"utf8"),oe}return B.qpro&&k.l++,oe[1].v=k.read_shift(U-k.l,"cstr"),oe}function w(k,q,B){var U=pe(7+B.length);U.write_shift(1,255),U.write_shift(2,q),U.write_shift(2,k),U.write_shift(1,39);for(var oe=0;oe<U.length;++oe){var Ee=B.charCodeAt(oe);U.write_shift(1,Ee>=128?95:Ee)}return U.write_shift(1,0),U}function y(k,q,B){var U=p(k,q,B);return U[1].v=k.read_shift(2,"i"),U}function E(k,q,B){var U=pe(7);return U.write_shift(1,255),U.write_shift(2,q),U.write_shift(2,k),U.write_shift(2,B,"i"),U}function N(k,q,B){var U=p(k,q,B);return U[1].v=k.read_shift(8,"f"),U}function g(k,q,B){var U=pe(13);return U.write_shift(1,255),U.write_shift(2,q),U.write_shift(2,k),U.write_shift(8,B,"f"),U}function _(k,q,B){var U=k.l+q,oe=p(k,q,B);if(oe[1].v=k.read_shift(8,"f"),B.qpro)k.l=U;else{var Ee=k.read_shift(2);J(k.slice(k.l,k.l+Ee),oe),k.l+=Ee}return oe}function b(k,q,B){var U=q&32768;return q&=-32769,q=(U?k:0)+(q>=8192?q-16384:q),(U?"":"$")+(B?yr(q):hr(q))}var I={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},O=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function J(k,q){Wr(k,0);for(var B=[],U=0,oe="",Ee="",Te="",ee="";k.l<k.length;){var te=k[k.l++];switch(te){case 0:B.push(k.read_shift(8,"f"));break;case 1:Ee=b(q[0].c,k.read_shift(2),!0),oe=b(q[0].r,k.read_shift(2),!1),B.push(Ee+oe);break;case 2:{var Se=b(q[0].c,k.read_shift(2),!0),De=b(q[0].r,k.read_shift(2),!1);Ee=b(q[0].c,k.read_shift(2),!0),oe=b(q[0].r,k.read_shift(2),!1),B.push(Se+De+":"+Ee+oe)}break;case 3:if(k.l<k.length){console.error("WK1 premature formula end");return}break;case 4:B.push("("+B.pop()+")");break;case 5:B.push(k.read_shift(2));break;case 6:{for(var et="";te=k[k.l++];)et+=String.fromCharCode(te);B.push('"'+et.replace(/"/g,'""')+'"')}break;case 8:B.push("-"+B.pop());break;case 23:B.push("+"+B.pop());break;case 22:B.push("NOT("+B.pop()+")");break;case 20:case 21:ee=B.pop(),Te=B.pop(),B.push(["AND","OR"][te-20]+"("+Te+","+ee+")");break;default:if(te<32&&O[te])ee=B.pop(),Te=B.pop(),B.push(Te+O[te]+ee);else if(I[te]){if(U=I[te][1],U==69&&(U=k[k.l++]),U>B.length){console.error("WK1 bad formula parse 0x"+te.toString(16)+":|"+B.join("|")+"|");return}var We=B.slice(-U);B.length-=U,B.push(I[te][0]+"("+We.join(",")+")")}else return te<=7?console.error("WK1 invalid opcode "+te.toString(16)):te<=24?console.error("WK1 unsupported op "+te.toString(16)):te<=30?console.error("WK1 invalid opcode "+te.toString(16)):te<=115?console.error("WK1 unsupported function opcode "+te.toString(16)):console.error("WK1 unrecognized opcode "+te.toString(16))}}B.length==1?q[1].f=""+B[0]:console.error("WK1 bad formula parse |"+B.join("|")+"|")}function he(k){var q=[{c:0,r:0},{t:"n",v:0},0];return q[0].r=k.read_shift(2),q[3]=k[k.l++],q[0].c=k[k.l++],q}function de(k,q){var B=he(k);return B[1].t="s",B[1].v=k.read_shift(q-4,"cstr"),B}function z(k,q,B,U){var oe=pe(6+U.length);oe.write_shift(2,k),oe.write_shift(1,B),oe.write_shift(1,q),oe.write_shift(1,39);for(var Ee=0;Ee<U.length;++Ee){var Te=U.charCodeAt(Ee);oe.write_shift(1,Te>=128?95:Te)}return oe.write_shift(1,0),oe}function re(k,q){var B=he(k);B[1].v=k.read_shift(2);var U=B[1].v>>1;if(B[1].v&1)switch(U&7){case 0:U=(U>>3)*5e3;break;case 1:U=(U>>3)*500;break;case 2:U=(U>>3)/20;break;case 3:U=(U>>3)/200;break;case 4:U=(U>>3)/2e3;break;case 5:U=(U>>3)/2e4;break;case 6:U=(U>>3)/16;break;case 7:U=(U>>3)/64;break}return B[1].v=U,B}function V(k,q){var B=he(k),U=k.read_shift(4),oe=k.read_shift(4),Ee=k.read_shift(2);if(Ee==65535)return U===0&&oe===3221225472?(B[1].t="e",B[1].v=15):U===0&&oe===3489660928?(B[1].t="e",B[1].v=42):B[1].v=0,B;var Te=Ee&32768;return Ee=(Ee&32767)-16446,B[1].v=(1-Te*2)*(oe*Math.pow(2,Ee+32)+U*Math.pow(2,Ee)),B}function M(k,q,B,U){var oe=pe(14);if(oe.write_shift(2,k),oe.write_shift(1,B),oe.write_shift(1,q),U==0)return oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(2,65535),oe;var Ee=0,Te=0,ee=0,te=0;return U<0&&(Ee=1,U=-U),Te=Math.log2(U)|0,U/=Math.pow(2,Te-31),te=U>>>0,(te&2147483648)==0&&(U/=2,++Te,te=U>>>0),U-=te,te|=2147483648,te>>>=0,U*=Math.pow(2,32),ee=U>>>0,oe.write_shift(4,ee),oe.write_shift(4,te),Te+=16383+(Ee?32768:0),oe.write_shift(2,Te),oe}function L(k,q){var B=V(k);return k.l+=q-14,B}function X(k,q){var B=he(k),U=k.read_shift(4);return B[1].v=U>>6,B}function K(k,q){var B=he(k),U=k.read_shift(8,"f");return B[1].v=U,B}function ne(k,q){var B=K(k);return k.l+=q-10,B}function W(k,q){return k[k.l+q-1]==0?k.read_shift(q,"cstr"):""}function Z(k,q){var B=k[k.l++];B>q-1&&(B=q-1);for(var U="";U.length<B;)U+=String.fromCharCode(k[k.l++]);return U}function me(k,q,B){if(!(!B.qpro||q<21)){var U=k.read_shift(1);k.l+=17,k.l+=1,k.l+=2;var oe=k.read_shift(q-21,"cstr");return[U,oe]}}function R(k,q){for(var B={},U=k.l+q;k.l<U;){var oe=k.read_shift(2);if(oe==14e3){for(B[oe]=[0,""],B[oe][0]=k.read_shift(2);k[k.l];)B[oe][1]+=String.fromCharCode(k[k.l]),k.l++;k.l++}}return B}function ve(k,q){var B=pe(5+k.length);B.write_shift(2,14e3),B.write_shift(2,q);for(var U=0;U<k.length;++U){var oe=k.charCodeAt(U);B[B.l++]=oe>127?95:oe}return B[B.l++]=0,B}var ye={0:{n:"BOF",f:ix},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:d},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:y},14:{n:"NUMBER",f:N},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:W},222:{n:"SHEETNAMELP",f:Z},65535:{n:""}},Y={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:de},23:{n:"NUMBER17",f:V},24:{n:"NUMBER18",f:re},25:{n:"FORMULA19",f:L},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:R},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:X},38:{n:"??"},39:{n:"NUMBER27",f:K},40:{n:"FORMULA28",f:ne},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:W},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:me},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:i,to_workbook:r}})(),Uy=/^\s|\s$|[\t\n\r]/;function dx(e,r){if(!r.bookSST)return"";var t=[Kt];t[t.length]=Fe("sst",null,{xmlns:Os[0],count:e.Count,uniqueCount:e.Unique});for(var s=0;s!=e.length;++s)if(e[s]!=null){var i=e[s],o="<si>";i.r?o+=i.r:(o+="<t",i.t||(i.t=""),i.t.match(Uy)&&(o+=' xml:space="preserve"'),o+=">"+St(i.t)+"</t>"),o+="</si>",t[t.length]=o}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function zy(e){return[e.read_shift(4),e.read_shift(4)]}function Wy(e,r){return r||(r=pe(8)),r.write_shift(4,e.Count),r.write_shift(4,e.Unique),r}var $y=O2;function Hy(e){var r=Rr();ge(r,159,Wy(e));for(var t=0;t<e.length;++t)ge(r,19,$y(e[t]));return ge(r,160),r.end()}function Vy(e){for(var r=[],t=e.split(""),s=0;s<t.length;++s)r[s]=t[s].charCodeAt(0);return r}function hx(e){var r=0,t,s=Vy(e),i=s.length+1,o,u,d,x,p;for(t=$a(i),t[0]=s.length,o=1;o!=i;++o)t[o]=s[o-1];for(o=i-1;o>=0;--o)u=t[o],d=(r&16384)===0?0:1,x=r<<1&32767,p=d|x,r=p^u;return r^52811}var Gy=(function(){function e(i,o){switch(o.type){case"base64":return r(Vn(i),o);case"binary":return r(i,o);case"buffer":return r(vt&&Buffer.isBuffer(i)?i.toString("binary"):Mi(i),o);case"array":return r(ko(i),o)}throw new Error("Unrecognized type "+o.type)}function r(i,o){var u=o||{},d=u.dense?[]:{},x=i.match(/\\trowd.*?\\row\b/g);if(!x.length)throw new Error("RTF missing table");var p={s:{c:0,r:0},e:{c:0,r:x.length-1}};return x.forEach(function(m,w){Array.isArray(d)&&(d[w]=[]);for(var y=/\\\w+\b/g,E=0,N,g=-1;N=y.exec(m);){switch(N[0]){case"\\cell":var _=m.slice(E,y.lastIndex-N[0].length);if(_[0]==" "&&(_=_.slice(1)),++g,_.length){var b={v:_,t:"s"};Array.isArray(d)?d[w][g]=b:d[Tt({r:w,c:g})]=b}break}E=y.lastIndex}g>p.e.c&&(p.e.c=g)}),d["!ref"]=Xt(p),d}function t(i,o){return Ga(e(i,o),o)}function s(i){for(var o=["{\\rtf1\\ansi"],u=Pt(i["!ref"]),d,x=Array.isArray(i),p=u.s.r;p<=u.e.r;++p){o.push("\\trowd\\trautofit1");for(var m=u.s.c;m<=u.e.c;++m)o.push("\\cellx"+(m+1));for(o.push("\\pard\\intbl"),m=u.s.c;m<=u.e.c;++m){var w=Tt({r:p,c:m});d=x?(i[p]||[])[m]:i[w],!(!d||d.v==null&&(!d.f||d.F))&&(o.push(" "+(d.w||(Gn(d),d.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:s}})();function Lh(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}var Xy=6,Hn=Xy;function xo(e){return Math.floor((e+Math.round(128/Hn)/256)*Hn)}function mo(e){return Math.floor((e-5)/Hn*100+.5)/100}function Mu(e){return Math.round((e*Hn+5)/Hn*256)/256}function i0(e){e.width?(e.wpx=xo(e.width),e.wch=mo(e.wpx),e.MDW=Hn):e.wpx?(e.wch=mo(e.wpx),e.width=Mu(e.wch),e.MDW=Hn):typeof e.wch=="number"&&(e.width=Mu(e.wch),e.wpx=xo(e.width),e.MDW=Hn),e.customWidth&&delete e.customWidth}var Ky=96,px=Ky;function vo(e){return e*96/px}function xx(e){return e*px/96}function Yy(e){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var s=t[0];s<=t[1];++s)e[s]!=null&&(r[r.length]=Fe("numFmt",null,{numFmtId:s,formatCode:St(e[s])}))}),r.length===1?"":(r[r.length]="</numFmts>",r[0]=Fe("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function qy(e){var r=[];return r[r.length]=Fe("cellXfs",null),e.forEach(function(t){r[r.length]=Fe("xf",null,t)}),r[r.length]="</cellXfs>",r.length===2?"":(r[0]=Fe("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function mx(e,r){var t=[Kt,Fe("styleSheet",null,{xmlns:Os[0],"xmlns:vt":nr.vt})],s;return e.SSF&&(s=Yy(e.SSF))!=null&&(t[t.length]=s),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=qy(r.cellXfs))&&(t[t.length]=s),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function Qy(e,r){var t=e.read_shift(2),s=wr(e);return[t,s]}function Jy(e,r,t){t||(t=pe(6+4*r.length)),t.write_shift(2,e),sr(r,t);var s=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),s}function Zy(e,r,t){var s={};s.sz=e.read_shift(2)/20;var i=U2(e);i.fItalic&&(s.italic=1),i.fCondense&&(s.condense=1),i.fExtend&&(s.extend=1),i.fShadow&&(s.shadow=1),i.fOutline&&(s.outline=1),i.fStrikeout&&(s.strike=1);var o=e.read_shift(2);switch(o===700&&(s.bold=1),e.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var u=e.read_shift(1);u!=0&&(s.underline=u);var d=e.read_shift(1);d>0&&(s.family=d);var x=e.read_shift(1);switch(x>0&&(s.charset=x),e.l++,s.color=B2(e),e.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=wr(e),s}function ew(e,r){r||(r=pe(153)),r.write_shift(2,e.sz*20),z2(e,r),r.write_shift(2,e.bold?700:400);var t=0;e.vertAlign=="superscript"?t=1:e.vertAlign=="subscript"&&(t=2),r.write_shift(2,t),r.write_shift(1,e.underline||0),r.write_shift(1,e.family||0),r.write_shift(1,e.charset||0),r.write_shift(1,0),ho(e.color,r);var s=0;return s=2,r.write_shift(1,s),sr(e.name,r),r.length>r.l?r.slice(0,r.l):r}var tw=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Eu,rw=bn;function Bh(e,r){r||(r=pe(84)),Eu||(Eu=Ku(tw));var t=Eu[e.patternType];t==null&&(t=40),r.write_shift(4,t);var s=0;if(t!=40)for(ho({auto:1},r),ho({auto:1},r);s<12;++s)r.write_shift(4,0);else{for(;s<4;++s)r.write_shift(4,0);for(;s<12;++s)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function nw(e,r){var t=e.l+r,s=e.read_shift(2),i=e.read_shift(2);return e.l=t,{ixfe:s,numFmtId:i}}function vx(e,r,t){t||(t=pe(16)),t.write_shift(2,r||0),t.write_shift(2,e.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var s=0;return t.write_shift(1,s),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function yi(e,r){return r||(r=pe(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var aw=bn;function sw(e,r){return r||(r=pe(51)),r.write_shift(1,0),yi(null,r),yi(null,r),yi(null,r),yi(null,r),yi(null,r),r.length>r.l?r.slice(0,r.l):r}function iw(e,r){return r||(r=pe(52)),r.write_shift(4,e.xfId),r.write_shift(2,1),r.write_shift(1,0),r.write_shift(1,0),fo(e.name||"",r),r.length>r.l?r.slice(0,r.l):r}function lw(e,r,t){var s=pe(2052);return s.write_shift(4,e),fo(r,s),fo(t,s),s.length>s.l?s.slice(0,s.l):s}function ow(e,r){if(r){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var i=s[0];i<=s[1];++i)r[i]!=null&&++t}),t!=0&&(ge(e,615,vn(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var i=s[0];i<=s[1];++i)r[i]!=null&&ge(e,44,Jy(i,r[i]))}),ge(e,616))}}function cw(e){var r=1;ge(e,611,vn(r)),ge(e,43,ew({sz:12,color:{theme:1},name:"Calibri",family:2})),ge(e,612)}function uw(e){var r=2;ge(e,603,vn(r)),ge(e,45,Bh({patternType:"none"})),ge(e,45,Bh({patternType:"gray125"})),ge(e,604)}function fw(e){var r=1;ge(e,613,vn(r)),ge(e,46,sw()),ge(e,614)}function dw(e){var r=1;ge(e,626,vn(r)),ge(e,47,vx({numFmtId:0},65535)),ge(e,627)}function hw(e,r){ge(e,617,vn(r.length)),r.forEach(function(t){ge(e,47,vx(t,0))}),ge(e,618)}function pw(e){var r=1;ge(e,619,vn(r)),ge(e,48,iw({xfId:0,name:"Normal"})),ge(e,620)}function xw(e){var r=0;ge(e,505,vn(r)),ge(e,506)}function mw(e){var r=0;ge(e,508,lw(r,"TableStyleMedium9","PivotStyleMedium4")),ge(e,509)}function vw(e,r){var t=Rr();return ge(t,278),ow(t,e.SSF),cw(t),uw(t),fw(t),dw(t),hw(t,r.cellXfs),pw(t),xw(t),mw(t),ge(t,279),t.end()}function gx(e,r){if(r&&r.themeXLSX)return r.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var t=[Kt];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function gw(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:wr(e)}}function yw(e){var r=pe(12+2*e.name.length);return r.write_shift(4,e.flags),r.write_shift(4,e.version),sr(e.name,r),r.slice(0,r.l)}function ww(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function _w(e){var r=pe(4+8*e.length);r.write_shift(4,e.length);for(var t=0;t<e.length;++t)r.write_shift(4,e[t][0]),r.write_shift(4,e[t][1]);return r}function Ew(e,r){var t=pe(8+2*r.length);return t.write_shift(4,e),sr(r,t),t.slice(0,t.l)}function Sw(e){return e.l+=4,e.read_shift(4)!=0}function Tw(e,r){var t=pe(8);return t.write_shift(4,e),t.write_shift(4,1),t}function Nw(){var e=Rr();return ge(e,332),ge(e,334,vn(1)),ge(e,335,yw({name:"XLDAPR",version:12e4,flags:3496657072})),ge(e,336),ge(e,339,Ew(1,"XLDAPR")),ge(e,52),ge(e,35,vn(514)),ge(e,4096,vn(0)),ge(e,4097,en(1)),ge(e,36),ge(e,53),ge(e,340),ge(e,337,Tw(1)),ge(e,51,_w([[1,0]])),ge(e,338),ge(e,333),e.end()}function yx(){var e=[Kt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function kw(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=Tt(t);var s=e.read_shift(1);return s&2&&(r.l="1"),s&8&&(r.a="1"),r}var ks=1024;function wx(e,r){for(var t=[21600,21600],s=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),i=[Fe("xml",null,{"xmlns:v":$r.v,"xmlns:o":$r.o,"xmlns:x":$r.x,"xmlns:mv":$r.mv}).replace(/\/>/,">"),Fe("o:shapelayout",Fe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Fe("v:shapetype",[Fe("v:stroke",null,{joinstyle:"miter"}),Fe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:s})];ks<e*1e3;)ks+=1e3;return r.forEach(function(o){var u=ar(o[0]),d={color2:"#BEFF82",type:"gradient"};d.type=="gradient"&&(d.angle="-180");var x=d.type=="gradient"?Fe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,p=Fe("v:fill",x,d),m={on:"t",obscured:"t"};++ks,i=i.concat(["<v:shape"+Oi({id:"_x0000_s"+ks,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(o[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",p,Fe("v:shadow",null,m),Fe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",dr("x:Anchor",[u.c+1,0,u.r+1,0,u.c+3,20,u.r+5,20].join(",")),dr("x:AutoFill","False"),dr("x:Row",String(u.r)),dr("x:Column",String(u.c)),o[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function _x(e){var r=[Kt,Fe("comments",null,{xmlns:Os[0]})],t=[];return r.push("<authors>"),e.forEach(function(s){s[1].forEach(function(i){var o=St(i.a);t.indexOf(o)==-1&&(t.push(o),r.push("<author>"+o+"</author>")),i.T&&i.ID&&t.indexOf("tc="+i.ID)==-1&&(t.push("tc="+i.ID),r.push("<author>tc="+i.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),e.forEach(function(s){var i=0,o=[];if(s[1][0]&&s[1][0].T&&s[1][0].ID?i=t.indexOf("tc="+s[1][0].ID):s[1].forEach(function(x){x.a&&(i=t.indexOf(St(x.a))),o.push(x.t||"")}),r.push('<comment ref="'+s[0]+'" authorId="'+i+'"><text>'),o.length<=1)r.push(dr("t",St(o[0]||"")));else{for(var u=`Comment:
    `+o[0]+`
`,d=1;d<o.length;++d)u+=`Reply:
    `+o[d]+`
`;r.push(dr("t",St(u)))}r.push("</text></comment>")}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function Cw(e,r,t){var s=[Kt,Fe("ThreadedComments",null,{xmlns:nr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var o="";(i[1]||[]).forEach(function(u,d){if(!u.T){delete u.ID;return}u.a&&r.indexOf(u.a)==-1&&r.push(u.a);var x={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};d==0?o=x.id:x.parentId=o,u.ID=x.id,u.a&&(x.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(u.a)).slice(-12)+"}"),s.push(Fe("threadedComment",dr("text",u.t||""),x))})}),s.push("</ThreadedComments>"),s.join("")}function Aw(e){var r=[Kt,Fe("personList",null,{xmlns:nr.TCMNT,"xmlns:x":Os[0]}).replace(/[\/]>/,">")];return e.forEach(function(t,s){r.push(Fe("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:t,providerId:"None"}))}),r.push("</personList>"),r.join("")}function bw(e){var r={};r.iauthor=e.read_shift(4);var t=qa(e);return r.rfx=t.s,r.ref=Tt(t.s),e.l+=16,r}function Fw(e,r){return r==null&&(r=pe(36)),r.write_shift(4,e[1].iauthor),Ds(e[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}var jw=wr;function Pw(e){return sr(e.slice(0,54))}function Ow(e){var r=Rr(),t=[];return ge(r,628),ge(r,630),e.forEach(function(s){s[1].forEach(function(i){t.indexOf(i.a)>-1||(t.push(i.a.slice(0,54)),ge(r,632,Pw(i.a)))})}),ge(r,631),ge(r,633),e.forEach(function(s){s[1].forEach(function(i){i.iauthor=t.indexOf(i.a);var o={s:ar(s[0]),e:ar(s[0])};ge(r,635,Fw([o,i])),i.t&&i.t.length>0&&ge(r,637,D2(i)),ge(r,636),delete i.iauthor})}),ge(r,634),ge(r,629),r.end()}function Rw(e,r){r.FullPaths.forEach(function(t,s){if(s!=0){var i=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Nt.utils.cfb_add(e,i,r.FileIndex[s].content)}})}var Ex=["xlsb","xlsm","xlam","biff8","xla"],Dw=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(s,i,o,u){var d=!1,x=!1;o.length==0?x=!0:o.charAt(0)=="["&&(x=!0,o=o.slice(1,-1)),u.length==0?d=!0:u.charAt(0)=="["&&(d=!0,u=u.slice(1,-1));var p=o.length>0?parseInt(o,10)|0:0,m=u.length>0?parseInt(u,10)|0:0;return d?m+=r.c:--m,x?p+=r.r:--p,i+(d?"":"$")+yr(m)+(x?"":"$")+hr(p)}return function(i,o){return r=o,i.replace(e,t)}})(),l0=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,o0=(function(){return function(r,t){return r.replace(l0,function(s,i,o,u,d,x){var p=t0(u)-(o?0:t.c),m=e0(x)-(d?0:t.r),w=m==0?"":d?m+1:"["+m+"]",y=p==0?"":o?p+1:"["+p+"]";return i+"R"+w+"C"+y})}})();function Iw(e,r){return e.replace(l0,function(t,s,i,o,u,d){return s+(i=="$"?i+o:yr(t0(o)+r.c))+(u=="$"?u+d:hr(e0(d)+r.r))})}function Mw(e){return e.length!=1}function Gt(e){e.l+=1}function ya(e,r){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function Sx(e,r,t){var s=2;if(t){if(t.biff>=2&&t.biff<=5)return Tx(e);t.biff==12&&(s=4)}var i=e.read_shift(s),o=e.read_shift(s),u=ya(e),d=ya(e);return{s:{r:i,c:u[0],cRel:u[1],rRel:u[2]},e:{r:o,c:d[0],cRel:d[1],rRel:d[2]}}}function Tx(e){var r=ya(e),t=ya(e),s=e.read_shift(1),i=e.read_shift(1);return{s:{r:r[0],c:s,cRel:r[1],rRel:r[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function Lw(e,r,t){if(t.biff<8)return Tx(e);var s=e.read_shift(t.biff==12?4:2),i=e.read_shift(t.biff==12?4:2),o=ya(e),u=ya(e);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:u[0],cRel:u[1],rRel:u[2]}}}function Nx(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return Bw(e);var s=e.read_shift(t&&t.biff==12?4:2),i=ya(e);return{r:s,c:i[0],cRel:i[1],rRel:i[2]}}function Bw(e){var r=ya(e),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function Uw(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function zw(e,r,t){var s=t&&t.biff?t.biff:8;if(s>=2&&s<=5)return Ww(e);var i=e.read_shift(s>=12?4:2),o=e.read_shift(2),u=(o&16384)>>14,d=(o&32768)>>15;if(o&=16383,d==1)for(;i>524287;)i-=1048576;if(u==1)for(;o>8191;)o=o-16384;return{r:i,c:o,cRel:u,rRel:d}}function Ww(e){var r=e.read_shift(2),t=e.read_shift(1),s=(r&32768)>>15,i=(r&16384)>>14;return r&=16383,s==1&&r>=8192&&(r=r-16384),i==1&&t>=128&&(t=t-256),{r,c:t,cRel:i,rRel:s}}function $w(e,r,t){var s=(e[e.l++]&96)>>5,i=Sx(e,t.biff>=2&&t.biff<=5?6:8,t);return[s,i]}function Hw(e,r,t){var s=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}var u=Sx(e,o,t);return[s,i,u]}function Vw(e,r,t){var s=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[s]}function Gw(e,r,t){var s=(e[e.l++]&96)>>5,i=e.read_shift(2),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}return e.l+=o,[s,i]}function Xw(e,r,t){var s=(e[e.l++]&96)>>5,i=Lw(e,r-1,t);return[s,i]}function Kw(e,r,t){var s=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[s]}function Uh(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function Yw(e,r,t){e.l+=2;for(var s=e.read_shift(t&&t.biff==2?1:2),i=[],o=0;o<=s;++o)i.push(e.read_shift(t&&t.biff==2?1:2));return i}function qw(e,r,t){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(t&&t.biff==2?1:2)]}function Qw(e,r,t){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(t&&t.biff==2?1:2)]}function Jw(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function Zw(e,r,t){var s=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[s]}function kx(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function e_(e){return e.read_shift(2),kx(e)}function t_(e){return e.read_shift(2),kx(e)}function r_(e,r,t){var s=(e[e.l]&96)>>5;e.l+=1;var i=Nx(e,0,t);return[s,i]}function n_(e,r,t){var s=(e[e.l]&96)>>5;e.l+=1;var i=zw(e,0,t);return[s,i]}function a_(e,r,t){var s=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var o=Nx(e,0,t);return[s,i,o]}function s_(e,r,t){var s=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(t&&t.biff<=3?1:2);return[s4[i],bx[i],s]}function i_(e,r,t){var s=e[e.l++],i=e.read_shift(1),o=t&&t.biff<=3?[s==88?-1:0,e.read_shift(1)]:l_(e);return[i,(o[0]===0?bx:a4)[o[1]]]}function l_(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function o_(e,r,t){e.l+=t&&t.biff==2?3:4}function c_(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var s=e.read_shift(2),i=e.read_shift(t&&t.biff==2?1:2);return[s,i]}function u_(e){return e.l++,Ui[e.read_shift(1)]}function f_(e){return e.l++,e.read_shift(2)}function d_(e){return e.l++,e.read_shift(1)!==0}function h_(e){return e.l++,Is(e)}function p_(e,r,t){return e.l++,ox(e,r-1,t)}function x_(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=ay(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=Ui[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Is(e);break;case 2:t[1]=oy(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function m_(e,r,t){for(var s=e.read_shift(t.biff==12?4:2),i=[],o=0;o!=s;++o)i.push((t.biff==12?qa:fy)(e));return i}function v_(e,r,t){var s=0,i=0;t.biff==12?(s=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),s=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--s,--i==0&&(i=256));for(var o=0,u=[];o!=s&&(u[o]=[]);++o)for(var d=0;d!=i;++d)u[o][d]=x_(e,t.biff);return u}function g_(e,r,t){var s=e.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,o=e.read_shift(i);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[s,0,o]}function y_(e,r,t){if(t.biff==5)return w_(e);var s=e.read_shift(1)>>>5&3,i=e.read_shift(2),o=e.read_shift(4);return[s,i,o]}function w_(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var s=e.read_shift(2);return e.l+=12,[r,t,s]}function __(e,r,t){var s=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var i=e.read_shift(t&&t.biff==2?1:2);return[s,i]}function E_(e,r,t){var s=e.read_shift(1)>>>5&3,i=e.read_shift(t&&t.biff==2?1:2);return[s,i]}function S_(e,r,t){var s=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[s]}function T_(e,r,t){var s=(e[e.l++]&96)>>5,i=e.read_shift(2),o=4;if(t)switch(t.biff){case 5:o=15;break;case 12:o=6;break}return e.l+=o,[s,i]}var N_=bn,k_=bn,C_=bn;function zi(e,r,t){return e.l+=2,[Uw(e)]}function c0(e){return e.l+=6,[]}var A_=zi,b_=c0,F_=c0,j_=zi;function Cx(e){return e.l+=2,[ix(e),e.read_shift(2)&1]}var P_=zi,O_=Cx,R_=c0,D_=zi,I_=zi,M_=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function L_(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),s=e.read_shift(4),i=e.read_shift(2),o=e.read_shift(2),u=M_[t>>2&31];return{ixti:r,coltype:t&3,rt:u,idx:s,c:i,C:o}}function B_(e){return e.l+=2,[e.read_shift(4)]}function U_(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function z_(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function W_(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function $_(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function H_(e){return e.l+=4,[0,0]}var zh={1:{n:"PtgExp",f:c_},2:{n:"PtgTbl",f:C_},3:{n:"PtgAdd",f:Gt},4:{n:"PtgSub",f:Gt},5:{n:"PtgMul",f:Gt},6:{n:"PtgDiv",f:Gt},7:{n:"PtgPower",f:Gt},8:{n:"PtgConcat",f:Gt},9:{n:"PtgLt",f:Gt},10:{n:"PtgLe",f:Gt},11:{n:"PtgEq",f:Gt},12:{n:"PtgGe",f:Gt},13:{n:"PtgGt",f:Gt},14:{n:"PtgNe",f:Gt},15:{n:"PtgIsect",f:Gt},16:{n:"PtgUnion",f:Gt},17:{n:"PtgRange",f:Gt},18:{n:"PtgUplus",f:Gt},19:{n:"PtgUminus",f:Gt},20:{n:"PtgPercent",f:Gt},21:{n:"PtgParen",f:Gt},22:{n:"PtgMissArg",f:Gt},23:{n:"PtgStr",f:p_},26:{n:"PtgSheet",f:U_},27:{n:"PtgEndSheet",f:z_},28:{n:"PtgErr",f:u_},29:{n:"PtgBool",f:d_},30:{n:"PtgInt",f:f_},31:{n:"PtgNum",f:h_},32:{n:"PtgArray",f:Kw},33:{n:"PtgFunc",f:s_},34:{n:"PtgFuncVar",f:i_},35:{n:"PtgName",f:g_},36:{n:"PtgRef",f:r_},37:{n:"PtgArea",f:$w},38:{n:"PtgMemArea",f:__},39:{n:"PtgMemErr",f:N_},40:{n:"PtgMemNoMem",f:k_},41:{n:"PtgMemFunc",f:E_},42:{n:"PtgRefErr",f:S_},43:{n:"PtgAreaErr",f:Vw},44:{n:"PtgRefN",f:n_},45:{n:"PtgAreaN",f:Xw},46:{n:"PtgMemAreaN",f:W_},47:{n:"PtgMemNoMemN",f:$_},57:{n:"PtgNameX",f:y_},58:{n:"PtgRef3d",f:a_},59:{n:"PtgArea3d",f:Hw},60:{n:"PtgRefErr3d",f:T_},61:{n:"PtgAreaErr3d",f:Gw},255:{}},V_={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},G_={1:{n:"PtgElfLel",f:Cx},2:{n:"PtgElfRw",f:D_},3:{n:"PtgElfCol",f:A_},6:{n:"PtgElfRwV",f:I_},7:{n:"PtgElfColV",f:j_},10:{n:"PtgElfRadical",f:P_},11:{n:"PtgElfRadicalS",f:R_},13:{n:"PtgElfColS",f:b_},15:{n:"PtgElfColSV",f:F_},16:{n:"PtgElfRadicalLel",f:O_},25:{n:"PtgList",f:L_},29:{n:"PtgSxName",f:B_},255:{}},X_={0:{n:"PtgAttrNoop",f:H_},1:{n:"PtgAttrSemi",f:Zw},2:{n:"PtgAttrIf",f:Qw},4:{n:"PtgAttrChoose",f:Yw},8:{n:"PtgAttrGoto",f:qw},16:{n:"PtgAttrSum",f:o_},32:{n:"PtgAttrBaxcel",f:Uh},33:{n:"PtgAttrBaxcel",f:Uh},64:{n:"PtgAttrSpace",f:e_},65:{n:"PtgAttrSpaceSemi",f:t_},128:{n:"PtgAttrIfError",f:Jw},255:{}};function K_(e,r,t,s){if(s.biff<8)return bn(e,r);for(var i=e.l+r,o=[],u=0;u!==t.length;++u)switch(t[u][0]){case"PtgArray":t[u][1]=v_(e,0,s),o.push(t[u][1]);break;case"PtgMemArea":t[u][2]=m_(e,t[u][1],s),o.push(t[u][2]);break;case"PtgExp":s&&s.biff==12&&(t[u][1][1]=e.read_shift(4),o.push(t[u][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[u][0]}return r=i-e.l,r!==0&&o.push(bn(e,r)),o}function Y_(e,r,t){for(var s=e.l+r,i,o,u=[];s!=e.l;)r=s-e.l,o=e[e.l],i=zh[o]||zh[V_[o]],(o===24||o===25)&&(i=(o===24?G_:X_)[e[e.l+1]]),!i||!i.f?bn(e,r):u.push([i.n,i.f(e,r,t)]);return u}function q_(e){for(var r=[],t=0;t<e.length;++t){for(var s=e[t],i=[],o=0;o<s.length;++o){var u=s[o];u?u[0]===2?i.push('"'+u[1].replace(/"/g,'""')+'"'):i.push(u[1]):i.push("")}r.push(i.join(","))}return r.join(";")}var Q_={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function J_(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Ax(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var s=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!s)return"SH33TJSERR1";var i="";if(t.biff>8)switch(e[s[0]][0]){case 357:return i=s[1]==-1?"#REF":e.SheetNames[s[1]],s[1]==s[2]?i:i+":"+e.SheetNames[s[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[s[0]][0];default:return"SH33TJSSRC"+e[s[0]][0]}switch(e[s[0]][0][0]){case 1025:return i=s[1]==-1?"#REF":e.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?i:i+":"+e.SheetNames[s[2]];case 14849:return e[s[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return e[s[0]][0][3]?(i=s[1]==-1?"#REF":e[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?i:i+":"+e[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function Wh(e,r,t){var s=Ax(e,r,t);return s=="#REF"?s:J_(s,t)}function Ps(e,r,t,s,i){var o=i&&i.biff||8,u={s:{c:0,r:0}},d=[],x,p,m,w=0,y=0,E,N="";if(!e[0]||!e[0][0])return"";for(var g=-1,_="",b=0,I=e[0].length;b<I;++b){var O=e[0][b];switch(O[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(x=d.pop(),p=d.pop(),g>=0){switch(e[0][g][1][0]){case 0:_=Lt(" ",e[0][g][1][1]);break;case 1:_=Lt("\r",e[0][g][1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}p=p+_,g=-1}d.push(p+Q_[O[0]]+x);break;case"PtgIsect":x=d.pop(),p=d.pop(),d.push(p+" "+x);break;case"PtgUnion":x=d.pop(),p=d.pop(),d.push(p+","+x);break;case"PtgRange":x=d.pop(),p=d.pop(),d.push(p+":"+x);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=ki(O[1][1],u,i),d.push(Ci(m,o));break;case"PtgRefN":m=t?ki(O[1][1],t,i):O[1][1],d.push(Ci(m,o));break;case"PtgRef3d":w=O[1][1],m=ki(O[1][2],u,i),N=Wh(s,w,i),d.push(N+"!"+Ci(m,o));break;case"PtgFunc":case"PtgFuncVar":var J=O[1][0],he=O[1][1];J||(J=0),J&=127;var de=J==0?[]:d.slice(-J);d.length-=J,he==="User"&&(he=de.shift()),d.push(he+"("+de.join(",")+")");break;case"PtgBool":d.push(O[1]?"TRUE":"FALSE");break;case"PtgInt":d.push(O[1]);break;case"PtgNum":d.push(String(O[1]));break;case"PtgStr":d.push('"'+O[1].replace(/"/g,'""')+'"');break;case"PtgErr":d.push(O[1]);break;case"PtgAreaN":E=kh(O[1][1],t?{s:t}:u,i),d.push(wu(E,i));break;case"PtgArea":E=kh(O[1][1],u,i),d.push(wu(E,i));break;case"PtgArea3d":w=O[1][1],E=O[1][2],N=Wh(s,w,i),d.push(N+"!"+wu(E,i));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":y=O[1][2];var z=(s.names||[])[y-1]||(s[0]||[])[y],re=z?z.Name:"SH33TJSNAME"+String(y);re&&re.slice(0,6)=="_xlfn."&&!i.xlfn&&(re=re.slice(6)),d.push(re);break;case"PtgNameX":var V=O[1][1];y=O[1][2];var M;if(i.biff<=5)V<0&&(V=-V),s[V]&&(M=s[V][y]);else{var L="";if(((s[V]||[])[0]||[])[0]==14849||(((s[V]||[])[0]||[])[0]==1025?s[V][y]&&s[V][y].itab>0&&(L=s.SheetNames[s[V][y].itab-1]+"!"):L=s.SheetNames[y-1]+"!"),s[V]&&s[V][y])L+=s[V][y].Name;else if(s[0]&&s[0][y])L+=s[0][y].Name;else{var X=(Ax(s,V,i)||"").split(";;");X[y-1]?L=X[y-1]:L+="SH33TJSERRX"}d.push(L);break}M||(M={Name:"SH33TJSERRY"}),d.push(M.Name);break;case"PtgParen":var K="(",ne=")";if(g>=0){switch(_="",e[0][g][1][0]){case 2:K=Lt(" ",e[0][g][1][1])+K;break;case 3:K=Lt("\r",e[0][g][1][1])+K;break;case 4:ne=Lt(" ",e[0][g][1][1])+ne;break;case 5:ne=Lt("\r",e[0][g][1][1])+ne;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}d.push(K+d.pop()+ne);break;case"PtgRefErr":d.push("#REF!");break;case"PtgRefErr3d":d.push("#REF!");break;case"PtgExp":m={c:O[1][1],r:O[1][0]};var W={c:t.c,r:t.r};if(s.sharedf[Tt(m)]){var Z=s.sharedf[Tt(m)];d.push(Ps(Z,u,W,s,i))}else{var me=!1;for(x=0;x!=s.arrayf.length;++x)if(p=s.arrayf[x],!(m.c<p[0].s.c||m.c>p[0].e.c)&&!(m.r<p[0].s.r||m.r>p[0].e.r)){d.push(Ps(p[1],u,W,s,i)),me=!0;break}me||d.push(O[1])}break;case"PtgArray":d.push("{"+q_(O[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":d.push("");break;case"PtgAreaErr":d.push("#REF!");break;case"PtgAreaErr3d":d.push("#REF!");break;case"PtgList":d.push("Table"+O[1].idx+"[#"+O[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(O));default:throw new Error("Unrecognized Formula Token: "+String(O))}var R=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&g>=0&&R.indexOf(e[0][b][0])==-1){O=e[0][g];var ve=!0;switch(O[1][0]){case 4:ve=!1;case 0:_=Lt(" ",O[1][1]);break;case 5:ve=!1;case 1:_=Lt("\r",O[1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+O[1][0])}d.push((ve?_:"")+d.pop()+(ve?"":_)),g=-1}}if(d.length>1&&i.WTF)throw new Error("bad formula stack");return d[0]}function Z_(e){if(e==null){var r=pe(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}else if(typeof e=="number")return Ha(e);return Ha(0)}function e4(e,r,t,s,i){var o=Va(r,t,i),u=Z_(e.v),d=pe(6),x=33;d.write_shift(2,x),d.write_shift(4,0);for(var p=pe(e.bf.length),m=0;m<e.bf.length;++m)p[m]=e.bf[m];var w=fr([o,u,d,p]);return w}function Co(e,r,t){var s=e.read_shift(4),i=Y_(e,s,t),o=e.read_shift(4),u=o>0?K_(e,o,i,t):null;return[i,u]}var t4=Co,Ao=Co,r4=Co,n4=Co,a4={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},bx={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},s4={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function i4(e){var r="of:="+e.replace(l0,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return r.replace(/;/g,"|").replace(/,/g,";")}function l4(e){return e.replace(/\./,"!")}var Ai=typeof Map<"u";function u0(e,r,t){var s=0,i=e.length;if(t){if(Ai?t.has(r):Object.prototype.hasOwnProperty.call(t,r)){for(var o=Ai?t.get(r):t[r];s<o.length;++s)if(e[o[s]].t===r)return e.Count++,o[s]}}else for(;s<i;++s)if(e[s].t===r)return e.Count++,s;return e[i]={t:r},e.Count++,e.Unique++,t&&(Ai?(t.has(r)||t.set(r,[]),t.get(r).push(i)):(Object.prototype.hasOwnProperty.call(t,r)||(t[r]=[]),t[r].push(i))),i}function bo(e,r){var t={min:e+1,max:e+1},s=-1;return r.MDW&&(Hn=r.MDW),r.width!=null?t.customWidth=1:r.wpx!=null?s=mo(r.wpx):r.wch!=null&&(s=r.wch),s>-1?(t.width=Mu(s),t.customWidth=1):r.width!=null&&(t.width=r.width),r.hidden&&(t.hidden=!0),r.level!=null&&(t.outlineLevel=t.level=r.level),t}function Fx(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function _a(e,r,t){var s=t.revssf[r.z!=null?r.z:"General"],i=60,o=e.length;if(s==null&&t.ssf){for(;i<392;++i)if(t.ssf[i]==null){Np(r.z,i),t.ssf[i]=r.z,t.revssf[r.z]=s=i;break}}for(i=0;i!=o;++i)if(e[i].numFmtId===s)return i;return e[o]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function o4(e,r,t){if(e&&e["!ref"]){var s=Pt(e["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+t+"): "+e["!ref"])}}function c4(e){if(e.length===0)return"";for(var r='<mergeCells count="'+e.length+'">',t=0;t!=e.length;++t)r+='<mergeCell ref="'+Xt(e[t])+'"/>';return r+"</mergeCells>"}function u4(e,r,t,s,i){var o=!1,u={},d=null;if(s.bookType!=="xlsx"&&r.vbaraw){var x=r.SheetNames[t];try{r.Workbook&&(x=r.Workbook.Sheets[t].CodeName||x)}catch{}o=!0,u.codeName=Pi(St(x))}if(e&&e["!outline"]){var p={summaryBelow:1,summaryRight:1};e["!outline"].above&&(p.summaryBelow=0),e["!outline"].left&&(p.summaryRight=0),d=(d||"")+Fe("outlinePr",null,p)}!o&&!d||(i[i.length]=Fe("sheetPr",d,u))}var f4=["objects","scenarios","selectLockedCells","selectUnlockedCells"],d4=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function h4(e){var r={sheet:1};return f4.forEach(function(t){e[t]!=null&&e[t]&&(r[t]="1")}),d4.forEach(function(t){e[t]!=null&&!e[t]&&(r[t]="0")}),e.password&&(r.password=hx(e.password).toString(16).toUpperCase()),Fe("sheetProtection",null,r)}function p4(e){return Fx(e),Fe("pageMargins",null,e)}function x4(e,r){for(var t=["<cols>"],s,i=0;i!=r.length;++i)(s=r[i])&&(t[t.length]=Fe("col",null,bo(i,s)));return t[t.length]="</cols>",t.join("")}function m4(e,r,t,s){var i=typeof e.ref=="string"?e.ref:Xt(e.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var o=t.Workbook.Names,u=Vr(i);u.s.r==u.e.r&&(u.e.r=Vr(r["!ref"]).e.r,i=Xt(u));for(var d=0;d<o.length;++d){var x=o[d];if(x.Name=="_xlnm._FilterDatabase"&&x.Sheet==s){x.Ref="'"+t.SheetNames[s]+"'!"+i;break}}return d==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+t.SheetNames[s]+"'!"+i}),Fe("autoFilter",null,{ref:i})}function v4(e,r,t,s){var i={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),Fe("sheetViews",Fe("sheetView",null,i),{})}function g4(e,r,t,s){if(e.c&&t["!comments"].push([r,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",o=e.t,u=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=Ui[e.v];break;case"d":s&&s.cellDates?i=Cr(e.v,-1).toISOString():(e=Ir(e),e.t="n",i=""+(e.v=Dr(Cr(e.v)))),typeof e.z>"u"&&(e.z=Bt[14]);break;default:i=e.v;break}var d=dr("v",St(i)),x={r},p=_a(s.cellXfs,e,s);switch(p!==0&&(x.s=p),e.t){case"n":break;case"d":x.t="d";break;case"b":x.t="b";break;case"e":x.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){d=dr("v",""+u0(s.Strings,e.v,s.revStrings)),x.t="s";break}x.t="str";break}if(e.t!=o&&(e.t=o,e.v=u),typeof e.f=="string"&&e.f){var m=e.F&&e.F.slice(0,r.length)==r?{t:"array",ref:e.F}:null;d=Fe("f",St(e.f),m)+(e.v!=null?d:"")}return e.l&&t["!links"].push([r,e.l]),e.D&&(x.cm=1),Fe("c",d,x)}function y4(e,r,t,s){var i=[],o=[],u=Pt(e["!ref"]),d="",x,p="",m=[],w=0,y=0,E=e["!rows"],N=Array.isArray(e),g={r:p},_,b=-1;for(y=u.s.c;y<=u.e.c;++y)m[y]=yr(y);for(w=u.s.r;w<=u.e.r;++w){for(o=[],p=hr(w),y=u.s.c;y<=u.e.c;++y){x=m[y]+p;var I=N?(e[w]||[])[y]:e[x];I!==void 0&&(d=g4(I,x,e,r))!=null&&o.push(d)}(o.length>0||E&&E[w])&&(g={r:p},E&&E[w]&&(_=E[w],_.hidden&&(g.hidden=1),b=-1,_.hpx?b=vo(_.hpx):_.hpt&&(b=_.hpt),b>-1&&(g.ht=b,g.customHeight=1),_.level&&(g.outlineLevel=_.level)),i[i.length]=Fe("row",o.join(""),g))}if(E)for(;w<E.length;++w)E&&E[w]&&(g={r:w+1},_=E[w],_.hidden&&(g.hidden=1),b=-1,_.hpx?b=vo(_.hpx):_.hpt&&(b=_.hpt),b>-1&&(g.ht=b,g.customHeight=1),_.level&&(g.outlineLevel=_.level),i[i.length]=Fe("row","",g));return i.join("")}function jx(e,r,t,s){var i=[Kt,Fe("worksheet",null,{xmlns:Os[0],"xmlns:r":nr.r})],o=t.SheetNames[e],u=0,d="",x=t.Sheets[o];x==null&&(x={});var p=x["!ref"]||"A1",m=Pt(p);if(m.e.c>16383||m.e.r>1048575){if(r.WTF)throw new Error("Range "+p+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),p=Xt(m)}s||(s={}),x["!comments"]=[];var w=[];u4(x,t,e,r,i),i[i.length]=Fe("dimension",null,{ref:p}),i[i.length]=v4(x,r,e,t),r.sheetFormat&&(i[i.length]=Fe("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),x["!cols"]!=null&&x["!cols"].length>0&&(i[i.length]=x4(x,x["!cols"])),i[u=i.length]="<sheetData/>",x["!links"]=[],x["!ref"]!=null&&(d=y4(x,r),d.length>0&&(i[i.length]=d)),i.length>u+1&&(i[i.length]="</sheetData>",i[u]=i[u].replace("/>",">")),x["!protect"]&&(i[i.length]=h4(x["!protect"])),x["!autofilter"]!=null&&(i[i.length]=m4(x["!autofilter"],x,t,e)),x["!merges"]!=null&&x["!merges"].length>0&&(i[i.length]=c4(x["!merges"]));var y=-1,E,N=-1;return x["!links"].length>0&&(i[i.length]="<hyperlinks>",x["!links"].forEach(function(g){g[1].Target&&(E={ref:g[0]},g[1].Target.charAt(0)!="#"&&(N=Et(s,-1,St(g[1].Target).replace(/#.*$/,""),xt.HLINK),E["r:id"]="rId"+N),(y=g[1].Target.indexOf("#"))>-1&&(E.location=St(g[1].Target.slice(y+1))),g[1].Tooltip&&(E.tooltip=St(g[1].Tooltip)),i[i.length]=Fe("hyperlink",null,E))}),i[i.length]="</hyperlinks>"),delete x["!links"],x["!margins"]!=null&&(i[i.length]=p4(x["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&(i[i.length]=dr("ignoredErrors",Fe("ignoredError",null,{numberStoredAsText:1,sqref:p}))),w.length>0&&(N=Et(s,-1,"../drawings/drawing"+(e+1)+".xml",xt.DRAW),i[i.length]=Fe("drawing",null,{"r:id":"rId"+N}),x["!drawing"]=w),x["!comments"].length>0&&(N=Et(s,-1,"../drawings/vmlDrawing"+(e+1)+".vml",xt.VML),i[i.length]=Fe("legacyDrawing",null,{"r:id":"rId"+N}),x["!legacy"]=N),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function w4(e,r){var t={},s=e.l+r;t.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=s,o&7&&(t.level=o&7),o&16&&(t.hidden=!0),o&32&&(t.hpt=i/20),t}function _4(e,r,t){var s=pe(145),i=(t["!rows"]||[])[e]||{};s.write_shift(4,e),s.write_shift(4,0);var o=320;i.hpx?o=vo(i.hpx)*20:i.hpt&&(o=i.hpt*20),s.write_shift(2,o),s.write_shift(1,0);var u=0;i.level&&(u|=i.level),i.hidden&&(u|=16),(i.hpx||i.hpt)&&(u|=32),s.write_shift(1,u),s.write_shift(1,0);var d=0,x=s.l;s.l+=4;for(var p={r:e,c:0},m=0;m<16;++m)if(!(r.s.c>m+1<<10||r.e.c<m<<10)){for(var w=-1,y=-1,E=m<<10;E<m+1<<10;++E){p.c=E;var N=Array.isArray(t)?(t[p.r]||[])[p.c]:t[Tt(p)];N&&(w<0&&(w=E),y=E)}w<0||(++d,s.write_shift(4,w),s.write_shift(4,y))}var g=s.l;return s.l=x,s.write_shift(4,d),s.l=g,s.length>s.l?s.slice(0,s.l):s}function E4(e,r,t,s){var i=_4(s,t,r);(i.length>17||(r["!rows"]||[])[s])&&ge(e,0,i)}var S4=qa,T4=Ds;function N4(){}function k4(e,r){var t={},s=e[e.l];return++e.l,t.above=!(s&64),t.left=!(s&128),e.l+=18,t.name=I2(e),t}function C4(e,r,t){t==null&&(t=pe(84+4*e.length));var s=192;r&&(r.above&&(s&=-65),r.left&&(s&=-129)),t.write_shift(1,s);for(var i=1;i<3;++i)t.write_shift(1,0);return ho({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),Gp(e,t),t.slice(0,t.l)}function A4(e){var r=tn(e);return[r]}function b4(e,r,t){return t==null&&(t=pe(8)),Xa(r,t)}function F4(e){var r=Ka(e);return[r]}function j4(e,r,t){return t==null&&(t=pe(4)),Ya(r,t)}function P4(e){var r=tn(e),t=e.read_shift(1);return[r,t,"b"]}function O4(e,r,t){return t==null&&(t=pe(9)),Xa(r,t),t.write_shift(1,e.v?1:0),t}function R4(e){var r=Ka(e),t=e.read_shift(1);return[r,t,"b"]}function D4(e,r,t){return t==null&&(t=pe(5)),Ya(r,t),t.write_shift(1,e.v?1:0),t}function I4(e){var r=tn(e),t=e.read_shift(1);return[r,t,"e"]}function M4(e,r,t){return t==null&&(t=pe(9)),Xa(r,t),t.write_shift(1,e.v),t}function L4(e){var r=Ka(e),t=e.read_shift(1);return[r,t,"e"]}function B4(e,r,t){return t==null&&(t=pe(8)),Ya(r,t),t.write_shift(1,e.v),t.write_shift(2,0),t.write_shift(1,0),t}function U4(e){var r=tn(e),t=e.read_shift(4);return[r,t,"s"]}function z4(e,r,t){return t==null&&(t=pe(12)),Xa(r,t),t.write_shift(4,r.v),t}function W4(e){var r=Ka(e),t=e.read_shift(4);return[r,t,"s"]}function $4(e,r,t){return t==null&&(t=pe(8)),Ya(r,t),t.write_shift(4,r.v),t}function H4(e){var r=tn(e),t=Is(e);return[r,t,"n"]}function V4(e,r,t){return t==null&&(t=pe(16)),Xa(r,t),Ha(e.v,t),t}function G4(e){var r=Ka(e),t=Is(e);return[r,t,"n"]}function X4(e,r,t){return t==null&&(t=pe(12)),Ya(r,t),Ha(e.v,t),t}function K4(e){var r=tn(e),t=Xp(e);return[r,t,"n"]}function Y4(e,r,t){return t==null&&(t=pe(12)),Xa(r,t),Kp(e.v,t),t}function q4(e){var r=Ka(e),t=Xp(e);return[r,t,"n"]}function Q4(e,r,t){return t==null&&(t=pe(8)),Ya(r,t),Kp(e.v,t),t}function J4(e){var r=tn(e),t=r0(e);return[r,t,"is"]}function Z4(e){var r=tn(e),t=wr(e);return[r,t,"str"]}function eE(e,r,t){return t==null&&(t=pe(12+4*e.v.length)),Xa(r,t),sr(e.v,t),t.length>t.l?t.slice(0,t.l):t}function tE(e){var r=Ka(e),t=wr(e);return[r,t,"str"]}function rE(e,r,t){return t==null&&(t=pe(8+4*e.v.length)),Ya(r,t),sr(e.v,t),t.length>t.l?t.slice(0,t.l):t}function nE(e,r,t){var s=e.l+r,i=tn(e);i.r=t["!row"];var o=e.read_shift(1),u=[i,o,"b"];if(t.cellFormula){e.l+=2;var d=Ao(e,s-e.l,t);u[3]=Ps(d,null,i,t.supbooks,t)}else e.l=s;return u}function aE(e,r,t){var s=e.l+r,i=tn(e);i.r=t["!row"];var o=e.read_shift(1),u=[i,o,"e"];if(t.cellFormula){e.l+=2;var d=Ao(e,s-e.l,t);u[3]=Ps(d,null,i,t.supbooks,t)}else e.l=s;return u}function sE(e,r,t){var s=e.l+r,i=tn(e);i.r=t["!row"];var o=Is(e),u=[i,o,"n"];if(t.cellFormula){e.l+=2;var d=Ao(e,s-e.l,t);u[3]=Ps(d,null,i,t.supbooks,t)}else e.l=s;return u}function iE(e,r,t){var s=e.l+r,i=tn(e);i.r=t["!row"];var o=wr(e),u=[i,o,"str"];if(t.cellFormula){e.l+=2;var d=Ao(e,s-e.l,t);u[3]=Ps(d,null,i,t.supbooks,t)}else e.l=s;return u}var lE=qa,oE=Ds;function cE(e,r){return r==null&&(r=pe(4)),r.write_shift(4,e),r}function uE(e,r){var t=e.l+r,s=qa(e),i=n0(e),o=wr(e),u=wr(e),d=wr(e);e.l=t;var x={rfx:s,relId:i,loc:o,display:d};return u&&(x.Tooltip=u),x}function fE(e,r){var t=pe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Ds({s:ar(e[0]),e:ar(e[0])},t),a0("rId"+r,t);var s=e[1].Target.indexOf("#"),i=s==-1?"":e[1].Target.slice(s+1);return sr(i||"",t),sr(e[1].Tooltip||"",t),sr("",t),t.slice(0,t.l)}function dE(){}function hE(e,r,t){var s=e.l+r,i=Yp(e),o=e.read_shift(1),u=[i];if(u[2]=o,t.cellFormula){var d=t4(e,s-e.l,t);u[1]=d}else e.l=s;return u}function pE(e,r,t){var s=e.l+r,i=qa(e),o=[i];if(t.cellFormula){var u=n4(e,s-e.l,t);o[1]=u,e.l=s}else e.l=s;return o}function xE(e,r,t){t==null&&(t=pe(18));var s=bo(e,r);t.write_shift(-4,e),t.write_shift(-4,e),t.write_shift(4,(s.width||10)*256),t.write_shift(4,0);var i=0;return r.hidden&&(i|=1),typeof s.width=="number"&&(i|=2),r.level&&(i|=r.level<<8),t.write_shift(2,i),t}var Px=["left","right","top","bottom","header","footer"];function mE(e){var r={};return Px.forEach(function(t){r[t]=Is(e)}),r}function vE(e,r){return r==null&&(r=pe(48)),Fx(e),Px.forEach(function(t){Ha(e[t],r)}),r}function gE(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function yE(e,r,t){t==null&&(t=pe(30));var s=924;return(((r||{}).Views||[])[0]||{}).RTL&&(s|=32),t.write_shift(2,s),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function wE(e){var r=pe(24);return r.write_shift(4,4),r.write_shift(4,1),Ds(e,r),r}function _E(e,r){return r==null&&(r=pe(66)),r.write_shift(2,e.password?hx(e.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?r.write_shift(4,e[t[0]]!=null&&!e[t[0]]?1:0):r.write_shift(4,e[t[0]]!=null&&e[t[0]]?0:1)}),r}function EE(){}function SE(){}function TE(e,r,t,s,i,o,u){if(r.v===void 0)return!1;var d="";switch(r.t){case"b":d=r.v?"1":"0";break;case"d":r=Ir(r),r.z=r.z||Bt[14],r.v=Dr(Cr(r.v)),r.t="n";break;case"n":case"e":d=""+r.v;break;default:d=r.v;break}var x={r:t,c:s};switch(x.s=_a(i.cellXfs,r,i),r.l&&o["!links"].push([Tt(x),r.l]),r.c&&o["!comments"].push([Tt(x),r.c]),r.t){case"s":case"str":return i.bookSST?(d=u0(i.Strings,r.v,i.revStrings),x.t="s",x.v=d,u?ge(e,18,$4(r,x)):ge(e,7,z4(r,x))):(x.t="str",u?ge(e,17,rE(r,x)):ge(e,6,eE(r,x))),!0;case"n":return r.v==(r.v|0)&&r.v>-1e3&&r.v<1e3?u?ge(e,13,Q4(r,x)):ge(e,2,Y4(r,x)):u?ge(e,16,X4(r,x)):ge(e,5,V4(r,x)),!0;case"b":return x.t="b",u?ge(e,15,D4(r,x)):ge(e,4,O4(r,x)),!0;case"e":return x.t="e",u?ge(e,14,B4(r,x)):ge(e,3,M4(r,x)),!0}return u?ge(e,12,j4(r,x)):ge(e,1,b4(r,x)),!0}function NE(e,r,t,s){var i=Pt(r["!ref"]||"A1"),o,u="",d=[];ge(e,145);var x=Array.isArray(r),p=i.e.r;r["!rows"]&&(p=Math.max(i.e.r,r["!rows"].length-1));for(var m=i.s.r;m<=p;++m){u=hr(m),E4(e,r,i,m);var w=!1;if(m<=i.e.r)for(var y=i.s.c;y<=i.e.c;++y){m===i.s.r&&(d[y]=yr(y)),o=d[y]+u;var E=x?(r[m]||[])[y]:r[o];if(!E){w=!1;continue}w=TE(e,E,m,y,s,r,w)}}ge(e,146)}function kE(e,r){!r||!r["!merges"]||(ge(e,177,cE(r["!merges"].length)),r["!merges"].forEach(function(t){ge(e,176,oE(t))}),ge(e,178))}function CE(e,r){!r||!r["!cols"]||(ge(e,390),r["!cols"].forEach(function(t,s){t&&ge(e,60,xE(s,t))}),ge(e,391))}function AE(e,r){!r||!r["!ref"]||(ge(e,648),ge(e,649,wE(Pt(r["!ref"]))),ge(e,650))}function bE(e,r,t){r["!links"].forEach(function(s){if(s[1].Target){var i=Et(t,-1,s[1].Target.replace(/#.*$/,""),xt.HLINK);ge(e,494,fE(s,i))}}),delete r["!links"]}function FE(e,r,t,s){if(r["!comments"].length>0){var i=Et(s,-1,"../drawings/vmlDrawing"+(t+1)+".vml",xt.VML);ge(e,551,a0("rId"+i)),r["!legacy"]=i}}function jE(e,r,t,s){if(r["!autofilter"]){var i=r["!autofilter"],o=typeof i.ref=="string"?i.ref:Xt(i.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var u=t.Workbook.Names,d=Vr(o);d.s.r==d.e.r&&(d.e.r=Vr(r["!ref"]).e.r,o=Xt(d));for(var x=0;x<u.length;++x){var p=u[x];if(p.Name=="_xlnm._FilterDatabase"&&p.Sheet==s){p.Ref="'"+t.SheetNames[s]+"'!"+o;break}}x==u.length&&u.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+t.SheetNames[s]+"'!"+o}),ge(e,161,Ds(Pt(o))),ge(e,162)}}function PE(e,r,t){ge(e,133),ge(e,137,yE(r,t)),ge(e,138),ge(e,134)}function OE(e,r){r["!protect"]&&ge(e,535,_E(r["!protect"]))}function RE(e,r,t,s){var i=Rr(),o=t.SheetNames[e],u=t.Sheets[o]||{},d=o;try{t&&t.Workbook&&(d=t.Workbook.Sheets[e].CodeName||d)}catch{}var x=Pt(u["!ref"]||"A1");if(x.e.c>16383||x.e.r>1048575){if(r.WTF)throw new Error("Range "+(u["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");x.e.c=Math.min(x.e.c,16383),x.e.r=Math.min(x.e.c,1048575)}return u["!links"]=[],u["!comments"]=[],ge(i,129),(t.vbaraw||u["!outline"])&&ge(i,147,C4(d,u["!outline"])),ge(i,148,T4(x)),PE(i,u,t.Workbook),CE(i,u),NE(i,u,e,r),OE(i,u),jE(i,u,t,e),kE(i,u),bE(i,u,s),u["!margins"]&&ge(i,476,vE(u["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&AE(i,u),FE(i,u,e,s),ge(i,130),i.end()}function DE(e,r){e.l+=10;var t=wr(e);return{name:t}}var IE=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function ME(e){return!e.Workbook||!e.Workbook.WBProps?"false":p2(e.Workbook.WBProps.date1904)?"true":"false"}var LE="][*?/\\".split("");function Ox(e,r){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return LE.forEach(function(s){if(e.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function BE(e,r,t){e.forEach(function(s,i){Ox(s);for(var o=0;o<i;++o)if(s==e[o])throw new Error("Duplicate Sheet Name: "+s);if(t){var u=r&&r[i]&&r[i].CodeName||s;if(u.charCodeAt(0)==95&&u.length>22)throw new Error("Bad Code Name: Worksheet"+u)}})}function UE(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var r=e.Workbook&&e.Workbook.Sheets||[];BE(e.SheetNames,r,!!e.vbaraw);for(var t=0;t<e.SheetNames.length;++t)o4(e.Sheets[e.SheetNames[t]],e.SheetNames[t],t)}function Rx(e){var r=[Kt];r[r.length]=Fe("workbook",null,{xmlns:Os[0],"xmlns:r":nr.r});var t=e.Workbook&&(e.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(IE.forEach(function(d){e.Workbook.WBProps[d[0]]!=null&&e.Workbook.WBProps[d[0]]!=d[1]&&(s[d[0]]=e.Workbook.WBProps[d[0]])}),e.Workbook.WBProps.CodeName&&(s.codeName=e.Workbook.WBProps.CodeName,delete s.CodeName)),r[r.length]=Fe("workbookPr",null,s);var i=e.Workbook&&e.Workbook.Sheets||[],o=0;if(i&&i[0]&&i[0].Hidden){for(r[r.length]="<bookViews>",o=0;o!=e.SheetNames.length&&!(!i[o]||!i[o].Hidden);++o);o==e.SheetNames.length&&(o=0),r[r.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",o=0;o!=e.SheetNames.length;++o){var u={name:St(e.SheetNames[o].slice(0,31))};if(u.sheetId=""+(o+1),u["r:id"]="rId"+(o+1),i[o])switch(i[o].Hidden){case 1:u.state="hidden";break;case 2:u.state="veryHidden";break}r[r.length]=Fe("sheet",null,u)}return r[r.length]="</sheets>",t&&(r[r.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(d){var x={name:d.Name};d.Comment&&(x.comment=d.Comment),d.Sheet!=null&&(x.localSheetId=""+d.Sheet),d.Hidden&&(x.hidden="1"),d.Ref&&(r[r.length]=Fe("definedName",St(d.Ref),x))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function zE(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=Iu(e),t.name=wr(e),t}function WE(e,r){return r||(r=pe(127)),r.write_shift(4,e.Hidden),r.write_shift(4,e.iTabID),a0(e.strRelID,r),sr(e.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function $E(e,r){var t={},s=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var i=r>8?wr(e):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(s&65536),t.backupFile=!!(s&64),t.checkCompatibility=!!(s&4096),t.date1904=!!(s&1),t.filterPrivacy=!!(s&8),t.hidePivotFieldList=!!(s&1024),t.promptedSolutions=!!(s&16),t.publishItems=!!(s&2048),t.refreshAllConnections=!!(s&262144),t.saveExternalLinkValues=!!(s&128),t.showBorderUnselectedTables=!!(s&4),t.showInkAnnotation=!!(s&32),t.showObjects=["all","placeholders","none"][s>>13&3],t.showPivotChartFilter=!!(s&32768),t.updateLinks=["userSet","never","always"][s>>8&3],t}function HE(e,r){r||(r=pe(72));var t=0;return e&&e.filterPrivacy&&(t|=8),r.write_shift(4,t),r.write_shift(4,0),Gp(e&&e.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}function VE(e,r,t){var s=e.l+r;e.l+=4,e.l+=1;var i=e.read_shift(4),o=M2(e),u=r4(e,0,t),d=n0(e);e.l=s;var x={Name:o,Ptg:u};return i<268435455&&(x.Sheet=i),d&&(x.Comment=d),x}function GE(e,r){ge(e,143);for(var t=0;t!=r.SheetNames.length;++t){var s=r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t]&&r.Workbook.Sheets[t].Hidden||0,i={Hidden:s,iTabID:t+1,strRelID:"rId"+(t+1),name:r.SheetNames[t]};ge(e,156,WE(i))}ge(e,144)}function XE(e,r){r||(r=pe(127));for(var t=0;t!=4;++t)r.write_shift(4,0);return sr("SheetJS",r),sr(ao.version,r),sr(ao.version,r),sr("7262",r),r.length>r.l?r.slice(0,r.l):r}function KE(e,r){r||(r=pe(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,e),r.write_shift(4,e);var t=120;return r.write_shift(1,t),r.length>r.l?r.slice(0,r.l):r}function YE(e,r){if(!(!r.Workbook||!r.Workbook.Sheets)){for(var t=r.Workbook.Sheets,s=0,i=-1,o=-1;s<t.length;++s)!t[s]||!t[s].Hidden&&i==-1?i=s:t[s].Hidden==1&&o==-1&&(o=s);o>i||(ge(e,135),ge(e,158,KE(i)),ge(e,136))}}function qE(e,r){var t=Rr();return ge(t,131),ge(t,128,XE()),ge(t,153,HE(e.Workbook&&e.Workbook.WBProps||null)),YE(t,e),GE(t,e),ge(t,132),t.end()}function QE(e,r,t){return(r.slice(-4)===".bin"?qE:Rx)(e)}function JE(e,r,t,s,i){return(r.slice(-4)===".bin"?RE:jx)(e,t,s,i)}function ZE(e,r,t){return(r.slice(-4)===".bin"?vw:mx)(e,t)}function eS(e,r,t){return(r.slice(-4)===".bin"?Hy:dx)(e,t)}function tS(e,r,t){return(r.slice(-4)===".bin"?Ow:_x)(e)}function rS(e){return(e.slice(-4)===".bin"?Nw:yx)()}function nS(e,r){var t=[];return e.Props&&t.push(Z2(e.Props,r)),e.Custprops&&t.push(ey(e.Props,e.Custprops)),t.join("")}function aS(){return""}function sS(e,r){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(s,i){var o=[];o.push(Fe("NumberFormat",null,{"ss:Format":St(Bt[s.numFmtId])}));var u={"ss:ID":"s"+(21+i)};t.push(Fe("Style",o.join(""),u))}),Fe("Styles",t.join(""))}function Dx(e){return Fe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+o0(e.Ref,{r:0,c:0})})}function iS(e){if(!((e||{}).Workbook||{}).Names)return"";for(var r=e.Workbook.Names,t=[],s=0;s<r.length;++s){var i=r[s];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||t.push(Dx(i)))}return Fe("Names",t.join(""))}function lS(e,r,t,s){if(!e||!((s||{}).Workbook||{}).Names)return"";for(var i=s.Workbook.Names,o=[],u=0;u<i.length;++u){var d=i[u];d.Sheet==t&&(d.Name.match(/^_xlfn\./)||o.push(Dx(d)))}return o.join("")}function oS(e,r,t,s){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(Fe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(Fe("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(Fe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[t])if(s.Workbook.Sheets[t].Hidden)i.push(Fe("Visible",s.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<t&&!(s.Workbook.Sheets[o]&&!s.Workbook.Sheets[o].Hidden);++o);o==t&&i.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(dr("ProtectContents","True")),e["!protect"].objects&&i.push(dr("ProtectObjects","True")),e["!protect"].scenarios&&i.push(dr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(dr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(dr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(u){e["!protect"][u[0]]&&i.push("<"+u[1]+"/>")})),i.length==0?"":Fe("WorksheetOptions",i.join(""),{xmlns:$r.x})}function cS(e){return e.map(function(r){var t=h2(r.t||""),s=Fe("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return Fe("Comment",s,{"ss:Author":r.a})}).join("")}function uS(e,r,t,s,i,o,u){if(!e||e.v==null&&e.f==null)return"";var d={};if(e.f&&(d["ss:Formula"]="="+St(o0(e.f,u))),e.F&&e.F.slice(0,r.length)==r){var x=ar(e.F.slice(r.length+1));d["ss:ArrayRange"]="RC:R"+(x.r==u.r?"":"["+(x.r-u.r)+"]")+"C"+(x.c==u.c?"":"["+(x.c-u.c)+"]")}if(e.l&&e.l.Target&&(d["ss:HRef"]=St(e.l.Target),e.l.Tooltip&&(d["x:HRefScreenTip"]=St(e.l.Tooltip))),t["!merges"])for(var p=t["!merges"],m=0;m!=p.length;++m)p[m].s.c!=u.c||p[m].s.r!=u.r||(p[m].e.c>p[m].s.c&&(d["ss:MergeAcross"]=p[m].e.c-p[m].s.c),p[m].e.r>p[m].s.r&&(d["ss:MergeDown"]=p[m].e.r-p[m].s.r));var w="",y="";switch(e.t){case"z":if(!s.sheetStubs)return"";break;case"n":w="Number",y=String(e.v);break;case"b":w="Boolean",y=e.v?"1":"0";break;case"e":w="Error",y=Ui[e.v];break;case"d":w="DateTime",y=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Bt[14]);break;case"s":w="String",y=d2(e.v||"");break}var E=_a(s.cellXfs,e,s);d["ss:StyleID"]="s"+(21+E),d["ss:Index"]=u.c+1;var N=e.v!=null?y:"",g=e.t=="z"?"":'<Data ss:Type="'+w+'">'+N+"</Data>";return(e.c||[]).length>0&&(g+=cS(e.c)),Fe("Cell",g,d)}function fS(e,r){var t='<Row ss:Index="'+(e+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=xx(r.hpt)),r.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(t+=' ss:Hidden="1"')),t+">"}function dS(e,r,t,s){if(!e["!ref"])return"";var i=Pt(e["!ref"]),o=e["!merges"]||[],u=0,d=[];e["!cols"]&&e["!cols"].forEach(function(_,b){i0(_);var I=!!_.width,O=bo(b,_),J={"ss:Index":b+1};I&&(J["ss:Width"]=xo(O.width)),_.hidden&&(J["ss:Hidden"]="1"),d.push(Fe("Column",null,J))});for(var x=Array.isArray(e),p=i.s.r;p<=i.e.r;++p){for(var m=[fS(p,(e["!rows"]||[])[p])],w=i.s.c;w<=i.e.c;++w){var y=!1;for(u=0;u!=o.length;++u)if(!(o[u].s.c>w)&&!(o[u].s.r>p)&&!(o[u].e.c<w)&&!(o[u].e.r<p)){(o[u].s.c!=w||o[u].s.r!=p)&&(y=!0);break}if(!y){var E={r:p,c:w},N=Tt(E),g=x?(e[p]||[])[w]:e[N];m.push(uS(g,N,e,r,t,s,E))}}m.push("</Row>"),m.length>2&&d.push(m.join(""))}return d.join("")}function hS(e,r,t){var s=[],i=t.SheetNames[e],o=t.Sheets[i],u=o?lS(o,r,e,t):"";return u.length>0&&s.push("<Names>"+u+"</Names>"),u=o?dS(o,r,e,t):"",u.length>0&&s.push("<Table>"+u+"</Table>"),s.push(oS(o,r,e,t)),s.join("")}function pS(e,r){r||(r={}),e.SSF||(e.SSF=Ir(Bt)),e.SSF&&(To(),So(e.SSF),r.revssf=No(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF,r.cellXfs=[],_a(r.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(nS(e,r)),t.push(aS()),t.push(""),t.push("");for(var s=0;s<e.SheetNames.length;++s)t.push(Fe("Worksheet",hS(s,r,e),{"ss:Name":St(e.SheetNames[s])}));return t[2]=sS(e,r),t[3]=iS(e),Kt+Fe("Workbook",t.join(""),{xmlns:$r.ss,"xmlns:o":$r.o,"xmlns:x":$r.x,"xmlns:ss":$r.ss,"xmlns:dt":$r.dt,"xmlns:html":$r.html})}var Su={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function xS(e,r){var t=[],s=[],i=[],o=0,u,d=xh(Ah,"n"),x=xh(bh,"n");if(e.Props)for(u=pr(e.Props),o=0;o<u.length;++o)(Object.prototype.hasOwnProperty.call(d,u[o])?t:Object.prototype.hasOwnProperty.call(x,u[o])?s:i).push([u[o],e.Props[u[o]]]);if(e.Custprops)for(u=pr(e.Custprops),o=0;o<u.length;++o)Object.prototype.hasOwnProperty.call(e.Props||{},u[o])||(Object.prototype.hasOwnProperty.call(d,u[o])?t:Object.prototype.hasOwnProperty.call(x,u[o])?s:i).push([u[o],e.Custprops[u[o]]]);var p=[];for(o=0;o<i.length;++o)sx.indexOf(i[o][0])>-1||rx.indexOf(i[o][0])>-1||i[o][1]!=null&&p.push(i[o]);s.length&&Nt.utils.cfb_add(r,"/SummaryInformation",Rh(s,Su.SI,x,bh)),(t.length||p.length)&&Nt.utils.cfb_add(r,"/DocumentSummaryInformation",Rh(t,Su.DSI,d,Ah,p.length?p:null,Su.UDI))}function mS(e,r){var t=r||{},s=Nt.utils.cfb_new({root:"R"}),i="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":i="/Workbook",t.biff=8;break;case"biff5":i="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Nt.utils.cfb_add(s,i,Ix(e,t)),t.biff==8&&(e.Props||e.Custprops)&&xS(e,s),t.biff==8&&e.vbaraw&&Rw(s,Nt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),s}var vS={0:{f:w4},1:{f:A4},2:{f:K4},3:{f:I4},4:{f:P4},5:{f:H4},6:{f:Z4},7:{f:U4},8:{f:iE},9:{f:sE},10:{f:nE},11:{f:aE},12:{f:F4},13:{f:q4},14:{f:L4},15:{f:R4},16:{f:G4},17:{f:tE},18:{f:W4},19:{f:r0},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:VE},40:{},42:{},43:{f:Zy},44:{f:Qy},45:{f:rw},46:{f:aw},47:{f:nw},48:{},49:{f:F2},50:{},51:{f:ww},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:jy},62:{f:J4},63:{f:kw},64:{f:EE},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:bn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:gE},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:k4},148:{f:S4,p:16},151:{f:dE},152:{},153:{f:$E},154:{},155:{},156:{f:zE},157:{},158:{},159:{T:1,f:zy},160:{T:-1},161:{T:1,f:qa},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:lE},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:gw},336:{T:-1},337:{f:Sw,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Iu},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Ny},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:hE},427:{f:pE},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:mE},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:N4},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:uE},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Iu},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:jw},633:{T:1},634:{T:-1},635:{T:1,f:bw},636:{T:-1},637:{f:R2},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:DE},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:SE},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function je(e,r,t,s){var i=r;if(!isNaN(i)){var o=s||(t||[]).length||0,u=e.next(4);u.write_shift(2,i),u.write_shift(2,o),o>0&&Zu(t)&&e.push(t)}}function gS(e,r,t,s){var i=(t||[]).length||0;if(i<=8224)return je(e,r,t,i);var o=r;if(!isNaN(o)){for(var u=t.parts||[],d=0,x=0,p=0;p+(u[d]||8224)<=8224;)p+=u[d]||8224,d++;var m=e.next(4);for(m.write_shift(2,o),m.write_shift(2,p),e.push(t.slice(x,x+p)),x+=p;x<i;){for(m=e.next(4),m.write_shift(2,60),p=0;p+(u[d]||8224)<=8224;)p+=u[d]||8224,d++;m.write_shift(2,p),e.push(t.slice(x,x+p)),x+=p}}}function Wi(e,r,t){return e||(e=pe(7)),e.write_shift(2,r),e.write_shift(2,t),e.write_shift(2,0),e.write_shift(1,0),e}function yS(e,r,t,s){var i=pe(9);return Wi(i,e,r),lx(t,s||"b",i),i}function wS(e,r,t){var s=pe(8+2*t.length);return Wi(s,e,r),s.write_shift(1,t.length),s.write_shift(t.length,t,"sbcs"),s.l<s.length?s.slice(0,s.l):s}function _S(e,r,t,s){if(r.v!=null)switch(r.t){case"d":case"n":var i=r.t=="d"?Dr(Cr(r.v)):r.v;i==(i|0)&&i>=0&&i<65536?je(e,2,Dy(t,s,i)):je(e,3,Ry(t,s,i));return;case"b":case"e":je(e,5,yS(t,s,r.v,r.t));return;case"s":case"str":je(e,4,wS(t,s,(r.v||"").slice(0,255)));return}je(e,1,Wi(null,t,s))}function ES(e,r,t,s){var i=Array.isArray(r),o=Pt(r["!ref"]||"A1"),u,d="",x=[];if(o.e.c>255||o.e.r>16383){if(s.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),u=Xt(o)}for(var p=o.s.r;p<=o.e.r;++p){d=hr(p);for(var m=o.s.c;m<=o.e.c;++m){p===o.s.r&&(x[m]=yr(m)),u=x[m]+d;var w=i?(r[p]||[])[m]:r[u];w&&_S(e,w,p,m)}}}function SS(e,r){for(var t=r||{},s=Rr(),i=0,o=0;o<e.SheetNames.length;++o)e.SheetNames[o]==t.sheet&&(i=o);if(i==0&&t.sheet&&e.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return je(s,t.biff==4?1033:t.biff==3?521:9,s0(e,16,t)),ES(s,e.Sheets[e.SheetNames[i]],i,t),je(s,10),s.end()}function TS(e,r,t){je(e,49,vy({sz:12,name:"Arial"},t))}function NS(e,r,t){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var i=s[0];i<=s[1];++i)r[i]!=null&&je(e,1054,wy(i,r[i],t))})}function kS(e,r){var t=pe(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),je(e,2151,t),t=pe(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),ux(Pt(r["!ref"]||"A1"),t),t.write_shift(4,4),je(e,2152,t)}function CS(e,r){for(var t=0;t<16;++t)je(e,224,Ih({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(s){je(e,224,Ih(s,0,r))})}function AS(e,r){for(var t=0;t<r["!links"].length;++t){var s=r["!links"][t];je(e,440,Ay(s)),s[1].Tooltip&&je(e,2048,by(s))}delete r["!links"]}function bS(e,r){if(r){var t=0;r.forEach(function(s,i){++t<=256&&s&&je(e,125,Py(bo(i,s),i))})}}function FS(e,r,t,s,i){var o=16+_a(i.cellXfs,r,i);if(r.v==null&&!r.bf){je(e,513,Va(t,s,o));return}if(r.bf)je(e,6,e4(r,t,s,i,o));else switch(r.t){case"d":case"n":var u=r.t=="d"?Dr(Cr(r.v)):r.v;je(e,515,Ty(t,s,u,o));break;case"b":case"e":je(e,517,Sy(t,s,r.v,o,i,r.t));break;case"s":case"str":if(i.bookSST){var d=u0(i.Strings,r.v,i.revStrings);je(e,253,gy(t,s,d,o))}else je(e,516,yy(t,s,(r.v||"").slice(0,255),o,i));break;default:je(e,513,Va(t,s,o))}}function jS(e,r,t){var s=Rr(),i=t.SheetNames[e],o=t.Sheets[i]||{},u=(t||{}).Workbook||{},d=(u.Sheets||[])[e]||{},x=Array.isArray(o),p=r.biff==8,m,w="",y=[],E=Pt(o["!ref"]||"A1"),N=p?65536:16384;if(E.e.c>255||E.e.r>=N){if(r.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");E.e.c=Math.min(E.e.c,255),E.e.r=Math.min(E.e.c,N-1)}je(s,2057,s0(t,16,r)),je(s,13,en(1)),je(s,12,en(100)),je(s,15,kr(!0)),je(s,17,kr(!1)),je(s,16,Ha(.001)),je(s,95,kr(!0)),je(s,42,kr(!1)),je(s,43,kr(!1)),je(s,130,en(1)),je(s,128,Ey()),je(s,131,kr(!1)),je(s,132,kr(!1)),p&&bS(s,o["!cols"]),je(s,512,_y(E,r)),p&&(o["!links"]=[]);for(var g=E.s.r;g<=E.e.r;++g){w=hr(g);for(var _=E.s.c;_<=E.e.c;++_){g===E.s.r&&(y[_]=yr(_)),m=y[_]+w;var b=x?(o[g]||[])[_]:o[m];b&&(FS(s,b,g,_,r),p&&b.l&&o["!links"].push([m,b.l]))}}var I=d.CodeName||d.name||i;return p&&je(s,574,my((u.Views||[])[0])),p&&(o["!merges"]||[]).length&&je(s,229,Cy(o["!merges"])),p&&AS(s,o),je(s,442,cx(I)),p&&kS(s,o),je(s,10),s.end()}function PS(e,r,t){var s=Rr(),i=(e||{}).Workbook||{},o=i.Sheets||[],u=i.WBProps||{},d=t.biff==8,x=t.biff==5;if(je(s,2057,s0(e,5,t)),t.bookType=="xla"&&je(s,135),je(s,225,d?en(1200):null),je(s,193,ny(2)),x&&je(s,191),x&&je(s,192),je(s,226),je(s,92,dy("SheetJS",t)),je(s,66,en(d?1200:1252)),d&&je(s,353,en(0)),d&&je(s,448),je(s,317,Oy(e.SheetNames.length)),d&&e.vbaraw&&je(s,211),d&&e.vbaraw){var p=u.CodeName||"ThisWorkbook";je(s,442,cx(p))}je(s,156,en(17)),je(s,25,kr(!1)),je(s,18,kr(!1)),je(s,19,en(0)),d&&je(s,431,kr(!1)),d&&je(s,444,en(0)),je(s,61,xy()),je(s,64,kr(!1)),je(s,141,en(0)),je(s,34,kr(ME(e)=="true")),je(s,14,kr(!0)),d&&je(s,439,kr(!1)),je(s,218,en(0)),TS(s,e,t),NS(s,e.SSF,t),CS(s,t),d&&je(s,352,kr(!1));var m=s.end(),w=Rr();d&&je(w,140,Fy()),d&&t.Strings&&gS(w,252,py(t.Strings)),je(w,10);var y=w.end(),E=Rr(),N=0,g=0;for(g=0;g<e.SheetNames.length;++g)N+=(d?12:11)+(d?2:1)*e.SheetNames[g].length;var _=m.length+N+y.length;for(g=0;g<e.SheetNames.length;++g){var b=o[g]||{};je(E,133,hy({pos:_,hs:b.Hidden||0,dt:0,name:e.SheetNames[g]},t)),_+=r[g].length}var I=E.end();if(N!=I.length)throw new Error("BS8 "+N+" != "+I.length);var O=[];return m.length&&O.push(m),I.length&&O.push(I),y.length&&O.push(y),fr(O)}function OS(e,r){var t=r||{},s=[];e&&!e.SSF&&(e.SSF=Ir(Bt)),e&&e.SSF&&(To(),So(e.SSF),t.revssf=No(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,f0(t),t.cellXfs=[],_a(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)s[s.length]=jS(i,t,e);return s.unshift(PS(e,s,t)),fr(s)}function Ix(e,r){for(var t=0;t<=e.SheetNames.length;++t){var s=e.Sheets[e.SheetNames[t]];if(!(!s||!s["!ref"])){var i=Vr(s["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var o=r||{};switch(o.biff||2){case 8:case 5:return OS(e,r);case 4:case 3:case 2:return SS(e,r)}throw new Error("invalid type "+o.bookType+" for BIFF")}function RS(e,r,t,s){for(var i=e["!merges"]||[],o=[],u=r.s.c;u<=r.e.c;++u){for(var d=0,x=0,p=0;p<i.length;++p)if(!(i[p].s.r>t||i[p].s.c>u)&&!(i[p].e.r<t||i[p].e.c<u)){if(i[p].s.r<t||i[p].s.c<u){d=-1;break}d=i[p].e.r-i[p].s.r+1,x=i[p].e.c-i[p].s.c+1;break}if(!(d<0)){var m=Tt({r:t,c:u}),w=s.dense?(e[t]||[])[u]:e[m],y=w&&w.v!=null&&(w.h||f2(w.w||(Gn(w),w.w)||""))||"",E={};d>1&&(E.rowspan=d),x>1&&(E.colspan=x),s.editable?y='<span contenteditable="true">'+y+"</span>":w&&(E["data-t"]=w&&w.t||"z",w.v!=null&&(E["data-v"]=w.v),w.z!=null&&(E["data-z"]=w.z),w.l&&(w.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+w.l.Target+'">'+y+"</a>")),E.id=(s.id||"sjs")+"-"+m,o.push(Fe("td",y,E))}}var N="<tr>";return N+o.join("")+"</tr>"}var DS='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',IS="</body></html>";function MS(e,r,t){var s=[];return s.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function Mx(e,r){var t=r||{},s=t.header!=null?t.header:DS,i=t.footer!=null?t.footer:IS,o=[s],u=Vr(e["!ref"]);t.dense=Array.isArray(e),o.push(MS(e,u,t));for(var d=u.s.r;d<=u.e.r;++d)o.push(RS(e,u,d,t));return o.push("</table>"+i),o.join("")}function Lx(e,r,t){var s=t||{},i=0,o=0;if(s.origin!=null)if(typeof s.origin=="number")i=s.origin;else{var u=typeof s.origin=="string"?ar(s.origin):s.origin;i=u.r,o=u.c}var d=r.getElementsByTagName("tr"),x=Math.min(s.sheetRows||1e7,d.length),p={s:{r:0,c:0},e:{r:i,c:o}};if(e["!ref"]){var m=Vr(e["!ref"]);p.s.r=Math.min(p.s.r,m.s.r),p.s.c=Math.min(p.s.c,m.s.c),p.e.r=Math.max(p.e.r,m.e.r),p.e.c=Math.max(p.e.c,m.e.c),i==-1&&(p.e.r=i=m.e.r+1)}var w=[],y=0,E=e["!rows"]||(e["!rows"]=[]),N=0,g=0,_=0,b=0,I=0,O=0;for(e["!cols"]||(e["!cols"]=[]);N<d.length&&g<x;++N){var J=d[N];if($h(J)){if(s.display)continue;E[g]={hidden:!0}}var he=J.children;for(_=b=0;_<he.length;++_){var de=he[_];if(!(s.display&&$h(de))){var z=de.hasAttribute("data-v")?de.getAttribute("data-v"):de.hasAttribute("v")?de.getAttribute("v"):x2(de.innerHTML),re=de.getAttribute("data-z")||de.getAttribute("z");for(y=0;y<w.length;++y){var V=w[y];V.s.c==b+o&&V.s.r<g+i&&g+i<=V.e.r&&(b=V.e.c+1-o,y=-1)}O=+de.getAttribute("colspan")||1,((I=+de.getAttribute("rowspan")||1)>1||O>1)&&w.push({s:{r:g+i,c:b+o},e:{r:g+i+(I||1)-1,c:b+o+(O||1)-1}});var M={t:"s",v:z},L=de.getAttribute("data-t")||de.getAttribute("t")||"";z!=null&&(z.length==0?M.t=L||"z":s.raw||z.trim().length==0||L=="s"||(z==="TRUE"?M={t:"b",v:!0}:z==="FALSE"?M={t:"b",v:!1}:isNaN($n(z))?isNaN(ji(z).getDate())||(M={t:"d",v:Cr(z)},s.cellDates||(M={t:"n",v:Dr(M.v)}),M.z=s.dateNF||Bt[14]):M={t:"n",v:$n(z)})),M.z===void 0&&re!=null&&(M.z=re);var X="",K=de.getElementsByTagName("A");if(K&&K.length)for(var ne=0;ne<K.length&&!(K[ne].hasAttribute("href")&&(X=K[ne].getAttribute("href"),X.charAt(0)!="#"));++ne);X&&X.charAt(0)!="#"&&(M.l={Target:X}),s.dense?(e[g+i]||(e[g+i]=[]),e[g+i][b+o]=M):e[Tt({c:b+o,r:g+i})]=M,p.e.c<b+o&&(p.e.c=b+o),b+=O}}++g}return w.length&&(e["!merges"]=(e["!merges"]||[]).concat(w)),p.e.r=Math.max(p.e.r,g-1+i),e["!ref"]=Xt(p),g>=x&&(e["!fullref"]=Xt((p.e.r=d.length-N+g-1+i,p))),e}function Bx(e,r){var t=r||{},s=t.dense?[]:{};return Lx(s,e,r)}function LS(e,r){return Ga(Bx(e,r),r)}function $h(e){var r="",t=BS(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function BS(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var US=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+Oi({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Kt+r}})(),Hh=(function(){var e=function(o){return St(o).replace(/  +/g,function(u){return'<text:s text:c="'+u.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,s=function(o,u,d){var x=[];x.push('      <table:table table:name="'+St(u.SheetNames[d])+`" table:style-name="ta1">
`);var p=0,m=0,w=Vr(o["!ref"]||"A1"),y=o["!merges"]||[],E=0,N=Array.isArray(o);if(o["!cols"])for(m=0;m<=w.e.c;++m)x.push("        <table:table-column"+(o["!cols"][m]?' table:style-name="co'+o["!cols"][m].ods+'"':"")+`></table:table-column>
`);var g="",_=o["!rows"]||[];for(p=0;p<w.s.r;++p)g=_[p]?' table:style-name="ro'+_[p].ods+'"':"",x.push("        <table:table-row"+g+`></table:table-row>
`);for(;p<=w.e.r;++p){for(g=_[p]?' table:style-name="ro'+_[p].ods+'"':"",x.push("        <table:table-row"+g+`>
`),m=0;m<w.s.c;++m)x.push(r);for(;m<=w.e.c;++m){var b=!1,I={},O="";for(E=0;E!=y.length;++E)if(!(y[E].s.c>m)&&!(y[E].s.r>p)&&!(y[E].e.c<m)&&!(y[E].e.r<p)){(y[E].s.c!=m||y[E].s.r!=p)&&(b=!0),I["table:number-columns-spanned"]=y[E].e.c-y[E].s.c+1,I["table:number-rows-spanned"]=y[E].e.r-y[E].s.r+1;break}if(b){x.push(t);continue}var J=Tt({r:p,c:m}),he=N?(o[p]||[])[m]:o[J];if(he&&he.f&&(I["table:formula"]=St(i4(he.f)),he.F&&he.F.slice(0,J.length)==J)){var de=Vr(he.F);I["table:number-matrix-columns-spanned"]=de.e.c-de.s.c+1,I["table:number-matrix-rows-spanned"]=de.e.r-de.s.r+1}if(!he){x.push(r);continue}switch(he.t){case"b":O=he.v?"TRUE":"FALSE",I["office:value-type"]="boolean",I["office:boolean-value"]=he.v?"true":"false";break;case"n":O=he.w||String(he.v||0),I["office:value-type"]="float",I["office:value"]=he.v||0;break;case"s":case"str":O=he.v==null?"":he.v,I["office:value-type"]="string";break;case"d":O=he.w||Cr(he.v).toISOString(),I["office:value-type"]="date",I["office:date-value"]=Cr(he.v).toISOString(),I["table:style-name"]="ce1";break;default:x.push(r);continue}var z=e(O);if(he.l&&he.l.Target){var re=he.l.Target;re=re.charAt(0)=="#"?"#"+l4(re.slice(1)):re,re.charAt(0)!="#"&&!re.match(/^\w+:/)&&(re="../"+re),z=Fe("text:a",z,{"xlink:href":re.replace(/&/g,"&amp;")})}x.push("          "+Fe("table:table-cell",Fe("text:p",z,{}),I)+`
`)}x.push(`        </table:table-row>
`)}return x.push(`      </table:table>
`),x.join("")},i=function(o,u){o.push(` <office:automatic-styles>
`),o.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),o.push(`   <number:month number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:day number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:year/>
`),o.push(`  </number:date-style>
`);var d=0;u.SheetNames.map(function(p){return u.Sheets[p]}).forEach(function(p){if(p&&p["!cols"]){for(var m=0;m<p["!cols"].length;++m)if(p["!cols"][m]){var w=p["!cols"][m];if(w.width==null&&w.wpx==null&&w.wch==null)continue;i0(w),w.ods=d;var y=p["!cols"][m].wpx+"px";o.push('  <style:style style:name="co'+d+`" style:family="table-column">
`),o.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+y+`"/>
`),o.push(`  </style:style>
`),++d}}});var x=0;u.SheetNames.map(function(p){return u.Sheets[p]}).forEach(function(p){if(p&&p["!rows"]){for(var m=0;m<p["!rows"].length;++m)if(p["!rows"][m]){p["!rows"][m].ods=x;var w=p["!rows"][m].hpx+"px";o.push('  <style:style style:name="ro'+x+`" style:family="table-row">
`),o.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+w+`"/>
`),o.push(`  </style:style>
`),++x}}}),o.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),o.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),o.push(`  </style:style>
`),o.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),o.push(` </office:automatic-styles>
`)};return function(u,d){var x=[Kt],p=Oi({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=Oi({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});d.bookType=="fods"?(x.push("<office:document"+p+m+`>
`),x.push(ex().replace(/office:document-meta/g,"office:meta"))):x.push("<office:document-content"+p+`>
`),i(x,u),x.push(`  <office:body>
`),x.push(`    <office:spreadsheet>
`);for(var w=0;w!=u.SheetNames.length;++w)x.push(s(u.Sheets[u.SheetNames[w]],u,w));return x.push(`    </office:spreadsheet>
`),x.push(`  </office:body>
`),d.bookType=="fods"?x.push("</office:document>"):x.push("</office:document-content>"),x.join("")}})();function Ux(e,r){if(r.bookType=="fods")return Hh(e,r);var t=Yu(),s="",i=[],o=[];return s="mimetype",st(t,s,"application/vnd.oasis.opendocument.spreadsheet"),s="content.xml",st(t,s,Hh(e,r)),i.push([s,"text/xml"]),o.push([s,"ContentFile"]),s="styles.xml",st(t,s,US(e,r)),i.push([s,"text/xml"]),o.push([s,"StylesFile"]),s="meta.xml",st(t,s,Kt+ex()),i.push([s,"text/xml"]),o.push([s,"MetadataFile"]),s="manifest.rdf",st(t,s,J2(o)),i.push([s,"application/rdf+xml"]),s="META-INF/manifest.xml",st(t,s,q2(i)),t}function go(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function zS(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):xn(Pi(e))}function WS(e,r){e:for(var t=0;t<=e.length-r.length;++t){for(var s=0;s<r.length;++s)if(e[t+s]!=r[s])continue e;return!0}return!1}function wa(e){var r=e.reduce(function(i,o){return i+o.length},0),t=new Uint8Array(r),s=0;return e.forEach(function(i){t.set(i,s),s+=i.length}),t}function $S(e,r,t){var s=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,i=t/Math.pow(10,s-6176);e[r+15]|=s>>7,e[r+14]|=(s&127)<<1;for(var o=0;i>=1;++o,i/=256)e[r+o]=i&255;e[r+15]|=t>=0?0:128}function Ri(e,r){var t=r?r[0]:0,s=e[t]&127;e:if(e[t++]>=128&&(s|=(e[t]&127)<<7,e[t++]<128||(s|=(e[t]&127)<<14,e[t++]<128)||(s|=(e[t]&127)<<21,e[t++]<128)||(s+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(s+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(s+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),s}function _t(e){var r=new Uint8Array(7);r[0]=e&127;var t=1;e:if(e>127){if(r[t-1]|=128,r[t]=e>>7&127,++t,e<=16383||(r[t-1]|=128,r[t]=e>>14&127,++t,e<=2097151)||(r[t-1]|=128,r[t]=e>>21&127,++t,e<=268435455)||(r[t-1]|=128,r[t]=e/256>>>21&127,++t,e<=34359738367)||(r[t-1]|=128,r[t]=e/65536>>>21&127,++t,e<=4398046511103))break e;r[t-1]|=128,r[t]=e/16777216>>>21&127,++t}return r.slice(0,t)}function js(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function Qt(e){for(var r=[],t=[0];t[0]<e.length;){var s=t[0],i=Ri(e,t),o=i&7;i=Math.floor(i/8);var u=0,d;if(i==0)break;switch(o){case 0:{for(var x=t[0];e[t[0]++]>=128;);d=e.slice(x,t[0])}break;case 5:u=4,d=e.slice(t[0],t[0]+u),t[0]+=u;break;case 1:u=8,d=e.slice(t[0],t[0]+u),t[0]+=u;break;case 2:u=Ri(e,t),d=e.slice(t[0],t[0]+u),t[0]+=u;break;default:throw new Error("PB Type ".concat(o," for Field ").concat(i," at offset ").concat(s))}var p={data:d,type:o};r[i]==null?r[i]=[p]:r[i].push(p)}return r}function cr(e){var r=[];return e.forEach(function(t,s){t.forEach(function(i){i.data&&(r.push(_t(s*8+i.type)),i.type==2&&r.push(_t(i.data.length)),r.push(i.data))})}),wa(r)}function dn(e){for(var r,t=[],s=[0];s[0]<e.length;){var i=Ri(e,s),o=Qt(e.slice(s[0],s[0]+i));s[0]+=i;var u={id:js(o[1][0].data),messages:[]};o[2].forEach(function(d){var x=Qt(d.data),p=js(x[3][0].data);u.messages.push({meta:x,data:e.slice(s[0],s[0]+p)}),s[0]+=p}),(r=o[3])!=null&&r[0]&&(u.merge=js(o[3][0].data)>>>0>0),t.push(u)}return t}function Es(e){var r=[];return e.forEach(function(t){var s=[];s[1]=[{data:_t(t.id),type:0}],s[2]=[],t.merge!=null&&(s[3]=[{data:_t(+!!t.merge),type:0}]);var i=[];t.messages.forEach(function(u){i.push(u.data),u.meta[3]=[{type:0,data:_t(u.data.length)}],s[2].push({data:cr(u.meta),type:2})});var o=cr(s);r.push(_t(o.length)),r.push(o),i.forEach(function(u){return r.push(u)})}),wa(r)}function HS(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],s=Ri(r,t),i=[];t[0]<r.length;){var o=r[t[0]]&3;if(o==0){var u=r[t[0]++]>>2;if(u<60)++u;else{var d=u-59;u=r[t[0]],d>1&&(u|=r[t[0]+1]<<8),d>2&&(u|=r[t[0]+2]<<16),d>3&&(u|=r[t[0]+3]<<24),u>>>=0,u++,t[0]+=d}i.push(r.slice(t[0],t[0]+u)),t[0]+=u;continue}else{var x=0,p=0;if(o==1?(p=(r[t[0]]>>2&7)+4,x=(r[t[0]++]&224)<<3,x|=r[t[0]++]):(p=(r[t[0]++]>>2)+1,o==2?(x=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(x=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),i=[wa(i)],x==0)throw new Error("Invalid offset 0");if(x>i[0].length)throw new Error("Invalid offset beyond length");if(p>=x)for(i.push(i[0].slice(-x)),p-=x;p>=i[i.length-1].length;)i.push(i[i.length-1]),p-=i[i.length-1].length;i.push(i[0].slice(-x,-x+p))}}var m=wa(i);if(m.length!=s)throw new Error("Unexpected length: ".concat(m.length," != ").concat(s));return m}function hn(e){for(var r=[],t=0;t<e.length;){var s=e[t++],i=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(HS(s,e.slice(t,t+i))),t+=i}if(t!==e.length)throw new Error("data is not a valid framed stream!");return wa(r)}function Ss(e){for(var r=[],t=0;t<e.length;){var s=Math.min(e.length-t,268435455),i=new Uint8Array(4);r.push(i);var o=_t(s),u=o.length;r.push(o),s<=60?(u++,r.push(new Uint8Array([s-1<<2]))):s<=256?(u+=2,r.push(new Uint8Array([240,s-1&255]))):s<=65536?(u+=3,r.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(u+=4,r.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(u+=5,r.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),r.push(e.slice(t,t+s)),u+=s,i[0]=0,i[1]=u&255,i[2]=u>>8&255,i[3]=u>>16&255,t+=s}return wa(r)}function Tu(e,r){var t=new Uint8Array(32),s=go(t),i=12,o=0;switch(t[0]=5,e.t){case"n":t[1]=2,$S(t,i,e.v),o|=1,i+=16;break;case"b":t[1]=6,s.setFloat64(i,e.v?1:0,!0),o|=2,i+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[1]=3,s.setUint32(i,r.indexOf(e.v),!0),o|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(8,o,!0),t.slice(0,i)}function Nu(e,r){var t=new Uint8Array(32),s=go(t),i=12,o=0;switch(t[0]=3,e.t){case"n":t[2]=2,s.setFloat64(i,e.v,!0),o|=32,i+=8;break;case"b":t[2]=6,s.setFloat64(i,e.v?1:0,!0),o|=32,i+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[2]=3,s.setUint32(i,r.indexOf(e.v),!0),o|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(4,o,!0),t.slice(0,i)}function xa(e){var r=Qt(e);return Ri(r[1][0].data)}function VS(e,r,t){var s,i,o,u;if(!((s=e[6])!=null&&s[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var d=((u=(o=e[8])==null?void 0:o[0])==null?void 0:u.data)&&js(e[8][0].data)>0||!1;if(d)throw"Math only works with normal offsets";for(var x=0,p=go(e[7][0].data),m=0,w=[],y=go(e[4][0].data),E=0,N=[],g=0;g<r.length;++g){if(r[g]==null){p.setUint16(g*2,65535,!0),y.setUint16(g*2,65535);continue}p.setUint16(g*2,m,!0),y.setUint16(g*2,E,!0);var _,b;switch(typeof r[g]){case"string":_=Tu({t:"s",v:r[g]},t),b=Nu({t:"s",v:r[g]},t);break;case"number":_=Tu({t:"n",v:r[g]},t),b=Nu({t:"n",v:r[g]},t);break;case"boolean":_=Tu({t:"b",v:r[g]},t),b=Nu({t:"b",v:r[g]},t);break;default:throw new Error("Unsupported value "+r[g])}w.push(_),m+=_.length,N.push(b),E+=b.length,++x}for(e[2][0].data=_t(x);g<e[7][0].data.length/2;++g)p.setUint16(g*2,65535,!0),y.setUint16(g*2,65535,!0);return e[6][0].data=wa(w),e[3][0].data=wa(N),x}function GS(e,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=Vr(t["!ref"]);s.s.r=s.s.c=0;var i=!1;s.e.c>9&&(i=!0,s.e.c=9),s.e.r>49&&(i=!0,s.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Xt(s)));var o=yo(t,{range:s,header:1}),u=["~Sh33tJ5~"];o.forEach(function(q){return q.forEach(function(B){typeof B=="string"&&u.push(B)})});var d={},x=[],p=Nt.read(r.numbers,{type:"base64"});p.FileIndex.map(function(q,B){return[q,p.FullPaths[B]]}).forEach(function(q){var B=q[0],U=q[1];if(B.type==2&&B.name.match(/\.iwa/)){var oe=B.content,Ee=hn(oe),Te=dn(Ee);Te.forEach(function(ee){x.push(ee.id),d[ee.id]={deps:[],location:U,type:js(ee.messages[0].meta[1][0].data)}})}}),x.sort(function(q,B){return q-B});var m=x.filter(function(q){return q>1}).map(function(q){return[q,_t(q)]});p.FileIndex.map(function(q,B){return[q,p.FullPaths[B]]}).forEach(function(q){var B=q[0];if(q[1],!!B.name.match(/\.iwa/)){var U=dn(hn(B.content));U.forEach(function(oe){oe.messages.forEach(function(Ee){m.forEach(function(Te){oe.messages.some(function(ee){return js(ee.meta[1][0].data)!=11006&&WS(ee.data,Te[1])})&&d[Te[0]].deps.push(oe.id)})})})}});for(var w=Nt.find(p,d[1].location),y=dn(hn(w.content)),E,N=0;N<y.length;++N){var g=y[N];g.id==1&&(E=g)}var _=xa(Qt(E.messages[0].data)[1][0].data);for(w=Nt.find(p,d[_].location),y=dn(hn(w.content)),N=0;N<y.length;++N)g=y[N],g.id==_&&(E=g);for(_=xa(Qt(E.messages[0].data)[2][0].data),w=Nt.find(p,d[_].location),y=dn(hn(w.content)),N=0;N<y.length;++N)g=y[N],g.id==_&&(E=g);for(_=xa(Qt(E.messages[0].data)[2][0].data),w=Nt.find(p,d[_].location),y=dn(hn(w.content)),N=0;N<y.length;++N)g=y[N],g.id==_&&(E=g);var b=Qt(E.messages[0].data);{b[6][0].data=_t(s.e.r+1),b[7][0].data=_t(s.e.c+1);var I=xa(b[46][0].data),O=Nt.find(p,d[I].location),J=dn(hn(O.content));{for(var he=0;he<J.length&&J[he].id!=I;++he);if(J[he].id!=I)throw"Bad ColumnRowUIDMapArchive";var de=Qt(J[he].messages[0].data);de[1]=[],de[2]=[],de[3]=[];for(var z=0;z<=s.e.c;++z){var re=[];re[1]=re[2]=[{type:0,data:_t(z+420690)}],de[1].push({type:2,data:cr(re)}),de[2].push({type:0,data:_t(z)}),de[3].push({type:0,data:_t(z)})}de[4]=[],de[5]=[],de[6]=[];for(var V=0;V<=s.e.r;++V)re=[],re[1]=re[2]=[{type:0,data:_t(V+726270)}],de[4].push({type:2,data:cr(re)}),de[5].push({type:0,data:_t(V)}),de[6].push({type:0,data:_t(V)});J[he].messages[0].data=cr(de)}O.content=Ss(Es(J)),O.size=O.content.length,delete b[46];var M=Qt(b[4][0].data);{M[7][0].data=_t(s.e.r+1);var L=Qt(M[1][0].data),X=xa(L[2][0].data);O=Nt.find(p,d[X].location),J=dn(hn(O.content));{if(J[0].id!=X)throw"Bad HeaderStorageBucket";var K=Qt(J[0].messages[0].data);for(V=0;V<o.length;++V){var ne=Qt(K[2][0].data);ne[1][0].data=_t(V),ne[4][0].data=_t(o[V].length),K[2][V]={type:K[2][0].type,data:cr(ne)}}J[0].messages[0].data=cr(K)}O.content=Ss(Es(J)),O.size=O.content.length;var W=xa(M[2][0].data);O=Nt.find(p,d[W].location),J=dn(hn(O.content));{if(J[0].id!=W)throw"Bad HeaderStorageBucket";for(K=Qt(J[0].messages[0].data),z=0;z<=s.e.c;++z)ne=Qt(K[2][0].data),ne[1][0].data=_t(z),ne[4][0].data=_t(s.e.r+1),K[2][z]={type:K[2][0].type,data:cr(ne)};J[0].messages[0].data=cr(K)}O.content=Ss(Es(J)),O.size=O.content.length;var Z=xa(M[4][0].data);(function(){for(var q=Nt.find(p,d[Z].location),B=dn(hn(q.content)),U,oe=0;oe<B.length;++oe){var Ee=B[oe];Ee.id==Z&&(U=Ee)}var Te=Qt(U.messages[0].data);{Te[3]=[];var ee=[];u.forEach(function(De,et){ee[1]=[{type:0,data:_t(et)}],ee[2]=[{type:0,data:_t(1)}],ee[3]=[{type:2,data:zS(De)}],Te[3].push({type:2,data:cr(ee)})})}U.messages[0].data=cr(Te);var te=Es(B),Se=Ss(te);q.content=Se,q.size=q.content.length})();var me=Qt(M[3][0].data);{var R=me[1][0];delete me[2];var ve=Qt(R.data);{var ye=xa(ve[2][0].data);(function(){for(var q=Nt.find(p,d[ye].location),B=dn(hn(q.content)),U,oe=0;oe<B.length;++oe){var Ee=B[oe];Ee.id==ye&&(U=Ee)}var Te=Qt(U.messages[0].data);{delete Te[6],delete me[7];var ee=new Uint8Array(Te[5][0].data);Te[5]=[];for(var te=0,Se=0;Se<=s.e.r;++Se){var De=Qt(ee);te+=VS(De,o[Se],u),De[1][0].data=_t(Se),Te[5].push({data:cr(De),type:2})}Te[1]=[{type:0,data:_t(s.e.c+1)}],Te[2]=[{type:0,data:_t(s.e.r+1)}],Te[3]=[{type:0,data:_t(te)}],Te[4]=[{type:0,data:_t(s.e.r+1)}]}U.messages[0].data=cr(Te);var et=Es(B),We=Ss(et);q.content=We,q.size=q.content.length})()}R.data=cr(ve)}M[3][0].data=cr(me)}b[4][0].data=cr(M)}E.messages[0].data=cr(b);var Y=Es(y),k=Ss(Y);return w.content=k,w.size=w.content.length,p}function XS(e){return function(t){for(var s=0;s!=e.length;++s){var i=e[s];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function f0(e){XS([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function KS(e,r){return r.bookType=="ods"?Ux(e,r):r.bookType=="numbers"?GS(e,r):r.bookType=="xlsb"?YS(e,r):qS(e,r)}function YS(e,r){ks=1024,e&&!e.SSF&&(e.SSF=Ir(Bt)),e&&e.SSF&&(To(),So(e.SSF),r.revssf=No(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Ai?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t=r.bookType=="xlsb"?"bin":"xml",s=Ex.indexOf(r.bookType)>-1,i=Qp();f0(r=r||{});var o=Yu(),u="",d=0;if(r.cellXfs=[],_a(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),u="docProps/core.xml",st(o,u,tx(e.Props,r)),i.coreprops.push(u),Et(r.rels,2,u,xt.CORE_PROPS),u="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var x=[],p=0;p<e.SheetNames.length;++p)(e.Workbook.Sheets[p]||{}).Hidden!=2&&x.push(e.SheetNames[p]);e.Props.SheetNames=x}for(e.Props.Worksheets=e.Props.SheetNames.length,st(o,u,nx(e.Props)),i.extprops.push(u),Et(r.rels,3,u,xt.EXT_PROPS),e.Custprops!==e.Props&&pr(e.Custprops||{}).length>0&&(u="docProps/custom.xml",st(o,u,ax(e.Custprops)),i.custprops.push(u),Et(r.rels,4,u,xt.CUST_PROPS)),d=1;d<=e.SheetNames.length;++d){var m={"!id":{}},w=e.Sheets[e.SheetNames[d-1]],y=(w||{})["!type"]||"sheet";if(u="xl/worksheets/sheet"+d+"."+t,st(o,u,JE(d-1,u,r,e,m)),i.sheets.push(u),Et(r.wbrels,-1,"worksheets/sheet"+d+"."+t,xt.WS[0]),w){var E=w["!comments"],N=!1,g="";E&&E.length>0&&(g="xl/comments"+d+"."+t,st(o,g,tS(E,g)),i.comments.push(g),Et(m,-1,"../comments"+d+"."+t,xt.CMNT),N=!0),w["!legacy"]&&N&&st(o,"xl/drawings/vmlDrawing"+d+".vml",wx(d,w["!comments"])),delete w["!comments"],delete w["!legacy"]}m["!id"].rId1&&st(o,Zp(u),bs(m))}return r.Strings!=null&&r.Strings.length>0&&(u="xl/sharedStrings."+t,st(o,u,eS(r.Strings,u,r)),i.strs.push(u),Et(r.wbrels,-1,"sharedStrings."+t,xt.SST)),u="xl/workbook."+t,st(o,u,QE(e,u)),i.workbooks.push(u),Et(r.rels,1,u,xt.WB),u="xl/theme/theme1.xml",st(o,u,gx(e.Themes,r)),i.themes.push(u),Et(r.wbrels,-1,"theme/theme1.xml",xt.THEME),u="xl/styles."+t,st(o,u,ZE(e,u,r)),i.styles.push(u),Et(r.wbrels,-1,"styles."+t,xt.STY),e.vbaraw&&s&&(u="xl/vbaProject.bin",st(o,u,e.vbaraw),i.vba.push(u),Et(r.wbrels,-1,"vbaProject.bin",xt.VBA)),u="xl/metadata."+t,st(o,u,rS(u)),i.metadata.push(u),Et(r.wbrels,-1,"metadata."+t,xt.XLMETA),st(o,"[Content_Types].xml",Jp(i,r)),st(o,"_rels/.rels",bs(r.rels)),st(o,"xl/_rels/workbook."+t+".rels",bs(r.wbrels)),delete r.revssf,delete r.ssf,o}function qS(e,r){ks=1024,e&&!e.SSF&&(e.SSF=Ir(Bt)),e&&e.SSF&&(To(),So(e.SSF),r.revssf=No(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Ai?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t="xml",s=Ex.indexOf(r.bookType)>-1,i=Qp();f0(r=r||{});var o=Yu(),u="",d=0;if(r.cellXfs=[],_a(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),u="docProps/core.xml",st(o,u,tx(e.Props,r)),i.coreprops.push(u),Et(r.rels,2,u,xt.CORE_PROPS),u="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var x=[],p=0;p<e.SheetNames.length;++p)(e.Workbook.Sheets[p]||{}).Hidden!=2&&x.push(e.SheetNames[p]);e.Props.SheetNames=x}e.Props.Worksheets=e.Props.SheetNames.length,st(o,u,nx(e.Props)),i.extprops.push(u),Et(r.rels,3,u,xt.EXT_PROPS),e.Custprops!==e.Props&&pr(e.Custprops||{}).length>0&&(u="docProps/custom.xml",st(o,u,ax(e.Custprops)),i.custprops.push(u),Et(r.rels,4,u,xt.CUST_PROPS));var m=["SheetJ5"];for(r.tcid=0,d=1;d<=e.SheetNames.length;++d){var w={"!id":{}},y=e.Sheets[e.SheetNames[d-1]],E=(y||{})["!type"]||"sheet";if(u="xl/worksheets/sheet"+d+"."+t,st(o,u,jx(d-1,r,e,w)),i.sheets.push(u),Et(r.wbrels,-1,"worksheets/sheet"+d+"."+t,xt.WS[0]),y){var N=y["!comments"],g=!1,_="";if(N&&N.length>0){var b=!1;N.forEach(function(I){I[1].forEach(function(O){O.T==!0&&(b=!0)})}),b&&(_="xl/threadedComments/threadedComment"+d+"."+t,st(o,_,Cw(N,m,r)),i.threadedcomments.push(_),Et(w,-1,"../threadedComments/threadedComment"+d+"."+t,xt.TCMNT)),_="xl/comments"+d+"."+t,st(o,_,_x(N)),i.comments.push(_),Et(w,-1,"../comments"+d+"."+t,xt.CMNT),g=!0}y["!legacy"]&&g&&st(o,"xl/drawings/vmlDrawing"+d+".vml",wx(d,y["!comments"])),delete y["!comments"],delete y["!legacy"]}w["!id"].rId1&&st(o,Zp(u),bs(w))}return r.Strings!=null&&r.Strings.length>0&&(u="xl/sharedStrings."+t,st(o,u,dx(r.Strings,r)),i.strs.push(u),Et(r.wbrels,-1,"sharedStrings."+t,xt.SST)),u="xl/workbook."+t,st(o,u,Rx(e)),i.workbooks.push(u),Et(r.rels,1,u,xt.WB),u="xl/theme/theme1.xml",st(o,u,gx(e.Themes,r)),i.themes.push(u),Et(r.wbrels,-1,"theme/theme1.xml",xt.THEME),u="xl/styles."+t,st(o,u,mx(e,r)),i.styles.push(u),Et(r.wbrels,-1,"styles."+t,xt.STY),e.vbaraw&&s&&(u="xl/vbaProject.bin",st(o,u,e.vbaraw),i.vba.push(u),Et(r.wbrels,-1,"vbaProject.bin",xt.VBA)),u="xl/metadata."+t,st(o,u,yx()),i.metadata.push(u),Et(r.wbrels,-1,"metadata."+t,xt.XLMETA),m.length>1&&(u="xl/persons/person.xml",st(o,u,Aw(m)),i.people.push(u),Et(r.wbrels,-1,"persons/person.xml",xt.PEOPLE)),st(o,"[Content_Types].xml",Jp(i,r)),st(o,"_rels/.rels",bs(r.rels)),st(o,"xl/_rels/workbook."+t+".rels",bs(r.wbrels)),delete r.revssf,delete r.ssf,o}function QS(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Vn(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function zx(e,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return Li(r.file,Nt.write(e,{type:vt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return Nt.write(e,r)}function JS(e,r){var t=Ir(r||{}),s=KS(e,t);return ZS(s,t)}function ZS(e,r){var t={},s=vt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(r.compression&&(t.compression="DEFLATE"),r.password)t.type=s;else switch(r.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":t.type=s;break;default:throw new Error("Unrecognized type "+r.type)}var i=e.FullPaths?Nt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!r.compression}):e.generate(t);if(typeof Deno<"u"&&typeof i=="string"){if(r.type=="binary"||r.type=="base64")return i;i=new Uint8Array(Eo(i))}return r.password&&typeof encrypt_agile<"u"?zx(encrypt_agile(i,r.password),r):r.type==="file"?Li(r.file,i):r.type=="string"?Ti(i):i}function eT(e,r){var t=r||{},s=mS(e,t);return zx(s,t)}function Cn(e,r,t){t||(t="");var s=t+e;switch(r.type){case"base64":return Fi(Pi(s));case"binary":return Pi(s);case"string":return e;case"file":return Li(r.file,s,"utf8");case"buffer":return vt?Xn(s,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(s):Cn(s,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function tT(e,r){switch(r.type){case"base64":return Fi(e);case"binary":return e;case"string":return e;case"file":return Li(r.file,e,"binary");case"buffer":return vt?Xn(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function to(e,r){switch(r.type){case"string":case"base64":case"binary":for(var t="",s=0;s<e.length;++s)t+=String.fromCharCode(e[s]);return r.type=="base64"?Fi(t):r.type=="string"?Ti(t):t;case"file":return Li(r.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+r.type)}}function Wx(e,r){bg(),UE(e);var t=Ir(r||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var s=Wx(e,t);return t.type="array",Eo(s)}var i=0;if(t.sheet&&(typeof t.sheet=="number"?i=t.sheet:i=e.SheetNames.indexOf(t.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Cn(pS(e,t),t);case"slk":case"sylk":return Cn(My.from_sheet(e.Sheets[e.SheetNames[i]],t),t);case"htm":case"html":return Cn(Mx(e.Sheets[e.SheetNames[i]],t),t);case"txt":return tT($x(e.Sheets[e.SheetNames[i]],t),t);case"csv":return Cn(d0(e.Sheets[e.SheetNames[i]],t),t,"\uFEFF");case"dif":return Cn(Ly.from_sheet(e.Sheets[e.SheetNames[i]],t),t);case"dbf":return to(Iy.from_sheet(e.Sheets[e.SheetNames[i]],t),t);case"prn":return Cn(By.from_sheet(e.Sheets[e.SheetNames[i]],t),t);case"rtf":return Cn(Gy.from_sheet(e.Sheets[e.SheetNames[i]],t),t);case"eth":return Cn(fx.from_sheet(e.Sheets[e.SheetNames[i]],t),t);case"fods":return Cn(Ux(e,t),t);case"wk1":return to(Mh.sheet_to_wk1(e.Sheets[e.SheetNames[i]],t),t);case"wk3":return to(Mh.book_to_wk3(e,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),to(Ix(e,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),eT(e,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return JS(e,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function rT(e){if(!e.bookType){var r={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType=r[e.bookType]||e.bookType}}function nT(e,r,t){var s={};return s.type="file",s.file=r,rT(s),Wx(e,s)}function aT(e,r,t,s,i,o,u,d){var x=hr(t),p=d.defval,m=d.raw||!Object.prototype.hasOwnProperty.call(d,"raw"),w=!0,y=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(y,"__rowNum__",{value:t,enumerable:!1})}catch{y.__rowNum__=t}else y.__rowNum__=t;if(!u||e[t])for(var E=r.s.c;E<=r.e.c;++E){var N=u?e[t][E]:e[s[E]+x];if(N===void 0||N.t===void 0){if(p===void 0)continue;o[E]!=null&&(y[o[E]]=p);continue}var g=N.v;switch(N.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+N.t)}if(o[E]!=null){if(g==null)if(N.t=="e"&&g===null)y[o[E]]=null;else if(p!==void 0)y[o[E]]=p;else if(m&&g===null)y[o[E]]=null;else continue;else y[o[E]]=m&&(N.t!=="n"||N.t==="n"&&d.rawNumbers!==!1)?g:Gn(N,g,d);g!=null&&(w=!1)}}return{row:y,isempty:w}}function yo(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},s=0,i=1,o=[],u=0,d="",x={s:{r:0,c:0},e:{r:0,c:0}},p=r||{},m=p.range!=null?p.range:e["!ref"];switch(p.header===1?s=1:p.header==="A"?s=2:Array.isArray(p.header)?s=3:p.header==null&&(s=0),typeof m){case"string":x=Pt(m);break;case"number":x=Pt(e["!ref"]),x.s.r=m;break;default:x=m}s>0&&(i=0);var w=hr(x.s.r),y=[],E=[],N=0,g=0,_=Array.isArray(e),b=x.s.r,I=0,O={};_&&!e[b]&&(e[b]=[]);var J=p.skipHidden&&e["!cols"]||[],he=p.skipHidden&&e["!rows"]||[];for(I=x.s.c;I<=x.e.c;++I)if(!(J[I]||{}).hidden)switch(y[I]=yr(I),t=_?e[b][I]:e[y[I]+w],s){case 1:o[I]=I-x.s.c;break;case 2:o[I]=y[I];break;case 3:o[I]=p.header[I-x.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),d=u=Gn(t,null,p),g=O[u]||0,!g)O[u]=1;else{do d=u+"_"+g++;while(O[d]);O[u]=g,O[d]=1}o[I]=d}for(b=x.s.r+i;b<=x.e.r;++b)if(!(he[b]||{}).hidden){var de=aT(e,x,b,y,s,o,_,p);(de.isempty===!1||(s===1?p.blankrows!==!1:p.blankrows))&&(E[N++]=de.row)}return E.length=N,E}var Vh=/"/g;function sT(e,r,t,s,i,o,u,d){for(var x=!0,p=[],m="",w=hr(t),y=r.s.c;y<=r.e.c;++y)if(s[y]){var E=d.dense?(e[t]||[])[y]:e[s[y]+w];if(E==null)m="";else if(E.v!=null){x=!1,m=""+(d.rawNumbers&&E.t=="n"?E.v:Gn(E,null,d));for(var N=0,g=0;N!==m.length;++N)if((g=m.charCodeAt(N))===i||g===o||g===34||d.forceQuotes){m='"'+m.replace(Vh,'""')+'"';break}m=="ID"&&(m='"ID"')}else E.f!=null&&!E.F?(x=!1,m="="+E.f,m.indexOf(",")>=0&&(m='"'+m.replace(Vh,'""')+'"')):m="";p.push(m)}return d.blankrows===!1&&x?null:p.join(u)}function d0(e,r){var t=[],s=r??{};if(e==null||e["!ref"]==null)return"";var i=Pt(e["!ref"]),o=s.FS!==void 0?s.FS:",",u=o.charCodeAt(0),d=s.RS!==void 0?s.RS:`
`,x=d.charCodeAt(0),p=new RegExp((o=="|"?"\\|":o)+"+$"),m="",w=[];s.dense=Array.isArray(e);for(var y=s.skipHidden&&e["!cols"]||[],E=s.skipHidden&&e["!rows"]||[],N=i.s.c;N<=i.e.c;++N)(y[N]||{}).hidden||(w[N]=yr(N));for(var g=0,_=i.s.r;_<=i.e.r;++_)(E[_]||{}).hidden||(m=sT(e,i,_,w,u,x,o,s),m!=null&&(s.strip&&(m=m.replace(p,"")),(m||s.blankrows!==!1)&&t.push((g++?d:"")+m)));return delete s.dense,t.join("")}function $x(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=d0(e,r);return t}function iT(e){var r="",t,s="";if(e==null||e["!ref"]==null)return[];var i=Pt(e["!ref"]),o="",u=[],d,x=[],p=Array.isArray(e);for(d=i.s.c;d<=i.e.c;++d)u[d]=yr(d);for(var m=i.s.r;m<=i.e.r;++m)for(o=hr(m),d=i.s.c;d<=i.e.c;++d)if(r=u[d]+o,t=p?(e[m]||[])[d]:e[r],s="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;s=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)s=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)s=""+t.v;else if(t.t=="b")s=t.v?"TRUE":"FALSE";else if(t.w!==void 0)s="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?s="'"+t.v:s=""+t.v}}x[x.length]=r+"="+s}return x}function Hx(e,r,t){var s=t||{},i=+!s.skipHeader,o=e||{},u=0,d=0;if(o&&s.origin!=null)if(typeof s.origin=="number")u=s.origin;else{var x=typeof s.origin=="string"?ar(s.origin):s.origin;u=x.r,d=x.c}var p,m={s:{c:0,r:0},e:{c:d,r:u+r.length-1+i}};if(o["!ref"]){var w=Pt(o["!ref"]);m.e.c=Math.max(m.e.c,w.e.c),m.e.r=Math.max(m.e.r,w.e.r),u==-1&&(u=w.e.r+1,m.e.r=u+r.length-1+i)}else u==-1&&(u=0,m.e.r=r.length-1+i);var y=s.header||[],E=0;r.forEach(function(g,_){pr(g).forEach(function(b){(E=y.indexOf(b))==-1&&(y[E=y.length]=b);var I=g[b],O="z",J="",he=Tt({c:d+E,r:u+_+i});p=Di(o,he),I&&typeof I=="object"&&!(I instanceof Date)?o[he]=I:(typeof I=="number"?O="n":typeof I=="boolean"?O="b":typeof I=="string"?O="s":I instanceof Date?(O="d",s.cellDates||(O="n",I=Dr(I)),J=s.dateNF||Bt[14]):I===null&&s.nullError&&(O="e",I=0),p?(p.t=O,p.v=I,delete p.w,delete p.R,J&&(p.z=J)):o[he]=p={t:O,v:I},J&&(p.z=J))})}),m.e.c=Math.max(m.e.c,d+y.length-1);var N=hr(u);if(i)for(E=0;E<y.length;++E)o[yr(E+d)+N]={t:"s",v:y[E]};return o["!ref"]=Xt(m),o}function lT(e,r){return Hx(null,e,r)}function Di(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var s=ar(r);return e[s.r]||(e[s.r]=[]),e[s.r][s.c]||(e[s.r][s.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?Di(e,Tt(r)):Di(e,Tt({r,c:t||0}))}function oT(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function cT(){return{SheetNames:[],Sheets:{}}}function uT(e,r,t,s){var i=1;if(!t)for(;i<=65535&&e.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&e.SheetNames.indexOf(t)>=0){var o=t.match(/(^.*?)(\d+)$/);i=o&&+o[2]||0;var u=o&&o[1]||t;for(++i;i<=65535&&e.SheetNames.indexOf(t=u+i)!=-1;++i);}if(Ox(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function fT(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var s=oT(e,r);switch(e.Workbook.Sheets[s]||(e.Workbook.Sheets[s]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[s].Hidden=t}function dT(e,r){return e.z=r,e}function Vx(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function hT(e,r,t){return Vx(e,"#"+r,t)}function pT(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function xT(e,r,t,s){for(var i=typeof r!="string"?r:Pt(r),o=typeof r=="string"?r:Xt(r),u=i.s.r;u<=i.e.r;++u)for(var d=i.s.c;d<=i.e.c;++d){var x=Di(e,u,d);x.t="n",x.F=o,delete x.v,u==i.s.r&&d==i.s.c&&(x.f=t,s&&(x.D=!0))}return e}var ku={encode_col:yr,encode_row:hr,encode_cell:Tt,encode_range:Xt,decode_col:t0,decode_row:e0,split_cell:b2,decode_cell:ar,decode_range:Vr,format_cell:Gn,sheet_add_aoa:Vp,sheet_add_json:Hx,sheet_add_dom:Lx,aoa_to_sheet:Rs,json_to_sheet:lT,table_to_sheet:Bx,table_to_book:LS,sheet_to_csv:d0,sheet_to_txt:$x,sheet_to_json:yo,sheet_to_html:Mx,sheet_to_formulae:iT,sheet_to_row_object_array:yo,sheet_get_cell:Di,book_new:cT,book_append_sheet:uT,book_set_sheet_visibility:fT,cell_set_number_format:dT,cell_set_hyperlink:Vx,cell_set_internal_link:hT,cell_add_comment:pT,sheet_set_array_formula:xT,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function mT({selectedCount:e,bulkMarginValue:r,setBulkMarginValue:t,closeBulkMarginModal:s,applyBulkMargin:i}){return c.jsx("div",{className:"fixed inset-0 z-20 flex items-center justify-center bg-[var(--color-bg-overlay)] px-4",children:c.jsxs("div",{className:"w-full max-w-sm rounded-md border border-[var(--color-border-default)] bg-[var(--color-bg-surface)] p-6 shadow-xl",children:[c.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Mise  jour de la marge"}),c.jsxs("p",{className:"text-sm text-[var(--color-text-secondary)] mb-4",children:["Appliquer une marge unique  ",e," ","produit",e===1?"":"s"," slectionn",e===1?"":"s","."]}),c.jsx("label",{htmlFor:"bulkMarginInput",className:"block text-sm mb-2",children:"Nouvelle marge"}),c.jsx("input",{id:"bulkMarginInput",type:"number",step:"0.01",value:r,onChange:o=>t(o.target.value),className:"w-full rounded border border-[var(--color-border-strong)] bg-[var(--color-bg-elevated)] px-3 py-2",autoFocus:!0}),c.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[c.jsx("button",{className:"btn btn-secondary",onClick:s,children:"Annuler"}),c.jsx("button",{className:"btn btn-primary",onClick:i,children:"Appliquer"})]})]})})}function vT({columns:e,visibleColumns:r,showColumnMenu:t,onToggleColumnMenu:s,onToggleColumn:i,onSave:o,onBulkDelete:u,selectedCount:d,isBulkDeleting:x,hasEdits:p}){return c.jsx("div",{className:"card p-4 mb-6 overflow-visible relative z-20",children:c.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[c.jsx("div",{className:"flex flex-wrap items-center gap-2",children:c.jsxs("div",{className:"relative",children:[c.jsx("button",{onClick:s,className:"btn btn-secondary text-sm",children:"Colonnes"}),t&&c.jsx("div",{className:"absolute z-50 mt-2 p-4 min-w-[10rem] bg-[var(--color-bg-input)] text-[var(--color-text-primary)] border border-[var(--color-border-strong)] rounded-md shadow-2xl flex flex-col gap-2",children:e.map(m=>c.jsxs("label",{className:"flex items-center space-x-2 text-sm",children:[c.jsx("input",{type:"checkbox",checked:r.includes(m.key),onChange:()=>i(m.key),className:"rounded"}),c.jsx("span",{children:m.label})]},m.key))})]})}),c.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[d>0&&c.jsx("button",{onClick:u,disabled:x,className:"btn btn-secondary text-sm text-red-500 disabled:opacity-50 disabled:cursor-not-allowed",children:"Supprimer produit(s)"}),c.jsx("button",{onClick:o,disabled:!p,className:"btn btn-primary text-sm",children:"Enregistrer"})]})]})})}function Gx({options:e,selected:r,onChange:t}){const[s,i]=H.useState(!1),o=H.useRef(null);H.useEffect(()=>{function d(x){o.current&&!o.current.contains(x.target)&&i(!1)}return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[]);const u=(d,x)=>{t(x?[...r,d]:r.filter(p=>p!==d))};return c.jsxs("div",{className:"relative",ref:o,children:[c.jsx("button",{type:"button",onClick:()=>i(d=>!d),className:"w-full px-2 py-1 bg-[var(--color-bg-surface)] text-[var(--color-text-primary)] border border-[var(--color-border-strong)] rounded text-left overflow-hidden whitespace-nowrap text-ellipsis",children:r.length?r.join(", "):"Tous"}),s&&c.jsx("div",{className:"absolute z-10 mt-1 max-h-60 overflow-auto bg-[var(--color-bg-surface)] text-[var(--color-text-primary)] border border-[var(--color-border-strong)] rounded shadow-lg",children:e.map(d=>c.jsxs("label",{className:"flex items-center space-x-2 px-2 py-1 hover:bg-[var(--color-bg-elevated)]",children:[c.jsx("input",{type:"checkbox",checked:r.includes(d),onChange:x=>u(d,x.target.checked),className:"rounded"}),c.jsx("span",{children:d})]},d))})]})}function gT({columns:e,visibleColumns:r,paginatedData:t,filters:s,onFilterChange:i,filterOptions:o,referenceData:u,selectedProducts:d,onToggleSelectProduct:x,onChange:p,onDelete:m,filteredCount:w,currentPage:y,totalPages:E,rowsPerPage:N,onPageChange:g,onRowsPerPageChange:_}){const{brandOptions:b,colorOptions:I,memoryOptions:O,typeOptions:J,ramOptions:he,normeOptions:de}=o,{brands:z,colors:re,memories:V,types:M,rams:L,normes:X}=u,K=Z=>{switch(Z){case"brand":return b;case"memory":return O;case"color":return I;case"type":return J;case"ram":return he;case"norme":return de;default:return[]}},ne=c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("span",{className:"text-sm text-[var(--color-text-muted)]",children:[w," rsultat",w===1?"":"s"]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"text-sm text-[var(--color-text-secondary)] mr-1",children:"Lignes"}),c.jsxs("select",{id:"refRowsPerPage",value:N,onChange:Z=>_(Number(Z.target.value)),className:"bg-[var(--color-bg-surface)] text-[var(--color-text-primary)] border border-[var(--color-border-strong)] rounded px-2 py-1 text-sm",children:[c.jsx("option",{value:10,children:"10"}),c.jsx("option",{value:20,children:"20"}),c.jsx("option",{value:50,children:"50"}),c.jsx("option",{value:100,children:"100"})]})]}),c.jsxs("span",{className:"text-sm text-[var(--color-text-secondary)]",children:[y," / ",E]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("button",{onClick:()=>g(Math.max(1,y-1)),disabled:y===1,className:"btn btn-secondary p-1.5 disabled:opacity-30","aria-label":"Page prcdente",children:c.jsx(Uu,{className:"w-4 h-4"})}),c.jsx("button",{onClick:()=>g(Math.min(E,y+1)),disabled:y===E,className:"btn btn-secondary p-1.5 disabled:opacity-30","aria-label":"Page suivante",children:c.jsx(Ii,{className:"w-4 h-4"})})]})]})]}),W=(Z,me)=>{switch(me){case"brand":return c.jsxs("select",{value:Z.brand_id??"",onChange:R=>p(Z.id,"brand_id",R.target.value===""?null:Number(R.target.value)),className:"px-2 py-1 bg-[var(--color-bg-input)] text-[var(--color-text-primary)] border border-[var(--color-border-default)] rounded",children:[c.jsx("option",{value:"",children:"null"}),z.map(R=>c.jsx("option",{value:R.id,children:R.brand},R.id))]});case"memory":return c.jsxs("select",{value:Z.memory_id??"",onChange:R=>p(Z.id,"memory_id",R.target.value===""?null:Number(R.target.value)),className:"px-2 py-1 bg-[var(--color-bg-input)] text-[var(--color-text-primary)] border border-[var(--color-border-default)] rounded",children:[c.jsx("option",{value:"",children:"null"}),V.map(R=>c.jsx("option",{value:R.id,children:R.memory},R.id))]});case"color":return c.jsxs("select",{value:Z.color_id??"",onChange:R=>p(Z.id,"color_id",R.target.value===""?null:Number(R.target.value)),className:"px-2 py-1 bg-[var(--color-bg-input)] text-[var(--color-text-primary)] border border-[var(--color-border-default)] rounded",children:[c.jsx("option",{value:"",children:"null"}),re.map(R=>c.jsx("option",{value:R.id,children:R.color},R.id))]});case"type":return c.jsxs("select",{value:Z.type_id??"",onChange:R=>p(Z.id,"type_id",R.target.value===""?null:Number(R.target.value)),className:"px-2 py-1 bg-[var(--color-bg-input)] text-[var(--color-text-primary)] border border-[var(--color-border-default)] rounded",children:[c.jsx("option",{value:"",children:"null"}),M.map(R=>c.jsx("option",{value:R.id,children:R.type},R.id))]});case"ram":return c.jsxs("select",{value:Z.ram_id??"",onChange:R=>p(Z.id,"ram_id",R.target.value===""?null:Number(R.target.value)),className:"px-2 py-1 bg-[var(--color-bg-input)] text-[var(--color-text-primary)] border border-[var(--color-border-default)] rounded",children:[c.jsx("option",{value:"",children:"null"}),L.map(R=>c.jsx("option",{value:R.id,children:R.ram},R.id))]});case"norme":return c.jsxs("select",{value:Z.norme_id??"",onChange:R=>p(Z.id,"norme_id",R.target.value===""?null:Number(R.target.value)),className:"px-2 py-1 bg-[var(--color-bg-input)] text-[var(--color-text-primary)] border border-[var(--color-border-default)] rounded",children:[c.jsx("option",{value:"",children:"null"}),X.map(R=>c.jsx("option",{value:R.id,children:R.norme},R.id))]});case"model":return c.jsx("input",{value:Z.model,onChange:R=>p(Z.id,"model",R.target.value),className:"w-full px-2 py-1 bg-[var(--color-bg-input)] text-[var(--color-text-primary)] border border-[var(--color-border-default)] rounded"});case"description":return c.jsx("input",{value:Z.description,onChange:R=>p(Z.id,"description",R.target.value),className:"w-full px-2 py-1 bg-[var(--color-bg-input)] text-[var(--color-text-primary)] border border-[var(--color-border-default)] rounded"});case"ean":return c.jsx("input",{value:Z.ean??"",onChange:R=>p(Z.id,"ean",R.target.value),className:"w-full px-2 py-1 bg-[var(--color-bg-input)] text-[var(--color-text-primary)] border border-[var(--color-border-default)] rounded"});default:return String(Z[me]??"")}};return c.jsxs("div",{className:"card overflow-hidden",children:[c.jsx("div",{className:"overflow-auto",children:c.jsxs("table",{className:"min-w-full text-sm text-left border-0",children:[c.jsxs("thead",{children:[c.jsxs("tr",{className:"bg-[var(--color-bg-elevated)]",children:[c.jsx("th",{className:"px-3 py-2 border-b border-[var(--color-border-default)] w-12"}),e.map(Z=>r.includes(Z.key)&&c.jsx("th",{className:"px-3 py-2 border-b border-[var(--color-border-default)]",children:Z.label},Z.key)),c.jsx("th",{className:"px-3 py-2 border-b border-[var(--color-border-default)] w-20 text-center",children:"Actions"})]}),c.jsxs("tr",{children:[c.jsx("th",{className:"px-3 py-1 border-b border-[var(--color-border-default)]"}),e.map(Z=>r.includes(Z.key)&&c.jsx("th",{className:"px-3 py-1 border-b border-[var(--color-border-default)]",children:["brand","memory","color","type","ram","norme"].includes(Z.key)?c.jsx(Gx,{options:K(Z.key),selected:s[Z.key]||[],onChange:me=>i({...s,[Z.key]:me})}):c.jsx("input",{type:"text",value:s[Z.key]||"",onChange:me=>i({...s,[Z.key]:me.target.value}),className:"w-full px-2 py-1 bg-[var(--color-bg-surface)] text-[var(--color-text-primary)] border border-[var(--color-border-strong)] rounded"})},Z.key)),c.jsx("th",{className:"px-3 py-1 border-b border-[var(--color-border-default)]"})]})]}),c.jsx("tbody",{children:t.map(Z=>c.jsxs("tr",{className:"odd:bg-[var(--color-bg-surface)] even:bg-[var(--color-bg-elevated)] hover:bg-[var(--color-bg-elevated)]/80",children:[c.jsx("td",{className:"px-3 py-1 border-b border-[var(--color-border-default)]",children:c.jsx("input",{type:"checkbox",checked:d.includes(Z.id),onChange:()=>x(Z.id),className:"rounded"})}),e.map(me=>r.includes(me.key)&&c.jsx("td",{className:"px-3 py-1 border-b border-[var(--color-border-default)]",children:W(Z,me.key)},me.key)),c.jsx("td",{className:"px-3 py-1 border-b border-[var(--color-border-default)] text-center",children:c.jsx("button",{onClick:()=>m(Z.id),className:"btn btn-secondary p-1.5 text-red-500",title:"Supprimer",children:c.jsx(za,{className:"w-4 h-4"})})})]},String(Z.id)))})]})}),c.jsx("div",{className:"px-4 py-3 border-t border-[var(--color-border-subtle)]",children:ne})]})}function yT(){const[e,r]=H.useState([]),[t,s]=H.useState({}),[i,o]=H.useState({}),[u,d]=H.useState([]),[x,p]=H.useState(!1),[m,w]=H.useState(1),[y,E]=H.useState(20),[N,g]=H.useState([]),[_,b]=H.useState([]),[I,O]=H.useState([]),[J,he]=H.useState([]),[de,z]=H.useState([]),[re,V]=H.useState([]),[M,L]=H.useState([]),[X,K]=H.useState(!1),ne=Fn(),[W,Z]=H.useState([]),[me,R]=H.useState([]),[ve,ye]=H.useState([]),[Y,k]=H.useState([]),[q,B]=H.useState([]),[U,oe]=H.useState([]),Ee=M.length,Te=[{key:"id",label:"ID"},{key:"model",label:"Modle"},{key:"description",label:"Description"},{key:"brand",label:"Marque"},{key:"memory",label:"Mmoire"},{key:"color",label:"Couleur"},{key:"type",label:"Type"},{key:"ram",label:"RAM"},{key:"norme",label:"Norme"},{key:"ean",label:"EAN"}];H.useEffect(()=>{Pu().then(Ue=>{r(Ue),d(Te.map(He=>He.key))}).catch(()=>r([])),Promise.all([Hu(),Vu(),sp(),op(),ip(),lp()]).then(([Ue,He,Ke,ct,ut,it])=>{g(Ue),b(He),O(Ke),he(ct),z(ut),V(it),Z(Ue.map(ft=>ft.brand)),R(He.map(ft=>ft.color)),ye(Ke.map(ft=>ft.memory)),k(ct.map(ft=>ft.type)),B(ut.map(ft=>ft.ram)),oe(it.map(ft=>ft.norme))}).catch(()=>{g([]),b([]),O([]),he([]),z([]),V([]),Z([]),R([]),ye([]),k([]),B([]),oe([])})},[]),H.useEffect(()=>{w(1)},[i,y]),H.useEffect(()=>{L(Ue=>Ue.filter(He=>e.some(Ke=>Ke.id===He)))},[e]);const ee=e.filter(Ue=>Te.every(He=>{const Ke=i[He.key];if(!Ke||Array.isArray(Ke)&&Ke.length===0)return!0;const ct=Ue[He.key];return["brand","memory","color","type","ram","norme"].includes(He.key)?Ke.includes(String(ct??"")):String(ct??"").toLowerCase().includes(Ke.toLowerCase())})),te=Math.max(1,Math.ceil(ee.length/y)),Se=ee.slice((m-1)*y,m*y);H.useEffect(()=>{m>te&&w(te)},[te,m]);const De=Ue=>{d(He=>He.includes(Ue)?He.filter(Ke=>Ke!==Ue):[...He,Ue])},et=(Ue,He,Ke)=>{r(ct=>ct.map(ut=>ut.id===Ue?{...ut,[He]:Ke}:ut)),s(ct=>({...ct,[Ue]:{...ct[Ue]||{},[He]:Ke}}))},We=Ue=>{Ue.length&&s(He=>{const Ke={...He};return Ue.forEach(ct=>{delete Ke[ct]}),Ke})},ot=Ue=>{L(He=>He.includes(Ue)?He.filter(Ke=>Ke!==Ue):[...He,Ue])},rt=async Ue=>{if(Ue<0){r(He=>He.filter(Ke=>Ke.id!==Ue)),We([Ue]),L(He=>He.filter(Ke=>Ke!==Ue)),ne("Produit supprim","success");return}if(window.confirm("Supprimer ce produit ?"))try{await Fv(Ue),r(He=>He.filter(Ke=>Ke.id!==Ue)),We([Ue]),L(He=>He.filter(Ke=>Ke!==Ue)),ne("Produit supprim","success")}catch{ne("Erreur lors de la suppression","error")}},Oe=async()=>{if(!Ee||X||!window.confirm(`Confirmez-vous la suppression de ${Ee} produit(s) ?`))return;K(!0);const Ue=M.filter(ut=>ut<0),He=M.filter(ut=>ut>0);let Ke=[];if(He.length)try{const ut=await jv(He);Ke=Array.isArray(ut?.deleted)?ut.deleted:He}catch{ne("Erreur lors de la suppression","error")}const ct=Array.from(new Set([...Ue,...Ke]));ct.length&&(r(ut=>ut.filter(it=>!ct.includes(it.id))),We(ct),L(ut=>ut.filter(it=>!ct.includes(it))),ne(`${ct.length} produit(s) supprim(s)`,"success")),K(!1)},Ot=async()=>{const Ue=[],He=[];if(Object.entries(t).forEach(([Ke,ct])=>{const ut=Number(Ke);if(ut<0){const{brand:it,memory:ft,color:rn,type:nn,ram:_r,norme:Ea,...Gr}={...ct};Ue.push(Gr)}else He.push({id:ut,...ct})}),!(!Ue.length&&!He.length))try{await Promise.all(Ue.map(ct=>vv(ct))),Ue.length&&ne(`${Ue.length} produit(s) crs`,"success"),He.length&&(await bv(He),ne(`${He.length} produit(s) mis  jour`,"success")),s({});const Ke=await Pu();r(Ke)}catch{ne("Erreur lors de l'enregistrement","error")}};return c.jsxs("div",{children:[c.jsx(vT,{columns:Te,visibleColumns:u,showColumnMenu:x,onToggleColumnMenu:()=>p(Ue=>!Ue),onToggleColumn:De,onSave:Ot,onBulkDelete:Oe,selectedCount:Ee,isBulkDeleting:X,hasEdits:Object.keys(t).length>0}),c.jsx(gT,{columns:Te,visibleColumns:u,paginatedData:Se,filters:i,onFilterChange:o,filterOptions:{brandOptions:W,colorOptions:me,memoryOptions:ve,typeOptions:Y,ramOptions:q,normeOptions:U},referenceData:{brands:N,colors:_,memories:I,types:J,rams:de,normes:re},selectedProducts:M,onToggleSelectProduct:ot,onChange:et,onDelete:rt,filteredCount:ee.length,currentPage:m,totalPages:te,rowsPerPage:y,onPageChange:w,onRowsPerPageChange:E})]})}function wT({columns:e,baseColumns:r,visibleColumns:t,filters:s,setFilters:i,brandOptions:o,colorOptions:u,memoryOptions:d,typeOptions:x,ramOptions:p,normeOptions:m,role:w}){return c.jsxs("tr",{children:[w!=="client"&&c.jsx("th",{className:"px-3 py-1 border-b border-[var(--color-border-default)]"}),e.map(y=>t.includes(y.key)&&c.jsx("th",{className:"px-3 py-1 border-b border-[var(--color-border-default)]",children:r.some(E=>E.key===y.key)?["brand","memory","color","type","ram","norme"].includes(y.key)?c.jsx(Gx,{options:y.key==="brand"?o:y.key==="memory"?d:y.key==="color"?u:y.key==="type"?x:y.key==="ram"?p:m,selected:s[y.key]||[],onChange:E=>i({...s,[y.key]:E})}):c.jsx("input",{type:"text",value:s[y.key]||"",onChange:E=>i({...s,[y.key]:E.target.value}),className:"w-full px-2 py-1 bg-[var(--color-bg-surface)] border border-[var(--color-border-strong)] rounded"}):null},y.key))]})}function _T({columns:e,baseColumns:r,visibleColumns:t,paginatedData:s,suppliers:i,role:o,editedPrices:u,setEditedPrices:d,setData:x,selectedSet:p,toggleProductSelection:m,toggleSelectAllCurrentPage:w,setSelectedProduct:y,getBaseBuyPrice:E,filters:N,setFilters:g,brandOptions:_,colorOptions:b,memoryOptions:I,typeOptions:O,ramOptions:J,normeOptions:he}){return c.jsxs("table",{className:"table border-0",children:[c.jsxs("thead",{children:[c.jsxs("tr",{className:"bg-[var(--color-bg-elevated)]",children:[o!=="client"&&c.jsx("th",{className:"px-3 py-2 border-b border-[var(--color-border-default)] w-12",children:c.jsx("input",{type:"checkbox",onChange:w,checked:s.length>0&&s.every(de=>p.has(de.id)),"aria-checked":s.some(de=>p.has(de.id))&&!s.every(de=>p.has(de.id))?"mixed":void 0,className:"rounded"})}),e.map(de=>t.includes(de.key)&&c.jsx("th",{className:"px-3 py-2 border-b border-[var(--color-border-default)]",children:de.label},de.key))]}),c.jsx(wT,{columns:e,baseColumns:r,visibleColumns:t,filters:N,setFilters:g,brandOptions:_,colorOptions:b,memoryOptions:I,typeOptions:O,ramOptions:J,normeOptions:he,role:o})]}),c.jsx("tbody",{children:s.map(de=>{const re=i.map(X=>de.buyPrices[X]).filter(X=>typeof X=="number"),V=re.length?Math.min(...re):void 0,M=E(de),L=p.has(de.id);return c.jsxs("tr",{className:`odd:bg-[var(--color-bg-surface)] even:bg-[var(--color-bg-elevated)] hover:bg-[var(--color-bg-elevated)]/80 ${o!=="client"?"cursor-pointer":""} ${L?"bg-[#B8860B]/10 ring-1 ring-[#B8860B]/40":""}`,onClick:()=>o!=="client"&&y(de),children:[o!=="client"&&c.jsx("td",{className:"px-3 py-1 border-b border-[var(--color-border-default)]",children:c.jsx("input",{type:"checkbox",checked:L,onClick:X=>X.stopPropagation(),onChange:()=>m(de.id),className:"rounded"})}),e.map(X=>{if(!t.includes(X.key))return null;let K=de[X.key];if(X.key.startsWith("pa_")){const W=X.key.slice(3);K=de.buyPrices[W]}const ne=X.key.startsWith("pa_")&&typeof K=="number"&&K===V;return c.jsx("td",{className:`px-3 py-1 border-b border-[var(--color-border-default)] ${ne?"text-green-400":""}`,children:X.key==="averagePrice"&&o!=="client"?c.jsx("input",{type:"number",step:"0.01",value:u[de.id]??de.averagePrice,onClick:W=>W.stopPropagation(),onChange:W=>{const Z=Number(W.target.value);d(me=>({...me,[de.id]:Z})),x(me=>me.map(R=>R.id===de.id?{...R,averagePrice:Z}:R))},className:"w-20 px-2 py-1 bg-[var(--color-bg-input)] border border-[var(--color-border-default)] rounded text-[var(--color-text-primary)]"}):X.key==="averagePrice"?de.averagePrice:X.key==="marge"&&o!=="client"?c.jsx("input",{type:"number",step:"0.01",value:de.marge,onClick:W=>W.stopPropagation(),onChange:W=>{const Z=Number(W.target.value);if(Number.isNaN(Z))return;const me=Number.isFinite(de.tcp)?de.tcp:de.averagePrice-de.marge-M,R=Number((me+M+Z).toFixed(2)),ve=M+me,ye=ve?Number((Z/ve*100).toFixed(4)):null;d(Y=>({...Y,[de.id]:R})),x(Y=>Y.map(k=>k.id===de.id?{...k,marge:Z,margePercent:ye,averagePrice:R}:k))},className:"w-20 px-2 py-1 bg-[var(--color-bg-input)] border border-[var(--color-border-default)] rounded text-[var(--color-text-primary)]"}):X.key==="marge"?de.marge:K!==void 0?String(K):""},X.key)})]},String(de.id))})})]})}const h0=new Intl.NumberFormat("fr-FR",{minimumFractionDigits:2,maximumFractionDigits:2}),Ts=e=>typeof e=="number"&&Number.isFinite(e)?`${h0.format(e)} `:"",ET=e=>typeof e=="number"&&Number.isFinite(e)?`${h0.format(e)} %`:"",ST=e=>typeof e=="number"&&Number.isFinite(e)?h0.format(e):"",TT=e=>{if(!e)return"";const r=new Date(e);return Number.isNaN(r.getTime())?"":r.toLocaleString("fr-FR")},wi=e=>{if(!e.trim())return NaN;const r=e.replace(",","."),t=Number(r);return Number.isFinite(t)?t:NaN};function NT({prices:e={},stocks:r={},calculations:t={},currentMargin:s=0,currentMarginPercent:i=null,baseCost:o,recommendedPrice:u,onUpdateMargin:d,onClose:x}){const p=H.useMemo(()=>new Set([...Object.keys(e||{}),...Object.keys(r||{}),...Object.keys(t||{})]),[e,r,t]),m=H.useMemo(()=>Array.from(p).sort((re,V)=>re.localeCompare(V)),[p]),[w,y]=H.useState(()=>s.toFixed(2)),[E,N]=H.useState(()=>typeof i=="number"&&Number.isFinite(i)?i.toFixed(2):o?(s/o*100).toFixed(2):""),[g,_]=H.useState(!1),[b,I]=H.useState(null);H.useEffect(()=>{y(s.toFixed(2)),typeof i=="number"&&Number.isFinite(i)?N(i.toFixed(2)):N(o?(s/o*100).toFixed(2):"")},[s,i,o]);const O=wi(w),J=Number.isNaN(O)?u??o:Number(((o||0)+O).toFixed(2)),he=re=>{y(re);const V=wi(re);!Number.isNaN(V)&&o&&N((V/o*100).toFixed(2))},de=re=>{N(re);const V=wi(re);!Number.isNaN(V)&&o&&y((o*(V/100)).toFixed(2))},z=async re=>{if(re.preventDefault(),g)return;const V=wi(w);if(Number.isNaN(V)){I("Veuillez saisir une marge en euros valide.");return}let M=null;const L=wi(E);Number.isNaN(L)?o&&(M=Number((V/o*100).toFixed(4))):M=L,I(null),_(!0);try{await d(V,M)}catch{I("Erreur lors de l'enregistrement de la marge.")}finally{_(!1)}};return c.jsx("div",{className:"fixed inset-0 bg-[var(--color-bg-overlay)] flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-[var(--color-bg-surface)] p-6 rounded-md border border-[var(--color-border-default)] w-full max-w-5xl mx-4",children:[c.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Dernires donnes calcules par fournisseur"}),c.jsxs("form",{onSubmit:z,className:"mb-6 space-y-4",children:[c.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[c.jsxs("label",{className:"flex flex-col text-sm",children:[c.jsx("span",{className:"mb-1 font-medium",children:"Marge ()"}),c.jsx("input",{type:"number",step:"0.01",value:w,onChange:re=>he(re.target.value),className:"rounded border border-[var(--color-border-strong)] bg-[var(--color-bg-elevated)] px-3 py-2"})]}),c.jsxs("label",{className:"flex flex-col text-sm",children:[c.jsx("span",{className:"mb-1 font-medium",children:"Marge (%)"}),c.jsx("input",{type:"number",step:"0.01",value:E,onChange:re=>de(re.target.value),className:"rounded border border-[var(--color-border-strong)] bg-[var(--color-bg-elevated)] px-3 py-2",disabled:!o}),!o&&c.jsx("span",{className:"mt-1 text-xs text-[var(--color-text-muted)]",children:"Impossible de calculer le pourcentage : prix d'achat ou TCP manquant."})]})]}),c.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-[var(--color-text-secondary)]",children:[c.jsxs("span",{children:["Base (PA + TCP): ",Ts(o)]}),c.jsxs("span",{children:["Prix de vente HT recalcul: ",Ts(J)]})]}),b&&c.jsx("p",{className:"text-sm text-red-400",children:b}),c.jsx("div",{className:"flex justify-end",children:c.jsx("button",{type:"submit",className:"btn btn-primary",disabled:g,children:g?"Enregistrement":"Mettre  jour la marge"})})]}),m.length?c.jsx("div",{className:"overflow-auto max-h-[60vh]",children:c.jsxs("table",{className:"table mb-4 min-w-full",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Fournisseur"}),c.jsx("th",{children:"Prix achat"}),c.jsx("th",{children:"Prix HT max"}),c.jsx("th",{children:"TCP"}),c.jsx("th",{children:"Marge ()"}),c.jsx("th",{children:"Marge (%)"}),c.jsx("th",{children:"Stock"}),c.jsx("th",{children:"Mise  jour"})]})}),c.jsx("tbody",{children:m.map(re=>c.jsxs("tr",{children:[c.jsx("td",{children:re}),c.jsx("td",{children:Ts(t[re]?.price??e[re])}),c.jsx("td",{children:Ts(t[re]?.prixhtMax)}),c.jsx("td",{children:Ts(t[re]?.tcp)}),c.jsx("td",{children:Ts(t[re]?.marge)}),c.jsx("td",{children:ET(t[re]?.margePercent)}),c.jsx("td",{children:ST(t[re]?.stock??r?.[re])}),c.jsx("td",{children:TT(t[re]?.updatedAt)})]},re))})]})}):c.jsx("p",{children:"Aucun prix disponible."}),c.jsx("div",{className:"text-right space-x-2",children:c.jsx("button",{onClick:x,className:"btn btn-secondary",type:"button",children:"Fermer"})})]})})}function kT({onBack:e,role:r}){const[t,s]=H.useState([]),[i,o]=H.useState([]),[u,d]=H.useState({}),[x,p]=H.useState({}),[m,w]=H.useState([]),[y,E]=H.useState(!1),[N,g]=H.useState(1),[_,b]=H.useState(20),[I,O]=H.useState([]),[J,he]=H.useState([]),[de,z]=H.useState([]),[re,V]=H.useState([]),[M,L]=H.useState([]),[X,K]=H.useState([]),[ne,W]=H.useState("calculations"),[Z,me]=H.useState(null),[R,ve]=H.useState([]),[ye,Y]=H.useState(!1),[k,q]=H.useState(""),[B,U]=H.useState(!1),oe=Fn(),Ee=Object.keys(x).length,Te=Ee>0,ee=R.length,te=H.useMemo(()=>new Set(R),[R]),Se=Pe=>{const Ye=Object.values(Pe.buyPrices||{}).filter(Ge=>typeof Ge=="number"&&!Number.isNaN(Ge));return typeof Pe.minBuyPrice=="number"&&!Number.isNaN(Pe.minBuyPrice)?Pe.minBuyPrice:Ye.length?Math.min(...Ye):0},De=H.useMemo(()=>r==="client"?[{key:"averagePrice",label:"Prix de vente"},{key:"model",label:"Modle"},{key:"description",label:"Description"}]:[{key:"id",label:"ID"},{key:"model",label:"Modle"},{key:"description",label:"Description"},{key:"brand",label:"Marque"},{key:"memory",label:"Mmoire"},{key:"color",label:"Couleur"},{key:"type",label:"Type"},{key:"ram",label:"RAM"},{key:"norme",label:"Norme"},{key:"averagePrice",label:"Prix de vente"},{key:"marge",label:"Marge"}],[r]),et=H.useMemo(()=>[...De,...r!=="client"?i.map(Pe=>({key:`pa_${Pe}`,label:`PA ${Pe}`})):[]].filter(Pe=>!Pe.label.includes("%")),[i,r]);H.useEffect(()=>{w(et.map(Pe=>Pe.key))},[et]),H.useEffect(()=>{nn(),Promise.all([Hu(),Vu(),sp(),op(),ip(),lp()]).then(([Pe,Ye,Ge,nt,Je,$t])=>{O(Pe.map(Ie=>Ie.brand)),he(Ye.map(Ie=>Ie.color)),z(Ge.map(Ie=>Ie.memory)),V(nt.map(Ie=>Ie.type)),L(Je.map(Ie=>Ie.ram)),K($t.map(Ie=>Ie.norme))}).catch(()=>{O([]),he([]),z([]),V([]),L([]),K([])})},[]),H.useEffect(()=>{const Pe=new Set(t.map(Ye=>Ye.id));ve(Ye=>{const Ge=Ye.filter(nt=>Pe.has(nt));return Ge.length===Ye.length?Ye:Ge})},[t]),H.useEffect(()=>{const Pe=Array.from(new Set(t.map(Ie=>Ie.brand).filter(Ie=>typeof Ie=="string")));Pe.length&&O(Ie=>Array.from(new Set([...Ie,...Pe])));const Ye=Array.from(new Set(t.map(Ie=>Ie.color).filter(Ie=>typeof Ie=="string")));Ye.length&&he(Ie=>Array.from(new Set([...Ie,...Ye])));const Ge=Array.from(new Set(t.map(Ie=>Ie.memory).filter(Ie=>typeof Ie=="string")));Ge.length&&z(Ie=>Array.from(new Set([...Ie,...Ge])));const nt=Array.from(new Set(t.map(Ie=>Ie.type).filter(Ie=>typeof Ie=="string")));nt.length&&V(Ie=>Array.from(new Set([...Ie,...nt])));const Je=Array.from(new Set(t.map(Ie=>Ie.ram).filter(Ie=>typeof Ie=="string")));Je.length&&L(Ie=>Array.from(new Set([...Ie,...Je])));const $t=Array.from(new Set(t.map(Ie=>Ie.norme).filter(Ie=>typeof Ie=="string")));$t.length&&K(Ie=>Array.from(new Set([...Ie,...$t])))},[t]),H.useEffect(()=>{g(1)},[u,_]);const We=t.filter(Pe=>De.every(Ye=>{const Ge=u[Ye.key];if(!Ge||Array.isArray(Ge)&&Ge.length===0)return!0;const nt=Pe[Ye.key];return["brand","memory","color","type","ram","norme"].includes(Ye.key)?Ge.includes(String(nt??"")):String(nt??"").toLowerCase().includes(Ge.toLowerCase())})),ot=Math.max(1,Math.ceil(We.length/_)),rt=We.slice((N-1)*_,N*_);H.useEffect(()=>{N>ot&&g(ot)},[ot,N]);const Oe=Pe=>{ve(Ye=>{const Ge=new Set(Ye);return Ge.has(Pe)?Ge.delete(Pe):Ge.add(Pe),Array.from(Ge)})},Ot=()=>{const Pe=rt.map(Ge=>Ge.id),Ye=Pe.every(Ge=>te.has(Ge));ve(Ge=>{const nt=new Set(Ge);return Ye?Pe.forEach(Je=>nt.delete(Je)):Pe.forEach(Je=>nt.add(Je)),Array.from(nt)})},Ue=()=>{q(""),Y(!0)},He=()=>{Y(!1),q("")},Ke=()=>{const Pe=k.trim();if(!Pe){oe("Veuillez indiquer une marge","error");return}const Ye=Pe.replace(/,/g,"."),Ge=Number(Ye);if(Number.isNaN(Ge)){oe("Marge invalide","error");return}const nt=Number(Ge.toFixed(2));if(!R.length){He();return}const Je=new Set(R),$t={};s(Ie=>Ie.map(dt=>{if(!Je.has(dt.id))return dt;const Er=Number.isFinite(dt.tcp)?dt.tcp:0,Ht=Se(dt),Jt=Number((Er+Ht+nt).toFixed(2)),mt=Ht+Er,ir=mt?Number((nt/mt*100).toFixed(4)):null;return $t[dt.id]=Jt,{...dt,marge:nt,margePercent:ir,averagePrice:Jt}})),p(Ie=>({...Ie,...$t})),oe(`${Je.size} produit${Je.size===1?"":"s"} mis  jour (en attente d'enregistrement)`,"success"),He()},ct=Pe=>{w(Ye=>Ye.includes(Pe)?Ye.filter(Ge=>Ge!==Pe):[...Ye,Pe])},ut=()=>We.map(Pe=>{const Ye={};return et.forEach(Ge=>{if(!m.includes(Ge.key))return;let nt=Pe[Ge.key];if(Ge.key.startsWith("pa_")){const Je=Ge.key.slice(3);nt=Pe.buyPrices[Je]}Ge.key==="averagePrice"&&x[Pe.id]!==void 0&&(nt=x[Pe.id]),Ye[Ge.label]=nt}),Ye}),it=()=>{const Pe=ku.book_new(),Ye=ku.json_to_sheet(ut());ku.book_append_sheet(Pe,Ye,"Data"),nT(Pe,`tcp_marge_${xu()}.xlsx`)},ft=async()=>{const Pe=Object.entries(x);if(Pe.length)try{await Promise.all(Pe.map(([Ye,Ge])=>{const nt=t.find(Je=>Je.id===Number(Ye));return qd(Number(Ye),{recommended_price:Ge,marge:nt?.marge,marge_percent:nt?.margePercent??void 0})})),oe(`${Pe.length} prix mis  jour`,"success"),p({})}catch{oe("Erreur lors de l'enregistrement","error")}},rn=async(Pe,Ye,Ge)=>{const nt=t.find(mt=>mt.id===Pe);if(!nt)return;const Je=Se(nt),$t=Number.isFinite(nt.tcp)?nt.tcp:0,Ie=Number(Ye.toFixed(2)),dt=Je+$t,Er=dt?Number((Ie/dt*100).toFixed(4)):Ge!==null?Number(Ge.toFixed(4)):null,Ht=Number((dt+Ie).toFixed(2));try{await qd(Pe,{marge:Ie,marge_percent:Er??void 0,recommended_price:Ht})}catch(mt){throw oe("Erreur lors de la mise  jour de la marge","error"),mt}const Jt=mt=>{const ir={};Object.entries(mt.latestCalculations||{}).forEach(([jn,Pn])=>{const On=Pn??{},Ta=On.price??mt.buyPrices[jn]??0,yn=On.tcp??mt.tcp??0,Kn=Ta+yn,an=Kn?Number((Ie/Kn*100).toFixed(4)):Er,Ms=Number((yn+Ta+Ie).toFixed(2));ir[jn]={...On,marge:Ie,margePercent:an,prixhtMax:Ms}});const Sa={...mt.salePrices};return Object.entries(ir).forEach(([jn,Pn])=>{Pn?.prixhtMax!==void 0&&(Sa[jn]=Pn.prixhtMax)}),{...mt,marge:Ie,margePercent:Er,averagePrice:Ht,salePrices:Sa,latestCalculations:ir}};s(mt=>mt.map(ir=>ir.id===Pe?Jt(ir):ir)),me(mt=>mt&&mt.id===Pe?Jt(mt):mt),p(mt=>{const ir={...mt};return delete ir[Pe],ir}),oe("Marge mise  jour","success")},nn=()=>{Ov().then(Pe=>{const Ye=Pe,Ge=new Set,nt=Ye.map(Je=>{Object.keys(Je.buy_price||{}).forEach(Ie=>Ge.add(Ie));const $t={};return Object.entries(Je.latest_calculations||{}).forEach(([Ie,dt])=>{$t[Ie]={price:dt?.price??void 0,tcp:dt?.tcp??void 0,marge45:dt?.marge4_5??void 0,marge:dt?.marge??void 0,margePercent:dt?.marge_percent??null,prixhtTcpMarge45:dt?.prixht_tcp_marge4_5??void 0,prixhtMarge45:dt?.prixht_marge4_5??void 0,prixhtMax:dt?.prixht_max??void 0,stock:dt?.stock??void 0,updatedAt:dt?.date??null}}),{id:Je.id,model:Je.model,description:Je.description,brand:Je.brand,memory:Je.memory,color:Je.color,type:Je.type,ram:Je.ram,norme:Je.norme,marge:Je.marge??0,margePercent:typeof Je.marge_percent=="number"?Je.marge_percent:null,averagePrice:Je.recommended_price??Je.average_price??0,buyPrices:Je.buy_price||{},salePrices:Je.supplier_prices||{},stockLevels:Je.stock_levels||{},latestCalculations:$t,minBuyPrice:typeof Je.min_buy_price=="number"?Je.min_buy_price:0,tcp:typeof Je.tcp=="number"?Je.tcp:0}});o(Array.from(Ge).sort()),s(nt)}).catch(()=>{s([]),o([])})},_r=async()=>{U(!0);try{const Pe=await Pv();oe(`Recalcul termin (${Pe.created} enregistrements)`,"success"),nn()}catch{oe("Erreur lors du recalcul","error")}finally{U(!1)}},Ea=()=>{const Pe=JSON.stringify(ut(),null,2),Ye=new Blob([Pe],{type:"application/json"}),Ge=URL.createObjectURL(Ye),nt=document.createElement("a");nt.href=Ge,nt.download=`tcp_marge_${xu()}.json`,document.body.appendChild(nt),nt.click(),document.body.removeChild(nt),URL.revokeObjectURL(Ge)},Gr=()=>{const Pe=ut();if(!Pe.length)return;const Ye=Object.keys(Pe[0]),Ge=Ye.map(Jt=>`<th>${Jt}</th>`).join(""),nt=Pe.map(Jt=>`<tr>${Ye.map(mt=>`<td>${Jt[mt]??""}</td>`).join("")}</tr>`).join(""),$t=`<!DOCTYPE html><html lang="fr"><head><meta charset="utf-8"><title>Export TCP/Marge</title><style>
      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%);
        color: white;
        padding: 20px;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        font-size: 14px;
      }
      th, td {
        border: 1px solid #3f3f46;
        padding: 8px;
      }
      th { background: #27272a; }
      tr:nth-child(odd) { background: #18181b; }
      tr:nth-child(even) { background: #27272a; }
    </style></head><body><table><thead><tr>${Ge}</tr></thead><tbody>${nt}</tbody></table></body></html>`,Ie=new Blob([$t],{type:"text/html"}),dt=URL.createObjectURL(Ie),Er=`ajt_product_${xu()}.html`,Ht=document.createElement("a");Ht.href=dt,Ht.download=Er,document.body.appendChild(Ht),Ht.click(),document.body.removeChild(Ht),window.open(dt,"_blank"),setTimeout(()=>URL.revokeObjectURL(dt),1e3)},gn=c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("span",{className:"text-sm text-[var(--color-text-muted)]",children:[We.length," rsultat",We.length===1?"":"s"]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"text-sm text-[var(--color-text-secondary)] mr-1",children:"Lignes"}),c.jsxs("select",{id:"rowsPerPage",value:_,onChange:Pe=>b(Number(Pe.target.value)),className:"bg-[var(--color-bg-surface)] border border-[var(--color-border-strong)] rounded px-2 py-1 text-sm",children:[c.jsx("option",{value:10,children:"10"}),c.jsx("option",{value:20,children:"20"}),c.jsx("option",{value:50,children:"50"}),c.jsx("option",{value:100,children:"100"})]})]}),c.jsxs("span",{className:"text-sm text-[var(--color-text-secondary)]",children:[N," / ",ot]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("button",{onClick:()=>g(Pe=>Math.max(1,Pe-1)),disabled:N===1,className:"btn btn-secondary p-1.5 disabled:opacity-30","aria-label":"Page prcdente",children:c.jsx(Uu,{className:"w-4 h-4"})}),c.jsx("button",{onClick:()=>g(Pe=>Math.min(ot,Pe+1)),disabled:N===ot,className:"btn btn-secondary p-1.5 disabled:opacity-30","aria-label":"Page suivante",children:c.jsx(Ii,{className:"w-4 h-4"})})]})]})]});return c.jsxs("div",{children:[e&&c.jsxs("button",{onClick:e,className:"btn btn-secondary mb-6",children:[c.jsx(wo,{className:"w-5 h-5"}),c.jsx("span",{children:"Retour"})]}),c.jsxs("div",{className:"mb-8",children:[c.jsxs("h1",{className:"text-3xl font-semibold text-[var(--color-text-heading)] flex items-center gap-3",children:[c.jsx(sv,{className:"w-8 h-8 text-[#B8860B]"}),"Produits"]}),c.jsxs("p",{className:"text-[var(--color-text-muted)] mt-1",children:["Grez les prix, marges et le rfrentiel produits. Semaine en cours : ",fv()]})]}),c.jsx("div",{className:"border-b border-[var(--color-border-subtle)] mb-6",children:c.jsxs("nav",{className:"flex gap-4",children:[c.jsx("button",{type:"button",onClick:()=>W("calculations"),className:`px-2 pb-3 text-sm font-medium transition-colors border-b-2 ${ne==="calculations"?"border-[#B8860B] text-[var(--color-text-heading)]":"border-transparent text-[var(--color-text-muted)] hover:text-[var(--color-text-secondary)]"}`,children:"TCP/Marges"}),r!=="client"&&c.jsx("button",{type:"button",onClick:()=>W("reference"),className:`px-2 pb-3 text-sm font-medium transition-colors border-b-2 ${ne==="reference"?"border-[#B8860B] text-[var(--color-text-heading)]":"border-transparent text-[var(--color-text-muted)] hover:text-[var(--color-text-secondary)]"}`,children:"Rfrentiel"})]})}),ne==="calculations"&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"card p-4 mb-6 overflow-visible relative z-20",children:c.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[c.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r!=="client"&&c.jsxs("div",{className:"relative",children:[c.jsx("button",{onClick:()=>E(Pe=>!Pe),className:"btn btn-secondary text-sm",children:"Colonnes"}),y&&c.jsx("div",{className:"absolute z-50 mt-2 p-4 min-w-[10rem] bg-[var(--color-bg-input)] text-[var(--color-text-primary)] border border-[var(--color-border-strong)] rounded-md shadow-2xl flex flex-col gap-2",children:et.map(Pe=>c.jsxs("label",{className:"flex items-center space-x-2 text-sm",children:[c.jsx("input",{type:"checkbox",checked:m.includes(Pe.key),onChange:()=>ct(Pe.key),className:"rounded"}),c.jsx("span",{children:Pe.label})]},Pe.key))})]}),r!=="client"&&c.jsx("div",{className:"w-px h-6 bg-[var(--color-border-subtle)]"}),r!=="client"&&c.jsxs("button",{onClick:_r,disabled:B,className:"btn btn-primary text-sm",children:[c.jsx(Wu,{className:`w-4 h-4 ${B?"animate-spin":""}`}),B?"Recalcul...":"Recalculer"]}),r!=="client"&&c.jsx("div",{className:"w-px h-6 bg-[var(--color-border-subtle)]"}),c.jsx("button",{onClick:it,className:"btn btn-secondary text-sm",children:"Export Excel"}),c.jsx("button",{onClick:Ea,className:"btn btn-secondary text-sm",children:"Export JSON"}),c.jsx("button",{onClick:Gr,className:"btn btn-secondary text-sm",children:"Gnre HTML"})]}),r!=="client"&&c.jsxs("div",{className:"flex flex-col items-end gap-2 md:items-center md:flex-row md:gap-4",children:[ee>0&&c.jsxs("button",{onClick:Ue,className:"btn btn-secondary text-sm",children:["Mise  jour marge (",ee,")"]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("span",{className:"text-sm text-[var(--color-text-secondary)]",children:[Ee," produit",Ee===1?"":"s"," modifi",Ee===1?"":"s"]}),c.jsxs("button",{onClick:ft,className:"btn btn-primary text-sm",disabled:!Te,children:["Enregistrer (",Ee,")"]})]})]})]})}),c.jsxs("div",{className:"card overflow-hidden",children:[c.jsx("div",{className:"overflow-auto",children:c.jsx(_T,{columns:et,baseColumns:De,visibleColumns:m,paginatedData:rt,suppliers:i,role:r,editedPrices:x,setEditedPrices:p,setData:s,selectedSet:te,toggleProductSelection:Oe,toggleSelectAllCurrentPage:Ot,setSelectedProduct:me,getBaseBuyPrice:Se,filters:u,setFilters:d,brandOptions:I,colorOptions:J,memoryOptions:de,typeOptions:re,ramOptions:M,normeOptions:X})}),c.jsx("div",{className:"px-4 py-3 border-t border-[var(--color-border-subtle)]",children:gn})]})]}),ne==="reference"&&c.jsx(yT,{}),r!=="client"&&Z&&c.jsx(NT,{prices:Z.salePrices,stocks:Z.stockLevels,calculations:Z.latestCalculations,currentMargin:Z.marge,currentMarginPercent:Z.margePercent,baseCost:Se(Z)+(Number.isFinite(Z.tcp)?Z.tcp:0),recommendedPrice:Z.averagePrice,onUpdateMargin:(Pe,Ye)=>rn(Z.id,Pe,Ye),onClose:()=>me(null)}),ye&&c.jsx(mT,{selectedCount:ee,bulkMarginValue:k,setBulkMarginValue:q,closeBulkMarginModal:He,applyBulkMargin:Ke})]})}function Xx(e){return e.normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").toLowerCase()}function CT({searchTerm:e,onSearchChange:r,minPrice:t,maxPrice:s,onPriceRangeChange:i,allProducts:o,priceRange:u,suppliers:d,selectedSupplier:x,onSupplierChange:p,onlyInStock:m,onOnlyInStockChange:w,eanFilter:y,onEanFilterChange:E,sortOrder:N,onSortOrderChange:g,onResetFilters:_}){const[b,I]=H.useState(!1),[O,J]=H.useState(!1),[he,de]=H.useState([]),[z,re]=H.useState([]),V=H.useRef(null),M=H.useRef(null);H.useEffect(()=>{const W=localStorage.getItem("ajtpro_search_history");W&&re(JSON.parse(W))},[]);const L=(W,Z,me=2)=>{if(!W||!Z)return!1;const R=W.toLowerCase(),ve=Z.toLowerCase();if(ve.includes(R))return!0;if(Math.abs(R.length-ve.length)>me)return!1;let ye=0;const Y=Math.max(R.length,ve.length);for(let k=0;k<Y;k++)if(R[k]!==ve[k]&&(ye++,ye>me))return!1;return!0},X=W=>{if(!W||W.length<2)return z.slice(0,5);const Z=new Set;return o.forEach(ve=>{const ye=ve.name.toLowerCase().split(" ");ve.name.toLowerCase().includes(W.toLowerCase())&&Z.add(ve.name),ye.forEach(Y=>{Y.includes(W.toLowerCase())&&Y.length>2&&Z.add(ve.name)}),L(W,ve.name,2)&&Z.add(ve.name)}),["Apple","Samsung","Xiaomi","Hotwav","JBL","Google","Honor","Nothing"].forEach(ve=>{L(W,ve,1)&&Z.add(ve)}),["iPhone","iPad","Galaxy","Note","Pro","Max","Mini","Watch","Buds"].forEach(ve=>{L(W,ve,1)&&Z.add(ve)}),Array.from(Z).slice(0,8)};H.useEffect(()=>{const W=X(e);de(W)},[e,o]);const K=W=>{r(W),J(!1);const Z=[W,...z.filter(me=>me!==W)].slice(0,10);re(Z),localStorage.setItem("ajtpro_search_history",JSON.stringify(Z))};H.useEffect(()=>{const W=Z=>{M.current&&!M.current.contains(Z.target)&&V.current&&!V.current.contains(Z.target)&&J(!1)};return document.addEventListener("mousedown",W),()=>document.removeEventListener("mousedown",W)},[]);const ne=W=>{if(W.preventDefault(),e.trim()){const Z=[e,...z.filter(me=>me!==e)].slice(0,10);re(Z),localStorage.setItem("ajtpro_search_history",JSON.stringify(Z))}J(!1)};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"relative",children:[c.jsx("form",{onSubmit:ne,className:"relative",children:c.jsxs("div",{className:"relative",children:[c.jsx(Au,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-[var(--color-text-muted)] w-5 h-5"}),c.jsx("input",{ref:V,type:"text",value:e,onChange:W=>r(W.target.value),onFocus:()=>J(!0),className:"w-full pl-12 pr-12 py-3 text-sm bg-[var(--color-bg-input)] border border-[var(--color-border-strong)] rounded-md text-[var(--color-text-primary)] placeholder-[var(--color-text-muted)] focus:border-[#B8860B] focus:outline-none transition-all duration-200",placeholder:" Rechercher un produit... (ex: iPhone, Galaxy, Hotwav)"}),e&&c.jsx("button",{type:"button",onClick:()=>{r(""),J(!1)},className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)] transition-colors",children:c.jsx(tp,{className:"w-5 h-5"})})]})}),O&&he.length>0&&c.jsxs("div",{ref:M,className:"absolute top-full left-0 right-0 mt-2 bg-[var(--color-bg-elevated)] border border-[var(--color-border-strong)] rounded-md shadow-2xl z-50 max-h-80 overflow-y-auto",children:[!e&&z.length>0&&c.jsx("div",{className:"p-3 border-b border-[var(--color-border-default)]",children:c.jsxs("div",{className:"flex items-center space-x-2 text-sm text-[var(--color-text-muted)] mb-2",children:[c.jsx(Yd,{className:"w-4 h-4"}),c.jsx("span",{children:"Recherches rcentes"})]})}),he.map((W,Z)=>c.jsx("button",{onClick:()=>K(W),className:"w-full text-left px-4 py-3 hover:bg-[var(--color-bg-input)] transition-colors border-b border-[var(--color-border-default)] last:border-b-0",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-[var(--color-text-primary)]",children:W}),z.includes(W)&&c.jsx(Yd,{className:"w-4 h-4 text-[#B8860B]"})]})},Z))]})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("button",{type:"button",onClick:()=>I(!b),className:"flex items-center justify-between w-full text-left text-sm font-semibold text-[var(--color-text-secondary)] uppercase tracking-wide",children:[c.jsx("span",{children:"Filtres avancs"}),c.jsx("svg",{className:`w-5 h-5 text-[var(--color-text-muted)] transform transition-transform ${b?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),b&&c.jsxs("div",{className:"space-y-6",children:[c.jsx("div",{className:"space-y-4",children:c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-[var(--color-text-muted)] mb-2",children:"Gamme de prix"}),c.jsxs("div",{className:"relative mb-4",children:[c.jsx("div",{className:"relative h-2 bg-[var(--color-border-strong)] rounded-full",children:c.jsx("div",{className:"absolute h-2 bg-[#B8860B] rounded-full",style:{left:`${(t-u.min)/(u.max-u.min)*100}%`,width:`${(s-t)/(u.max-u.min)*100}%`}})}),c.jsx("input",{type:"range",min:u.min,max:u.max,value:t,onChange:W=>{const Z=Math.min(Number(W.target.value),s-1);i(Z,s)},className:"absolute top-0 w-full h-2 opacity-0 cursor-pointer"}),c.jsx("input",{type:"range",min:u.min,max:u.max,value:s,onChange:W=>{const Z=Math.max(Number(W.target.value),t+1);i(t,Z)},className:"absolute top-0 w-full h-2 opacity-0 cursor-pointer"})]}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"flex-1",children:c.jsx("input",{type:"number",value:t,onChange:W=>{const Z=Math.max(u.min,Math.min(Number(W.target.value),s-1));i(Z,s)},className:"w-full px-3 py-2 bg-[var(--color-bg-input)] border border-[var(--color-border-strong)] rounded-md text-[var(--color-text-primary)] text-xs focus:border-[#B8860B] focus:outline-none",min:u.min,max:s-1})}),c.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:""}),c.jsx("div",{className:"flex-1",children:c.jsx("input",{type:"number",value:s,onChange:W=>{const Z=Math.min(u.max,Math.max(Number(W.target.value),t+1));i(t,Z)},className:"w-full px-3 py-2 bg-[var(--color-bg-input)] border border-[var(--color-border-strong)] rounded-md text-[var(--color-text-primary)] text-xs focus:border-[#B8860B] focus:outline-none",min:t+1,max:u.max})}),c.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:""})]})]})}),c.jsx("div",{className:"pt-4 border-t border-[var(--color-border-default)]",children:c.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-[var(--color-text-muted)] mb-1",children:"Fournisseur"}),c.jsxs("select",{value:x,onChange:W=>p(W.target.value),className:"w-full px-3 py-2 bg-[var(--color-bg-input)] border border-[var(--color-border-strong)] rounded-md text-[var(--color-text-primary)] text-sm focus:border-[#B8860B] focus:outline-none",children:[c.jsx("option",{value:"all",children:"Tous les fournisseurs"}),d.map(W=>c.jsx("option",{value:W,children:W},W))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-[var(--color-text-muted)] mb-1",children:"Disponibilit"}),c.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 bg-[var(--color-bg-input)] border border-[var(--color-border-strong)] rounded-md text-sm text-[var(--color-text-primary)]",children:[c.jsx("input",{type:"checkbox",checked:m,onChange:W=>w(W.target.checked),className:"h-4 w-4 rounded border-[var(--color-border-strong)] text-[#B8860B] focus:ring-[#B8860B]"}),"Stock disponible uniquement"]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-[var(--color-text-muted)] mb-1",children:"EAN"}),c.jsx("input",{type:"text",value:y,onChange:W=>E(W.target.value),placeholder:"Rechercher par EAN",className:"w-full px-3 py-2 bg-[var(--color-bg-input)] border border-[var(--color-border-strong)] rounded-md text-[var(--color-text-primary)] text-sm focus:border-[#B8860B] focus:outline-none"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-[var(--color-text-muted)] mb-1",children:"Tri par prix"}),c.jsxs("select",{value:N,onChange:W=>g(W.target.value),className:"w-full px-3 py-2 bg-[var(--color-bg-input)] border border-[var(--color-border-strong)] rounded-md text-[var(--color-text-primary)] text-sm focus:border-[#B8860B] focus:outline-none",children:[c.jsx("option",{value:"asc",children:"Prix croissant"}),c.jsx("option",{value:"desc",children:"Prix dcroissant"})]})]})]})}),c.jsx("div",{className:"pt-4 border-t border-[var(--color-border-default)]",children:c.jsx("button",{onClick:_,className:"btn btn-secondary w-full text-sm",children:"Rinitialiser les filtres"})})]})]})]})}const Gh=["bg-emerald-500/15 text-emerald-700 dark:text-emerald-200 ring-emerald-500/40","bg-sky-500/15 text-sky-700 dark:text-sky-200 ring-sky-500/40","bg-violet-500/15 text-violet-700 dark:text-violet-200 ring-violet-500/40","bg-rose-500/15 text-rose-700 dark:text-rose-200 ring-rose-500/40","bg-amber-500/15 text-amber-700 dark:text-amber-200 ring-amber-500/40","bg-lime-500/15 text-lime-700 dark:text-lime-200 ring-lime-500/40","bg-cyan-500/15 text-cyan-700 dark:text-cyan-200 ring-cyan-500/40","bg-fuchsia-500/15 text-fuchsia-700 dark:text-fuchsia-200 ring-fuchsia-500/40"];function AT(e){let r=0;for(let t=0;t<e.length;t+=1)r=(r*31+e.charCodeAt(t))%2**32;return Math.abs(r)}function bT(...e){const r=[];return e.forEach(s=>{if(s){if(Array.isArray(s)){s.forEach(i=>{typeof i=="string"&&i.trim().length>0&&r.push(i)});return}typeof s=="string"&&s.trim().length>0&&r.push(s)}}),Xx(r.join(" ")).replace(/[^a-z0-9]+/g," ").trim()}function FT(e){if(!e)return"bg-[var(--color-bg-input)]/40 text-[var(--color-text-secondary)] ring-zinc-500/20";const r=AT(e)%Gh.length;return Gh[r]}function jT(e){return typeof e=="number"&&!Number.isNaN(e)?Math.round(e*100)/100:0}function PT(){const[e,r]=H.useState([]),[t,s]=H.useState(""),[i,o]=H.useState(0),[u,d]=H.useState(0),[x,p]=H.useState({min:0,max:0}),[m,w]=H.useState(!0),[y,E]=H.useState(null),[N,g]=H.useState("all"),[_,b]=H.useState(!1),[I,O]=H.useState(""),[J,he]=H.useState("asc");H.useEffect(()=>{w(!0),Rv().then(M=>{const L=M.map((W,Z)=>{const me=W.price??W.selling_price??null,R=typeof me=="number"&&!Number.isNaN(me),ve=jT(R?me:0),ye=W.name??W.model??W.description??`Produit ${Z+1}`,Y=Array.isArray(W.color_synonyms)?W.color_synonyms.filter(q=>typeof q=="string").map(q=>q.trim()).filter(q=>q.length>0):[],k=bT(ye,W.description??null,W.brand??null,W.supplier??null,Y,W.ean??null,W.part_number??null);return{id:String(W.id??ye??Z),name:ye,description:W.description??null,brand:W.brand??null,price:ve,hasPrice:R,supplier:W.supplier??null,quantity:typeof W.quantity=="number"&&!Number.isNaN(W.quantity)?W.quantity:null,ean:typeof W.ean=="string"&&W.ean.trim().length>0?W.ean.trim():null,partNumber:typeof W.part_number=="string"&&W.part_number.trim().length>0?W.part_number.trim():null,colorSynonyms:Y,searchIndex:k}}),X=L.map(W=>W.price).filter(W=>typeof W=="number"&&!Number.isNaN(W));let K=X.length?Math.floor(Math.min(...X)):0,ne=X.length?Math.ceil(Math.max(...X)):0;K===ne&&(ne=K+1),p({min:K,max:ne}),o(K),d(ne),r(L),E(null)}).catch(M=>{console.error("Unable to fetch supplier catalog",M),r([]),p({min:0,max:1}),o(0),d(1);const L=M instanceof Error&&M.message?M.message:"Impossible de rcuprer les produits. Veuillez ressayer.";E(L)}).finally(()=>w(!1))},[]);const de=H.useMemo(()=>{const M=new Set;return e.forEach(L=>{L.supplier&&M.add(L.supplier)}),Array.from(M).sort((L,X)=>L.localeCompare(X))},[e]),z=H.useMemo(()=>{const L=Xx(t.trim()).split(/[^a-z0-9]+/).map(K=>K.trim()).filter(K=>K.length>0),X=I.trim().toLowerCase();return e.filter(K=>{const ne=L.length===0||L.every(ve=>K.searchIndex.includes(ve)),W=K.price>=i&&K.price<=u,Z=N==="all"||K.supplier===N,me=!_||typeof K.quantity=="number"&&!Number.isNaN(K.quantity)&&K.quantity>0,R=X.length===0||typeof K.ean=="string"&&K.ean.toLowerCase().includes(X);return ne&&W&&Z&&me&&R}).sort((K,ne)=>J==="asc"?K.price-ne.price:ne.price-K.price)},[e,t,i,u,N,_,I,J]),re=(M,L)=>{o(Math.max(x.min,Math.min(M,L-1))),d(Math.min(x.max,Math.max(L,M+1)))},V=()=>{s(""),o(x.min),d(x.max),g("all"),b(!1),O(""),he("asc")};return c.jsxs("div",{children:[c.jsxs("div",{className:"mb-8",children:[c.jsxs("h1",{className:"text-3xl font-semibold text-[var(--color-text-heading)] flex items-center gap-3",children:[c.jsx(av,{className:"w-8 h-8 text-[#B8860B]"}),"Moteur de recherche produits"]}),c.jsx("p",{className:"text-[var(--color-text-muted)] mt-1",children:"Explorez le catalogue, affinez vos recherches par prix ou mots-cls et accdez rapidement aux produits pertinents."})]}),m?c.jsxs("div",{className:"flex items-center justify-center py-20 text-[var(--color-text-muted)]",children:[c.jsx(An,{className:"w-6 h-6 animate-spin mr-3"}),"Chargement des produits..."]}):y?c.jsx("div",{className:"rounded-md border border-red-500/40 bg-red-500/10 px-6 py-4 text-red-200",children:y}):c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"card mb-6 overflow-visible relative z-20",children:c.jsx(CT,{searchTerm:t,onSearchChange:s,minPrice:i,maxPrice:u,onPriceRangeChange:re,allProducts:e.map(M=>({name:M.name,price:M.price,brand:M.brand??"Inconnu"})),priceRange:x,suppliers:de,selectedSupplier:N,onSupplierChange:g,onlyInStock:_,onOnlyInStockChange:b,eanFilter:I,onEanFilterChange:O,sortOrder:J,onSortOrderChange:he,onResetFilters:V})}),c.jsxs("div",{className:"card overflow-hidden",children:[c.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-[var(--color-border-subtle)]",children:[c.jsxs("h2",{className:"text-sm font-semibold text-[var(--color-text-heading)]",children:["Rsultats (",z.length,")"]}),c.jsxs("span",{className:"text-xs text-[var(--color-text-muted)]",children:["Gamme : ",i,"  ",u,""]})]}),z.length===0?c.jsx("div",{className:"px-6 py-12 text-center text-[var(--color-text-muted)]",children:"Aucun produit ne correspond  votre recherche pour le moment."}):c.jsx("div",{className:"divide-y divide-[var(--color-border-subtle)]",children:z.map(M=>c.jsx("div",{className:"px-4 py-4 hover:bg-[var(--color-bg-elevated)]/50 transition-colors",children:c.jsxs("div",{className:"flex items-start justify-between gap-6",children:[c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("h3",{className:"text-base font-semibold text-[var(--color-text-primary)]",children:M.name}),M.brand&&c.jsx("p",{className:"mt-0.5 text-sm uppercase tracking-wide text-[#B8860B]",children:M.brand}),M.description&&c.jsx("p",{className:"mt-1.5 text-sm text-[var(--color-text-muted)] line-clamp-2",children:M.description}),c.jsxs("div",{className:"mt-2 flex items-center gap-4 text-xs text-[var(--color-text-muted)]",children:[c.jsxs("span",{className:"flex items-center gap-1.5",children:[c.jsx(Vm,{className:"h-3.5 w-3.5"}),"Stock: ",typeof M.quantity=="number"?M.quantity:"N/C"]}),c.jsxs("span",{className:"flex items-center gap-1.5",children:[c.jsx(Hm,{className:"h-3.5 w-3.5"}),"EAN: ",M.ean??"N/C"]})]})]}),c.jsxs("div",{className:"flex items-center gap-3 flex-shrink-0",children:[c.jsx("span",{className:`inline-flex items-center rounded-full px-3 py-1 text-[11px] font-semibold uppercase tracking-wide ring-1 ring-inset ${FT(M.supplier)}`,children:M.supplier??"Fournisseur inconnu"}),c.jsx("div",{className:"rounded-md bg-[#B8860B]/10 px-4 py-2 text-[#B8860B] font-semibold whitespace-nowrap",children:M.hasPrice?`${M.price.toFixed(2)}`:"Prix N/C"})]})]})},M.id))})]})]})]})}function pn({text:e}){const[r,t]=H.useState(!1);return c.jsxs("span",{className:"relative inline-block ml-1 align-middle",children:[c.jsx("button",{type:"button",onClick:()=>t(s=>!s),className:"text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)]",children:c.jsx(Jm,{className:"w-4 h-4"})}),r&&c.jsx("div",{className:"absolute left-5 top-0 z-10 w-60 text-xs bg-[var(--color-bg-elevated)] border border-[var(--color-border-strong)] rounded p-2",children:e})]})}function OT({supplierId:e,setSupplierId:r,brandId:t,setBrandId:s,productId:i,setProductId:o,startWeek:u,setStartWeek:d,endWeek:x,setEndWeek:p,suppliers:m,brands:w,filteredProducts:y,graphVisible:E,toggleGraph:N,graphOptions:g}){return c.jsxs("div",{className:"card mb-6 space-y-4",children:[c.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[c.jsxs("select",{value:e,onChange:_=>r(_.target.value?Number(_.target.value):""),className:"bg-[var(--color-bg-input)] border border-[var(--color-border-strong)] rounded-md px-3 py-2 text-sm",children:[c.jsx("option",{value:"",children:"Tous fournisseurs"}),m.map(_=>c.jsx("option",{value:_.id,children:_.name},_.id))]}),c.jsxs("select",{value:t,onChange:_=>s(_.target.value?Number(_.target.value):""),className:"bg-[var(--color-bg-input)] border border-[var(--color-border-strong)] rounded-md px-3 py-2 text-sm",children:[c.jsx("option",{value:"",children:"Toutes marques"}),w.map(_=>c.jsx("option",{value:_.id,children:_.brand},_.id))]}),c.jsx("input",{type:"week",value:u,onChange:_=>d(_.target.value),className:"bg-[var(--color-bg-input)] border border-[var(--color-border-strong)] rounded-md px-3 py-2 text-sm"}),c.jsx("input",{type:"week",value:x,onChange:_=>p(_.target.value),className:"bg-[var(--color-bg-input)] border border-[var(--color-border-strong)] rounded-md px-3 py-2 text-sm"}),c.jsxs("select",{value:i,onChange:_=>o(_.target.value?Number(_.target.value):""),className:"bg-[var(--color-bg-input)] border border-[var(--color-border-strong)] rounded-md px-3 py-2 text-sm",children:[c.jsx("option",{value:"",children:"Choisir un produit"}),y.map(_=>c.jsx("option",{value:_.id,children:_.model},_.id))]})]}),c.jsx("div",{className:"flex flex-wrap gap-4 pt-3 border-t border-[var(--color-border-subtle)]",children:g.map(_=>c.jsxs("label",{className:"flex items-center space-x-1 text-sm",children:[c.jsx("input",{type:"checkbox",checked:E[_.key]??!0,onChange:()=>N(_.key),className:"accent-[#B8860B]"}),c.jsx("span",{children:_.label})]},_.key))})]})}function RT({data:e}){if(!e.length)return c.jsx("svg",{viewBox:"0 0 700 320",className:"w-full h-80 bg-[var(--color-bg-surface)] rounded"});const i=Math.max(...e.map(m=>m.value))*1.1,o=620/Math.max(1,e.length-1),u=e.map((m,w)=>{const y=40+w*o,E=280-m.value/i*240;return{x:y,y:E}}),d=u.map((m,w)=>`${w===0?"M":"L"}${m.x},${m.y}`).join(" "),x=4,p=240/x;return c.jsxs("svg",{viewBox:"0 0 700 320",className:"w-full h-80 bg-[var(--color-bg-surface)] rounded",preserveAspectRatio:"xMidYMid meet",children:[Array.from({length:x+1}).map((m,w)=>c.jsx("line",{x1:40,y1:280-w*p,x2:660,y2:280-w*p,stroke:"var(--color-chart-grid)"},w)),c.jsx("line",{x1:40,y1:280,x2:660,y2:280,stroke:"var(--color-chart-axis)"}),c.jsx("line",{x1:40,y1:40,x2:40,y2:280,stroke:"var(--color-chart-axis)"}),e.map((m,w)=>c.jsx("text",{x:40+w*o,y:295,fontSize:"10",textAnchor:"middle",fill:"var(--color-chart-text)",children:m.label},m.label)),Array.from({length:x+1}).map((m,w)=>c.jsx("text",{x:35,y:280-w*p+4,fontSize:"10",textAnchor:"end",fill:"var(--color-chart-text)",children:(i/x*w).toFixed(0)},w)),c.jsx("path",{d,fill:"none",stroke:"#B8860B",strokeWidth:"2"}),u.map((m,w)=>c.jsx("circle",{cx:m.x,cy:m.y,r:3,fill:"#B8860B"},w))]})}function DT({globalData:e,brandId:r}){return c.jsxs("div",{children:[c.jsxs("h2",{className:"font-semibold mb-2 flex items-center",children:["Vue globale",c.jsx(pn,{text:"Prix moyen toutes marques et fournisseurs pour chaque semaine."})]}),c.jsx(RT,{data:e}),e.length===0&&c.jsx("p",{className:"text-center text-sm text-[var(--color-text-muted)] mt-2",children:r?"Pas de donnes pour cette marque":"Pas de donnes"})]})}function IT({series:e}){const i=e.flatMap(m=>m.data);if(!i.length)return c.jsx("svg",{viewBox:"0 0 700 320",className:"w-full h-80 bg-[var(--color-bg-surface)] rounded"});const o=Array.from(new Set(i.map(m=>m.label))).sort(),u=Math.max(...i.map(m=>m.value))*1.1,d=620/o.length,x=(d-10)/e.length,p=["#B8860B","#38bdf8","#22c55e","#e879f9","#facc15","#f43f5e"];return c.jsxs("svg",{viewBox:"0 0 700 320",className:"w-full h-80 bg-[var(--color-bg-surface)] rounded",preserveAspectRatio:"xMidYMid meet",children:[o.map((m,w)=>c.jsx("text",{x:40+w*d+d/2,y:295,fontSize:"10",textAnchor:"middle",fill:"var(--color-chart-text)",children:m},m)),e.map((m,w)=>c.jsx("g",{children:o.map((y,E)=>{const N=m.data.find(b=>b.label===y);if(!N)return null;const g=N.value/u*240,_=40+E*d+5+w*x;return c.jsx("rect",{x:_,y:280-g,width:x-2,height:g,fill:p[w%p.length]},y)})},m.name)),Array.from({length:5}).map((m,w)=>c.jsx("text",{x:35,y:280-240/4*w+4,fontSize:"10",textAnchor:"end",fill:"var(--color-chart-text)",children:(u/4*w).toFixed(0)},w)),c.jsx("line",{x1:40,y1:280,x2:660,y2:280,stroke:"var(--color-chart-axis)"}),c.jsx("line",{x1:40,y1:40,x2:40,y2:280,stroke:"var(--color-chart-axis)"})]})}function MT({brandSupplierSeries:e}){return c.jsxs("div",{children:[c.jsxs("h2",{className:"font-semibold mb-2 flex items-center",children:["Prix moyen marque/fournisseur",c.jsx(pn,{text:"Compare les prix moyens par marque selon les fournisseurs."})]}),c.jsx(IT,{series:e}),e.length===0&&c.jsx("p",{className:"text-center text-sm text-[var(--color-text-muted)] mt-2",children:"Pas de donnes"})]})}function LT({series:e}){const i=e.flatMap(m=>m.data);if(!i.length)return c.jsx("svg",{viewBox:"0 0 700 320",className:"w-full h-80 bg-[var(--color-bg-surface)] rounded"});const o=Array.from(new Set(i.map(m=>m.label))).sort(),u=Math.max(...i.map(m=>m.value))*1.1,d=620/o.length,x=(d-10)/e.length,p=["#B8860B","#38bdf8","#22c55e","#e879f9","#facc15","#f43f5e"];return c.jsxs("svg",{viewBox:"0 0 700 320",className:"w-full h-80 bg-[var(--color-bg-surface)] rounded",preserveAspectRatio:"xMidYMid meet",children:[o.map((m,w)=>c.jsx("text",{x:40+w*d+d/2,y:295,fontSize:"10",textAnchor:"middle",fill:"var(--color-chart-text)",children:m},m)),e.map((m,w)=>c.jsx("g",{children:o.map((y,E)=>{const N=m.data.find(b=>b.label===y);if(!N)return null;const g=N.value/u*240,_=40+E*d+5+w*x;return c.jsx("rect",{x:_,y:280-g,width:x-2,height:g,fill:p[w%p.length]},y)})},m.name)),Array.from({length:5}).map((m,w)=>c.jsx("text",{x:35,y:280-240/4*w+4,fontSize:"10",textAnchor:"end",fill:"var(--color-chart-text)",children:(u/4*w).toFixed(0)},w)),c.jsx("line",{x1:40,y1:280,x2:660,y2:280,stroke:"var(--color-chart-axis)"}),c.jsx("line",{x1:40,y1:40,x2:40,y2:280,stroke:"var(--color-chart-axis)"})]})}function BT({productSupplierSeries:e}){return c.jsxs("div",{children:[c.jsxs("h2",{className:"font-semibold mb-2 flex items-center",children:["Prix moyen produit/fournisseur",c.jsx(pn,{text:"Compare les prix moyens par produit selon les fournisseurs."})]}),c.jsx(LT,{series:e}),e.length===0&&c.jsx("p",{className:"text-center text-sm text-[var(--color-text-muted)] mt-2",children:"Pas de donnes"})]})}const Cu=[{key:"global",label:"Vue globale"},{key:"brandSupplier",label:"Prix moyen marque/fournisseur"},{key:"productSupplier",label:"Prix moyen produit/fournisseur"},{key:"product",label:"volution du produit"},{key:"relative",label:"volution relative (%)"},{key:"distribution",label:"Distribution des prix"},{key:"stdev",label:"cart-type par fournisseur"},{key:"range",label:"Prix min/max par semaine"},{key:"index",label:"Indice des prix"},{key:"correlation",label:"Corrlation des prix"},{key:"anomalies",label:"Anomalies dtectes"}];function Xh({data:e}){if(!e.length)return c.jsx("svg",{viewBox:"0 0 700 320",className:"w-full h-80 bg-[var(--color-bg-surface)] rounded"});const i=Math.max(...e.map(m=>m.value))*1.1,o=620/Math.max(1,e.length-1),u=e.map((m,w)=>{const y=40+w*o,E=280-m.value/i*240;return{x:y,y:E}}),d=u.map((m,w)=>`${w===0?"M":"L"}${m.x},${m.y}`).join(" "),x=4,p=240/x;return c.jsxs("svg",{viewBox:"0 0 700 320",className:"w-full h-80 bg-[var(--color-bg-surface)] rounded",preserveAspectRatio:"xMidYMid meet",children:[Array.from({length:x+1}).map((m,w)=>c.jsx("line",{x1:40,y1:280-w*p,x2:660,y2:280-w*p,stroke:"var(--color-chart-grid)"},w)),c.jsx("line",{x1:40,y1:280,x2:660,y2:280,stroke:"var(--color-chart-axis)"}),c.jsx("line",{x1:40,y1:40,x2:40,y2:280,stroke:"var(--color-chart-axis)"}),e.map((m,w)=>c.jsx("text",{x:40+w*o,y:295,fontSize:"10",textAnchor:"middle",fill:"var(--color-chart-text)",children:m.label},m.label)),Array.from({length:x+1}).map((m,w)=>c.jsx("text",{x:35,y:280-w*p+4,fontSize:"10",textAnchor:"end",fill:"var(--color-chart-text)",children:(i/x*w).toFixed(0)},w)),c.jsx("path",{d,fill:"none",stroke:"#B8860B",strokeWidth:"2"}),u.map((m,w)=>c.jsx("circle",{cx:m.x,cy:m.y,r:3,fill:"#B8860B"},w))]})}function UT({series:e}){const i=e.flatMap(y=>y.data);if(!i.length)return c.jsx("svg",{viewBox:"0 0 700 320",className:"w-full h-80 bg-[var(--color-bg-surface)] rounded"});const o=Math.max(...i.map(y=>y.value))*1.1,u=Array.from(new Set(i.map(y=>y.label))).sort(),d=620/Math.max(1,u.length-1),x=4,p=240/x,m=["#B8860B","#38bdf8","#22c55e","#e879f9","#facc15","#f43f5e"],w=e.map((y,E)=>{const g=u.map(b=>{const I=y.data.find(O=>O.label===b);return{x:40+u.indexOf(b)*d,y:I?280-I.value/o*240:null}}).filter(b=>b.y!==null),_=g.map((b,I)=>`${I===0?"M":"L"}${b.x},${b.y}`).join(" ");return{name:y.name,color:m[E%m.length],points:g,path:_}});return c.jsxs("svg",{viewBox:"0 0 700 320",className:"w-full h-80 bg-[var(--color-bg-surface)] rounded",preserveAspectRatio:"xMidYMid meet",children:[Array.from({length:x+1}).map((y,E)=>c.jsx("line",{x1:40,y1:280-E*p,x2:660,y2:280-E*p,stroke:"var(--color-chart-grid)"},E)),c.jsx("line",{x1:40,y1:280,x2:660,y2:280,stroke:"var(--color-chart-axis)"}),c.jsx("line",{x1:40,y1:40,x2:40,y2:280,stroke:"var(--color-chart-axis)"}),u.map((y,E)=>c.jsx("text",{x:40+E*d,y:295,fontSize:"10",textAnchor:"middle",fill:"var(--color-chart-text)",children:y},y)),Array.from({length:x+1}).map((y,E)=>c.jsx("text",{x:35,y:280-E*p+4,fontSize:"10",textAnchor:"end",fill:"var(--color-chart-text)",children:(o/x*E).toFixed(0)},E)),w.map(y=>c.jsxs("g",{children:[c.jsx("path",{d:y.path,fill:"none",stroke:y.color,strokeWidth:"2"}),y.points.map((E,N)=>c.jsx("circle",{cx:E.x,cy:E.y,r:3,fill:y.color},N))]},y.name))]})}function Kh({data:e}){if(!e.length)return c.jsx("svg",{viewBox:"0 0 700 320",className:"w-full h-80 bg-[var(--color-bg-surface)] rounded"});const i=Math.max(...e.map(u=>u.value))*1.1,o=620/e.length;return c.jsxs("svg",{viewBox:"0 0 700 320",className:"w-full h-80 bg-[var(--color-bg-surface)] rounded",preserveAspectRatio:"xMidYMid meet",children:[e.map((u,d)=>{const x=40+d*o,p=u.value/i*240;return c.jsxs("g",{children:[c.jsx("rect",{x:x+5,y:280-p,width:o-10,height:p,fill:"#B8860B"}),c.jsx("text",{x:x+o/2,y:295,fontSize:"10",textAnchor:"middle",fill:"var(--color-chart-text)",children:u.label})]},u.label)}),Array.from({length:5}).map((u,d)=>c.jsx("text",{x:35,y:280-240/4*d+4,fontSize:"10",textAnchor:"end",fill:"var(--color-chart-text)",children:(i/4*d).toFixed(0)},d)),c.jsx("line",{x1:40,y1:280,x2:660,y2:280,stroke:"var(--color-chart-axis)"}),c.jsx("line",{x1:40,y1:40,x2:40,y2:280,stroke:"var(--color-chart-axis)"})]})}function zT({data:e}){if(!e.length)return c.jsx("svg",{viewBox:"0 0 700 320",className:"w-full h-80 bg-[var(--color-bg-surface)] rounded"});const i=Math.max(...e.map(u=>u.max))*1.1,o=620/Math.max(1,e.length-1);return c.jsxs("svg",{viewBox:"0 0 700 320",className:"w-full h-80 bg-[var(--color-bg-surface)] rounded",preserveAspectRatio:"xMidYMid meet",children:[e.map((u,d)=>{const x=40+d*o,p=280-u.min/i*240,m=280-u.max/i*240;return c.jsxs("g",{children:[c.jsx("line",{x1:x,y1:p,x2:x,y2:m,stroke:"#B8860B",strokeWidth:"4"}),c.jsx("text",{x,y:295,fontSize:"10",textAnchor:"middle",fill:"var(--color-chart-text)",children:u.label})]},u.label)}),c.jsx("line",{x1:40,y1:280,x2:660,y2:280,stroke:"var(--color-chart-axis)"}),c.jsx("line",{x1:40,y1:40,x2:40,y2:280,stroke:"var(--color-chart-axis)"})]})}function WT({labels:e,matrix:r}){if(!e.length)return c.jsx("div",{className:"h-40"});const t=s=>{const i=Math.max(-1,Math.min(1,s)),o=Math.round(255*(i<0?1:1-i)),u=Math.round(255*(i>0?1:1+i));return`rgb(${o},${u},150)`};return c.jsxs("table",{className:"border-collapse",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{className:"w-20"}),e.map(s=>c.jsx("th",{className:"text-xs px-2",children:s},s))]})}),c.jsx("tbody",{children:e.map((s,i)=>c.jsxs("tr",{children:[c.jsx("th",{className:"text-xs pr-2 text-right",children:s}),e.map((o,u)=>c.jsx("td",{style:{backgroundColor:t(r[i][u])},className:"w-10 h-6 text-center text-xs",children:r[i][u].toFixed(2)},o))]},s))})]})}function $T({onBack:e}){const[r,t]=H.useState([]),[s,i]=H.useState([]),[o,u]=H.useState([]),[d,x]=H.useState([]),[p,m]=H.useState([]),[w,y]=H.useState([]),[E,N]=H.useState([]),[g,_]=H.useState({}),[b,I]=H.useState(""),[O,J]=H.useState(""),[he,de]=H.useState(""),[z,re]=H.useState(""),[V,M]=H.useState("");H.useEffect(()=>{_o().then(ee=>m(ee)).catch(()=>m([])),Hu().then(ee=>y(ee)).catch(()=>y([])),Pu().then(ee=>N(ee)).catch(()=>N([])),zv().then(ee=>{const te={};ee.forEach(Se=>{te[Se.name]=Se.visible}),Cu.forEach(Se=>{Se.key in te||(te[Se.key]=!0)}),_(te)}).catch(()=>{const ee={};Cu.forEach(te=>ee[te.key]=!0),_(ee)})},[]);const L=ee=>{_(te=>{const Se=!te[ee],De={...te,[ee]:Se};return Wv(ee,Se).catch(()=>{}),De})},X=ee=>{if(!ee)return;const[te,Se]=ee.split("-W");return`S${Se}-${te}`},K=H.useCallback(()=>{Qd({supplierId:b?Number(b):void 0,brandId:O?Number(O):void 0,startWeek:X(z),endWeek:X(V)}).then(ee=>t(ee)).catch(()=>t([]))},[b,O,z,V]),ne=H.useCallback(()=>{Bv({supplierId:b?Number(b):void 0,brandId:O?Number(O):void 0,startWeek:X(z),endWeek:X(V)}).then(ee=>u(ee)).catch(()=>u([]))},[b,O,z,V]),W=H.useCallback(()=>{Uv({supplierId:b?Number(b):void 0,brandId:O?Number(O):void 0,productId:he?Number(he):void 0,startWeek:X(z),endWeek:X(V)}).then(ee=>x(ee)).catch(()=>x([]))},[b,O,he,z,V]),Z=H.useCallback(()=>{if(!he){i([]);return}Qd({productId:Number(he),startWeek:X(z),endWeek:X(V)}).then(ee=>i(ee)).catch(()=>i([]))},[he,z,V]);H.useEffect(()=>{K()},[K]),H.useEffect(()=>{Z()},[Z]),H.useEffect(()=>{ne()},[ne]),H.useEffect(()=>{W()},[W]);const me=H.useMemo(()=>E.filter(ee=>O?ee.brand_id===Number(O):!0),[E,O]),R=H.useMemo(()=>{const ee={};return r.forEach(te=>{ee[te.week]?(ee[te.week].sum+=te.avg_price,ee[te.week].count+=1):ee[te.week]={sum:te.avg_price,count:1}}),Object.entries(ee).map(([te,{sum:Se,count:De}])=>({label:te,value:Se/De})).sort((te,Se)=>te.label.localeCompare(Se.label))},[r]),ve=H.useMemo(()=>{const ee={};return s.forEach(te=>{te.supplier&&(ee[te.supplier]||(ee[te.supplier]=[]),ee[te.supplier].push({label:te.week,value:te.avg_price}))}),Object.entries(ee).map(([te,Se])=>({name:te,data:Se.sort((De,et)=>De.label.localeCompare(et.label))}))},[s]),ye=H.useMemo(()=>{const ee=R.slice().sort((te,Se)=>te.label.localeCompare(Se.label));return ee.map((te,Se)=>{if(Se===0)return{label:te.label,value:0};const De=ee[Se-1].value,et=De?(te.value-De)/De*100:0;return{label:te.label,value:et}})},[R]),Y=H.useMemo(()=>{if(!r.length)return[];const ee=r.map(ot=>ot.avg_price),te=10,Se=Math.min(...ee),et=(Math.max(...ee)-Se)/te||1,We=[];for(let ot=0;ot<te;ot++){const rt=Se+ot*et,Oe=rt+et,Ot=ee.filter(Ue=>Ue>=rt&&Ue<Oe).length;We.push({label:`${rt.toFixed(0)}-${Oe.toFixed(0)}`,value:Ot})}return We},[r]),k=H.useMemo(()=>{const ee={};s.forEach(Se=>{Se.supplier&&(ee[Se.supplier]||(ee[Se.supplier]=[]),ee[Se.supplier].push(Se.avg_price))});const te=Se=>{const De=Se.reduce((We,ot)=>We+ot,0)/Se.length,et=Se.reduce((We,ot)=>We+Math.pow(ot-De,2),0)/Se.length;return Math.sqrt(et)};return Object.entries(ee).map(([Se,De])=>({label:Se,value:te(De)}))},[s]),q=H.useMemo(()=>{const ee={};return s.forEach(te=>{ee[te.week]?(ee[te.week].min=Math.min(ee[te.week].min,te.avg_price),ee[te.week].max=Math.max(ee[te.week].max,te.avg_price)):ee[te.week]={min:te.avg_price,max:te.avg_price}}),Object.entries(ee).map(([te,{min:Se,max:De}])=>({label:te,min:Se,max:De})).sort((te,Se)=>te.label.localeCompare(Se.label))},[s]),B=H.useMemo(()=>{if(!R.length)return[];const ee=R[0].value||1;return R.map(te=>({label:te.label,value:te.value/ee*100}))},[R]),U=H.useMemo(()=>{const ee=Array.from(new Set(s.map(We=>We.supplier).filter(Boolean))),te=Array.from(new Set(s.map(We=>We.week))).sort(),Se={};ee.forEach(We=>{Se[We]=te.map(ot=>{const rt=s.find(Oe=>Oe.supplier===We&&Oe.week===ot);return rt?rt.avg_price:null})});const De=(We,ot)=>{const rt=We.map((it,ft)=>[it,ot[ft]]).filter(it=>it[0]!==null&&it[1]!==null),Oe=rt.length;if(Oe<2)return 0;const Ot=rt.reduce((it,[ft])=>it+ft,0)/Oe,Ue=rt.reduce((it,[,ft])=>it+ft,0)/Oe,He=rt.reduce((it,[ft,rn])=>it+(ft-Ot)*(rn-Ue),0),Ke=Math.sqrt(rt.reduce((it,[ft])=>it+Math.pow(ft-Ot,2),0)),ct=Math.sqrt(rt.reduce((it,[,ft])=>it+Math.pow(ft-Ue,2),0)),ut=Ke*ct;return ut?He/ut:0},et=ee.map(We=>ee.map(ot=>De(Se[We],Se[ot])));return{labels:ee,matrix:et}},[s]),oe=H.useMemo(()=>{const ee={};return o.forEach(te=>{ee[te.supplier]||(ee[te.supplier]=[]),ee[te.supplier].push({label:te.brand,value:te.avg_price})}),Object.entries(ee).map(([te,Se])=>({name:te,data:Se.sort((De,et)=>De.label.localeCompare(et.label))}))},[o]),Ee=H.useMemo(()=>{const ee={};return d.forEach(te=>{ee[te.supplier]||(ee[te.supplier]=[]),ee[te.supplier].push({label:te.product,value:te.avg_price})}),Object.entries(ee).map(([te,Se])=>({name:te,data:Se.sort((De,et)=>De.label.localeCompare(et.label))}))},[d]),Te=H.useMemo(()=>{const ee=R.slice().sort((Se,De)=>Se.label.localeCompare(De.label)),te=[];for(let Se=1;Se<ee.length;Se++){const De=ee[Se-1].value,et=ee[Se].value;De&&Math.abs((et-De)/De)>=.2&&te.push({week:ee[Se].label,change:(et-De)/De*100})}return te},[R]);return c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between mb-8",children:[c.jsxs("div",{children:[c.jsxs("h1",{className:"text-3xl font-semibold text-[var(--color-text-heading)] flex items-center gap-3",children:[c.jsx(Gm,{className:"w-8 h-8 text-[#B8860B]"}),"Statistiques de prix"]}),c.jsx("p",{className:"text-[var(--color-text-muted)] mt-1",children:"Analyse graphique des prix, marges et tendances fournisseurs"})]}),e&&c.jsxs("button",{onClick:e,className:"btn btn-secondary",children:[c.jsx(wo,{className:"w-5 h-5"}),c.jsx("span",{children:"Retour"})]})]}),c.jsx(OT,{supplierId:b,setSupplierId:I,brandId:O,setBrandId:J,productId:he,setProductId:de,startWeek:z,setStartWeek:re,endWeek:V,setEndWeek:M,suppliers:p,brands:w,filteredProducts:me,graphVisible:g,toggleGraph:L,graphOptions:Cu}),c.jsxs("div",{className:"space-y-6",children:[g.global&&c.jsx("div",{className:"card overflow-hidden",children:c.jsx(DT,{globalData:R,brandId:O})}),g.brandSupplier&&c.jsx("div",{className:"card overflow-hidden",children:c.jsx(MT,{brandSupplierSeries:oe})}),g.productSupplier&&c.jsx("div",{className:"card overflow-hidden",children:c.jsx(BT,{productSupplierSeries:Ee})}),g.product&&c.jsxs("div",{className:"card overflow-hidden",children:[c.jsxs("h2",{className:"font-semibold mb-2 flex items-center",children:["volution du produit",c.jsx(pn,{text:"Comparer l'volution du prix du produit selon les fournisseurs."})]}),c.jsx(UT,{series:ve}),he&&ve.length===0&&c.jsx("p",{className:"text-center text-sm text-[var(--color-text-muted)] mt-2",children:"Pas de donnes pour ce produit"})]}),g.relative&&c.jsxs("div",{className:"card overflow-hidden",children:[c.jsxs("h2",{className:"font-semibold mb-2 flex items-center",children:["volution relative (%)",c.jsx(pn,{text:"Variation en pourcentage d'une semaine sur l'autre."})]}),c.jsx(Xh,{data:ye})]}),g.distribution&&c.jsxs("div",{className:"card overflow-hidden",children:[c.jsxs("h2",{className:"font-semibold mb-2 flex items-center",children:["Distribution des prix",c.jsx(pn,{text:"Rpartition des prix moyens pour identifier les valeurs atypiques."})]}),c.jsx(Kh,{data:Y})]}),g.stdev&&c.jsxs("div",{className:"card overflow-hidden",children:[c.jsxs("h2",{className:"font-semibold mb-2 flex items-center",children:["cart-type par fournisseur",c.jsx(pn,{text:"Mesure la dispersion des prix pour chaque fournisseur."})]}),c.jsx(Kh,{data:k})]}),g.range&&c.jsxs("div",{className:"card overflow-hidden",children:[c.jsxs("h2",{className:"font-semibold mb-2 flex items-center",children:["Prix min/max par semaine",c.jsx(pn,{text:"Fourchette des prix observs chaque semaine."})]}),c.jsx(zT,{data:q})]}),g.index&&c.jsxs("div",{className:"card overflow-hidden",children:[c.jsxs("h2",{className:"font-semibold mb-2 flex items-center",children:["Indice des prix (base 100)",c.jsx(pn,{text:"Indice bas sur la premire semaine pour suivre l'volution globale."})]}),c.jsx(Xh,{data:B})]}),g.correlation&&c.jsxs("div",{className:"card overflow-hidden",children:[c.jsxs("h2",{className:"font-semibold mb-2 flex items-center",children:["Corrlation des prix",c.jsx(pn,{text:"Met en vidence les fournisseurs ayant des volutions similaires."})]}),c.jsx(WT,{labels:U.labels,matrix:U.matrix})]}),g.anomalies&&c.jsxs("div",{className:"card overflow-hidden",children:[c.jsxs("h2",{className:"font-semibold mb-2 flex items-center",children:["Anomalies dtectes",c.jsx(pn,{text:"Signale les variations suprieures  20\\u00a0% d'une semaine sur l'autre."})]}),Te.length?c.jsxs("table",{className:"table border-0",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Semaine"}),c.jsx("th",{children:"Variation %"})]})}),c.jsx("tbody",{children:Te.map(ee=>c.jsxs("tr",{children:[c.jsx("td",{children:ee.week}),c.jsxs("td",{className:"text-red-400",children:[ee.change.toFixed(1),"%"]})]},ee.week))})]}):c.jsx("p",{className:"text-center text-sm text-[var(--color-text-muted)]",children:"Aucune anomalie"})]})]})]})}function HT(){const e=localStorage.getItem("role"),r=e&&e!=="client"?"products":"search",[t,s]=H.useState(r),[i,o]=H.useState(null),[u,d]=H.useState(localStorage.getItem("token")),[x,p]=H.useState(e||""),[m,w]=H.useState(!1),y=H.useRef(null);H.useEffect(()=>{u&&Ei(u)},[u]);const E=(I,O,J)=>{p(I),d(O),localStorage.setItem("role",I),Ei(O),no(J),s(I!=="client"?"products":"search")},N=()=>{p(""),d(null),Ei(null),no(null),localStorage.removeItem("role"),s("search"),w(!1)};H.useEffect(()=>{const I=()=>N();return window.addEventListener("auth:logout",I),()=>window.removeEventListener("auth:logout",I)},[]);const g=async()=>{o(null);try{await pv(),o("Connexion russie !")}catch{o("Impossible de se connecter  l'API. Vrifiez la configuration du serveur.")}};if(H.useEffect(()=>{const I=O=>{y.current&&!y.current.contains(O.target)&&w(!1)};return document.addEventListener("mousedown",I),()=>document.removeEventListener("mousedown",I)},[]),!u)return c.jsx(kg,{onLogin:E});const _=t==="products",b=t==="admin"||t==="sync";return c.jsxs("div",{className:"min-h-screen text-[var(--color-text-primary)] flex flex-col",children:[c.jsx("header",{className:"sticky top-0 z-40 bg-[var(--color-bg-nav)] backdrop-blur-lg border-b border-[#B8860B]/15",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex items-center justify-between h-14",children:[c.jsxs("div",{className:"flex items-center gap-8",children:[c.jsx("span",{className:"text-lg font-bold tracking-tight text-[#B8860B] select-none",children:"AJT Pro"}),c.jsxs("nav",{className:"hidden sm:flex items-center gap-1",children:[x!=="client"&&c.jsxs("button",{onClick:()=>{s("products"),w(!1)},className:`flex items-center gap-2 px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${_?"bg-[#B8860B]/15 text-[#B8860B]":"text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)] hover:bg-[var(--color-bg-elevated)]"}`,children:[c.jsx(Kd,{className:"w-4 h-4"}),c.jsx("span",{children:"Produits"})]}),c.jsxs("button",{onClick:()=>{s("search"),w(!1)},className:`flex items-center gap-2 px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${t==="search"?"bg-[#B8860B]/15 text-[#B8860B]":"text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)] hover:bg-[var(--color-bg-elevated)]"}`,children:[c.jsx(Au,{className:"w-4 h-4"}),c.jsx("span",{children:"Moteur de recherche"})]})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("div",{className:"flex sm:hidden items-center gap-1",children:[x!=="client"&&c.jsx("button",{onClick:()=>{s("products"),w(!1)},className:`p-2 rounded-md transition-colors ${_?"text-[#B8860B] bg-[#B8860B]/15":"text-[var(--color-text-muted)]"}`,"aria-label":"Produits",children:c.jsx(Kd,{className:"w-5 h-5"})}),c.jsx("button",{onClick:()=>{s("search"),w(!1)},className:`p-2 rounded-md transition-colors ${t==="search"?"text-[#B8860B] bg-[#B8860B]/15":"text-[var(--color-text-muted)]"}`,"aria-label":"Moteur de recherche",children:c.jsx(Au,{className:"w-5 h-5"})})]}),c.jsxs("div",{className:"relative",ref:y,children:[c.jsxs("button",{onClick:()=>w(I=>!I),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${b?"bg-[#B8860B]/15 text-[#B8860B]":"text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)] hover:bg-[var(--color-bg-elevated)]"}`,children:[c.jsx(ro,{className:"w-4 h-4"}),c.jsx("span",{className:"hidden sm:inline",children:"Paramtres"}),c.jsx(Bu,{className:`w-3.5 h-3.5 transition-transform ${m?"rotate-180":""}`})]}),m&&c.jsxs("div",{className:"absolute right-0 mt-2 w-48 rounded-md border border-[var(--color-border-default)] bg-[var(--color-bg-surface)] shadow-xl z-50 py-1",children:[x!=="client"&&c.jsxs(c.Fragment,{children:[c.jsxs("button",{onClick:()=>{s("admin"),w(!1)},className:`flex w-full items-center gap-2.5 px-4 py-2.5 text-left text-sm transition-colors hover:bg-[var(--color-bg-elevated)] ${t==="admin"?"text-[#B8860B]":"text-[var(--color-text-primary)]"}`,children:[c.jsx(ro,{className:"w-4 h-4"}),c.jsx("span",{children:"Admin"})]}),c.jsxs("button",{onClick:()=>{s("sync"),w(!1)},className:`flex w-full items-center gap-2.5 px-4 py-2.5 text-left text-sm transition-colors hover:bg-[var(--color-bg-elevated)] ${t==="sync"?"text-[#B8860B]":"text-[var(--color-text-primary)]"}`,children:[c.jsx(Wu,{className:"w-4 h-4"}),c.jsx("span",{children:"Synchro"})]}),c.jsx("div",{className:"my-1 border-t border-[var(--color-border-subtle)]"})]}),c.jsxs("button",{onClick:N,className:"flex w-full items-center gap-2.5 px-4 py-2.5 text-left text-sm text-red-400 transition-colors hover:bg-[var(--color-bg-elevated)]",children:[c.jsx(tv,{className:"w-4 h-4"}),c.jsx("span",{children:"Dconnexion"})]})]})]})]})]})})}),c.jsx("main",{className:"flex-1",children:c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8",children:[t==="search"&&c.jsx(PT,{}),x!=="client"&&t==="dataImport"&&c.jsx(sh,{}),x!=="client"&&t==="statistics"&&c.jsx($T,{}),x!=="client"&&t==="admin"&&c.jsx(pg,{}),x!=="client"&&t==="sync"&&c.jsx(sh,{}),x!=="client"&&t==="products"&&c.jsx(kT,{role:x}),t!=="admin"&&t!=="sync"&&c.jsxs("div",{className:"text-center mt-8 mb-6",children:[c.jsx("button",{onClick:g,className:"btn btn-primary",children:"Tester la connexion API"}),i&&c.jsx("p",{className:"mt-2 text-sm text-[var(--color-text-muted)]",children:i})]})]})})]})}const VT=H.createContext(void 0),Yh="ajtpro_theme";function GT({children:e}){const[r,t]=H.useState(()=>localStorage.getItem(Yh)==="light"?"light":"dark");H.useEffect(()=>{const i=document.documentElement;r==="dark"?i.classList.add("dark"):i.classList.remove("dark"),localStorage.setItem(Yh,r)},[r]);const s=()=>t(i=>i==="dark"?"light":"dark");return c.jsxs(VT.Provider,{value:{theme:r,toggleTheme:s},children:[e,c.jsx("button",{onClick:s,className:"fixed bottom-6 right-6 z-50 flex h-12 w-12 items-center justify-center rounded-full bg-gold text-black shadow-lg transition-transform hover:scale-110","aria-label":"Toggle theme",children:r==="dark"?c.jsx(ov,{size:22}):c.jsx(nv,{size:22})})]})}Um.createRoot(document.getElementById("root")).render(c.jsx(H.StrictMode,{children:c.jsx(GT,{children:c.jsx(Zv,{children:c.jsx(HT,{})})})}));
